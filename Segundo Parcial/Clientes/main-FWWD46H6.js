import{A as $0,B as on,C as zr,D as _d,E as pu,F as _m,G as H0,H as q0,I as B,J as Lt,K as nt,L as vm,M as G0,N as gu,O as ie,P as zt,Q as vd,R as wm,S as an,T as Wr,U as Gi,V as wd,W as z0,X as Tn,Y as pt,a as S,b as ce,c as gm,d as v,e as P0,f as fd,g as k0,h as O0,i as D,j as oo,k as pd,l as F0,m as V0,n as ot,o as gd,p as fu,q as mm,r as L0,s as Hn,t as ym,u as md,v as j0,w as U0,x as yd,y as ze,z as B0}from"./chunk-EMU53QTL.js";var W0=null;var Em=1,K0=Symbol("SIGNAL");function Wt(t){let e=W0;return W0=t,e}var Q0={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function LF(t){if(!(Dm(t)&&!t.dirty)&&!(!t.dirty&&t.lastCleanEpoch===Em)){if(!t.producerMustRecompute(t)&&!Im(t)){t.dirty=!1,t.lastCleanEpoch=Em;return}t.producerRecomputeValue(t),t.dirty=!1,t.lastCleanEpoch=Em}}function Y0(t){return t&&(t.nextProducerIndex=0),Wt(t)}function Z0(t,e){if(Wt(e),!(!t||t.producerNode===void 0||t.producerIndexOfThis===void 0||t.producerLastReadVersion===void 0)){if(Dm(t))for(let n=t.nextProducerIndex;n<t.producerNode.length;n++)Cm(t.producerNode[n],t.producerIndexOfThis[n]);for(;t.producerNode.length>t.nextProducerIndex;)t.producerNode.pop(),t.producerLastReadVersion.pop(),t.producerIndexOfThis.pop()}}function Im(t){Ed(t);for(let e=0;e<t.producerNode.length;e++){let n=t.producerNode[e],r=t.producerLastReadVersion[e];if(r!==n.version||(LF(n),r!==n.version))return!0}return!1}function X0(t){if(Ed(t),Dm(t))for(let e=0;e<t.producerNode.length;e++)Cm(t.producerNode[e],t.producerIndexOfThis[e]);t.producerNode.length=t.producerLastReadVersion.length=t.producerIndexOfThis.length=0,t.liveConsumerNode&&(t.liveConsumerNode.length=t.liveConsumerIndexOfThis.length=0)}function Cm(t,e){if(jF(t),Ed(t),t.liveConsumerNode.length===1)for(let r=0;r<t.producerNode.length;r++)Cm(t.producerNode[r],t.producerIndexOfThis[r]);let n=t.liveConsumerNode.length-1;if(t.liveConsumerNode[e]=t.liveConsumerNode[n],t.liveConsumerIndexOfThis[e]=t.liveConsumerIndexOfThis[n],t.liveConsumerNode.length--,t.liveConsumerIndexOfThis.length--,e<t.liveConsumerNode.length){let r=t.liveConsumerIndexOfThis[e],i=t.liveConsumerNode[e];Ed(i),i.producerIndexOfThis[r]=e}}function Dm(t){return t.consumerIsAlwaysLive||(t?.liveConsumerNode?.length??0)>0}function Ed(t){t.producerNode??=[],t.producerIndexOfThis??=[],t.producerLastReadVersion??=[]}function jF(t){t.liveConsumerNode??=[],t.liveConsumerIndexOfThis??=[]}function UF(){throw new Error}var BF=UF;function J0(t){BF=t}function q(t){return typeof t=="function"}function ao(t){let n=t(r=>{Error.call(r),r.stack=new Error().stack});return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}var Id=ao(t=>function(n){t(this),this.message=n?`${n.length} errors occurred during unsubscription:
${n.map((r,i)=>`${i+1}) ${r.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=n});function zi(t,e){if(t){let n=t.indexOf(e);0<=n&&t.splice(n,1)}}var Ue=class t{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;let{_parentage:n}=this;if(n)if(this._parentage=null,Array.isArray(n))for(let s of n)s.remove(this);else n.remove(this);let{initialTeardown:r}=this;if(q(r))try{r()}catch(s){e=s instanceof Id?s.errors:[s]}let{_finalizers:i}=this;if(i){this._finalizers=null;for(let s of i)try{eT(s)}catch(o){e=e??[],o instanceof Id?e=[...e,...o.errors]:e.push(o)}}if(e)throw new Id(e)}}add(e){var n;if(e&&e!==this)if(this.closed)eT(e);else{if(e instanceof t){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(n=this._finalizers)!==null&&n!==void 0?n:[]).push(e)}}_hasParent(e){let{_parentage:n}=this;return n===e||Array.isArray(n)&&n.includes(e)}_addParent(e){let{_parentage:n}=this;this._parentage=Array.isArray(n)?(n.push(e),n):n?[n,e]:e}_removeParent(e){let{_parentage:n}=this;n===e?this._parentage=null:Array.isArray(n)&&zi(n,e)}remove(e){let{_finalizers:n}=this;n&&zi(n,e),e instanceof t&&e._removeParent(this)}};Ue.EMPTY=(()=>{let t=new Ue;return t.closed=!0,t})();var Tm=Ue.EMPTY;function Cd(t){return t instanceof Ue||t&&"closed"in t&&q(t.remove)&&q(t.add)&&q(t.unsubscribe)}function eT(t){q(t)?t():t.unsubscribe()}var bn={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var uo={setTimeout(t,e,...n){let{delegate:r}=uo;return r?.setTimeout?r.setTimeout(t,e,...n):setTimeout(t,e,...n)},clearTimeout(t){let{delegate:e}=uo;return(e?.clearTimeout||clearTimeout)(t)},delegate:void 0};function Dd(t){uo.setTimeout(()=>{let{onUnhandledError:e}=bn;if(e)e(t);else throw t})}function Wi(){}var tT=bm("C",void 0,void 0);function nT(t){return bm("E",void 0,t)}function rT(t){return bm("N",t,void 0)}function bm(t,e,n){return{kind:t,value:e,error:n}}var Ki=null;function co(t){if(bn.useDeprecatedSynchronousErrorHandling){let e=!Ki;if(e&&(Ki={errorThrown:!1,error:null}),t(),e){let{errorThrown:n,error:r}=Ki;if(Ki=null,n)throw r}}else t()}function iT(t){bn.useDeprecatedSynchronousErrorHandling&&Ki&&(Ki.errorThrown=!0,Ki.error=t)}var Qi=class extends Ue{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,Cd(e)&&e.add(this)):this.destination=qF}static create(e,n,r){return new Ir(e,n,r)}next(e){this.isStopped?Am(rT(e),this):this._next(e)}error(e){this.isStopped?Am(nT(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?Am(tT,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},$F=Function.prototype.bind;function Sm(t,e){return $F.call(t,e)}var xm=class{constructor(e){this.partialObserver=e}next(e){let{partialObserver:n}=this;if(n.next)try{n.next(e)}catch(r){Td(r)}}error(e){let{partialObserver:n}=this;if(n.error)try{n.error(e)}catch(r){Td(r)}else Td(e)}complete(){let{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(n){Td(n)}}},Ir=class extends Qi{constructor(e,n,r){super();let i;if(q(e)||!e)i={next:e??void 0,error:n??void 0,complete:r??void 0};else{let s;this&&bn.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),i={next:e.next&&Sm(e.next,s),error:e.error&&Sm(e.error,s),complete:e.complete&&Sm(e.complete,s)}):i=e}this.destination=new xm(i)}};function Td(t){bn.useDeprecatedSynchronousErrorHandling?iT(t):Dd(t)}function HF(t){throw t}function Am(t,e){let{onStoppedNotification:n}=bn;n&&uo.setTimeout(()=>n(t,e))}var qF={closed:!0,next:Wi,error:HF,complete:Wi};var lo=typeof Symbol=="function"&&Symbol.observable||"@@observable";function gt(t){return t}function Mm(...t){return Rm(t)}function Rm(t){return t.length===0?gt:t.length===1?t[0]:function(n){return t.reduce((r,i)=>i(r),n)}}var J=(()=>{class t{constructor(n){n&&(this._subscribe=n)}lift(n){let r=new t;return r.source=this,r.operator=n,r}subscribe(n,r,i){let s=zF(n)?n:new Ir(n,r,i);return co(()=>{let{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(n){try{return this._subscribe(n)}catch(r){n.error(r)}}forEach(n,r){return r=sT(r),new r((i,s)=>{let o=new Ir({next:a=>{try{n(a)}catch(u){s(u),o.unsubscribe()}},error:s,complete:i});this.subscribe(o)})}_subscribe(n){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(n)}[lo](){return this}pipe(...n){return Rm(n)(this)}toPromise(n){return n=sT(n),new n((r,i)=>{let s;this.subscribe(o=>s=o,o=>i(o),()=>r(s))})}}return t.create=e=>new t(e),t})();function sT(t){var e;return(e=t??bn.Promise)!==null&&e!==void 0?e:Promise}function GF(t){return t&&q(t.next)&&q(t.error)&&q(t.complete)}function zF(t){return t&&t instanceof Qi||GF(t)&&Cd(t)}function Nm(t){return q(t?.lift)}function W(t){return e=>{if(Nm(e))return e.lift(function(n){try{return t(n,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function G(t,e,n,r,i){return new Pm(t,e,n,r,i)}var Pm=class extends Qi{constructor(e,n,r,i,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=n?function(a){try{n(a)}catch(u){e.error(u)}}:super._next,this._error=i?function(a){try{i(a)}catch(u){e.error(u)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:n}=this;super.unsubscribe(),!n&&((e=this.onFinalize)===null||e===void 0||e.call(this))}}};function ho(){return W((t,e)=>{let n=null;t._refCount++;let r=G(e,void 0,void 0,void 0,()=>{if(!t||t._refCount<=0||0<--t._refCount){n=null;return}let i=t._connection,s=n;n=null,i&&(!s||i===s)&&i.unsubscribe(),e.unsubscribe()});t.subscribe(r),r.closed||(n=t.connect())})}var fo=class extends J{constructor(e,n){super(),this.source=e,this.subjectFactory=n,this._subject=null,this._refCount=0,this._connection=null,Nm(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){let e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;let{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new Ue;let n=this.getSubject();e.add(this.source.subscribe(G(n,void 0,()=>{this._teardown(),n.complete()},r=>{this._teardown(),n.error(r)},()=>this._teardown()))),e.closed&&(this._connection=null,e=Ue.EMPTY)}return e}refCount(){return ho()(this)}};var oT=ao(t=>function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var rt=(()=>{class t extends J{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(n){let r=new bd(this,this);return r.operator=n,r}_throwIfClosed(){if(this.closed)throw new oT}next(n){co(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let r of this.currentObservers)r.next(n)}})}error(n){co(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=n;let{observers:r}=this;for(;r.length;)r.shift().error(n)}})}complete(){co(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:n}=this;for(;n.length;)n.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var n;return((n=this.observers)===null||n===void 0?void 0:n.length)>0}_trySubscribe(n){return this._throwIfClosed(),super._trySubscribe(n)}_subscribe(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)}_innerSubscribe(n){let{hasError:r,isStopped:i,observers:s}=this;return r||i?Tm:(this.currentObservers=null,s.push(n),new Ue(()=>{this.currentObservers=null,zi(s,n)}))}_checkFinalizedStatuses(n){let{hasError:r,thrownError:i,isStopped:s}=this;r?n.error(i):s&&n.complete()}asObservable(){let n=new J;return n.source=this,n}}return t.create=(e,n)=>new bd(e,n),t})(),bd=class extends rt{constructor(e,n){super(),this.destination=e,this.source=n}next(e){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.next)===null||r===void 0||r.call(n,e)}error(e){var n,r;(r=(n=this.destination)===null||n===void 0?void 0:n.error)===null||r===void 0||r.call(n,e)}complete(){var e,n;(n=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||n===void 0||n.call(e)}_subscribe(e){var n,r;return(r=(n=this.source)===null||n===void 0?void 0:n.subscribe(e))!==null&&r!==void 0?r:Tm}};var mt=class extends rt{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){let n=super._subscribe(e);return!n.closed&&e.next(this._value),n}getValue(){let{hasError:e,thrownError:n,_value:r}=this;if(e)throw n;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}};var mu={now(){return(mu.delegate||Date).now()},delegate:void 0};var Sd=class extends rt{constructor(e=1/0,n=1/0,r=mu){super(),this._bufferSize=e,this._windowTime=n,this._timestampProvider=r,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=n===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,n)}next(e){let{isStopped:n,_buffer:r,_infiniteTimeWindow:i,_timestampProvider:s,_windowTime:o}=this;n||(r.push(e),!i&&r.push(s.now()+o)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();let n=this._innerSubscribe(e),{_infiniteTimeWindow:r,_buffer:i}=this,s=i.slice();for(let o=0;o<s.length&&!e.closed;o+=r?1:2)e.next(s[o]);return this._checkFinalizedStatuses(e),n}_trimBuffer(){let{_bufferSize:e,_timestampProvider:n,_buffer:r,_infiniteTimeWindow:i}=this,s=(i?1:2)*e;if(e<1/0&&s<r.length&&r.splice(0,r.length-s),!i){let o=n.now(),a=0;for(let u=1;u<r.length&&r[u]<=o;u+=2)a=u;a&&r.splice(0,a+1)}}};var Ad=class extends Ue{constructor(e,n){super()}schedule(e,n=0){return this}};var yu={setInterval(t,e,...n){let{delegate:r}=yu;return r?.setInterval?r.setInterval(t,e,...n):setInterval(t,e,...n)},clearInterval(t){let{delegate:e}=yu;return(e?.clearInterval||clearInterval)(t)},delegate:void 0};var po=class extends Ad{constructor(e,n){super(e,n),this.scheduler=e,this.work=n,this.pending=!1}schedule(e,n=0){var r;if(this.closed)return this;this.state=e;let i=this.id,s=this.scheduler;return i!=null&&(this.id=this.recycleAsyncId(s,i,n)),this.pending=!0,this.delay=n,this.id=(r=this.id)!==null&&r!==void 0?r:this.requestAsyncId(s,this.id,n),this}requestAsyncId(e,n,r=0){return yu.setInterval(e.flush.bind(e,this),r)}recycleAsyncId(e,n,r=0){if(r!=null&&this.delay===r&&this.pending===!1)return n;n!=null&&yu.clearInterval(n)}execute(e,n){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;let r=this._execute(e,n);if(r)return r;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,n){let r=!1,i;try{this.work(e)}catch(s){r=!0,i=s||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),i}unsubscribe(){if(!this.closed){let{id:e,scheduler:n}=this,{actions:r}=n;this.work=this.state=this.scheduler=null,this.pending=!1,zi(r,this),e!=null&&(this.id=this.recycleAsyncId(n,e,null)),this.delay=null,super.unsubscribe()}}};var go=class t{constructor(e,n=t.now){this.schedulerActionCtor=e,this.now=n}schedule(e,n=0,r){return new this.schedulerActionCtor(this,e).schedule(r,n)}};go.now=mu.now;var mo=class extends go{constructor(e,n=go.now){super(e,n),this.actions=[],this._active=!1}flush(e){let{actions:n}=this;if(this._active){n.push(e);return}let r;this._active=!0;do if(r=e.execute(e.state,e.delay))break;while(e=n.shift());if(this._active=!1,r){for(;e=n.shift();)e.unsubscribe();throw r}}};var Yi=new mo(po);var xd=class extends po{constructor(e,n){super(e,n),this.scheduler=e,this.work=n}schedule(e,n=0){return n>0?super.schedule(e,n):(this.delay=n,this.state=e,this.scheduler.flush(this),this)}execute(e,n){return n>0||this.closed?super.execute(e,n):this._execute(e,n)}requestAsyncId(e,n,r=0){return r!=null&&r>0||r==null&&this.delay>0?super.requestAsyncId(e,n,r):(e.flush(this),0)}};var Md=class extends mo{};var km=new Md(xd);var jt=new J(t=>t.complete());function aT(t){return t&&q(t.schedule)}function Om(t){return t[t.length-1]}function yo(t){return q(Om(t))?t.pop():void 0}function qn(t){return aT(Om(t))?t.pop():void 0}function uT(t,e){return typeof Om(t)=="number"?t.pop():e}var Rd=t=>t&&typeof t.length=="number"&&typeof t!="function";function Nd(t){return q(t?.then)}function Pd(t){return q(t[lo])}function kd(t){return Symbol.asyncIterator&&q(t?.[Symbol.asyncIterator])}function Od(t){return new TypeError(`You provided ${t!==null&&typeof t=="object"?"an invalid object":`'${t}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function WF(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var Fd=WF();function Vd(t){return q(t?.[Fd])}function Ld(t){return k0(this,arguments,function*(){let n=t.getReader();try{for(;;){let{value:r,done:i}=yield fd(n.read());if(i)return yield fd(void 0);yield yield fd(r)}}finally{n.releaseLock()}})}function jd(t){return q(t?.getReader)}function Ee(t){if(t instanceof J)return t;if(t!=null){if(Pd(t))return KF(t);if(Rd(t))return QF(t);if(Nd(t))return YF(t);if(kd(t))return cT(t);if(Vd(t))return ZF(t);if(jd(t))return XF(t)}throw Od(t)}function KF(t){return new J(e=>{let n=t[lo]();if(q(n.subscribe))return n.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function QF(t){return new J(e=>{for(let n=0;n<t.length&&!e.closed;n++)e.next(t[n]);e.complete()})}function YF(t){return new J(e=>{t.then(n=>{e.closed||(e.next(n),e.complete())},n=>e.error(n)).then(null,Dd)})}function ZF(t){return new J(e=>{for(let n of t)if(e.next(n),e.closed)return;e.complete()})}function cT(t){return new J(e=>{JF(t,e).catch(n=>e.error(n))})}function XF(t){return cT(Ld(t))}function JF(t,e){var n,r,i,s;return P0(this,void 0,void 0,function*(){try{for(n=O0(t);r=yield n.next(),!r.done;){let o=r.value;if(e.next(o),e.closed)return}}catch(o){i={error:o}}finally{try{r&&!r.done&&(s=n.return)&&(yield s.call(n))}finally{if(i)throw i.error}}e.complete()})}function Ut(t,e,n,r=0,i=!1){let s=e.schedule(function(){n(),i?t.add(this.schedule(null,r)):this.unsubscribe()},r);if(t.add(s),!i)return s}function un(t,e=0){return W((n,r)=>{n.subscribe(G(r,i=>Ut(r,t,()=>r.next(i),e),()=>Ut(r,t,()=>r.complete(),e),i=>Ut(r,t,()=>r.error(i),e)))})}function Sn(t,e=0){return W((n,r)=>{r.add(t.schedule(()=>n.subscribe(r),e))})}function lT(t,e){return Ee(t).pipe(Sn(e),un(e))}function dT(t,e){return Ee(t).pipe(Sn(e),un(e))}function hT(t,e){return new J(n=>{let r=0;return e.schedule(function(){r===t.length?n.complete():(n.next(t[r++]),n.closed||this.schedule())})})}function fT(t,e){return new J(n=>{let r;return Ut(n,e,()=>{r=t[Fd](),Ut(n,e,()=>{let i,s;try{({value:i,done:s}=r.next())}catch(o){n.error(o);return}s?n.complete():n.next(i)},0,!0)}),()=>q(r?.return)&&r.return()})}function Ud(t,e){if(!t)throw new Error("Iterable cannot be null");return new J(n=>{Ut(n,e,()=>{let r=t[Symbol.asyncIterator]();Ut(n,e,()=>{r.next().then(i=>{i.done?n.complete():n.next(i.value)})},0,!0)})})}function pT(t,e){return Ud(Ld(t),e)}function gT(t,e){if(t!=null){if(Pd(t))return lT(t,e);if(Rd(t))return hT(t,e);if(Nd(t))return dT(t,e);if(kd(t))return Ud(t,e);if(Vd(t))return fT(t,e);if(jd(t))return pT(t,e)}throw Od(t)}function fe(t,e){return e?gT(t,e):Ee(t)}function V(...t){let e=qn(t);return fe(t,e)}function _o(t,e){let n=q(t)?t:()=>t,r=i=>i.error(n());return new J(e?i=>e.schedule(r,0,i):r)}function Fm(t){return!!t&&(t instanceof J||q(t.lift)&&q(t.subscribe))}var Cr=ao(t=>function(){t(this),this.name="EmptyError",this.message="no elements in sequence"});function F(t,e){return W((n,r)=>{let i=0;n.subscribe(G(r,s=>{r.next(t.call(e,s,i++))}))})}var{isArray:eV}=Array;function tV(t,e){return eV(e)?t(...e):t(e)}function Bd(t){return F(e=>tV(t,e))}var{isArray:nV}=Array,{getPrototypeOf:rV,prototype:iV,keys:sV}=Object;function $d(t){if(t.length===1){let e=t[0];if(nV(e))return{args:e,keys:null};if(oV(e)){let n=sV(e);return{args:n.map(r=>e[r]),keys:n}}}return{args:t,keys:null}}function oV(t){return t&&typeof t=="object"&&rV(t)===iV}function Hd(t,e){return t.reduce((n,r,i)=>(n[r]=e[i],n),{})}function _u(...t){let e=qn(t),n=yo(t),{args:r,keys:i}=$d(t);if(r.length===0)return fe([],e);let s=new J(aV(r,e,i?o=>Hd(i,o):gt));return n?s.pipe(Bd(n)):s}function aV(t,e,n=gt){return r=>{mT(e,()=>{let{length:i}=t,s=new Array(i),o=i,a=i;for(let u=0;u<i;u++)mT(e,()=>{let c=fe(t[u],e),l=!1;c.subscribe(G(r,d=>{s[u]=d,l||(l=!0,a--),a||r.next(n(s.slice()))},()=>{--o||r.complete()}))},r)},r)}}function mT(t,e,n){t?Ut(n,t,e):e()}function yT(t,e,n,r,i,s,o,a){let u=[],c=0,l=0,d=!1,h=()=>{d&&!u.length&&!c&&e.complete()},f=g=>c<r?p(g):u.push(g),p=g=>{s&&e.next(g),c++;let _=!1;Ee(n(g,l++)).subscribe(G(e,C=>{i?.(C),s?f(C):e.next(C)},()=>{_=!0},void 0,()=>{if(_)try{for(c--;u.length&&c<r;){let C=u.shift();o?Ut(e,o,()=>p(C)):p(C)}h()}catch(C){e.error(C)}}))};return t.subscribe(G(e,f,()=>{d=!0,h()})),()=>{a?.()}}function We(t,e,n=1/0){return q(e)?We((r,i)=>F((s,o)=>e(r,s,i,o))(Ee(t(r,i))),n):(typeof e=="number"&&(n=e),W((r,i)=>yT(r,i,t,n)))}function Kr(t=1/0){return We(gt,t)}function _T(){return Kr(1)}function vo(...t){return _T()(fe(t,qn(t)))}function qd(t){return new J(e=>{Ee(t()).subscribe(e)})}function Vm(...t){let e=yo(t),{args:n,keys:r}=$d(t),i=new J(s=>{let{length:o}=n;if(!o){s.complete();return}let a=new Array(o),u=o,c=o;for(let l=0;l<o;l++){let d=!1;Ee(n[l]).subscribe(G(s,h=>{d||(d=!0,c--),a[l]=h},()=>u--,void 0,()=>{(!u||!d)&&(c||s.next(r?Hd(r,a):a),s.complete())}))}});return e?i.pipe(Bd(e)):i}function wo(...t){let e=qn(t),n=uT(t,1/0),r=t;return r.length?r.length===1?Ee(r[0]):Kr(n)(fe(r,e)):jt}function yt(t,e){return W((n,r)=>{let i=0;n.subscribe(G(r,s=>t.call(e,s,i++)&&r.next(s)))})}function Qr(t){return W((e,n)=>{let r=null,i=!1,s;r=e.subscribe(G(n,void 0,void 0,o=>{s=Ee(t(o,Qr(t)(e))),r?(r.unsubscribe(),r=null,s.subscribe(n)):i=!0})),i&&(r.unsubscribe(),r=null,s.subscribe(n))})}function vT(t,e,n,r,i){return(s,o)=>{let a=n,u=e,c=0;s.subscribe(G(o,l=>{let d=c++;u=a?t(u,l,d):(a=!0,l),r&&o.next(u)},i&&(()=>{a&&o.next(u),o.complete()})))}}function Zi(t,e){return q(e)?We(t,e,1):We(t,1)}function Yr(t){return W((e,n)=>{let r=!1;e.subscribe(G(n,i=>{r=!0,n.next(i)},()=>{r||n.next(t),n.complete()}))})}function Dr(t){return t<=0?()=>jt:W((e,n)=>{let r=0;e.subscribe(G(n,i=>{++r<=t&&(n.next(i),t<=r&&n.complete())}))})}function Lm(t){return F(()=>t)}function vu(t,e=gt){return t=t??uV,W((n,r)=>{let i,s=!0;n.subscribe(G(r,o=>{let a=e(o);(s||!t(i,a))&&(s=!1,i=a,r.next(o))}))})}function uV(t,e){return t===e}function Gd(t=cV){return W((e,n)=>{let r=!1;e.subscribe(G(n,i=>{r=!0,n.next(i)},()=>r?n.complete():n.error(t())))})}function cV(){return new Cr}function wu(t){return W((e,n)=>{try{e.subscribe(n)}finally{n.add(t)}})}function cn(t,e){let n=arguments.length>=2;return r=>r.pipe(t?yt((i,s)=>t(i,s,r)):gt,Dr(1),n?Yr(e):Gd(()=>new Cr))}function Eo(t){return t<=0?()=>jt:W((e,n)=>{let r=[];e.subscribe(G(n,i=>{r.push(i),t<r.length&&r.shift()},()=>{for(let i of r)n.next(i);n.complete()},void 0,()=>{r=null}))})}function jm(t,e){let n=arguments.length>=2;return r=>r.pipe(t?yt((i,s)=>t(i,s,r)):gt,Eo(1),n?Yr(e):Gd(()=>new Cr))}function Eu(){return W((t,e)=>{let n,r=!1;t.subscribe(G(e,i=>{let s=n;n=i,r&&e.next([s,i]),r=!0}))})}function Gn(t,e){return W(vT(t,e,arguments.length>=2,!0))}function Iu(t={}){let{connector:e=()=>new rt,resetOnError:n=!0,resetOnComplete:r=!0,resetOnRefCountZero:i=!0}=t;return s=>{let o,a,u,c=0,l=!1,d=!1,h=()=>{a?.unsubscribe(),a=void 0},f=()=>{h(),o=u=void 0,l=d=!1},p=()=>{let g=o;f(),g?.unsubscribe()};return W((g,_)=>{c++,!d&&!l&&h();let C=u=u??e();_.add(()=>{c--,c===0&&!d&&!l&&(a=Um(p,i))}),C.subscribe(_),!o&&c>0&&(o=new Ir({next:M=>C.next(M),error:M=>{d=!0,h(),a=Um(f,n,M),C.error(M)},complete:()=>{l=!0,h(),a=Um(f,r),C.complete()}}),Ee(g).subscribe(o))})(s)}}function Um(t,e,...n){if(e===!0){t();return}if(e===!1)return;let r=new Ir({next:()=>{r.unsubscribe(),t()}});return Ee(e(...n)).subscribe(r)}function zd(t,e,n){let r,i=!1;return t&&typeof t=="object"?{bufferSize:r=1/0,windowTime:e=1/0,refCount:i=!1,scheduler:n}=t:r=t??1/0,Iu({connector:()=>new Sd(r,e,n),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:i})}function Bm(t){return W((e,n)=>{let r=!1,i=0;e.subscribe(G(n,s=>(r||(r=!t(s,i++)))&&n.next(s)))})}function Xi(...t){let e=qn(t);return W((n,r)=>{(e?vo(t,n,e):vo(t,n)).subscribe(r)})}function Re(t,e){return W((n,r)=>{let i=null,s=0,o=!1,a=()=>o&&!i&&r.complete();n.subscribe(G(r,u=>{i?.unsubscribe();let c=0,l=s++;Ee(t(u,l)).subscribe(i=G(r,d=>r.next(e?e(u,d,l,c++):d),()=>{i=null,a()}))},()=>{o=!0,a()}))})}function Wd(t,e){return q(e)?Re(()=>t,e):Re(()=>t)}function $m(t){return W((e,n)=>{Ee(t).subscribe(G(n,()=>n.complete(),Wi)),!n.closed&&e.subscribe(n)})}function Ke(t,e,n){let r=q(t)||e||n?{next:t,error:e,complete:n}:t;return r?W((i,s)=>{var o;(o=r.subscribe)===null||o===void 0||o.call(r);let a=!0;i.subscribe(G(s,u=>{var c;(c=r.next)===null||c===void 0||c.call(r,u),s.next(u)},()=>{var u;a=!1,(u=r.complete)===null||u===void 0||u.call(r),s.complete()},u=>{var c;a=!1,(c=r.error)===null||c===void 0||c.call(r,u),s.error(u)},()=>{var u,c;a&&((u=r.unsubscribe)===null||u===void 0||u.call(r)),(c=r.finalize)===null||c===void 0||c.call(r)}))}):gt}function Hm(...t){let e=yo(t);return W((n,r)=>{let i=t.length,s=new Array(i),o=t.map(()=>!1),a=!1;for(let u=0;u<i;u++)Ee(t[u]).subscribe(G(r,c=>{s[u]=c,!a&&!o[u]&&(o[u]=!0,(a=o.every(gt))&&(o=null))},Wi));n.subscribe(G(r,u=>{if(a){let c=[u,...s];r.next(e?e(...c):c)}}))})}var lV="https://g.co/ng/security#xss",U=class extends Error{constructor(e,n){super(zy(e,n)),this.code=e}};function zy(t,e){return`${`NG0${Math.abs(t)}`}${e?": "+e:""}`}function Ie(t){for(let e in t)if(t[e]===Ie)return e;throw Error("Could not find renamed property on target object.")}function dV(t,e){for(let n in e)e.hasOwnProperty(n)&&!t.hasOwnProperty(n)&&(t[n]=e[n])}function Bt(t){if(typeof t=="string")return t;if(Array.isArray(t))return"["+t.map(Bt).join(", ")+"]";if(t==null)return""+t;if(t.overriddenName)return`${t.overriddenName}`;if(t.name)return`${t.name}`;let e=t.toString();if(e==null)return""+e;let n=e.indexOf(`
`);return n===-1?e:e.substring(0,n)}function wT(t,e){return t==null||t===""?e===null?"":e:e==null||e===""?t:t+" "+e}var hV=Ie({__forward_ref__:Ie});function us(t){return t.__forward_ref__=us,t.toString=function(){return Bt(this())},t}function xt(t){return sb(t)?t():t}function sb(t){return typeof t=="function"&&t.hasOwnProperty(hV)&&t.__forward_ref__===us}function ob(t){return t&&!!t.\u0275providers}var fV=Ie({\u0275cmp:Ie}),pV=Ie({\u0275dir:Ie}),gV=Ie({\u0275pipe:Ie}),mV=Ie({\u0275mod:Ie}),rh=Ie({\u0275fac:Ie}),Cu=Ie({__NG_ELEMENT_ID__:Ie}),ET=Ie({__NG_ENV_ID__:Ie});function ab(t){return typeof t=="string"?t:t==null?"":String(t)}function yV(t){return typeof t=="function"?t.name||t.toString():typeof t=="object"&&t!=null&&typeof t.type=="function"?t.type.name||t.type.toString():ab(t)}function _V(t,e){let n=e?`. Dependency path: ${e.join(" > ")} > ${t}`:"";throw new U(-200,t)}function Wy(t,e){throw new U(-201,!1)}function k(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function Qe(t){return{providers:t.providers||[],imports:t.imports||[]}}function Dh(t){return IT(t,cb)||IT(t,lb)}function ub(t){return Dh(t)!==null}function IT(t,e){return t.hasOwnProperty(e)?t[e]:null}function vV(t){let e=t&&(t[cb]||t[lb]);return e||null}function CT(t){return t&&(t.hasOwnProperty(DT)||t.hasOwnProperty(wV))?t[DT]:null}var cb=Ie({\u0275prov:Ie}),DT=Ie({\u0275inj:Ie}),lb=Ie({ngInjectableDef:Ie}),wV=Ie({ngInjectorDef:Ie}),ne=function(t){return t[t.Default=0]="Default",t[t.Host=1]="Host",t[t.Self=2]="Self",t[t.SkipSelf=4]="SkipSelf",t[t.Optional=8]="Optional",t}(ne||{}),iy;function db(){return iy}function ln(t){let e=iy;return iy=t,e}function hb(t,e,n){let r=Dh(t);if(r&&r.providedIn=="root")return r.value===void 0?r.value=r.factory():r.value;if(n&ne.Optional)return null;if(e!==void 0)return e;Wy(t,"Injector")}var Kt=globalThis;var P=class{constructor(e,n){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,typeof n=="number"?this.__NG_ELEMENT_ID__=n:n!==void 0&&(this.\u0275prov=k({token:this,providedIn:n.providedIn||"root",factory:n.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};var EV={},Tu=EV,sy="__NG_DI_FLAG__",ih="ngTempTokenPath",IV="ngTokenPath",CV=/\n/gm,DV="\u0275",TT="__source",bo;function TV(){return bo}function Zr(t){let e=bo;return bo=t,e}function bV(t,e=ne.Default){if(bo===void 0)throw new U(-203,!1);return bo===null?hb(t,void 0,e):bo.get(t,e&ne.Optional?null:void 0,e)}function I(t,e=ne.Default){return(db()||bV)(xt(t),e)}function R(t,e=ne.Default){return I(t,Th(e))}function Th(t){return typeof t>"u"||typeof t=="number"?t:0|(t.optional&&8)|(t.host&&1)|(t.self&&2)|(t.skipSelf&&4)}function oy(t){let e=[];for(let n=0;n<t.length;n++){let r=xt(t[n]);if(Array.isArray(r)){if(r.length===0)throw new U(900,!1);let i,s=ne.Default;for(let o=0;o<r.length;o++){let a=r[o],u=SV(a);typeof u=="number"?u===-1?i=a.token:s|=u:i=a}e.push(I(i,s))}else e.push(I(r))}return e}function fb(t,e){return t[sy]=e,t.prototype[sy]=e,t}function SV(t){return t[sy]}function AV(t,e,n,r){let i=t[ih];throw e[TT]&&i.unshift(e[TT]),t.message=xV(`
`+t.message,i,n,r),t[IV]=i,t[ih]=null,t}function xV(t,e,n,r=null){t=t&&t.charAt(0)===`
`&&t.charAt(1)==DV?t.slice(2):t;let i=Bt(e);if(Array.isArray(e))i=e.map(Bt).join(" -> ");else if(typeof e=="object"){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+(typeof a=="string"?JSON.stringify(a):Bt(a)))}i=`{${s.join(", ")}}`}return`${n}${r?"("+r+")":""}[${i}]: ${t.replace(CV,`
  `)}`}function Fu(t){return{toString:t}.toString()}var pb=function(t){return t[t.OnPush=0]="OnPush",t[t.Default=1]="Default",t}(pb||{}),Kn=function(t){return t[t.Emulated=0]="Emulated",t[t.None=2]="None",t[t.ShadowDom=3]="ShadowDom",t}(Kn||{}),Ao={},dn=[],fn=function(t){return t[t.None=0]="None",t[t.SignalBased=1]="SignalBased",t[t.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",t}(fn||{});function gb(t,e,n){let r=t.length;for(;;){let i=t.indexOf(e,n);if(i===-1)return i;if(i===0||t.charCodeAt(i-1)<=32){let s=e.length;if(i+s===r||t.charCodeAt(i+s)<=32)return i}n=i+1}}function ay(t,e,n){let r=0;for(;r<n.length;){let i=n[r];if(typeof i=="number"){if(i!==0)break;r++;let s=n[r++],o=n[r++],a=n[r++];t.setAttribute(e,o,a,s)}else{let s=i,o=n[++r];RV(s)?t.setProperty(e,s,o):t.setAttribute(e,s,o),r++}}return r}function MV(t){return t===3||t===4||t===6}function RV(t){return t.charCodeAt(0)===64}function bu(t,e){if(!(e===null||e.length===0))if(t===null||t.length===0)t=e.slice();else{let n=-1;for(let r=0;r<e.length;r++){let i=e[r];typeof i=="number"?n=i:n===0||(n===-1||n===2?bT(t,n,i,null,e[++r]):bT(t,n,i,null,null))}}return t}function bT(t,e,n,r,i){let s=0,o=t.length;if(e===-1)o=-1;else for(;s<t.length;){let a=t[s++];if(typeof a=="number"){if(a===e){o=-1;break}else if(a>e){o=s-1;break}}}for(;s<t.length;){let a=t[s];if(typeof a=="number")break;if(a===n){if(r===null){i!==null&&(t[s+1]=i);return}else if(r===t[s+1]){t[s+2]=i;return}}s++,r!==null&&s++,i!==null&&s++}o!==-1&&(t.splice(o,0,e),s=o+1),t.splice(s++,0,n),r!==null&&t.splice(s++,0,r),i!==null&&t.splice(s++,0,i)}var mb="ng-template";function NV(t,e,n){let r=0,i=!0;for(;r<t.length;){let s=t[r++];if(typeof s=="string"&&i){let o=t[r++];if(n&&s==="class"&&gb(o.toLowerCase(),e,0)!==-1)return!0}else if(s===1){for(;r<t.length&&typeof(s=t[r++])=="string";)if(s.toLowerCase()===e)return!0;return!1}else typeof s=="number"&&(i=!1)}return!1}function yb(t){return t.type===4&&t.value!==mb}function PV(t,e,n){let r=t.type===4&&!n?mb:t.value;return e===r}function kV(t,e,n){let r=4,i=t.attrs||[],s=VV(i),o=!1;for(let a=0;a<e.length;a++){let u=e[a];if(typeof u=="number"){if(!o&&!An(r)&&!An(u))return!1;if(o&&An(u))continue;o=!1,r=u|r&1;continue}if(!o)if(r&4){if(r=2|r&1,u!==""&&!PV(t,u,n)||u===""&&e.length===1){if(An(r))return!1;o=!0}}else{let c=r&8?u:e[++a];if(r&8&&t.attrs!==null){if(!NV(t.attrs,c,n)){if(An(r))return!1;o=!0}continue}let l=r&8?"class":u,d=OV(l,i,yb(t),n);if(d===-1){if(An(r))return!1;o=!0;continue}if(c!==""){let h;d>s?h="":h=i[d+1].toLowerCase();let f=r&8?h:null;if(f&&gb(f,c,0)!==-1||r&2&&c!==h){if(An(r))return!1;o=!0}}}}return An(r)||o}function An(t){return(t&1)===0}function OV(t,e,n,r){if(e===null)return-1;let i=0;if(r||!n){let s=!1;for(;i<e.length;){let o=e[i];if(o===t)return i;if(o===3||o===6)s=!0;else if(o===1||o===2){let a=e[++i];for(;typeof a=="string";)a=e[++i];continue}else{if(o===4)break;if(o===0){i+=4;continue}}i+=s?1:2}return-1}else return LV(e,t)}function FV(t,e,n=!1){for(let r=0;r<e.length;r++)if(kV(t,e[r],n))return!0;return!1}function VV(t){for(let e=0;e<t.length;e++){let n=t[e];if(MV(n))return e}return t.length}function LV(t,e){let n=t.indexOf(4);if(n>-1)for(n++;n<t.length;){let r=t[n];if(typeof r=="number")return-1;if(r===e)return n;n++}return-1}function ST(t,e){return t?":not("+e.trim()+")":e}function jV(t){let e=t[0],n=1,r=2,i="",s=!1;for(;n<t.length;){let o=t[n];if(typeof o=="string")if(r&2){let a=t[++n];i+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else r&8?i+="."+o:r&4&&(i+=" "+o);else i!==""&&!An(o)&&(e+=ST(s,i),i=""),r=o,s=s||!An(r);n++}return i!==""&&(e+=ST(s,i)),e}function UV(t){return t.map(jV).join(",")}function BV(t){let e=[],n=[],r=1,i=2;for(;r<t.length;){let s=t[r];if(typeof s=="string")i===2?s!==""&&e.push(s,t[++r]):i===8&&n.push(s);else{if(!An(i))break;i=s}r++}return{attrs:e,classes:n}}function Fo(t){return Fu(()=>{let e=Ib(t),n=ce(S({},e),{decls:t.decls,vars:t.vars,template:t.template,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,onPush:t.changeDetection===pb.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&t.dependencies||null,getStandaloneInjector:null,signals:t.signals??!1,data:t.data||{},encapsulation:t.encapsulation||Kn.Emulated,styles:t.styles||dn,_:null,schemas:t.schemas||null,tView:null,id:""});Cb(n);let r=t.dependencies;return n.directiveDefs=xT(r,!1),n.pipeDefs=xT(r,!0),n.id=qV(n),n})}function $V(t){return Jr(t)||_b(t)}function HV(t){return t!==null}function Ye(t){return Fu(()=>({type:t.type,bootstrap:t.bootstrap||dn,declarations:t.declarations||dn,imports:t.imports||dn,exports:t.exports||dn,transitiveCompileScopes:null,schemas:t.schemas||null,id:t.id||null}))}function AT(t,e){if(t==null)return Ao;let n={};for(let r in t)if(t.hasOwnProperty(r)){let i=t[r],s,o,a=fn.None;Array.isArray(i)?(a=i[0],s=i[1],o=i[2]??s):(s=i,o=i),e?(n[s]=a!==fn.None?[r,a]:r,e[s]=o):n[s]=r}return n}function $t(t){return Fu(()=>{let e=Ib(t);return Cb(e),e})}function Jr(t){return t[fV]||null}function _b(t){return t[pV]||null}function vb(t){return t[gV]||null}function wb(t){let e=Jr(t)||_b(t)||vb(t);return e!==null?e.standalone:!1}function Eb(t,e){let n=t[mV]||null;if(!n&&e===!0)throw new Error(`Type ${Bt(t)} does not have '\u0275mod' property.`);return n}function Ib(t){let e={};return{type:t.type,providersResolver:null,factory:null,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:t.inputs||Ao,exportAs:t.exportAs||null,standalone:t.standalone===!0,signals:t.signals===!0,selectors:t.selectors||dn,viewQuery:t.viewQuery||null,features:t.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:AT(t.inputs,e),outputs:AT(t.outputs),debugInfo:null}}function Cb(t){t.features?.forEach(e=>e(t))}function xT(t,e){if(!t)return null;let n=e?vb:$V;return()=>(typeof t=="function"?t():t).map(r=>n(r)).filter(HV)}function qV(t){let e=0,n=[t.selectors,t.ngContentSelectors,t.hostVars,t.hostAttrs,t.consts,t.vars,t.decls,t.encapsulation,t.standalone,t.signals,t.exportAs,JSON.stringify(t.inputs),JSON.stringify(t.outputs),Object.getOwnPropertyNames(t.type.prototype),!!t.contentQueries,!!t.viewQuery].join("|");for(let i of n)e=Math.imul(31,e)+i.charCodeAt(0)<<0;return e+=2147483648,"c"+e}var Sr=0,ue=1,H=2,Et=3,xn=4,Rn=5,sh=6,Su=7,Mn=8,xo=9,ei=10,It=11,Au=12,MT=13,Vo=14,Qn=15,bh=16,Io=17,xu=18,Sh=19,Db=20,Xr=21,qm=22,ts=23,ti=25,Tb=1;var ns=7,oh=8,ah=9,hn=10,Ky=function(t){return t[t.None=0]="None",t[t.HasTransplantedViews=2]="HasTransplantedViews",t}(Ky||{});function Ji(t){return Array.isArray(t)&&typeof t[Tb]=="object"}function Ar(t){return Array.isArray(t)&&t[Tb]===!0}function bb(t){return(t.flags&4)!==0}function Ah(t){return t.componentOffset>-1}function Qy(t){return(t.flags&1)===1}function ni(t){return!!t.template}function GV(t){return(t[H]&512)!==0}function Mo(t,e){let n=t.hasOwnProperty(rh);return n?t[rh]:null}var uy=class{constructor(e,n,r){this.previousValue=e,this.currentValue=n,this.firstChange=r}isFirstChange(){return this.firstChange}};function Sb(t,e,n,r){e!==null?e.applyValueToInputSignal(e,r):t[n]=r}function Lo(){return Ab}function Ab(t){return t.type.prototype.ngOnChanges&&(t.setInput=WV),zV}Lo.ngInherit=!0;function zV(){let t=Mb(this),e=t?.current;if(e){let n=t.previous;if(n===Ao)t.previous=e;else for(let r in e)n[r]=e[r];t.current=null,this.ngOnChanges(e)}}function WV(t,e,n,r,i){let s=this.declaredInputs[r],o=Mb(t)||KV(t,{previous:Ao,current:null}),a=o.current||(o.current={}),u=o.previous,c=u[s];a[s]=new uy(c&&c.currentValue,n,u===Ao),Sb(t,e,i,n)}var xb="__ngSimpleChanges__";function Mb(t){return t[xb]||null}function KV(t,e){return t[xb]=e}var RT=null;var zn=function(t,e,n){RT?.(t,e,n)},QV="svg",YV="math",ZV=!1;function XV(){return ZV}function Yn(t){for(;Array.isArray(t);)t=t[Sr];return t}function Rb(t,e){return Yn(e[t])}function Nn(t,e){return Yn(e[t.index])}function Nb(t,e){return t.data[e]}function ii(t,e){let n=e[t];return Ji(n)?n:n[Sr]}function Yy(t){return(t[H]&128)===128}function JV(t){return Ar(t[Et])}function uh(t,e){return e==null?null:t[e]}function Pb(t){t[Io]=0}function eL(t){t[H]&1024||(t[H]|=1024,Yy(t)&&Mu(t))}function tL(t,e){for(;t>0;)e=e[Vo],t--;return e}function Zy(t){return!!(t[H]&9216||t[ts]?.dirty)}function cy(t){Zy(t)?Mu(t):t[H]&64&&(XV()?(t[H]|=1024,Mu(t)):t[ei].changeDetectionScheduler?.notify())}function Mu(t){t[ei].changeDetectionScheduler?.notify();let e=Ru(t);for(;e!==null&&!(e[H]&8192||(e[H]|=8192,!Yy(e)));)e=Ru(e)}function kb(t,e){if((t[H]&256)===256)throw new U(911,!1);t[Xr]===null&&(t[Xr]=[]),t[Xr].push(e)}function nL(t,e){if(t[Xr]===null)return;let n=t[Xr].indexOf(e);n!==-1&&t[Xr].splice(n,1)}function Ru(t){let e=t[Et];return Ar(e)?e[Et]:e}var oe={lFrame:qb(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function rL(){return oe.lFrame.elementDepthCount}function iL(){oe.lFrame.elementDepthCount++}function sL(){oe.lFrame.elementDepthCount--}function Ob(){return oe.bindingsEnabled}function oL(){return oe.skipHydrationRootTNode!==null}function aL(t){return oe.skipHydrationRootTNode===t}function uL(){oe.skipHydrationRootTNode=null}function Be(){return oe.lFrame.lView}function Xn(){return oe.lFrame.tView}function Fb(t){return oe.lFrame.contextLView=t,t[Mn]}function Vb(t){return oe.lFrame.contextLView=null,t}function pn(){let t=Lb();for(;t!==null&&t.type===64;)t=t.parent;return t}function Lb(){return oe.lFrame.currentTNode}function cL(){let t=oe.lFrame,e=t.currentTNode;return t.isParent?e:e.parent}function Vu(t,e){let n=oe.lFrame;n.currentTNode=t,n.isParent=e}function jb(){return oe.lFrame.isParent}function lL(){oe.lFrame.isParent=!1}function dL(t){return oe.lFrame.bindingIndex=t}function Ub(){return oe.lFrame.bindingIndex++}function hL(t){let e=oe.lFrame,n=e.bindingIndex;return e.bindingIndex=e.bindingIndex+t,n}function fL(){return oe.lFrame.inI18n}function pL(t,e){let n=oe.lFrame;n.bindingIndex=n.bindingRootIndex=t,ly(e)}function gL(){return oe.lFrame.currentDirectiveIndex}function ly(t){oe.lFrame.currentDirectiveIndex=t}function mL(t){let e=oe.lFrame.currentDirectiveIndex;return e===-1?null:t[e]}function Bb(t){oe.lFrame.currentQueryIndex=t}function yL(t){let e=t[ue];return e.type===2?e.declTNode:e.type===1?t[Rn]:null}function $b(t,e,n){if(n&ne.SkipSelf){let i=e,s=t;for(;i=i.parent,i===null&&!(n&ne.Host);)if(i=yL(s),i===null||(s=s[Vo],i.type&10))break;if(i===null)return!1;e=i,t=s}let r=oe.lFrame=Hb();return r.currentTNode=e,r.lView=t,!0}function Xy(t){let e=Hb(),n=t[ue];oe.lFrame=e,e.currentTNode=n.firstChild,e.lView=t,e.tView=n,e.contextLView=t,e.bindingIndex=n.bindingStartIndex,e.inI18n=!1}function Hb(){let t=oe.lFrame,e=t===null?null:t.child;return e===null?qb(t):e}function qb(t){let e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null,inI18n:!1};return t!==null&&(t.child=e),e}function Gb(){let t=oe.lFrame;return oe.lFrame=t.parent,t.currentTNode=null,t.lView=null,t}var zb=Gb;function Jy(){let t=Gb();t.isParent=!0,t.tView=null,t.selectedIndex=-1,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function _L(t){return(oe.lFrame.contextLView=tL(t,oe.lFrame.contextLView))[Mn]}function jo(){return oe.lFrame.selectedIndex}function rs(t){oe.lFrame.selectedIndex=t}function vL(){let t=oe.lFrame;return Nb(t.tView,t.selectedIndex)}function wL(){return oe.lFrame.currentNamespace}var Wb=!0;function e_(){return Wb}function t_(t){Wb=t}function EL(t,e,n){let{ngOnChanges:r,ngOnInit:i,ngDoCheck:s}=e.type.prototype;if(r){let o=Ab(e);(n.preOrderHooks??=[]).push(t,o),(n.preOrderCheckHooks??=[]).push(t,o)}i&&(n.preOrderHooks??=[]).push(0-t,i),s&&((n.preOrderHooks??=[]).push(t,s),(n.preOrderCheckHooks??=[]).push(t,s))}function n_(t,e){for(let n=e.directiveStart,r=e.directiveEnd;n<r;n++){let s=t.data[n].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:u,ngAfterViewChecked:c,ngOnDestroy:l}=s;o&&(t.contentHooks??=[]).push(-n,o),a&&((t.contentHooks??=[]).push(n,a),(t.contentCheckHooks??=[]).push(n,a)),u&&(t.viewHooks??=[]).push(-n,u),c&&((t.viewHooks??=[]).push(n,c),(t.viewCheckHooks??=[]).push(n,c)),l!=null&&(t.destroyHooks??=[]).push(n,l)}}function Xd(t,e,n){Kb(t,e,3,n)}function Jd(t,e,n,r){(t[H]&3)===n&&Kb(t,e,n,r)}function Gm(t,e){let n=t[H];(n&3)===e&&(n&=16383,n+=1,t[H]=n)}function Kb(t,e,n,r){let i=r!==void 0?t[Io]&65535:0,s=r??-1,o=e.length-1,a=0;for(let u=i;u<o;u++)if(typeof e[u+1]=="number"){if(a=e[u],r!=null&&a>=r)break}else e[u]<0&&(t[Io]+=65536),(a<s||s==-1)&&(IL(t,n,e,u),t[Io]=(t[Io]&4294901760)+u+2),u++}function NT(t,e){zn(4,t,e);let n=Wt(null);try{e.call(t)}finally{Wt(n),zn(5,t,e)}}function IL(t,e,n,r){let i=n[r]<0,s=n[r+1],o=i?-n[r]:n[r],a=t[o];i?t[H]>>14<t[Io]>>16&&(t[H]&3)===e&&(t[H]+=16384,NT(a,s)):NT(a,s)}var So=-1,is=class{constructor(e,n,r){this.factory=e,this.resolving=!1,this.canSeeViewProviders=n,this.injectImpl=r}};function CL(t){return t instanceof is}function DL(t){return(t.flags&8)!==0}function TL(t){return(t.flags&16)!==0}function Qb(t){return t!==So}function ch(t){return t&32767}function bL(t){return t>>16}function lh(t,e){let n=bL(t),r=e;for(;n>0;)r=r[Vo],n--;return r}var dy=!0;function PT(t){let e=dy;return dy=t,e}var SL=256,Yb=SL-1,Zb=5,AL=0,Wn={};function xL(t,e,n){let r;typeof n=="string"?r=n.charCodeAt(0)||0:n.hasOwnProperty(Cu)&&(r=n[Cu]),r==null&&(r=n[Cu]=AL++);let i=r&Yb,s=1<<i;e.data[t+(i>>Zb)]|=s}function dh(t,e){let n=Xb(t,e);if(n!==-1)return n;let r=e[ue];r.firstCreatePass&&(t.injectorIndex=e.length,zm(r.data,t),zm(e,null),zm(r.blueprint,null));let i=r_(t,e),s=t.injectorIndex;if(Qb(i)){let o=ch(i),a=lh(i,e),u=a[ue].data;for(let c=0;c<8;c++)e[s+c]=a[o+c]|u[o+c]}return e[s+8]=i,s}function zm(t,e){t.push(0,0,0,0,0,0,0,0,e)}function Xb(t,e){return t.injectorIndex===-1||t.parent&&t.parent.injectorIndex===t.injectorIndex||e[t.injectorIndex+8]===null?-1:t.injectorIndex}function r_(t,e){if(t.parent&&t.parent.injectorIndex!==-1)return t.parent.injectorIndex;let n=0,r=null,i=e;for(;i!==null;){if(r=rS(i),r===null)return So;if(n++,i=i[Vo],r.injectorIndex!==-1)return r.injectorIndex|n<<16}return So}function hy(t,e,n){xL(t,e,n)}function Jb(t,e,n){if(n&ne.Optional||t!==void 0)return t;Wy(e,"NodeInjector")}function eS(t,e,n,r){if(n&ne.Optional&&r===void 0&&(r=null),!(n&(ne.Self|ne.Host))){let i=t[xo],s=ln(void 0);try{return i?i.get(e,r,n&ne.Optional):hb(e,r,n&ne.Optional)}finally{ln(s)}}return Jb(r,e,n)}function tS(t,e,n,r=ne.Default,i){if(t!==null){if(e[H]&2048&&!(r&ne.Self)){let o=kL(t,e,n,r,Wn);if(o!==Wn)return o}let s=nS(t,e,n,r,Wn);if(s!==Wn)return s}return eS(e,n,r,i)}function nS(t,e,n,r,i){let s=NL(n);if(typeof s=="function"){if(!$b(e,t,r))return r&ne.Host?Jb(i,n,r):eS(e,n,r,i);try{let o;if(o=s(r),o==null&&!(r&ne.Optional))Wy(n);else return o}finally{zb()}}else if(typeof s=="number"){let o=null,a=Xb(t,e),u=So,c=r&ne.Host?e[Qn][Rn]:null;for((a===-1||r&ne.SkipSelf)&&(u=a===-1?r_(t,e):e[a+8],u===So||!OT(r,!1)?a=-1:(o=e[ue],a=ch(u),e=lh(u,e)));a!==-1;){let l=e[ue];if(kT(s,a,l.data)){let d=ML(a,e,n,o,r,c);if(d!==Wn)return d}u=e[a+8],u!==So&&OT(r,e[ue].data[a+8]===c)&&kT(s,a,e)?(o=l,a=ch(u),e=lh(u,e)):a=-1}}return i}function ML(t,e,n,r,i,s){let o=e[ue],a=o.data[t+8],u=r==null?Ah(a)&&dy:r!=o&&(a.type&3)!==0,c=i&ne.Host&&s===a,l=RL(a,o,n,u,c);return l!==null?Ro(e,o,l,a):Wn}function RL(t,e,n,r,i){let s=t.providerIndexes,o=e.data,a=s&1048575,u=t.directiveStart,c=t.directiveEnd,l=s>>20,d=r?a:a+l,h=i?a+l:c;for(let f=d;f<h;f++){let p=o[f];if(f<u&&n===p||f>=u&&p.type===n)return f}if(i){let f=o[u];if(f&&ni(f)&&f.type===n)return u}return null}function Ro(t,e,n,r){let i=t[n],s=e.data;if(CL(i)){let o=i;o.resolving&&_V(yV(s[n]));let a=PT(o.canSeeViewProviders);o.resolving=!0;let u,c=o.injectImpl?ln(o.injectImpl):null,l=$b(t,r,ne.Default);try{i=t[n]=o.factory(void 0,s,t,r),e.firstCreatePass&&n>=r.directiveStart&&EL(n,s[n],e)}finally{c!==null&&ln(c),PT(a),o.resolving=!1,zb()}}return i}function NL(t){if(typeof t=="string")return t.charCodeAt(0)||0;let e=t.hasOwnProperty(Cu)?t[Cu]:void 0;return typeof e=="number"?e>=0?e&Yb:PL:e}function kT(t,e,n){let r=1<<t;return!!(n[e+(t>>Zb)]&r)}function OT(t,e){return!(t&ne.Self)&&!(t&ne.Host&&e)}var es=class{constructor(e,n){this._tNode=e,this._lView=n}get(e,n,r){return tS(this._tNode,this._lView,e,Th(r),n)}};function PL(){return new es(pn(),Be())}function cs(t){return Fu(()=>{let e=t.prototype.constructor,n=e[rh]||fy(e),r=Object.prototype,i=Object.getPrototypeOf(t.prototype).constructor;for(;i&&i!==r;){let s=i[rh]||fy(i);if(s&&s!==n)return s;i=Object.getPrototypeOf(i)}return s=>new s})}function fy(t){return sb(t)?()=>{let e=fy(xt(t));return e&&e()}:Mo(t)}function kL(t,e,n,r,i){let s=t,o=e;for(;s!==null&&o!==null&&o[H]&2048&&!(o[H]&512);){let a=nS(s,o,n,r|ne.Self,Wn);if(a!==Wn)return a;let u=s.parent;if(!u){let c=o[Db];if(c){let l=c.get(n,Wn,r);if(l!==Wn)return l}u=rS(o),o=o[Vo]}s=u}return i}function rS(t){let e=t[ue],n=e.type;return n===2?e.declTNode:n===1?t[Rn]:null}var Kd="__parameters__";function OL(t){return function(...n){if(t){let r=t(...n);for(let i in r)this[i]=r[i]}}}function iS(t,e,n){return Fu(()=>{let r=OL(e);function i(...s){if(this instanceof i)return r.apply(this,s),this;let o=new i(...s);return a.annotation=o,a;function a(u,c,l){let d=u.hasOwnProperty(Kd)?u[Kd]:Object.defineProperty(u,Kd,{value:[]})[Kd];for(;d.length<=l;)d.push(null);return(d[l]=d[l]||[]).push(o),u}}return n&&(i.prototype=Object.create(n.prototype)),i.prototype.ngMetadataName=t,i.annotationCls=i,i})}function FL(t){let e=Kt.ng;if(e&&e.\u0275compilerFacade)return e.\u0275compilerFacade;throw new Error("JIT compiler unavailable")}function VL(t){return typeof t=="function"}function i_(t,e){t.forEach(n=>Array.isArray(n)?i_(n,e):e(n))}function sS(t,e,n){e>=t.length?t.push(n):t.splice(e,0,n)}function hh(t,e){return e>=t.length-1?t.pop():t.splice(e,1)[0]}function LL(t,e,n,r){let i=t.length;if(i==e)t.push(n,r);else if(i===1)t.push(r,t[0]),t[0]=n;else{for(i--,t.push(t[i-1],t[i]);i>e;){let s=i-2;t[i]=t[s],i--}t[e]=n,t[e+1]=r}}function jL(t,e,n){let r=Lu(t,e);return r>=0?t[r|1]=n:(r=~r,LL(t,r,e,n)),r}function Wm(t,e){let n=Lu(t,e);if(n>=0)return t[n|1]}function Lu(t,e){return UL(t,e,1)}function UL(t,e,n){let r=0,i=t.length>>n;for(;i!==r;){let s=r+(i-r>>1),o=t[s<<n];if(e===o)return s<<n;o>e?i=s:r=s+1}return~(i<<n)}var Uo=fb(iS("Optional"),8);var s_=fb(iS("SkipSelf"),4);function BL(t){let e=[],n=new Map;function r(i){let s=n.get(i);if(!s){let o=t(i);n.set(i,s=o.then(GL))}return s}return fh.forEach((i,s)=>{let o=[];i.templateUrl&&o.push(r(i.templateUrl).then(c=>{i.template=c}));let a=typeof i.styles=="string"?[i.styles]:i.styles||[];if(i.styles=a,i.styleUrl&&i.styleUrls?.length)throw new Error("@Component cannot define both `styleUrl` and `styleUrls`. Use `styleUrl` if the component has one stylesheet, or `styleUrls` if it has multiple");if(i.styleUrls?.length){let c=i.styles.length,l=i.styleUrls;i.styleUrls.forEach((d,h)=>{a.push(""),o.push(r(d).then(f=>{a[c+h]=f,l.splice(l.indexOf(d),1),l.length==0&&(i.styleUrls=void 0)}))})}else i.styleUrl&&o.push(r(i.styleUrl).then(c=>{a.push(c),i.styleUrl=void 0}));let u=Promise.all(o).then(()=>zL(s));e.push(u)}),HL(),Promise.all(e).then(()=>{})}var fh=new Map,$L=new Set;function HL(){let t=fh;return fh=new Map,t}function qL(){return fh.size===0}function GL(t){return typeof t=="string"?t:t.text()}function zL(t){$L.delete(t)}var No=new P(""),oS=new P("",-1),aS=new P(""),ph=class{get(e,n=Tu){if(n===Tu){let r=new Error(`NullInjectorError: No provider for ${Bt(e)}!`);throw r.name="NullInjectorError",r}return n}};function WL(...t){return{\u0275providers:uS(!0,t),\u0275fromNgModule:!0}}function uS(t,...e){let n=[],r=new Set,i,s=o=>{n.push(o)};return i_(e,o=>{let a=o;py(a,s,[],r)&&(i||=[],i.push(a))}),i!==void 0&&cS(i,s),n}function cS(t,e){for(let n=0;n<t.length;n++){let{ngModule:r,providers:i}=t[n];o_(i,s=>{e(s,r)})}}function py(t,e,n,r){if(t=xt(t),!t)return!1;let i=null,s=CT(t),o=!s&&Jr(t);if(!s&&!o){let u=t.ngModule;if(s=CT(u),s)i=u;else return!1}else{if(o&&!o.standalone)return!1;i=t}let a=r.has(i);if(o){if(a)return!1;if(r.add(i),o.dependencies){let u=typeof o.dependencies=="function"?o.dependencies():o.dependencies;for(let c of u)py(c,e,n,r)}}else if(s){if(s.imports!=null&&!a){r.add(i);let c;try{i_(s.imports,l=>{py(l,e,n,r)&&(c||=[],c.push(l))})}finally{}c!==void 0&&cS(c,e)}if(!a){let c=Mo(i)||(()=>new i);e({provide:i,useFactory:c,deps:dn},i),e({provide:aS,useValue:i,multi:!0},i),e({provide:No,useValue:()=>I(i),multi:!0},i)}let u=s.providers;if(u!=null&&!a){let c=t;o_(u,l=>{e(l,c)})}}else return!1;return i!==t&&t.providers!==void 0}function o_(t,e){for(let n of t)ob(n)&&(n=n.\u0275providers),Array.isArray(n)?o_(n,e):e(n)}var KL=Ie({provide:String,useValue:Ie});function lS(t){return t!==null&&typeof t=="object"&&KL in t}function QL(t){return!!(t&&t.useExisting)}function YL(t){return!!(t&&t.useFactory)}function Po(t){return typeof t=="function"}function ZL(t){return!!t.useClass}var xh=new P(""),eh={},XL={},Km;function a_(){return Km===void 0&&(Km=new ph),Km}var Qt=class{},Nu=class extends Qt{get destroyed(){return this._destroyed}constructor(e,n,r,i){super(),this.parent=n,this.source=r,this.scopes=i,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,my(e,o=>this.processProvider(o)),this.records.set(oS,Co(void 0,this)),i.has("environment")&&this.records.set(Qt,Co(void 0,this));let s=this.records.get(xh);s!=null&&typeof s.value=="string"&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(aS,dn,ne.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(let n of this._ngOnDestroyHooks)n.ngOnDestroy();let e=this._onDestroyHooks;this._onDestroyHooks=[];for(let n of e)n()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear()}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();let n=Zr(this),r=ln(void 0),i;try{return e()}finally{Zr(n),ln(r)}}get(e,n=Tu,r=ne.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(ET))return e[ET](this);r=Th(r);let i,s=Zr(this),o=ln(void 0);try{if(!(r&ne.SkipSelf)){let u=this.records.get(e);if(u===void 0){let c=rj(e)&&Dh(e);c&&this.injectableDefInScope(c)?u=Co(gy(e),eh):u=null,this.records.set(e,u)}if(u!=null)return this.hydrate(e,u)}let a=r&ne.Self?a_():this.parent;return n=r&ne.Optional&&n===Tu?null:n,a.get(e,n)}catch(a){if(a.name==="NullInjectorError"){if((a[ih]=a[ih]||[]).unshift(Bt(e)),s)throw a;return AV(a,e,"R3InjectorError",this.source)}else throw a}finally{ln(o),Zr(s)}}resolveInjectorInitializers(){let e=Zr(this),n=ln(void 0),r;try{let i=this.get(No,dn,ne.Self);for(let s of i)s()}finally{Zr(e),ln(n)}}toString(){let e=[],n=this.records;for(let r of n.keys())e.push(Bt(r));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new U(205,!1)}processProvider(e){e=xt(e);let n=Po(e)?e:xt(e&&e.provide),r=ej(e);if(!Po(e)&&e.multi===!0){let i=this.records.get(n);i||(i=Co(void 0,eh,!0),i.factory=()=>oy(i.multi),this.records.set(n,i)),n=e,i.multi.push(e)}this.records.set(n,r)}hydrate(e,n){return n.value===eh&&(n.value=XL,n.value=n.factory()),typeof n.value=="object"&&n.value&&nj(n.value)&&this._ngOnDestroyHooks.add(n.value),n.value}injectableDefInScope(e){if(!e.providedIn)return!1;let n=xt(e.providedIn);return typeof n=="string"?n==="any"||this.scopes.has(n):this.injectorDefTypes.has(n)}removeOnDestroy(e){let n=this._onDestroyHooks.indexOf(e);n!==-1&&this._onDestroyHooks.splice(n,1)}};function gy(t){let e=Dh(t),n=e!==null?e.factory:Mo(t);if(n!==null)return n;if(t instanceof P)throw new U(204,!1);if(t instanceof Function)return JL(t);throw new U(204,!1)}function JL(t){if(t.length>0)throw new U(204,!1);let n=vV(t);return n!==null?()=>n.factory(t):()=>new t}function ej(t){if(lS(t))return Co(void 0,t.useValue);{let e=dS(t);return Co(e,eh)}}function dS(t,e,n){let r;if(Po(t)){let i=xt(t);return Mo(i)||gy(i)}else if(lS(t))r=()=>xt(t.useValue);else if(YL(t))r=()=>t.useFactory(...oy(t.deps||[]));else if(QL(t))r=()=>I(xt(t.useExisting));else{let i=xt(t&&(t.useClass||t.provide));if(tj(t))r=()=>new i(...oy(t.deps));else return Mo(i)||gy(i)}return r}function Co(t,e,n=!1){return{factory:t,value:e,multi:n?[]:void 0}}function tj(t){return!!t.deps}function nj(t){return t!==null&&typeof t=="object"&&typeof t.ngOnDestroy=="function"}function rj(t){return typeof t=="function"||typeof t=="object"&&t instanceof P}function my(t,e){for(let n of t)Array.isArray(n)?my(n,e):n&&ob(n)?my(n.\u0275providers,e):e(n)}function si(t,e){t instanceof Nu&&t.assertNotDestroyed();let n,r=Zr(t),i=ln(void 0);try{return e()}finally{Zr(r),ln(i)}}function ij(t){if(!db()&&!TV())throw new U(-203,!1)}function FT(t,e=null,n=null,r){let i=hS(t,e,n,r);return i.resolveInjectorInitializers(),i}function hS(t,e=null,n=null,r,i=new Set){let s=[n||dn,WL(t)];return r=r||(typeof t=="object"?void 0:Bt(t)),new Nu(s,e||a_(),r||null,i)}var Pn=(()=>{let e=class e{static create(r,i){if(Array.isArray(r))return FT({name:""},i,r,"");{let s=r.name??"";return FT({name:s},r.parent,r.providers,s)}}};e.THROW_IF_NOT_FOUND=Tu,e.NULL=new ph,e.\u0275prov=k({token:e,providedIn:"any",factory:()=>I(oS)}),e.__NG_ELEMENT_ID__=-1;let t=e;return t})();var yy;function fS(t){yy=t}function sj(){if(yy!==void 0)return yy;if(typeof document<"u")return document;throw new U(210,!1)}var Mh=new P("",{providedIn:"root",factory:()=>oj}),oj="ng",u_=new P(""),Ct=new P("",{providedIn:"platform",factory:()=>"unknown"});var c_=new P("",{providedIn:"root",factory:()=>sj().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});function pS(t){return t instanceof Function?t():t}function aj(t){return(t??R(Pn)).get(Ct)==="browser"}function gS(t){return(t.flags&128)===128}var Tr=function(t){return t[t.Important=1]="Important",t[t.DashCase=2]="DashCase",t}(Tr||{});var mS=new Map,uj=0;function cj(){return uj++}function lj(t){mS.set(t[Sh],t)}function dj(t){mS.delete(t[Sh])}var VT="__ngContext__";function ss(t,e){Ji(e)?(t[VT]=e[Sh],lj(e)):t[VT]=e}var hj;function l_(t,e){return hj(t,e)}function Do(t,e,n,r,i){if(r!=null){let s,o=!1;Ar(r)?s=r:Ji(r)&&(o=!0,r=r[Sr]);let a=Yn(r);t===0&&n!==null?i==null?ES(e,n,a):gh(e,n,a,i||null,!0):t===1&&n!==null?gh(e,n,a,i||null,!0):t===2?xj(e,a,o):t===3&&e.destroyNode(a),s!=null&&Rj(e,t,s,n,i)}}function fj(t,e){return t.createText(e)}function pj(t,e,n){t.setValue(e,n)}function yS(t,e,n){return t.createElement(e,n)}function gj(t,e){_S(t,e),e[Sr]=null,e[Rn]=null}function mj(t,e,n,r,i,s){r[Sr]=i,r[Rn]=e,Rh(t,r,n,1,i,s)}function _S(t,e){Rh(t,e,e[It],2,null,null)}function yj(t){let e=t[Au];if(!e)return Qm(t[ue],t);for(;e;){let n=null;if(Ji(e))n=e[Au];else{let r=e[hn];r&&(n=r)}if(!n){for(;e&&!e[xn]&&e!==t;)Ji(e)&&Qm(e[ue],e),e=e[Et];e===null&&(e=t),Ji(e)&&Qm(e[ue],e),n=e&&e[xn]}e=n}}function _j(t,e,n,r){let i=hn+r,s=n.length;r>0&&(n[i-1][xn]=e),r<s-hn?(e[xn]=n[i],sS(n,hn+r,e)):(n.push(e),e[xn]=null),e[Et]=n;let o=e[bh];o!==null&&n!==o&&vj(o,e);let a=e[xu];a!==null&&a.insertView(t),cy(e),e[H]|=128}function vj(t,e){let n=t[ah],i=e[Et][Et][Qn];e[Qn]!==i&&(t[H]|=Ky.HasTransplantedViews),n===null?t[ah]=[e]:n.push(e)}function vS(t,e){let n=t[ah],r=n.indexOf(e);n.splice(r,1)}function _y(t,e){if(t.length<=hn)return;let n=hn+e,r=t[n];if(r){let i=r[bh];i!==null&&i!==t&&vS(i,r),e>0&&(t[n-1][xn]=r[xn]);let s=hh(t,hn+e);gj(r[ue],r);let o=s[xu];o!==null&&o.detachView(s[ue]),r[Et]=null,r[xn]=null,r[H]&=-129}return r}function wS(t,e){if(!(e[H]&256)){let n=e[It];n.destroyNode&&Rh(t,e,n,3,null,null),yj(e)}}function Qm(t,e){if(!(e[H]&256)){e[H]&=-129,e[H]|=256,e[ts]&&X0(e[ts]),Ej(t,e),wj(t,e),e[ue].type===1&&e[It].destroy();let n=e[bh];if(n!==null&&Ar(e[Et])){n!==e[Et]&&vS(n,e);let r=e[xu];r!==null&&r.detachView(t)}dj(e)}}function wj(t,e){let n=t.cleanup,r=e[Su];if(n!==null)for(let s=0;s<n.length-1;s+=2)if(typeof n[s]=="string"){let o=n[s+3];o>=0?r[o]():r[-o].unsubscribe(),s+=2}else{let o=r[n[s+1]];n[s].call(o)}r!==null&&(e[Su]=null);let i=e[Xr];if(i!==null){e[Xr]=null;for(let s=0;s<i.length;s++){let o=i[s];o()}}}function Ej(t,e){let n;if(t!=null&&(n=t.destroyHooks)!=null)for(let r=0;r<n.length;r+=2){let i=e[n[r]];if(!(i instanceof is)){let s=n[r+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){let a=i[s[o]],u=s[o+1];zn(4,a,u);try{u.call(a)}finally{zn(5,a,u)}}else{zn(4,i,s);try{s.call(i)}finally{zn(5,i,s)}}}}}function Ij(t,e,n){return Cj(t,e.parent,n)}function Cj(t,e,n){let r=e;for(;r!==null&&r.type&40;)e=r,r=e.parent;if(r===null)return n[Sr];{let{componentOffset:i}=r;if(i>-1){let{encapsulation:s}=t.data[r.directiveStart+i];if(s===Kn.None||s===Kn.Emulated)return null}return Nn(r,n)}}function gh(t,e,n,r,i){t.insertBefore(e,n,r,i)}function ES(t,e,n){t.appendChild(e,n)}function LT(t,e,n,r,i){r!==null?gh(t,e,n,r,i):ES(t,e,n)}function Dj(t,e,n,r){t.removeChild(e,n,r)}function d_(t,e){return t.parentNode(e)}function Tj(t,e){return t.nextSibling(e)}function bj(t,e,n){return Aj(t,e,n)}function Sj(t,e,n){return t.type&40?Nn(t,n):null}var Aj=Sj,jT;function h_(t,e,n,r){let i=Ij(t,r,e),s=e[It],o=r.parent||e[Rn],a=bj(o,r,e);if(i!=null)if(Array.isArray(n))for(let u=0;u<n.length;u++)LT(s,i,n[u],a,!1);else LT(s,i,n,a,!1);jT!==void 0&&jT(s,r,e,n,i)}function th(t,e){if(e!==null){let n=e.type;if(n&3)return Nn(e,t);if(n&4)return vy(-1,t[e.index]);if(n&8){let r=e.child;if(r!==null)return th(t,r);{let i=t[e.index];return Ar(i)?vy(-1,i):Yn(i)}}else{if(n&32)return l_(e,t)()||Yn(t[e.index]);{let r=IS(t,e);if(r!==null){if(Array.isArray(r))return r[0];let i=Ru(t[Qn]);return th(i,r)}else return th(t,e.next)}}}return null}function IS(t,e){if(e!==null){let r=t[Qn][Rn],i=e.projection;return r.projection[i]}return null}function vy(t,e){let n=hn+t+1;if(n<e.length){let r=e[n],i=r[ue].firstChild;if(i!==null)return th(r,i)}return e[ns]}function xj(t,e,n){let r=d_(t,e);r&&Dj(t,r,e,n)}function f_(t,e,n,r,i,s,o){for(;n!=null;){let a=r[n.index],u=n.type;if(o&&e===0&&(a&&ss(Yn(a),r),n.flags|=2),(n.flags&32)!==32)if(u&8)f_(t,e,n.child,r,i,s,!1),Do(e,t,i,a,s);else if(u&32){let c=l_(n,r),l;for(;l=c();)Do(e,t,i,l,s);Do(e,t,i,a,s)}else u&16?Mj(t,e,r,n,i,s):Do(e,t,i,a,s);n=o?n.projectionNext:n.next}}function Rh(t,e,n,r,i,s){f_(n,r,t.firstChild,e,i,s,!1)}function Mj(t,e,n,r,i,s){let o=n[Qn],u=o[Rn].projection[r.projection];if(Array.isArray(u))for(let c=0;c<u.length;c++){let l=u[c];Do(e,t,i,l,s)}else{let c=u,l=o[Et];gS(r)&&(c.flags|=128),f_(t,e,c,l,i,s,!0)}}function Rj(t,e,n,r,i){let s=n[ns],o=Yn(n);s!==o&&Do(e,t,r,s,i);for(let a=hn;a<n.length;a++){let u=n[a];Rh(u[ue],u,t,e,r,s)}}function Nj(t,e,n,r,i){if(e)i?t.addClass(n,r):t.removeClass(n,r);else{let s=r.indexOf("-")===-1?void 0:Tr.DashCase;i==null?t.removeStyle(n,r,s):(typeof i=="string"&&i.endsWith("!important")&&(i=i.slice(0,-10),s|=Tr.Important),t.setStyle(n,r,i,s))}}function Pj(t,e,n){t.setAttribute(e,"style",n)}function CS(t,e,n){n===""?t.removeAttribute(e,"class"):t.setAttribute(e,"class",n)}function DS(t,e,n){let{mergedAttrs:r,classes:i,styles:s}=n;r!==null&&ay(t,e,r),i!==null&&CS(t,e,i),s!==null&&Pj(t,e,s)}var wy=class{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${lV})`}};function p_(t){return t instanceof wy?t.changingThisBreaksApplicationSecurity:t}var Ey=class{};var kj="h",Oj="b";var Fj=()=>null;function g_(t,e,n=!1){return Fj(t,e,n)}var Iy=class{},mh=class{};function Vj(t){let e=Error(`No component factory found for ${Bt(t)}.`);return e[Lj]=t,e}var Lj="ngComponent";var Cy=class{resolveComponentFactory(e){throw Vj(e)}},Nh=(()=>{let e=class e{};e.NULL=new Cy;let t=e;return t})();function jj(){return Ph(pn(),Be())}function Ph(t,e){return new xr(Nn(t,e))}var xr=(()=>{let e=class e{constructor(r){this.nativeElement=r}};e.__NG_ELEMENT_ID__=jj;let t=e;return t})();var Pu=class{},oi=(()=>{let e=class e{constructor(){this.destroyNode=null}};e.__NG_ELEMENT_ID__=()=>Uj();let t=e;return t})();function Uj(){let t=Be(),e=pn(),n=ii(e.index,t);return(Ji(n)?n:t)[It]}var Bj=(()=>{let e=class e{};e.\u0275prov=k({token:e,providedIn:"root",factory:()=>null});let t=e;return t})(),Ym={};function TS(t){return Hj(t)?Array.isArray(t)||!(t instanceof Map)&&Symbol.iterator in t:!1}function $j(t,e){if(Array.isArray(t))for(let n=0;n<t.length;n++)e(t[n]);else{let n=t[Symbol.iterator](),r;for(;!(r=n.next()).done;)e(r.value)}}function Hj(t){return t!==null&&(typeof t=="function"||typeof t=="object")}var Dy=class{constructor(){}supports(e){return TS(e)}create(e){return new Ty(e)}},qj=(t,e)=>e,Ty=class{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||qj}forEachItem(e){let n;for(n=this._itHead;n!==null;n=n._next)e(n)}forEachOperation(e){let n=this._itHead,r=this._removalsHead,i=0,s=null;for(;n||r;){let o=!r||n&&n.currentIndex<UT(r,i,s)?n:r,a=UT(o,i,s),u=o.currentIndex;if(o===r)i--,r=r._nextRemoved;else if(n=n._next,o.previousIndex==null)i++;else{s||(s=[]);let c=a-i,l=u-i;if(c!=l){for(let h=0;h<c;h++){let f=h<s.length?s[h]:s[h]=0,p=f+h;l<=p&&p<c&&(s[h]=f+1)}let d=o.previousIndex;s[d]=l-c}}a!==u&&e(o,a,u)}}forEachPreviousItem(e){let n;for(n=this._previousItHead;n!==null;n=n._nextPrevious)e(n)}forEachAddedItem(e){let n;for(n=this._additionsHead;n!==null;n=n._nextAdded)e(n)}forEachMovedItem(e){let n;for(n=this._movesHead;n!==null;n=n._nextMoved)e(n)}forEachRemovedItem(e){let n;for(n=this._removalsHead;n!==null;n=n._nextRemoved)e(n)}forEachIdentityChange(e){let n;for(n=this._identityChangesHead;n!==null;n=n._nextIdentityChange)e(n)}diff(e){if(e==null&&(e=[]),!TS(e))throw new U(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let n=this._itHead,r=!1,i,s,o;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)s=e[a],o=this._trackByFn(a,s),n===null||!Object.is(n.trackById,o)?(n=this._mismatch(n,s,o,a),r=!0):(r&&(n=this._verifyReinsertion(n,s,o,a)),Object.is(n.item,s)||this._addIdentityChange(n,s)),n=n._next}else i=0,$j(e,a=>{o=this._trackByFn(i,a),n===null||!Object.is(n.trackById,o)?(n=this._mismatch(n,a,o,i),r=!0):(r&&(n=this._verifyReinsertion(n,a,o,i)),Object.is(n.item,a)||this._addIdentityChange(n,a)),n=n._next,i++}),this.length=i;return this._truncate(n),this.collection=e,this.isDirty}get isDirty(){return this._additionsHead!==null||this._movesHead!==null||this._removalsHead!==null||this._identityChangesHead!==null}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;e!==null;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;e!==null;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;e!==null;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,n,r,i){let s;return e===null?s=this._itTail:(s=e._prev,this._remove(e)),e=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null),e!==null?(Object.is(e.item,n)||this._addIdentityChange(e,n),this._reinsertAfter(e,s,i)):(e=this._linkedRecords===null?null:this._linkedRecords.get(r,i),e!==null?(Object.is(e.item,n)||this._addIdentityChange(e,n),this._moveAfter(e,s,i)):e=this._addAfter(new by(n,r),s,i)),e}_verifyReinsertion(e,n,r,i){let s=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null);return s!==null?e=this._reinsertAfter(s,e._prev,i):e.currentIndex!=i&&(e.currentIndex=i,this._addToMoves(e,i)),e}_truncate(e){for(;e!==null;){let n=e._next;this._addToRemovals(this._unlink(e)),e=n}this._unlinkedRecords!==null&&this._unlinkedRecords.clear(),this._additionsTail!==null&&(this._additionsTail._nextAdded=null),this._movesTail!==null&&(this._movesTail._nextMoved=null),this._itTail!==null&&(this._itTail._next=null),this._removalsTail!==null&&(this._removalsTail._nextRemoved=null),this._identityChangesTail!==null&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,n,r){this._unlinkedRecords!==null&&this._unlinkedRecords.remove(e);let i=e._prevRemoved,s=e._nextRemoved;return i===null?this._removalsHead=s:i._nextRemoved=s,s===null?this._removalsTail=i:s._prevRemoved=i,this._insertAfter(e,n,r),this._addToMoves(e,r),e}_moveAfter(e,n,r){return this._unlink(e),this._insertAfter(e,n,r),this._addToMoves(e,r),e}_addAfter(e,n,r){return this._insertAfter(e,n,r),this._additionsTail===null?this._additionsTail=this._additionsHead=e:this._additionsTail=this._additionsTail._nextAdded=e,e}_insertAfter(e,n,r){let i=n===null?this._itHead:n._next;return e._next=i,e._prev=n,i===null?this._itTail=e:i._prev=e,n===null?this._itHead=e:n._next=e,this._linkedRecords===null&&(this._linkedRecords=new yh),this._linkedRecords.put(e),e.currentIndex=r,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){this._linkedRecords!==null&&this._linkedRecords.remove(e);let n=e._prev,r=e._next;return n===null?this._itHead=r:n._next=r,r===null?this._itTail=n:r._prev=n,e}_addToMoves(e,n){return e.previousIndex===n||(this._movesTail===null?this._movesTail=this._movesHead=e:this._movesTail=this._movesTail._nextMoved=e),e}_addToRemovals(e){return this._unlinkedRecords===null&&(this._unlinkedRecords=new yh),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,this._removalsTail===null?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,n){return e.item=n,this._identityChangesTail===null?this._identityChangesTail=this._identityChangesHead=e:this._identityChangesTail=this._identityChangesTail._nextIdentityChange=e,e}},by=class{constructor(e,n){this.item=e,this.trackById=n,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}},Sy=class{constructor(){this._head=null,this._tail=null}add(e){this._head===null?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,n){let r;for(r=this._head;r!==null;r=r._nextDup)if((n===null||n<=r.currentIndex)&&Object.is(r.trackById,e))return r;return null}remove(e){let n=e._prevDup,r=e._nextDup;return n===null?this._head=r:n._nextDup=r,r===null?this._tail=n:r._prevDup=n,this._head===null}},yh=class{constructor(){this.map=new Map}put(e){let n=e.trackById,r=this.map.get(n);r||(r=new Sy,this.map.set(n,r)),r.add(e)}get(e,n){let r=e,i=this.map.get(r);return i?i.get(e,n):null}remove(e){let n=e.trackById;return this.map.get(n).remove(e)&&this.map.delete(n),e}get isEmpty(){return this.map.size===0}clear(){this.map.clear()}};function UT(t,e,n){let r=t.previousIndex;if(r===null)return r;let i=0;return n&&r<n.length&&(i=n[r]),r+e+i}function BT(){return new m_([new Dy])}var m_=(()=>{let e=class e{constructor(r){this.factories=r}static create(r,i){if(i!=null){let s=i.factories.slice();r=r.concat(s)}return new e(r)}static extend(r){return{provide:e,useFactory:i=>e.create(r,i||BT()),deps:[[e,new s_,new Uo]]}}find(r){let i=this.factories.find(s=>s.supports(r));if(i!=null)return i;throw new U(901,!1)}};e.\u0275prov=k({token:e,providedIn:"root",factory:BT});let t=e;return t})();function _h(t,e,n,r,i=!1){for(;n!==null;){let s=e[n.index];s!==null&&r.push(Yn(s)),Ar(s)&&Gj(s,r);let o=n.type;if(o&8)_h(t,e,n.child,r);else if(o&32){let a=l_(n,e),u;for(;u=a();)r.push(u)}else if(o&16){let a=IS(e,n);if(Array.isArray(a))r.push(...a);else{let u=Ru(e[Qn]);_h(u[ue],u,a,r,!0)}}n=i?n.projectionNext:n.next}return r}function Gj(t,e){for(let n=hn;n<t.length;n++){let r=t[n],i=r[ue].firstChild;i!==null&&_h(r[ue],r,i,e)}t[ns]!==t[Sr]&&e.push(t[ns])}var bS=[];function zj(t){return t[ts]??Wj(t)}function Wj(t){let e=bS.pop()??Object.create(Qj);return e.lView=t,e}function Kj(t){t.lView[ts]!==t&&(t.lView=null,bS.push(t))}var Qj=ce(S({},Q0),{consumerIsAlwaysLive:!0,consumerMarkedDirty:t=>{Mu(t.lView)},consumerOnSignalRead(){this.lView[ts]=this}});function SS(t){return xS(t[Au])}function AS(t){return xS(t[xn])}function xS(t){for(;t!==null&&!Ar(t);)t=t[xn];return t}var Yj="ngOriginalError";function Zm(t){return t[Yj]}var Zn=class{constructor(){this._console=console}handleError(e){let n=this._findOriginalError(e);this._console.error("ERROR",e),n&&this._console.error("ORIGINAL ERROR",n)}_findOriginalError(e){let n=e&&Zm(e);for(;n&&Zm(n);)n=Zm(n);return n||null}},MS=new P("",{providedIn:"root",factory:()=>R(Zn).handleError.bind(void 0)});var RS=!1,Zj=new P("",{providedIn:"root",factory:()=>RS});var Bo={};function Jn(t=1){NS(Xn(),Be(),jo()+t,!1)}function NS(t,e,n,r){if(!r)if((e[H]&3)===3){let s=t.preOrderCheckHooks;s!==null&&Xd(e,s,n)}else{let s=t.preOrderHooks;s!==null&&Jd(e,s,0,n)}rs(n)}function _e(t,e=ne.Default){let n=Be();if(n===null)return I(t,e);let r=pn();return tS(r,n,xt(t),e)}function PS(){let t="invalid";throw new Error(t)}function kS(t,e,n,r,i,s){let o=Wt(null);try{let a=null;i&fn.SignalBased&&(a=e[r][K0]),a!==null&&a.transformFn!==void 0&&(s=a.transformFn(s)),i&fn.HasDecoratorInputTransform&&(s=t.inputTransforms[r].call(e,s)),t.setInput!==null?t.setInput(e,a,s,n,r):Sb(e,a,r,s)}finally{Wt(o)}}function Xj(t,e){let n=t.hostBindingOpCodes;if(n!==null)try{for(let r=0;r<n.length;r++){let i=n[r];if(i<0)rs(~i);else{let s=i,o=n[++r],a=n[++r];pL(o,s);let u=e[s];a(2,u)}}}finally{rs(-1)}}function kh(t,e,n,r,i,s,o,a,u,c,l){let d=e.blueprint.slice();return d[Sr]=i,d[H]=r|4|128|8|64,(c!==null||t&&t[H]&2048)&&(d[H]|=2048),Pb(d),d[Et]=d[Vo]=t,d[Mn]=n,d[ei]=o||t&&t[ei],d[It]=a||t&&t[It],d[xo]=u||t&&t[xo]||null,d[Rn]=s,d[Sh]=cj(),d[sh]=l,d[Db]=c,d[Qn]=e.type==2?t[Qn]:d,d}function Oh(t,e,n,r,i){let s=t.data[e];if(s===null)s=Jj(t,e,n,r,i),fL()&&(s.flags|=32);else if(s.type&64){s.type=n,s.value=r,s.attrs=i;let o=cL();s.injectorIndex=o===null?-1:o.injectorIndex}return Vu(s,!0),s}function Jj(t,e,n,r,i){let s=Lb(),o=jb(),a=o?s:s&&s.parent,u=t.data[e]=i2(t,a,n,e,r,i);return t.firstChild===null&&(t.firstChild=u),s!==null&&(o?s.child==null&&u.parent!==null&&(s.child=u):s.next===null&&(s.next=u,u.prev=s)),u}function OS(t,e,n,r){if(n===0)return-1;let i=e.length;for(let s=0;s<n;s++)e.push(r),t.blueprint.push(r),t.data.push(null);return i}function FS(t,e,n,r,i){let s=jo(),o=r&2;try{rs(-1),o&&e.length>ti&&NS(t,e,ti,!1),zn(o?2:0,i),n(r,i)}finally{rs(s),zn(o?3:1,i)}}function VS(t,e,n){if(bb(e)){let r=Wt(null);try{let i=e.directiveStart,s=e.directiveEnd;for(let o=i;o<s;o++){let a=t.data[o];a.contentQueries&&a.contentQueries(1,n[o],o)}}finally{Wt(r)}}}function LS(t,e,n){Ob()&&(d2(t,e,n,Nn(n,e)),(n.flags&64)===64&&HS(t,e,n))}function jS(t,e,n=Nn){let r=e.localNames;if(r!==null){let i=e.index+1;for(let s=0;s<r.length;s+=2){let o=r[s+1],a=o===-1?n(e,t):t[o];t[i++]=a}}}function US(t){let e=t.tView;return e===null||e.incompleteFirstPass?t.tView=y_(1,null,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts,t.id):e}function y_(t,e,n,r,i,s,o,a,u,c,l){let d=ti+r,h=d+i,f=e2(d,h),p=typeof c=="function"?c():c;return f[ue]={type:t,blueprint:f,template:n,queries:null,viewQuery:a,declTNode:e,data:f.slice().fill(null,d),bindingStartIndex:d,expandoStartIndex:h,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof s=="function"?s():s,pipeRegistry:typeof o=="function"?o():o,firstChild:null,schemas:u,consts:p,incompleteFirstPass:!1,ssrId:l}}function e2(t,e){let n=[];for(let r=0;r<e;r++)n.push(r<t?null:Bo);return n}function t2(t,e,n,r){let s=r.get(Zj,RS)||n===Kn.ShadowDom,o=t.selectRootElement(e,s);return n2(o),o}function n2(t){r2(t)}var r2=()=>null;function i2(t,e,n,r,i,s){let o=e?e.injectorIndex:-1,a=0;return oL()&&(a|=128),{type:n,index:r,insertBeforeIndex:null,injectorIndex:o,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:i,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}function $T(t,e,n,r,i){for(let s in e){if(!e.hasOwnProperty(s))continue;let o=e[s];if(o===void 0)continue;r??={};let a,u=fn.None;Array.isArray(o)?(a=o[0],u=o[1]):a=o;let c=s;if(i!==null){if(!i.hasOwnProperty(s))continue;c=i[s]}t===0?HT(r,n,c,a,u):HT(r,n,c,a)}return r}function HT(t,e,n,r,i){let s;t.hasOwnProperty(n)?(s=t[n]).push(e,r):s=t[n]=[e,r],i!==void 0&&s.push(i)}function s2(t,e,n){let r=e.directiveStart,i=e.directiveEnd,s=t.data,o=e.attrs,a=[],u=null,c=null;for(let l=r;l<i;l++){let d=s[l],h=n?n.get(d):null,f=h?h.inputs:null,p=h?h.outputs:null;u=$T(0,d.inputs,l,u,f),c=$T(1,d.outputs,l,c,p);let g=u!==null&&o!==null&&!yb(e)?w2(u,l,o):null;a.push(g)}u!==null&&(u.hasOwnProperty("class")&&(e.flags|=8),u.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=u,e.outputs=c}function o2(t){return t==="class"?"className":t==="for"?"htmlFor":t==="formaction"?"formAction":t==="innerHtml"?"innerHTML":t==="readonly"?"readOnly":t==="tabindex"?"tabIndex":t}function a2(t,e,n,r,i,s,o,a){let u=Nn(e,n),c=e.inputs,l;!a&&c!=null&&(l=c[r])?(__(t,n,l,r,i),Ah(e)&&u2(n,e.index)):e.type&3?(r=o2(r),i=o!=null?o(i,e.value||"",r):i,s.setProperty(u,r,i)):e.type&12}function u2(t,e){let n=ii(e,t);n[H]&16||(n[H]|=64)}function BS(t,e,n,r){if(Ob()){let i=r===null?null:{"":-1},s=f2(t,n),o,a;s===null?o=a=null:[o,a]=s,o!==null&&$S(t,e,n,o,i,a),i&&p2(n,r,i)}n.mergedAttrs=bu(n.mergedAttrs,n.attrs)}function $S(t,e,n,r,i,s){for(let c=0;c<r.length;c++)hy(dh(n,e),t,r[c].type);m2(n,t.data.length,r.length);for(let c=0;c<r.length;c++){let l=r[c];l.providersResolver&&l.providersResolver(l)}let o=!1,a=!1,u=OS(t,e,r.length,null);for(let c=0;c<r.length;c++){let l=r[c];n.mergedAttrs=bu(n.mergedAttrs,l.hostAttrs),y2(t,n,e,u,l),g2(u,l,i),l.contentQueries!==null&&(n.flags|=4),(l.hostBindings!==null||l.hostAttrs!==null||l.hostVars!==0)&&(n.flags|=64);let d=l.type.prototype;!o&&(d.ngOnChanges||d.ngOnInit||d.ngDoCheck)&&((t.preOrderHooks??=[]).push(n.index),o=!0),!a&&(d.ngOnChanges||d.ngDoCheck)&&((t.preOrderCheckHooks??=[]).push(n.index),a=!0),u++}s2(t,n,s)}function c2(t,e,n,r,i){let s=i.hostBindings;if(s){let o=t.hostBindingOpCodes;o===null&&(o=t.hostBindingOpCodes=[]);let a=~e.index;l2(o)!=a&&o.push(a),o.push(n,r,s)}}function l2(t){let e=t.length;for(;e>0;){let n=t[--e];if(typeof n=="number"&&n<0)return n}return 0}function d2(t,e,n,r){let i=n.directiveStart,s=n.directiveEnd;Ah(n)&&_2(e,n,t.data[i+n.componentOffset]),t.firstCreatePass||dh(n,e),ss(r,e);let o=n.initialInputs;for(let a=i;a<s;a++){let u=t.data[a],c=Ro(e,t,a,n);if(ss(c,e),o!==null&&v2(e,a-i,c,u,n,o),ni(u)){let l=ii(n.index,e);l[Mn]=Ro(e,t,a,n)}}}function HS(t,e,n){let r=n.directiveStart,i=n.directiveEnd,s=n.index,o=gL();try{rs(s);for(let a=r;a<i;a++){let u=t.data[a],c=e[a];ly(a),(u.hostBindings!==null||u.hostVars!==0||u.hostAttrs!==null)&&h2(u,c)}}finally{rs(-1),ly(o)}}function h2(t,e){t.hostBindings!==null&&t.hostBindings(1,e)}function f2(t,e){let n=t.directiveRegistry,r=null,i=null;if(n)for(let s=0;s<n.length;s++){let o=n[s];if(FV(e,o.selectors,!1))if(r||(r=[]),ni(o))if(o.findHostDirectiveDefs!==null){let a=[];i=i||new Map,o.findHostDirectiveDefs(o,a,i),r.unshift(...a,o);let u=a.length;Ay(t,e,u)}else r.unshift(o),Ay(t,e,0);else i=i||new Map,o.findHostDirectiveDefs?.(o,r,i),r.push(o)}return r===null?null:[r,i]}function Ay(t,e,n){e.componentOffset=n,(t.components??=[]).push(e.index)}function p2(t,e,n){if(e){let r=t.localNames=[];for(let i=0;i<e.length;i+=2){let s=n[e[i+1]];if(s==null)throw new U(-301,!1);r.push(e[i],s)}}}function g2(t,e,n){if(n){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)n[e.exportAs[r]]=t;ni(e)&&(n[""]=t)}}function m2(t,e,n){t.flags|=1,t.directiveStart=e,t.directiveEnd=e+n,t.providerIndexes=e}function y2(t,e,n,r,i){t.data[r]=i;let s=i.factory||(i.factory=Mo(i.type,!0)),o=new is(s,ni(i),_e);t.blueprint[r]=o,n[r]=o,c2(t,e,r,OS(t,n,i.hostVars,Bo),i)}function _2(t,e,n){let r=Nn(e,t),i=US(n),s=t[ei].rendererFactory,o=16;n.signals?o=4096:n.onPush&&(o=64);let a=Fh(t,kh(t,i,null,o,r,e,null,s.createRenderer(r,n),null,null,null));t[e.index]=a}function v2(t,e,n,r,i,s){let o=s[e];if(o!==null)for(let a=0;a<o.length;){let u=o[a++],c=o[a++],l=o[a++],d=o[a++];kS(r,n,u,c,l,d)}}function w2(t,e,n){let r=null,i=0;for(;i<n.length;){let s=n[i];if(s===0){i+=4;continue}else if(s===5){i+=2;continue}if(typeof s=="number")break;if(t.hasOwnProperty(s)){r===null&&(r=[]);let o=t[s];for(let a=0;a<o.length;a+=3)if(o[a]===e){r.push(s,o[a+1],o[a+2],n[i+1]);break}}i+=2}return r}function qS(t,e,n,r){return[t,!0,0,e,null,r,null,n,null,null]}function GS(t,e){let n=t.contentQueries;if(n!==null){let r=Wt(null);try{for(let i=0;i<n.length;i+=2){let s=n[i],o=n[i+1];if(o!==-1){let a=t.data[o];Bb(s),a.contentQueries(2,e[o],o)}}}finally{Wt(r)}}}function Fh(t,e){return t[Au]?t[MT][xn]=e:t[Au]=e,t[MT]=e,e}function xy(t,e,n){Bb(0);let r=Wt(null);try{e(t,n)}finally{Wt(r)}}function E2(t){return t[Su]||(t[Su]=[])}function I2(t){return t.cleanup||(t.cleanup=[])}function zS(t,e){let n=t[xo],r=n?n.get(Zn,null):null;r&&r.handleError(e)}function __(t,e,n,r,i){for(let s=0;s<n.length;){let o=n[s++],a=n[s++],u=n[s++],c=e[o],l=t.data[o];kS(l,c,r,a,u,i)}}function C2(t,e,n){let r=Rb(e,t);pj(t[It],r,n)}var WS=100;function KS(t,e=!0,n=0){let r=t[ei],i=r.rendererFactory,s=!1;s||i.begin?.();try{D2(t,n)}catch(o){throw e&&zS(t,o),o}finally{s||(i.end?.(),r.inlineEffectRunner?.flush())}}function D2(t,e){My(t,e);let n=0;for(;Zy(t);){if(n===WS)throw new U(103,!1);n++,My(t,1)}}function T2(t,e,n,r){let i=e[H];if((i&256)===256)return;let s=!1;!s&&e[ei].inlineEffectRunner?.flush(),Xy(e);let o=null,a=null;!s&&b2(t)&&(a=zj(e),o=Y0(a));try{Pb(e),dL(t.bindingStartIndex),n!==null&&FS(t,e,n,2,r);let u=(i&3)===3;if(!s)if(u){let d=t.preOrderCheckHooks;d!==null&&Xd(e,d,null)}else{let d=t.preOrderHooks;d!==null&&Jd(e,d,0,null),Gm(e,0)}if(S2(e),QS(e,0),t.contentQueries!==null&&GS(t,e),!s)if(u){let d=t.contentCheckHooks;d!==null&&Xd(e,d)}else{let d=t.contentHooks;d!==null&&Jd(e,d,1),Gm(e,1)}Xj(t,e);let c=t.components;c!==null&&ZS(e,c,0);let l=t.viewQuery;if(l!==null&&xy(2,l,r),!s)if(u){let d=t.viewCheckHooks;d!==null&&Xd(e,d)}else{let d=t.viewHooks;d!==null&&Jd(e,d,2),Gm(e,2)}if(t.firstUpdatePass===!0&&(t.firstUpdatePass=!1),e[qm]){for(let d of e[qm])d();e[qm]=null}s||(e[H]&=-73)}catch(u){throw Mu(e),u}finally{a!==null&&(Z0(a,o),Kj(a)),Jy()}}function b2(t){return t.type!==2}function QS(t,e){for(let n=SS(t);n!==null;n=AS(n))for(let r=hn;r<n.length;r++){let i=n[r];YS(i,e)}}function S2(t){for(let e=SS(t);e!==null;e=AS(e)){if(!(e[H]&Ky.HasTransplantedViews))continue;let n=e[ah];for(let r=0;r<n.length;r++){let i=n[r],s=i[Et];eL(i)}}}function A2(t,e,n){let r=ii(e,t);YS(r,n)}function YS(t,e){Yy(t)&&My(t,e)}function My(t,e){let r=t[ue],i=t[H],s=t[ts],o=!!(e===0&&i&16);if(o||=!!(i&64&&e===0),o||=!!(i&1024),o||=!!(s?.dirty&&Im(s)),s&&(s.dirty=!1),t[H]&=-9217,o)T2(r,t,r.template,t[Mn]);else if(i&8192){QS(t,1);let a=r.components;a!==null&&ZS(t,a,1)}}function ZS(t,e,n){for(let r=0;r<e.length;r++)A2(t,e[r],n)}function v_(t){for(t[ei].changeDetectionScheduler?.notify();t;){t[H]|=64;let e=Ru(t);if(GV(t)&&!e)return t;t=e}return null}var os=class{get rootNodes(){let e=this._lView,n=e[ue];return _h(n,e,n.firstChild,[])}constructor(e,n,r=!0){this._lView=e,this._cdRefInjectingView=n,this.notifyErrorHandler=r,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[Mn]}set context(e){this._lView[Mn]=e}get destroyed(){return(this._lView[H]&256)===256}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let e=this._lView[Et];if(Ar(e)){let n=e[oh],r=n?n.indexOf(this):-1;r>-1&&(_y(e,r),hh(n,r))}this._attachedToViewContainer=!1}wS(this._lView[ue],this._lView)}onDestroy(e){kb(this._lView,e)}markForCheck(){v_(this._cdRefInjectingView||this._lView)}detach(){this._lView[H]&=-129}reattach(){cy(this._lView),this._lView[H]|=128}detectChanges(){this._lView[H]|=1024,KS(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new U(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,_S(this._lView[ue],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new U(902,!1);this._appRef=e,cy(this._lView)}},$o=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=x2;let t=e;return t})();function x2(t){return M2(pn(),Be(),(t&16)===16)}function M2(t,e,n){if(Ah(t)&&!n){let r=ii(t.index,e);return new os(r,r)}else if(t.type&47){let r=e[Qn];return new os(r,e)}return null}var XS=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=R2,e.__NG_ENV_ID__=r=>r;let t=e;return t})(),Ry=class extends XS{constructor(e){super(),this._lView=e}onDestroy(e){return kb(this._lView,e),()=>nL(this._lView,e)}};function R2(){return new Ry(Be())}var qT=new Set;function w_(t){qT.has(t)||(qT.add(t),performance?.mark?.("mark_feature_usage",{detail:{feature:t}}))}var Ny=class extends rt{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,n,r){let i=e,s=n||(()=>null),o=r;if(e&&typeof e=="object"){let u=e;i=u.next?.bind(u),s=u.error?.bind(u),o=u.complete?.bind(u)}this.__isAsync&&(s=Xm(s),i&&(i=Xm(i)),o&&(o=Xm(o)));let a=super.subscribe({next:i,error:s,complete:o});return e instanceof Ue&&e.add(a),a}};function Xm(t){return e=>{setTimeout(t,void 0,e)}}var it=Ny;function GT(...t){}function N2(){let t=typeof Kt.requestAnimationFrame=="function",e=Kt[t?"requestAnimationFrame":"setTimeout"],n=Kt[t?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&e&&n){let r=e[Zone.__symbol__("OriginalDelegate")];r&&(e=r);let i=n[Zone.__symbol__("OriginalDelegate")];i&&(n=i)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:n}}var se=class t{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:n=!1,shouldCoalesceRunChangeDetection:r=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new it(!1),this.onMicrotaskEmpty=new it(!1),this.onStable=new it(!1),this.onError=new it(!1),typeof Zone>"u")throw new U(908,!1);Zone.assertZonePatched();let i=this;i._nesting=0,i._outer=i._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(i._inner=i._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(i._inner=i._inner.fork(Zone.longStackTraceZoneSpec)),i.shouldCoalesceEventChangeDetection=!r&&n,i.shouldCoalesceRunChangeDetection=r,i.lastRequestAnimationFrameId=-1,i.nativeRequestAnimationFrame=N2().nativeRequestAnimationFrame,O2(i)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get("isAngularZone")===!0}static assertInAngularZone(){if(!t.isInAngularZone())throw new U(909,!1)}static assertNotInAngularZone(){if(t.isInAngularZone())throw new U(909,!1)}run(e,n,r){return this._inner.run(e,n,r)}runTask(e,n,r,i){let s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+i,e,P2,GT,GT);try{return s.runTask(o,n,r)}finally{s.cancelTask(o)}}runGuarded(e,n,r){return this._inner.runGuarded(e,n,r)}runOutsideAngular(e){return this._outer.run(e)}},P2={};function E_(t){if(t._nesting==0&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function k2(t){t.isCheckStableRunning||t.lastRequestAnimationFrameId!==-1||(t.lastRequestAnimationFrameId=t.nativeRequestAnimationFrame.call(Kt,()=>{t.fakeTopEventTask||(t.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{t.lastRequestAnimationFrameId=-1,Py(t),t.isCheckStableRunning=!0,E_(t),t.isCheckStableRunning=!1},void 0,()=>{},()=>{})),t.fakeTopEventTask.invoke()}),Py(t))}function O2(t){let e=()=>{k2(t)};t._inner=t._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(n,r,i,s,o,a)=>{if(F2(a))return n.invokeTask(i,s,o,a);try{return zT(t),n.invokeTask(i,s,o,a)}finally{(t.shouldCoalesceEventChangeDetection&&s.type==="eventTask"||t.shouldCoalesceRunChangeDetection)&&e(),WT(t)}},onInvoke:(n,r,i,s,o,a,u)=>{try{return zT(t),n.invoke(i,s,o,a,u)}finally{t.shouldCoalesceRunChangeDetection&&e(),WT(t)}},onHasTask:(n,r,i,s)=>{n.hasTask(i,s),r===i&&(s.change=="microTask"?(t._hasPendingMicrotasks=s.microTask,Py(t),E_(t)):s.change=="macroTask"&&(t.hasPendingMacrotasks=s.macroTask))},onHandleError:(n,r,i,s)=>(n.handleError(i,s),t.runOutsideAngular(()=>t.onError.emit(s)),!1)})}function Py(t){t._hasPendingMicrotasks||(t.shouldCoalesceEventChangeDetection||t.shouldCoalesceRunChangeDetection)&&t.lastRequestAnimationFrameId!==-1?t.hasPendingMicrotasks=!0:t.hasPendingMicrotasks=!1}function zT(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function WT(t){t._nesting--,E_(t)}var ky=class{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new it,this.onMicrotaskEmpty=new it,this.onStable=new it,this.onError=new it}run(e,n,r){return e.apply(n,r)}runGuarded(e,n,r){return e.apply(n,r)}runOutsideAngular(e){return e()}runTask(e,n,r,i){return e.apply(n,r)}};function F2(t){return!Array.isArray(t)||t.length!==1?!1:t[0].data?.__ignore_ng_zone__===!0}function V2(t="zone.js",e){return t==="noop"?new ky:t==="zone.js"?new se(e):t}var To=function(t){return t[t.EarlyRead=0]="EarlyRead",t[t.Write=1]="Write",t[t.MixedReadWrite=2]="MixedReadWrite",t[t.Read=3]="Read",t}(To||{}),L2={destroy(){}};function I_(t,e){!e&&ij(I_);let n=e?.injector??R(Pn);if(!aj(n))return L2;w_("NgAfterNextRender");let r=n.get(C_),i=r.handler??=new Fy,s=e?.phase??To.MixedReadWrite,o=()=>{i.unregister(u),a()},a=n.get(XS).onDestroy(o),u=new Oy(n,s,()=>{o(),t()});return i.register(u),{destroy:o}}var Oy=class{constructor(e,n,r){this.phase=n,this.callbackFn=r,this.zone=e.get(se),this.errorHandler=e.get(Zn,null,{optional:!0})}invoke(){try{this.zone.runOutsideAngular(this.callbackFn)}catch(e){this.errorHandler?.handleError(e)}}},Fy=class{constructor(){this.executingCallbacks=!1,this.buckets={[To.EarlyRead]:new Set,[To.Write]:new Set,[To.MixedReadWrite]:new Set,[To.Read]:new Set},this.deferredCallbacks=new Set}register(e){(this.executingCallbacks?this.deferredCallbacks:this.buckets[e.phase]).add(e)}unregister(e){this.buckets[e.phase].delete(e),this.deferredCallbacks.delete(e)}execute(){this.executingCallbacks=!0;for(let e of Object.values(this.buckets))for(let n of e)n.invoke();this.executingCallbacks=!1;for(let e of this.deferredCallbacks)this.buckets[e.phase].add(e);this.deferredCallbacks.clear()}destroy(){for(let e of Object.values(this.buckets))e.clear();this.deferredCallbacks.clear()}},C_=(()=>{let e=class e{constructor(){this.handler=null,this.internalCallbacks=[]}execute(){let r=[...this.internalCallbacks];this.internalCallbacks.length=0;for(let i of r)i();this.handler?.execute()}ngOnDestroy(){this.handler?.destroy(),this.handler=null,this.internalCallbacks.length=0}};e.\u0275prov=k({token:e,providedIn:"root",factory:()=>new e});let t=e;return t})();function j2(t,e){let n=ii(e,t),r=n[ue];U2(r,n);let i=n[Sr];i!==null&&n[sh]===null&&(n[sh]=g_(i,n[xo])),D_(r,n,n[Mn])}function U2(t,e){for(let n=e.length;n<t.blueprint.length;n++)e.push(t.blueprint[n])}function D_(t,e,n){Xy(e);try{let r=t.viewQuery;r!==null&&xy(1,r,n);let i=t.template;i!==null&&FS(t,e,i,1,n),t.firstCreatePass&&(t.firstCreatePass=!1),t.staticContentQueries&&GS(t,e),t.staticViewQueries&&xy(2,t.viewQuery,n);let s=t.components;s!==null&&B2(e,s)}catch(r){throw t.firstCreatePass&&(t.incompleteFirstPass=!0,t.firstCreatePass=!1),r}finally{e[H]&=-5,Jy()}}function B2(t,e){for(let n=0;n<e.length;n++)j2(t,e[n])}function Vy(t,e,n){let r=n?t.styles:null,i=n?t.classes:null,s=0;if(e!==null)for(let o=0;o<e.length;o++){let a=e[o];if(typeof a=="number")s=a;else if(s==1)i=wT(i,a);else if(s==2){let u=a,c=e[++o];r=wT(r,u+": "+c+";")}}n?t.styles=r:t.stylesWithoutHost=r,n?t.classes=i:t.classesWithoutHost=i}var vh=class extends Nh{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){let n=Jr(e);return new ko(n,this.ngModule)}};function KT(t){let e=[];for(let n in t){if(!t.hasOwnProperty(n))continue;let r=t[n];r!==void 0&&e.push({propName:Array.isArray(r)?r[0]:r,templateName:n})}return e}function $2(t){let e=t.toLowerCase();return e==="svg"?QV:e==="math"?YV:null}var Ly=class{constructor(e,n){this.injector=e,this.parentInjector=n}get(e,n,r){r=Th(r);let i=this.injector.get(e,Ym,r);return i!==Ym||n===Ym?i:this.parentInjector.get(e,n,r)}},ko=class extends mh{get inputs(){let e=this.componentDef,n=e.inputTransforms,r=KT(e.inputs);if(n!==null)for(let i of r)n.hasOwnProperty(i.propName)&&(i.transform=n[i.propName]);return r}get outputs(){return KT(this.componentDef.outputs)}constructor(e,n){super(),this.componentDef=e,this.ngModule=n,this.componentType=e.type,this.selector=UV(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!n}create(e,n,r,i){i=i||this.ngModule;let s=i instanceof Qt?i:i?.injector;s&&this.componentDef.getStandaloneInjector!==null&&(s=this.componentDef.getStandaloneInjector(s)||s);let o=s?new Ly(e,s):e,a=o.get(Pu,null);if(a===null)throw new U(407,!1);let u=o.get(Bj,null),c=o.get(C_,null),l=o.get(Ey,null),d={rendererFactory:a,sanitizer:u,inlineEffectRunner:null,afterRenderEventManager:c,changeDetectionScheduler:l},h=a.createRenderer(null,this.componentDef),f=this.componentDef.selectors[0][0]||"div",p=r?t2(h,r,this.componentDef.encapsulation,o):yS(h,f,$2(f)),g=512;this.componentDef.signals?g|=4096:this.componentDef.onPush||(g|=16);let _=null;p!==null&&(_=g_(p,o,!0));let C=y_(0,null,null,1,0,null,null,null,null,null,null),M=kh(null,C,null,g,null,null,d,h,o,null,_);Xy(M);let T,j;try{let $=this.componentDef,Y,Me=null;$.findHostDirectiveDefs?(Y=[],Me=new Map,$.findHostDirectiveDefs($,Y,Me),Y.push($)):Y=[$];let sn=H2(M,p),pm=q2(sn,p,$,Y,M,d,h);j=Nb(C,ti),p&&W2(h,$,p,r),n!==void 0&&K2(j,this.ngContentSelectors,n),T=z2(pm,$,Y,Me,M,[Q2]),D_(C,M,null)}finally{Jy()}return new jy(this.componentType,T,Ph(j,M),M,j)}},jy=class extends Iy{constructor(e,n,r,i,s){super(),this.location=r,this._rootLView=i,this._tNode=s,this.previousInputValues=null,this.instance=n,this.hostView=this.changeDetectorRef=new os(i,void 0,!1),this.componentType=e}setInput(e,n){let r=this._tNode.inputs,i;if(r!==null&&(i=r[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),n))return;let s=this._rootLView;__(s[ue],s,i,e,n),this.previousInputValues.set(e,n);let o=ii(this._tNode.index,s);v_(o)}}get injector(){return new es(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}};function H2(t,e){let n=t[ue],r=ti;return t[r]=e,Oh(n,r,2,"#host",null)}function q2(t,e,n,r,i,s,o){let a=i[ue];G2(r,t,e,o);let u=null;e!==null&&(u=g_(e,i[xo]));let c=s.rendererFactory.createRenderer(e,n),l=16;n.signals?l=4096:n.onPush&&(l=64);let d=kh(i,US(n),null,l,i[t.index],t,s,c,null,null,u);return a.firstCreatePass&&Ay(a,t,r.length-1),Fh(i,d),i[t.index]=d}function G2(t,e,n,r){for(let i of t)e.mergedAttrs=bu(e.mergedAttrs,i.hostAttrs);e.mergedAttrs!==null&&(Vy(e,e.mergedAttrs,!0),n!==null&&DS(r,n,e))}function z2(t,e,n,r,i,s){let o=pn(),a=i[ue],u=Nn(o,i);$S(a,i,o,n,null,r);for(let l=0;l<n.length;l++){let d=o.directiveStart+l,h=Ro(i,a,d,o);ss(h,i)}HS(a,i,o),u&&ss(u,i);let c=Ro(i,a,o.directiveStart+o.componentOffset,o);if(t[Mn]=i[Mn]=c,s!==null)for(let l of s)l(c,e);return VS(a,o,t),c}function W2(t,e,n,r){if(r)ay(t,n,["ng-version","17.1.3"]);else{let{attrs:i,classes:s}=BV(e.selectors[0]);i&&ay(t,n,i),s&&s.length>0&&CS(t,n,s.join(" "))}}function K2(t,e,n){let r=t.projection=[];for(let i=0;i<e.length;i++){let s=n[i];r.push(s!=null?Array.from(s):null)}}function Q2(){let t=pn();n_(Be()[ue],t)}function Y2(t){return Object.getPrototypeOf(t.prototype).constructor}function ai(t){let e=Y2(t.type),n=!0,r=[t];for(;e;){let i;if(ni(t))i=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new U(903,!1);i=e.\u0275dir}if(i){if(n){r.push(i);let o=t;o.inputs=Qd(t.inputs),o.inputTransforms=Qd(t.inputTransforms),o.declaredInputs=Qd(t.declaredInputs),o.outputs=Qd(t.outputs);let a=i.hostBindings;a&&tU(t,a);let u=i.viewQuery,c=i.contentQueries;if(u&&J2(t,u),c&&eU(t,c),Z2(t,i),dV(t.outputs,i.outputs),ni(i)&&i.data.animation){let l=t.data;l.animation=(l.animation||[]).concat(i.data.animation)}}let s=i.features;if(s)for(let o=0;o<s.length;o++){let a=s[o];a&&a.ngInherit&&a(t),a===ai&&(n=!1)}}e=Object.getPrototypeOf(e)}X2(r)}function Z2(t,e){for(let n in e.inputs){if(!e.inputs.hasOwnProperty(n)||t.inputs.hasOwnProperty(n))continue;let r=e.inputs[n];if(r!==void 0&&(t.inputs[n]=r,t.declaredInputs[n]=e.declaredInputs[n],e.inputTransforms!==null)){let i=Array.isArray(r)?r[0]:r;if(!e.inputTransforms.hasOwnProperty(i))continue;t.inputTransforms??={},t.inputTransforms[i]=e.inputTransforms[i]}}}function X2(t){let e=0,n=null;for(let r=t.length-1;r>=0;r--){let i=t[r];i.hostVars=e+=i.hostVars,i.hostAttrs=bu(i.hostAttrs,n=bu(n,i.hostAttrs))}}function Qd(t){return t===Ao?{}:t===dn?[]:t}function J2(t,e){let n=t.viewQuery;n?t.viewQuery=(r,i)=>{e(r,i),n(r,i)}:t.viewQuery=e}function eU(t,e){let n=t.contentQueries;n?t.contentQueries=(r,i,s)=>{e(r,i,s),n(r,i,s)}:t.contentQueries=e}function tU(t,e){let n=t.hostBindings;n?t.hostBindings=(r,i)=>{e(r,i),n(r,i)}:t.hostBindings=e}var PZ=new RegExp(`^(\\d+)*(${Oj}|${kj})*(.*)`);var nU=()=>null;function QT(t,e){return nU(t,e)}function rU(t,e,n,r){let i=e.tView,o=t[H]&4096?4096:16,a=kh(t,i,n,o,null,e,null,null,null,r?.injector??null,r?.dehydratedView??null),u=t[e.index];a[bh]=u;let c=t[xu];return c!==null&&(a[xu]=c.createEmbeddedView(i)),D_(i,a,n),a}function YT(t,e){return!e||e.firstChild===null||gS(t)}function iU(t,e,n,r=!0){let i=e[ue];if(_j(i,e,t,n),r){let o=vy(n,t),a=e[It],u=d_(a,t[ns]);u!==null&&mj(i,t[Rn],a,e,u,o)}let s=e[sh];s!==null&&s.firstChild!==null&&(s.firstChild=null)}var ju=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=sU;let t=e;return t})();function sU(){let t=pn();return aU(t,Be())}var oU=ju,JS=class extends oU{constructor(e,n,r){super(),this._lContainer=e,this._hostTNode=n,this._hostLView=r}get element(){return Ph(this._hostTNode,this._hostLView)}get injector(){return new es(this._hostTNode,this._hostLView)}get parentInjector(){let e=r_(this._hostTNode,this._hostLView);if(Qb(e)){let n=lh(e,this._hostLView),r=ch(e),i=n[ue].data[r+8];return new es(i,n)}else return new es(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){let n=ZT(this._lContainer);return n!==null&&n[e]||null}get length(){return this._lContainer.length-hn}createEmbeddedView(e,n,r){let i,s;typeof r=="number"?i=r:r!=null&&(i=r.index,s=r.injector);let o=QT(this._lContainer,e.ssrId),a=e.createEmbeddedViewImpl(n||{},s,o);return this.insertImpl(a,i,YT(this._hostTNode,o)),a}createComponent(e,n,r,i,s){let o=e&&!VL(e),a;if(o)a=n;else{let p=n||{};a=p.index,r=p.injector,i=p.projectableNodes,s=p.environmentInjector||p.ngModuleRef}let u=o?e:new ko(Jr(e)),c=r||this.parentInjector;if(!s&&u.ngModule==null){let g=(o?c:this.parentInjector).get(Qt,null);g&&(s=g)}let l=Jr(u.componentType??{}),d=QT(this._lContainer,l?.id??null),h=d?.firstChild??null,f=u.create(c,i,h,s);return this.insertImpl(f.hostView,a,YT(this._hostTNode,d)),f}insert(e,n){return this.insertImpl(e,n,!0)}insertImpl(e,n,r){let i=e._lView;if(JV(i)){let a=this.indexOf(e);if(a!==-1)this.detach(a);else{let u=i[Et],c=new JS(u,u[Rn],u[Et]);c.detach(c.indexOf(e))}}let s=this._adjustIndex(n),o=this._lContainer;return iU(o,i,s,r),e.attachToViewContainerRef(),sS(Jm(o),s,e),e}move(e,n){return this.insert(e,n)}indexOf(e){let n=ZT(this._lContainer);return n!==null?n.indexOf(e):-1}remove(e){let n=this._adjustIndex(e,-1),r=_y(this._lContainer,n);r&&(hh(Jm(this._lContainer),n),wS(r[ue],r))}detach(e){let n=this._adjustIndex(e,-1),r=_y(this._lContainer,n);return r&&hh(Jm(this._lContainer),n)!=null?new os(r):null}_adjustIndex(e,n=0){return e??this.length+n}};function ZT(t){return t[oh]}function Jm(t){return t[oh]||(t[oh]=[])}function aU(t,e){let n,r=e[t.index];return Ar(r)?n=r:(n=qS(r,e,null,t),e[t.index]=n,Fh(e,n)),cU(n,e,t,r),new JS(n,t,e)}function uU(t,e){let n=t[It],r=n.createComment(""),i=Nn(e,t),s=d_(n,i);return gh(n,s,r,Tj(n,i),!1),r}var cU=hU,lU=()=>!1;function dU(t,e,n){return lU(t,e,n)}function hU(t,e,n,r){if(t[ns])return;let i;n.type&8?i=Yn(r):i=uU(e,n),t[ns]=i}var ri=class{},ku=class{};var wh=class extends ri{constructor(e,n,r){super(),this._parent=n,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new vh(this);let i=Eb(e);this._bootstrapComponents=pS(i.bootstrap),this._r3Injector=hS(e,n,[{provide:ri,useValue:this},{provide:Nh,useValue:this.componentFactoryResolver},...r],Bt(e),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(e)}get injector(){return this._r3Injector}destroy(){let e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(n=>n()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}},Eh=class extends ku{constructor(e){super(),this.moduleType=e}create(e){return new wh(this.moduleType,e,[])}};function fU(t,e,n){return new wh(t,e,n)}var Uy=class extends ri{constructor(e){super(),this.componentFactoryResolver=new vh(this),this.instance=null;let n=new Nu([...e.providers,{provide:ri,useValue:this},{provide:Nh,useValue:this.componentFactoryResolver}],e.parent||a_(),e.debugName,new Set(["environment"]));this.injector=n,e.runEnvironmentInitializers&&n.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}};function Vh(t,e,n=null){return new Uy({providers:t,parent:e,debugName:n,runEnvironmentInitializers:!0}).injector}var Lh=(()=>{let e=class e{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new mt(!1)}get _hasPendingTasks(){return this.hasPendingTasks.value}add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);let r=this.taskId++;return this.pendingTasks.add(r),r}remove(r){this.pendingTasks.delete(r),this.pendingTasks.size===0&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=k({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function T_(t,e,n){let r=t[e];return Object.is(r,n)?!1:(t[e]=n,!0)}function pU(t,e,n,r,i,s,o,a,u){let c=e.consts,l=Oh(e,t,4,o||null,uh(c,a));BS(e,n,l,uh(c,u)),n_(e,l);let d=l.tView=y_(2,l,r,i,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,c,null);return e.queries!==null&&(e.queries.template(e,l),d.queries=e.queries.embeddedTView(l)),l}function b_(t,e,n,r,i,s,o,a){let u=Be(),c=Xn(),l=t+ti,d=c.firstCreatePass?pU(l,c,u,e,n,r,i,s,o):c.data[l];Vu(d,!1);let h=gU(c,u,d,t);e_()&&h_(c,u,h,d),ss(h,u);let f=qS(h,u,h,d);return u[l]=f,Fh(u,f),dU(f,d,u),Qy(d)&&LS(c,u,d),o!=null&&jS(u,d,a),b_}var gU=mU;function mU(t,e,n,r){return t_(!0),e[It].createComment("")}function yU(t,e,n,r){return T_(t,Ub(),n)?e+ab(n)+r:Bo}function Yd(t,e){return t<<17|e<<2}function as(t){return t>>17&32767}function _U(t){return(t&2)==2}function vU(t,e){return t&131071|e<<17}function By(t){return t|2}function Oo(t){return(t&131068)>>2}function ey(t,e){return t&-131069|e<<2}function wU(t){return(t&1)===1}function $y(t){return t|1}function EU(t,e,n,r,i,s){let o=s?e.classBindings:e.styleBindings,a=as(o),u=Oo(o);t[r]=n;let c=!1,l;if(Array.isArray(n)){let d=n;l=d[1],(l===null||Lu(d,l)>0)&&(c=!0)}else l=n;if(i)if(u!==0){let h=as(t[a+1]);t[r+1]=Yd(h,a),h!==0&&(t[h+1]=ey(t[h+1],r)),t[a+1]=vU(t[a+1],r)}else t[r+1]=Yd(a,0),a!==0&&(t[a+1]=ey(t[a+1],r)),a=r;else t[r+1]=Yd(u,0),a===0?a=r:t[u+1]=ey(t[u+1],r),u=r;c&&(t[r+1]=By(t[r+1])),XT(t,l,r,!0),XT(t,l,r,!1),IU(e,l,t,r,s),o=Yd(a,u),s?e.classBindings=o:e.styleBindings=o}function IU(t,e,n,r,i){let s=i?t.residualClasses:t.residualStyles;s!=null&&typeof e=="string"&&Lu(s,e)>=0&&(n[r+1]=$y(n[r+1]))}function XT(t,e,n,r){let i=t[n+1],s=e===null,o=r?as(i):Oo(i),a=!1;for(;o!==0&&(a===!1||s);){let u=t[o],c=t[o+1];CU(u,e)&&(a=!0,t[o+1]=r?$y(c):By(c)),o=r?as(c):Oo(c)}a&&(t[n+1]=r?By(i):$y(i))}function CU(t,e){return t===null||e==null||(Array.isArray(t)?t[1]:t)===e?!0:Array.isArray(t)&&typeof e=="string"?Lu(t,e)>=0:!1}function ls(t,e,n){let r=Be(),i=Ub();if(T_(r,i,e)){let s=Xn(),o=vL();a2(s,o,r,t,e,r[It],n,!1)}return ls}function JT(t,e,n,r,i){let s=e.inputs,o=i?"class":"style";__(t,n,s[o],o,r)}function S_(t,e){return DU(t,e,null,!0),S_}function DU(t,e,n,r){let i=Be(),s=Xn(),o=hL(2);if(s.firstUpdatePass&&bU(s,t,o,r),e!==Bo&&T_(i,o,e)){let a=s.data[jo()];RU(s,a,i,i[It],t,i[o+1]=NU(e,n),r,o)}}function TU(t,e){return e>=t.expandoStartIndex}function bU(t,e,n,r){let i=t.data;if(i[n+1]===null){let s=i[jo()],o=TU(t,n);PU(s,r)&&e===null&&!o&&(e=!1),e=SU(i,s,e,r),EU(i,s,e,n,o,r)}}function SU(t,e,n,r){let i=mL(t),s=r?e.residualClasses:e.residualStyles;if(i===null)(r?e.classBindings:e.styleBindings)===0&&(n=ty(null,t,e,n,r),n=Ou(n,e.attrs,r),s=null);else{let o=e.directiveStylingLast;if(o===-1||t[o]!==i)if(n=ty(i,t,e,n,r),s===null){let u=AU(t,e,r);u!==void 0&&Array.isArray(u)&&(u=ty(null,t,e,u[1],r),u=Ou(u,e.attrs,r),xU(t,e,r,u))}else s=MU(t,e,r)}return s!==void 0&&(r?e.residualClasses=s:e.residualStyles=s),n}function AU(t,e,n){let r=n?e.classBindings:e.styleBindings;if(Oo(r)!==0)return t[as(r)]}function xU(t,e,n,r){let i=n?e.classBindings:e.styleBindings;t[as(i)]=r}function MU(t,e,n){let r,i=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<i;s++){let o=t[s].hostAttrs;r=Ou(r,o,n)}return Ou(r,e.attrs,n)}function ty(t,e,n,r,i){let s=null,o=n.directiveEnd,a=n.directiveStylingLast;for(a===-1?a=n.directiveStart:a++;a<o&&(s=e[a],r=Ou(r,s.hostAttrs,i),s!==t);)a++;return t!==null&&(n.directiveStylingLast=a),r}function Ou(t,e,n){let r=n?1:2,i=-1;if(e!==null)for(let s=0;s<e.length;s++){let o=e[s];typeof o=="number"?i=o:i===r&&(Array.isArray(t)||(t=t===void 0?[]:["",t]),jL(t,o,n?!0:e[++s]))}return t===void 0?null:t}function RU(t,e,n,r,i,s,o,a){if(!(e.type&3))return;let u=t.data,c=u[a+1],l=wU(c)?eb(u,e,n,i,Oo(c),o):void 0;if(!Ih(l)){Ih(s)||_U(c)&&(s=eb(u,null,n,i,a,o));let d=Rb(jo(),n);Nj(r,o,d,i,s)}}function eb(t,e,n,r,i,s){let o=e===null,a;for(;i>0;){let u=t[i],c=Array.isArray(u),l=c?u[1]:u,d=l===null,h=n[i+1];h===Bo&&(h=d?dn:void 0);let f=d?Wm(h,r):l===r?h:void 0;if(c&&!Ih(f)&&(f=Wm(u,r)),Ih(f)&&(a=f,o))return a;let p=t[i+1];i=o?as(p):Oo(p)}if(e!==null){let u=s?e.residualClasses:e.residualStyles;u!=null&&(a=Wm(u,r))}return a}function Ih(t){return t!==void 0}function NU(t,e){return t==null||t===""||(typeof e=="string"?t=t+e:typeof t=="object"&&(t=Bt(p_(t)))),t}function PU(t,e){return(t.flags&(e?8:16))!==0}function kU(t,e,n,r,i,s){let o=e.consts,a=uh(o,i),u=Oh(e,t,2,r,a);return BS(e,n,u,uh(o,s)),u.attrs!==null&&Vy(u,u.attrs,!1),u.mergedAttrs!==null&&Vy(u,u.mergedAttrs,!0),e.queries!==null&&e.queries.elementStart(e,u),u}function me(t,e,n,r){let i=Be(),s=Xn(),o=ti+t,a=i[It],u=s.firstCreatePass?kU(o,s,i,e,n,r):s.data[o],c=OU(s,i,u,a,e,t);i[o]=c;let l=Qy(u);return Vu(u,!0),DS(a,c,u),(u.flags&32)!==32&&e_()&&h_(s,i,c,u),rL()===0&&ss(c,i),iL(),l&&(LS(s,i,u),VS(s,u,i)),r!==null&&jS(i,u),me}function Te(){let t=pn();jb()?lL():(t=t.parent,Vu(t,!1));let e=t;aL(e)&&uL(),sL();let n=Xn();return n.firstCreatePass&&(n_(n,t),bb(t)&&n.queries.elementEnd(t)),e.classesWithoutHost!=null&&DL(e)&&JT(n,e,Be(),e.classesWithoutHost,!0),e.stylesWithoutHost!=null&&TL(e)&&JT(n,e,Be(),e.stylesWithoutHost,!1),Te}function er(t,e,n,r){return me(t,e,n,r),Te(),er}var OU=(t,e,n,r,i,s)=>(t_(!0),yS(r,i,wL()));function eA(){return Be()}var Ch="en-US";var FU=Ch;function VU(t){typeof t=="string"&&(FU=t.toLowerCase().replace(/_/g,"-"))}function ds(t){return!!t&&typeof t.then=="function"}function tA(t){return!!t&&typeof t.subscribe=="function"}function Mt(t,e,n,r){let i=Be(),s=Xn(),o=pn();return jU(s,i,i[It],o,t,e,r),Mt}function LU(t,e,n,r){let i=t.cleanup;if(i!=null)for(let s=0;s<i.length-1;s+=2){let o=i[s];if(o===n&&i[s+1]===r){let a=e[Su],u=i[s+2];return a.length>u?a[u]:null}typeof o=="string"&&(s+=2)}return null}function jU(t,e,n,r,i,s,o){let a=Qy(r),c=t.firstCreatePass&&I2(t),l=e[Mn],d=E2(e),h=!0;if(r.type&3||o){let g=Nn(r,e),_=o?o(g):g,C=d.length,M=o?j=>o(Yn(j[r.index])):r.index,T=null;if(!o&&a&&(T=LU(t,e,i,r.index)),T!==null){let j=T.__ngLastListenerFn__||T;j.__ngNextListenerFn__=s,T.__ngLastListenerFn__=s,h=!1}else{s=nb(r,e,l,s,!1);let j=n.listen(_,i,s);d.push(s,j),c&&c.push(i,M,C,C+1)}}else s=nb(r,e,l,s,!1);let f=r.outputs,p;if(h&&f!==null&&(p=f[i])){let g=p.length;if(g)for(let _=0;_<g;_+=2){let C=p[_],M=p[_+1],$=e[C][M].subscribe(s),Y=d.length;d.push(s,$),c&&c.push(i,r.index,Y,-(Y+1))}}}function tb(t,e,n,r){try{return zn(6,e,n),n(r)!==!1}catch(i){return zS(t,i),!1}finally{zn(7,e,n)}}function nb(t,e,n,r,i){return function s(o){if(o===Function)return r;let a=t.componentOffset>-1?ii(t.index,e):e;v_(a);let u=tb(e,n,r,o),c=s.__ngNextListenerFn__;for(;c;)u=tb(e,n,c,o)&&u,c=c.__ngNextListenerFn__;return i&&u===!1&&o.preventDefault(),u}}function nA(t=1){return _L(t)}var A_=(()=>{let e=class e{};e.__NG_ELEMENT_ID__=$U;let t=e;return t})(),UU=A_,BU=class extends UU{constructor(e,n,r){super(),this._declarationLView=e,this._declarationTContainer=n,this.elementRef=r}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,n){return this.createEmbeddedViewImpl(e,n)}createEmbeddedViewImpl(e,n,r){let i=rU(this._declarationLView,this._declarationTContainer,e,{injector:n,dehydratedView:r});return new os(i)}};function $U(){return HU(pn(),Be())}function HU(t,e){return t.type&4?new BU(e,t,Ph(t,e)):null}function Ne(t,e=""){let n=Be(),r=Xn(),i=t+ti,s=r.firstCreatePass?Oh(r,i,1,e,null):r.data[i],o=qU(r,n,s,e,t);n[i]=o,e_()&&h_(r,n,o,s),Vu(s,!1)}var qU=(t,e,n,r,i)=>(t_(!0),fj(e[It],r));function Ho(t){return rA("",t,""),Ho}function rA(t,e,n){let r=Be(),i=yU(r,t,e,n);return i!==Bo&&C2(r,jo(),i),rA}function GU(t,e,n){let r=Xn();if(r.firstCreatePass){let i=ni(t);Hy(n,r.data,r.blueprint,i,!0),Hy(e,r.data,r.blueprint,i,!1)}}function Hy(t,e,n,r,i){if(t=xt(t),Array.isArray(t))for(let s=0;s<t.length;s++)Hy(t[s],e,n,r,i);else{let s=Xn(),o=Be(),a=pn(),u=Po(t)?t:xt(t.provide),c=dS(t),l=a.providerIndexes&1048575,d=a.directiveStart,h=a.providerIndexes>>20;if(Po(t)||!t.multi){let f=new is(c,i,_e),p=ry(u,e,i?l:l+h,d);p===-1?(hy(dh(a,o),s,u),ny(s,t,e.length),e.push(u),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),n.push(f),o.push(f)):(n[p]=f,o[p]=f)}else{let f=ry(u,e,l+h,d),p=ry(u,e,l,l+h),g=f>=0&&n[f],_=p>=0&&n[p];if(i&&!_||!i&&!g){hy(dh(a,o),s,u);let C=KU(i?WU:zU,n.length,i,r,c);!i&&_&&(n[p].providerFactory=C),ny(s,t,e.length,0),e.push(u),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),n.push(C),o.push(C)}else{let C=iA(n[i?p:f],c,!i&&r);ny(s,t,f>-1?f:p,C)}!i&&r&&_&&n[p].componentProviders++}}}function ny(t,e,n,r){let i=Po(e),s=ZL(e);if(i||s){let u=(s?xt(e.useClass):e).prototype.ngOnDestroy;if(u){let c=t.destroyHooks||(t.destroyHooks=[]);if(!i&&e.multi){let l=c.indexOf(n);l===-1?c.push(n,[r,u]):c[l+1].push(r,u)}else c.push(n,u)}}}function iA(t,e,n){return n&&t.componentProviders++,t.multi.push(e)-1}function ry(t,e,n,r){for(let i=n;i<r;i++)if(e[i]===t)return i;return-1}function zU(t,e,n,r){return qy(this.multi,[])}function WU(t,e,n,r){let i=this.multi,s;if(this.providerFactory){let o=this.providerFactory.componentProviders,a=Ro(n,n[ue],this.providerFactory.index,r);s=a.slice(0,o),qy(i,s);for(let u=o;u<a.length;u++)s.push(a[u])}else s=[],qy(i,s);return s}function qy(t,e){for(let n=0;n<t.length;n++){let r=t[n];e.push(r())}return e}function KU(t,e,n,r,i){let s=new is(t,n,_e);return s.multi=[],s.index=e,s.componentProviders=0,iA(s,i,r&&!n),s}function Uu(t,e=[]){return n=>{n.providersResolver=(r,i)=>GU(r,i?i(t):t,e)}}var QU=(()=>{let e=class e{constructor(r){this._injector=r,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(r){if(!r.standalone)return null;if(!this.cachedInjectors.has(r)){let i=uS(!1,r.type),s=i.length>0?Vh([i],this._injector,`Standalone[${r.type.name}]`):null;this.cachedInjectors.set(r,s)}return this.cachedInjectors.get(r)}ngOnDestroy(){try{for(let r of this.cachedInjectors.values())r!==null&&r.destroy()}finally{this.cachedInjectors.clear()}}};e.\u0275prov=k({token:e,providedIn:"environment",factory:()=>new e(I(Qt))});let t=e;return t})();function sA(t){w_("NgStandalone"),t.getStandaloneInjector=e=>e.get(QU).getOrCreateStandaloneInjector(t)}var Zd=null;function YU(t){Zd!==null&&(t.defaultEncapsulation!==Zd.defaultEncapsulation||t.preserveWhitespaces!==Zd.preserveWhitespaces)||(Zd=t)}var br=class{constructor(e){this.full=e;let n=e.split(".");this.major=n[0],this.minor=n[1],this.patch=n.slice(2).join(".")}},oA=new br("17.1.3"),jh=(()=>{let e=class e{log(r){console.log(r)}warn(r){console.warn(r)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=k({token:e,factory:e.\u0275fac,providedIn:"platform"});let t=e;return t})(),Gy=class{constructor(e,n){this.ngModuleFactory=e,this.componentFactories=n}},Uh=(()=>{let e=class e{compileModuleSync(r){return new Eh(r)}compileModuleAsync(r){return Promise.resolve(this.compileModuleSync(r))}compileModuleAndAllComponentsSync(r){let i=this.compileModuleSync(r),s=Eb(r),o=pS(s.declarations).reduce((a,u)=>{let c=Jr(u);return c&&a.push(new ko(c)),a},[]);return new Gy(i,o)}compileModuleAndAllComponentsAsync(r){return Promise.resolve(this.compileModuleAndAllComponentsSync(r))}clearCache(){}clearCacheFor(r){}getModuleId(r){}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=k({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),ZU=new P("");var x_=new P(""),Bu=new P(""),Bh=(()=>{let e=class e{constructor(r,i,s){this._ngZone=r,this.registry=i,this._pendingCount=0,this._isZoneStable=!0,this._callbacks=[],this.taskTrackingZone=null,M_||(XU(s),s.addToWindow(i)),this._watchAngularEvents(),r.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{se.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&this._pendingCount===0&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;this._callbacks.length!==0;){let r=this._callbacks.pop();clearTimeout(r.timeoutId),r.doneCb()}});else{let r=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>i.updateCb&&i.updateCb(r)?(clearTimeout(i.timeoutId),!1):!0)}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(r=>({source:r.source,creationLocation:r.creationLocation,data:r.data})):[]}addCallback(r,i,s){let o=-1;i&&i>0&&(o=setTimeout(()=>{this._callbacks=this._callbacks.filter(a=>a.timeoutId!==o),r()},i)),this._callbacks.push({doneCb:r,timeoutId:o,updateCb:s})}whenStable(r,i,s){if(s&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(r,i,s),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(r){this.registry.registerApplication(r,this)}unregisterApplication(r){this.registry.unregisterApplication(r)}findProviders(r,i,s){return[]}};e.\u0275fac=function(i){return new(i||e)(I(se),I($h),I(Bu))},e.\u0275prov=k({token:e,factory:e.\u0275fac});let t=e;return t})(),$h=(()=>{let e=class e{constructor(){this._applications=new Map}registerApplication(r,i){this._applications.set(r,i)}unregisterApplication(r){this._applications.delete(r)}unregisterAllApplications(){this._applications.clear()}getTestability(r){return this._applications.get(r)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(r,i=!0){return M_?.findTestabilityInTree(this,r,i)??null}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=k({token:e,factory:e.\u0275fac,providedIn:"platform"});let t=e;return t})();function XU(t){M_=t}var M_,Hh=new P(""),aA=(()=>{let e=class e{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((r,i)=>{this.resolve=r,this.reject=i}),this.appInits=R(Hh,{optional:!0})??[]}runInitializers(){if(this.initialized)return;let r=[];for(let s of this.appInits){let o=s();if(ds(o))r.push(o);else if(tA(o)){let a=new Promise((u,c)=>{o.subscribe({complete:u,error:c})});r.push(a)}}let i=()=>{this.done=!0,this.resolve()};Promise.all(r).then(()=>{i()}).catch(s=>{this.reject(s)}),r.length===0&&i(),this.initialized=!0}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=k({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),R_=new P("");function JU(t,e,n){let r=new Eh(n);return Promise.resolve(r)}function eB(){J0(()=>{throw new U(600,!1)})}function tB(t){return t.isBoundToModule}function nB(t,e,n){try{let r=n();return ds(r)?r.catch(i=>{throw e.runOutsideAngular(()=>t.handleError(i)),i}):r}catch(r){throw e.runOutsideAngular(()=>t.handleError(r)),r}}function uA(t,e){return Array.isArray(e)?e.reduce(uA,t):S(S({},t),e)}var qo=(()=>{let e=class e{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=R(MS),this.afterRenderEffectManager=R(C_),this.componentTypes=[],this.components=[],this.isStable=R(Lh).hasPendingTasks.pipe(F(r=>!r)),this._injector=R(Qt)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(r,i){let s=r instanceof mh;if(!this._injector.get(aA).done){let f=!s&&wb(r),p=!1;throw new U(405,p)}let a;s?a=r:a=this._injector.get(Nh).resolveComponentFactory(r),this.componentTypes.push(a.componentType);let u=tB(a)?void 0:this._injector.get(ri),c=i||a.selector,l=a.create(Pn.NULL,[],c,u),d=l.location.nativeElement,h=l.injector.get(x_,null);return h?.registerApplication(d),l.onDestroy(()=>{this.detachView(l.hostView),nh(this.components,l),h?.unregisterApplication(d)}),this._loadComponent(l),l}tick(){if(this._runningTick)throw new U(101,!1);try{this._runningTick=!0,this.detectChangesInAttachedViews()}catch(r){this.internalErrorHandler(r)}finally{this._runningTick=!1}}detectChangesInAttachedViews(){let r=0;do{if(r===WS)throw new U(103,!1);let i=r===0;for(let{_lView:s,notifyErrorHandler:o}of this._views)!i&&!ib(s)||this.detectChangesInView(s,o,i);this.afterRenderEffectManager.execute(),r++}while(this._views.some(({_lView:i})=>ib(i)))}detectChangesInView(r,i,s){let o;s?(o=0,r[H]|=1024):r[H]&64?o=0:o=1,KS(r,i,o)}attachView(r){let i=r;this._views.push(i),i.attachToAppRef(this)}detachView(r){let i=r;nh(this._views,i),i.detachFromAppRef()}_loadComponent(r){this.attachView(r.hostView),this.tick(),this.components.push(r);let i=this._injector.get(R_,[]);[...this._bootstrapListeners,...i].forEach(s=>s(r))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(r=>r()),this._views.slice().forEach(r=>r.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(r){return this._destroyListeners.push(r),()=>nh(this._destroyListeners,r)}destroy(){if(this._destroyed)throw new U(406,!1);let r=this._injector;r.destroy&&!r.destroyed&&r.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=k({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function nh(t,e){let n=t.indexOf(e);n>-1&&t.splice(n,1)}function rb(t){for(let e=t.length-1;e>=0;e--)if(t[e]!==void 0)return t[e]}function ib(t){return Zy(t)}var rB=(()=>{let e=class e{constructor(){this.zone=R(se),this.applicationRef=R(qo)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=k({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function iB(t){return[{provide:se,useFactory:t},{provide:No,multi:!0,useFactory:()=>{let e=R(rB,{optional:!0});return()=>e.initialize()}},{provide:No,multi:!0,useFactory:()=>{let e=R(aB);return()=>{e.initialize()}}},{provide:MS,useFactory:sB}]}function sB(){let t=R(se),e=R(Zn);return n=>t.runOutsideAngular(()=>e.handleError(n))}function oB(t){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:t?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:t?.runCoalescing??!1}}var aB=(()=>{let e=class e{constructor(){this.subscription=new Ue,this.initialized=!1,this.zone=R(se),this.pendingTasks=R(Lh)}initialize(){if(this.initialized)return;this.initialized=!0;let r=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(r=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{se.assertNotInAngularZone(),queueMicrotask(()=>{r!==null&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(r),r=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{se.assertInAngularZone(),r??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=k({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function uB(){return typeof $localize<"u"&&$localize.locale||Ch}var N_=new P("",{providedIn:"root",factory:()=>R(N_,ne.Optional|ne.SkipSelf)||uB()});var cA=new P(""),lA=(()=>{let e=class e{constructor(r){this._injector=r,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(r,i){let s=V2(i?.ngZone,oB({eventCoalescing:i?.ngZoneEventCoalescing,runCoalescing:i?.ngZoneRunCoalescing}));return s.run(()=>{let o=fU(r.moduleType,this.injector,iB(()=>s)),a=o.injector.get(Zn,null);return s.runOutsideAngular(()=>{let u=s.onError.subscribe({next:c=>{a.handleError(c)}});o.onDestroy(()=>{nh(this._modules,o),u.unsubscribe()})}),nB(a,s,()=>{let u=o.injector.get(aA);return u.runInitializers(),u.donePromise.then(()=>{let c=o.injector.get(N_,Ch);return VU(c||Ch),this._moduleDoBootstrap(o),o})})})}bootstrapModule(r,i=[]){let s=uA({},i);return JU(this.injector,s,r).then(o=>this.bootstrapModuleFactory(o,s))}_moduleDoBootstrap(r){let i=r.injector.get(qo);if(r._bootstrapComponents.length>0)r._bootstrapComponents.forEach(s=>i.bootstrap(s));else if(r.instance.ngDoBootstrap)r.instance.ngDoBootstrap(i);else throw new U(-403,!1);this._modules.push(r)}onDestroy(r){this._destroyListeners.push(r)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new U(404,!1);this._modules.slice().forEach(i=>i.destroy()),this._destroyListeners.forEach(i=>i());let r=this._injector.get(cA,null);r&&(r.forEach(i=>i()),r.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}};e.\u0275fac=function(i){return new(i||e)(I(Pn))},e.\u0275prov=k({token:e,factory:e.\u0275fac,providedIn:"platform"});let t=e;return t})(),Du=null,dA=new P("");function cB(t){if(Du&&!Du.get(dA,!1))throw new U(400,!1);eB(),Du=t;let e=t.get(lA);return hB(t),e}function P_(t,e,n=[]){let r=`Platform: ${e}`,i=new P(r);return(s=[])=>{let o=hA();if(!o||o.injector.get(dA,!1)){let a=[...n,...s,{provide:i,useValue:!0}];t?t(a):cB(lB(a,r))}return dB(i)}}function lB(t=[],e){return Pn.create({name:e,providers:[{provide:xh,useValue:"platform"},{provide:cA,useValue:new Set([()=>Du=null])},...t]})}function dB(t){let e=hA();if(!e)throw new U(401,!1);return e}function hA(){return Du?.get(lA)??null}function hB(t){t.get(u_,null)?.forEach(n=>n())}function k_(){return!1}var fA=P_(null,"core",[]),pA=(()=>{let e=class e{constructor(r){}};e.\u0275fac=function(i){return new(i||e)(I(qo))},e.\u0275mod=Ye({type:e}),e.\u0275inj=Qe({});let t=e;return t})();function qh(t){return typeof t=="boolean"?t:t!=null&&t!=="false"}function gA(t){let e=Jr(t);if(!e)return null;let n=new ko(e);return{get selector(){return n.selector},get type(){return n.componentType},get inputs(){return n.inputs},get outputs(){return n.outputs},get ngContentSelectors(){return n.ngContentSelectors},get isStandalone(){return e.standalone},get isSignal(){return e.signals}}}var vA=null;function tr(){return vA}function wA(t){vA??=t}var Gh=class{},qt=new P(""),L_=(()=>{let e=class e{historyGo(r){throw new Error("")}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=k({token:e,factory:()=>R(gB),providedIn:"platform"});let t=e;return t})(),EA=new P(""),gB=(()=>{let e=class e extends L_{constructor(){super(),this._doc=R(qt),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return tr().getBaseHref(this._doc)}onPopState(r){let i=tr().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",r,!1),()=>i.removeEventListener("popstate",r)}onHashChange(r){let i=tr().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",r,!1),()=>i.removeEventListener("hashchange",r)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(r){this._location.pathname=r}pushState(r,i,s){this._history.pushState(r,i,s)}replaceState(r,i,s){this._history.replaceState(r,i,s)}forward(){this._history.forward()}back(){this._history.back()}historyGo(r=0){this._history.go(r)}getState(){return this._history.state}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=k({token:e,factory:()=>new e,providedIn:"platform"});let t=e;return t})();function j_(t,e){if(t.length==0)return e;if(e.length==0)return t;let n=0;return t.endsWith("/")&&n++,e.startsWith("/")&&n++,n==2?t+e.substring(1):n==1?t+e:t+"/"+e}function mA(t){let e=t.match(/#|\?|$/),n=e&&e.index||t.length,r=n-(t[n-1]==="/"?1:0);return t.slice(0,r)+t.slice(n)}function Mr(t){return t&&t[0]!=="?"?"?"+t:t}var hs=(()=>{let e=class e{historyGo(r){throw new Error("")}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=k({token:e,factory:()=>R(U_),providedIn:"root"});let t=e;return t})(),IA=new P(""),U_=(()=>{let e=class e extends hs{constructor(r,i){super(),this._platformLocation=r,this._removeListenerFns=[],this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??R(qt).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(r){this._removeListenerFns.push(this._platformLocation.onPopState(r),this._platformLocation.onHashChange(r))}getBaseHref(){return this._baseHref}prepareExternalUrl(r){return j_(this._baseHref,r)}path(r=!1){let i=this._platformLocation.pathname+Mr(this._platformLocation.search),s=this._platformLocation.hash;return s&&r?`${i}${s}`:i}pushState(r,i,s,o){let a=this.prepareExternalUrl(s+Mr(o));this._platformLocation.pushState(r,i,a)}replaceState(r,i,s,o){let a=this.prepareExternalUrl(s+Mr(o));this._platformLocation.replaceState(r,i,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(r=0){this._platformLocation.historyGo?.(r)}};e.\u0275fac=function(i){return new(i||e)(I(L_),I(IA,8))},e.\u0275prov=k({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),CA=(()=>{let e=class e extends hs{constructor(r,i){super(),this._platformLocation=r,this._baseHref="",this._removeListenerFns=[],i!=null&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(r){this._removeListenerFns.push(this._platformLocation.onPopState(r),this._platformLocation.onHashChange(r))}getBaseHref(){return this._baseHref}path(r=!1){let i=this._platformLocation.hash??"#";return i.length>0?i.substring(1):i}prepareExternalUrl(r){let i=j_(this._baseHref,r);return i.length>0?"#"+i:i}pushState(r,i,s,o){let a=this.prepareExternalUrl(s+Mr(o));a.length==0&&(a=this._platformLocation.pathname),this._platformLocation.pushState(r,i,a)}replaceState(r,i,s,o){let a=this.prepareExternalUrl(s+Mr(o));a.length==0&&(a=this._platformLocation.pathname),this._platformLocation.replaceState(r,i,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(r=0){this._platformLocation.historyGo?.(r)}};e.\u0275fac=function(i){return new(i||e)(I(L_),I(IA,8))},e.\u0275prov=k({token:e,factory:e.\u0275fac});let t=e;return t})(),Go=(()=>{let e=class e{constructor(r){this._subject=new it,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=r;let i=this._locationStrategy.getBaseHref();this._basePath=_B(mA(yA(i))),this._locationStrategy.onPopState(s=>{this._subject.emit({url:this.path(!0),pop:!0,state:s.state,type:s.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(r=!1){return this.normalize(this._locationStrategy.path(r))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(r,i=""){return this.path()==this.normalize(r+Mr(i))}normalize(r){return e.stripTrailingSlash(yB(this._basePath,yA(r)))}prepareExternalUrl(r){return r&&r[0]!=="/"&&(r="/"+r),this._locationStrategy.prepareExternalUrl(r)}go(r,i="",s=null){this._locationStrategy.pushState(s,"",r,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(r+Mr(i)),s)}replaceState(r,i="",s=null){this._locationStrategy.replaceState(s,"",r,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(r+Mr(i)),s)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(r=0){this._locationStrategy.historyGo?.(r)}onUrlChange(r){return this._urlChangeListeners.push(r),this._urlChangeSubscription??=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)}),()=>{let i=this._urlChangeListeners.indexOf(r);this._urlChangeListeners.splice(i,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(r="",i){this._urlChangeListeners.forEach(s=>s(r,i))}subscribe(r,i,s){return this._subject.subscribe({next:r,error:i,complete:s})}};e.normalizeQueryParams=Mr,e.joinWithSlash=j_,e.stripTrailingSlash=mA,e.\u0275fac=function(i){return new(i||e)(I(hs))},e.\u0275prov=k({token:e,factory:()=>mB(),providedIn:"root"});let t=e;return t})();function mB(){return new Go(I(hs))}function yB(t,e){if(!t||!e.startsWith(t))return e;let n=e.substring(t.length);return n===""||["/",";","?","#"].includes(n[0])?n:e}function yA(t){return t.replace(/\/index.html$/,"")}function _B(t){if(new RegExp("^(https?:)?//").test(t)){let[,n]=t.split(/\/\/[^\/]+/);return n}return t}function DA(t,e){e=encodeURIComponent(e);for(let n of t.split(";")){let r=n.indexOf("="),[i,s]=r==-1?[n,""]:[n.slice(0,r),n.slice(r+1)];if(i.trim()===e)return decodeURIComponent(s)}return null}var O_=class{constructor(e,n,r,i){this.$implicit=e,this.ngForOf=n,this.index=r,this.count=i}get first(){return this.index===0}get last(){return this.index===this.count-1}get even(){return this.index%2===0}get odd(){return!this.even}},TA=(()=>{let e=class e{set ngForOf(r){this._ngForOf=r,this._ngForOfDirty=!0}set ngForTrackBy(r){this._trackByFn=r}get ngForTrackBy(){return this._trackByFn}constructor(r,i,s){this._viewContainer=r,this._template=i,this._differs=s,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(r){r&&(this._template=r)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;let r=this._ngForOf;if(!this._differ&&r)if(0)try{}catch{}else this._differ=this._differs.find(r).create(this.ngForTrackBy)}if(this._differ){let r=this._differ.diff(this._ngForOf);r&&this._applyChanges(r)}}_applyChanges(r){let i=this._viewContainer;r.forEachOperation((s,o,a)=>{if(s.previousIndex==null)i.createEmbeddedView(this._template,new O_(s.item,this._ngForOf,-1,-1),a===null?void 0:a);else if(a==null)i.remove(o===null?void 0:o);else if(o!==null){let u=i.get(o);i.move(u,a),_A(u,s)}});for(let s=0,o=i.length;s<o;s++){let u=i.get(s).context;u.index=s,u.count=o,u.ngForOf=this._ngForOf}r.forEachIdentityChange(s=>{let o=i.get(s.currentIndex);_A(o,s)})}static ngTemplateContextGuard(r,i){return!0}};e.\u0275fac=function(i){return new(i||e)(_e(ju),_e(A_),_e(m_))},e.\u0275dir=$t({type:e,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0});let t=e;return t})();function _A(t,e){t.context.$implicit=e.item}var bA=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Ye({type:e}),e.\u0275inj=Qe({});let t=e;return t})(),B_="browser",vB="server";function wB(t){return t===B_}function fs(t){return t===vB}var SA=(()=>{let e=class e{};e.\u0275prov=k({token:e,providedIn:"root",factory:()=>wB(R(Ct))?new F_(R(qt),window):new V_});let t=e;return t})(),F_=class{constructor(e,n){this.document=e,this.window=n,this.offset=()=>[0,0]}setOffset(e){Array.isArray(e)?this.offset=()=>e:this.offset=e}getScrollPosition(){return[this.window.scrollX,this.window.scrollY]}scrollToPosition(e){this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){let n=EB(this.document,e);n&&(this.scrollToElement(n),n.focus())}setHistoryScrollRestoration(e){this.window.history.scrollRestoration=e}scrollToElement(e){let n=e.getBoundingClientRect(),r=n.left+this.window.pageXOffset,i=n.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(r-s[0],i-s[1])}};function EB(t,e){let n=t.getElementById(e)||t.getElementsByName(e)[0];if(n)return n;if(typeof t.createTreeWalker=="function"&&t.body&&typeof t.body.attachShadow=="function"){let r=t.createTreeWalker(t.body,NodeFilter.SHOW_ELEMENT),i=r.currentNode;for(;i;){let s=i.shadowRoot;if(s){let o=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(o)return o}i=r.nextNode()}}return null}var V_=class{setOffset(e){}getScrollPosition(){return[0,0]}scrollToPosition(e){}scrollToAnchor(e){}setHistoryScrollRestoration(e){}},zh=class{};var q_=class extends Gh{constructor(){super(...arguments),this.supportsDOMEvents=!0}},G_=class t extends q_{static makeCurrent(){wA(new t)}onAndCancel(e,n,r){return e.addEventListener(n,r),()=>{e.removeEventListener(n,r)}}dispatchEvent(e,n){e.dispatchEvent(n)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,n){return n=n||this.getDefaultDocument(),n.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,n){return n==="window"?window:n==="document"?e:n==="body"?e.body:null}getBaseHref(e){let n=DB();return n==null?null:TB(n)}resetBaseElement(){$u=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return DA(document.cookie,e)}},$u=null;function DB(){return $u=$u||document.querySelector("base"),$u?$u.getAttribute("href"):null}function TB(t){return new URL(t,document.baseURI).pathname}var z_=class{addToWindow(e){Kt.getAngularTestability=(r,i=!0)=>{let s=e.findTestabilityInTree(r,i);if(s==null)throw new U(5103,!1);return s},Kt.getAllAngularTestabilities=()=>e.getAllTestabilities(),Kt.getAllAngularRootElements=()=>e.getAllRootElements();let n=r=>{let i=Kt.getAllAngularTestabilities(),s=i.length,o=function(){s--,s==0&&r()};i.forEach(a=>{a.whenStable(o)})};Kt.frameworkStabilizers||(Kt.frameworkStabilizers=[]),Kt.frameworkStabilizers.push(n)}findTestabilityInTree(e,n,r){if(n==null)return null;let i=e.getTestability(n);return i??(r?tr().isShadowRoot(n)?this.findTestabilityInTree(e,n.host,!0):this.findTestabilityInTree(e,n.parentElement,!0):null)}},bB=(()=>{let e=class e{build(){return new XMLHttpRequest}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=k({token:e,factory:e.\u0275fac});let t=e;return t})(),W_=new P(""),RA=(()=>{let e=class e{constructor(r,i){this._zone=i,this._eventNameToPlugin=new Map,r.forEach(s=>{s.manager=this}),this._plugins=r.slice().reverse()}addEventListener(r,i,s){return this._findPluginFor(i).addEventListener(r,i,s)}getZone(){return this._zone}_findPluginFor(r){let i=this._eventNameToPlugin.get(r);if(i)return i;if(i=this._plugins.find(o=>o.supports(r)),!i)throw new U(5101,!1);return this._eventNameToPlugin.set(r,i),i}};e.\u0275fac=function(i){return new(i||e)(I(W_),I(se))},e.\u0275prov=k({token:e,factory:e.\u0275fac});let t=e;return t})(),Wh=class{constructor(e){this._doc=e}},$_="ng-app-id",NA=(()=>{let e=class e{constructor(r,i,s,o={}){this.doc=r,this.appId=i,this.nonce=s,this.platformId=o,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=fs(o),this.resetHostNodes()}addStyles(r){for(let i of r)this.changeUsageCount(i,1)===1&&this.onStyleAdded(i)}removeStyles(r){for(let i of r)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){let r=this.styleNodesInDOM;r&&(r.forEach(i=>i.remove()),r.clear());for(let i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(r){this.hostNodes.add(r);for(let i of this.getAllStyles())this.addStyleToHost(r,i)}removeHost(r){this.hostNodes.delete(r)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(r){for(let i of this.hostNodes)this.addStyleToHost(i,r)}onStyleRemoved(r){let i=this.styleRef;i.get(r)?.elements?.forEach(s=>s.remove()),i.delete(r)}collectServerRenderedStyles(){let r=this.doc.head?.querySelectorAll(`style[${$_}="${this.appId}"]`);if(r?.length){let i=new Map;return r.forEach(s=>{s.textContent!=null&&i.set(s.textContent,s)}),i}return null}changeUsageCount(r,i){let s=this.styleRef;if(s.has(r)){let o=s.get(r);return o.usage+=i,o.usage}return s.set(r,{usage:i,elements:[]}),i}getStyleElement(r,i){let s=this.styleNodesInDOM,o=s?.get(i);if(o?.parentNode===r)return s.delete(i),o.removeAttribute($_),o;{let a=this.doc.createElement("style");return this.nonce&&a.setAttribute("nonce",this.nonce),a.textContent=i,this.platformIsServer&&a.setAttribute($_,this.appId),r.appendChild(a),a}}addStyleToHost(r,i){let s=this.getStyleElement(r,i),o=this.styleRef,a=o.get(i)?.elements;a?a.push(s):o.set(i,{elements:[s],usage:1})}resetHostNodes(){let r=this.hostNodes;r.clear(),r.add(this.doc.head)}};e.\u0275fac=function(i){return new(i||e)(I(qt),I(Mh),I(c_,8),I(Ct))},e.\u0275prov=k({token:e,factory:e.\u0275fac});let t=e;return t})(),H_={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},Q_=/%COMP%/g,PA="%COMP%",SB=`_nghost-${PA}`,AB=`_ngcontent-${PA}`,xB=!0,MB=new P("",{providedIn:"root",factory:()=>xB});function RB(t){return AB.replace(Q_,t)}function NB(t){return SB.replace(Q_,t)}function kA(t,e){return e.map(n=>n.replace(Q_,t))}var AA=(()=>{let e=class e{constructor(r,i,s,o,a,u,c,l=null){this.eventManager=r,this.sharedStylesHost=i,this.appId=s,this.removeStylesOnCompDestroy=o,this.doc=a,this.platformId=u,this.ngZone=c,this.nonce=l,this.rendererByCompId=new Map,this.platformIsServer=fs(u),this.defaultRenderer=new Hu(r,a,c,this.platformIsServer)}createRenderer(r,i){if(!r||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===Kn.ShadowDom&&(i=ce(S({},i),{encapsulation:Kn.Emulated}));let s=this.getOrCreateRenderer(r,i);return s instanceof Kh?s.applyToHost(r):s instanceof qu&&s.applyStyles(),s}getOrCreateRenderer(r,i){let s=this.rendererByCompId,o=s.get(i.id);if(!o){let a=this.doc,u=this.ngZone,c=this.eventManager,l=this.sharedStylesHost,d=this.removeStylesOnCompDestroy,h=this.platformIsServer;switch(i.encapsulation){case Kn.Emulated:o=new Kh(c,l,i,this.appId,d,a,u,h);break;case Kn.ShadowDom:return new K_(c,l,r,i,a,u,this.nonce,h);default:o=new qu(c,l,i,d,a,u,h);break}s.set(i.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}};e.\u0275fac=function(i){return new(i||e)(I(RA),I(NA),I(Mh),I(MB),I(qt),I(Ct),I(se),I(c_))},e.\u0275prov=k({token:e,factory:e.\u0275fac});let t=e;return t})(),Hu=class{constructor(e,n,r,i){this.eventManager=e,this.doc=n,this.ngZone=r,this.platformIsServer=i,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(e,n){return n?this.doc.createElementNS(H_[n]||n,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,n){(xA(e)?e.content:e).appendChild(n)}insertBefore(e,n,r){e&&(xA(e)?e.content:e).insertBefore(n,r)}removeChild(e,n){e&&e.removeChild(n)}selectRootElement(e,n){let r=typeof e=="string"?this.doc.querySelector(e):e;if(!r)throw new U(-5104,!1);return n||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,n,r,i){if(i){n=i+":"+n;let s=H_[i];s?e.setAttributeNS(s,n,r):e.setAttribute(n,r)}else e.setAttribute(n,r)}removeAttribute(e,n,r){if(r){let i=H_[r];i?e.removeAttributeNS(i,n):e.removeAttribute(`${r}:${n}`)}else e.removeAttribute(n)}addClass(e,n){e.classList.add(n)}removeClass(e,n){e.classList.remove(n)}setStyle(e,n,r,i){i&(Tr.DashCase|Tr.Important)?e.style.setProperty(n,r,i&Tr.Important?"important":""):e.style[n]=r}removeStyle(e,n,r){r&Tr.DashCase?e.style.removeProperty(n):e.style[n]=""}setProperty(e,n,r){e!=null&&(e[n]=r)}setValue(e,n){e.nodeValue=n}listen(e,n,r){if(typeof e=="string"&&(e=tr().getGlobalEventTarget(this.doc,e),!e))throw new Error(`Unsupported event target ${e} for event ${n}`);return this.eventManager.addEventListener(e,n,this.decoratePreventDefault(r))}decoratePreventDefault(e){return n=>{if(n==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(n)):e(n))===!1&&n.preventDefault()}}};function xA(t){return t.tagName==="TEMPLATE"&&t.content!==void 0}var K_=class extends Hu{constructor(e,n,r,i,s,o,a,u){super(e,s,o,u),this.sharedStylesHost=n,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let c=kA(i.id,i.styles);for(let l of c){let d=document.createElement("style");a&&d.setAttribute("nonce",a),d.textContent=l,this.shadowRoot.appendChild(d)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,n){return super.appendChild(this.nodeOrShadowRoot(e),n)}insertBefore(e,n,r){return super.insertBefore(this.nodeOrShadowRoot(e),n,r)}removeChild(e,n){return super.removeChild(this.nodeOrShadowRoot(e),n)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},qu=class extends Hu{constructor(e,n,r,i,s,o,a,u){super(e,s,o,a),this.sharedStylesHost=n,this.removeStylesOnCompDestroy=i,this.styles=u?kA(u,r.styles):r.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}},Kh=class extends qu{constructor(e,n,r,i,s,o,a,u){let c=i+"-"+r.id;super(e,n,r,s,o,a,u,c),this.contentAttr=RB(c),this.hostAttr=NB(c)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,n){let r=super.createElement(e,n);return super.setAttribute(r,this.contentAttr,""),r}},PB=(()=>{let e=class e extends Wh{constructor(r){super(r)}supports(r){return!0}addEventListener(r,i,s){return r.addEventListener(i,s,!1),()=>this.removeEventListener(r,i,s)}removeEventListener(r,i,s){return r.removeEventListener(i,s)}};e.\u0275fac=function(i){return new(i||e)(I(qt))},e.\u0275prov=k({token:e,factory:e.\u0275fac});let t=e;return t})(),MA=["alt","control","meta","shift"],kB={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},OB={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey},FB=(()=>{let e=class e extends Wh{constructor(r){super(r)}supports(r){return e.parseEventName(r)!=null}addEventListener(r,i,s){let o=e.parseEventName(i),a=e.eventCallback(o.fullKey,s,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>tr().onAndCancel(r,o.domEventName,a))}static parseEventName(r){let i=r.toLowerCase().split("."),s=i.shift();if(i.length===0||!(s==="keydown"||s==="keyup"))return null;let o=e._normalizeKey(i.pop()),a="",u=i.indexOf("code");if(u>-1&&(i.splice(u,1),a="code."),MA.forEach(l=>{let d=i.indexOf(l);d>-1&&(i.splice(d,1),a+=l+".")}),a+=o,i.length!=0||o.length===0)return null;let c={};return c.domEventName=s,c.fullKey=a,c}static matchEventFullKeyCode(r,i){let s=kB[r.key]||r.key,o="";return i.indexOf("code.")>-1&&(s=r.code,o="code."),s==null||!s?!1:(s=s.toLowerCase(),s===" "?s="space":s==="."&&(s="dot"),MA.forEach(a=>{if(a!==s){let u=OB[a];u(r)&&(o+=a+".")}}),o+=s,o===i)}static eventCallback(r,i,s){return o=>{e.matchEventFullKeyCode(o,r)&&s.runGuarded(()=>i(o))}}static _normalizeKey(r){return r==="esc"?"escape":r}};e.\u0275fac=function(i){return new(i||e)(I(qt))},e.\u0275prov=k({token:e,factory:e.\u0275fac});let t=e;return t})();function VB(){G_.makeCurrent()}function LB(){return new Zn}function jB(){return fS(document),document}var UB=[{provide:Ct,useValue:B_},{provide:u_,useValue:VB,multi:!0},{provide:qt,useFactory:jB,deps:[]}],OA=P_(fA,"browser",UB),BB=new P(""),$B=[{provide:Bu,useClass:z_,deps:[]},{provide:x_,useClass:Bh,deps:[se,$h,Bu]},{provide:Bh,useClass:Bh,deps:[se,$h,Bu]}],HB=[{provide:xh,useValue:"root"},{provide:Zn,useFactory:LB,deps:[]},{provide:W_,useClass:PB,multi:!0,deps:[qt,se,Ct]},{provide:W_,useClass:FB,multi:!0,deps:[qt]},AA,NA,RA,{provide:Pu,useExisting:AA},{provide:zh,useClass:bB,deps:[]},[]],FA=(()=>{let e=class e{constructor(r){}static withServerTransition(r){return{ngModule:e,providers:[{provide:Mh,useValue:r.appId}]}}};e.\u0275fac=function(i){return new(i||e)(I(BB,12))},e.\u0275mod=Ye({type:e}),e.\u0275inj=Qe({providers:[...HB,...$B],imports:[bA,pA]});let t=e;return t})();var VA=(()=>{let e=class e{constructor(r){this._doc=r}getTitle(){return this._doc.title}setTitle(r){this._doc.title=r||""}};e.\u0275fac=function(i){return new(i||e)(I(qt))},e.\u0275prov=k({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var X="primary",sc=Symbol("RouteTitle"),ev=class{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let n=this.params[e];return Array.isArray(n)?n[0]:n}return null}getAll(e){if(this.has(e)){let n=this.params[e];return Array.isArray(n)?n:[n]}return[]}get keys(){return Object.keys(this.params)}};function Yo(t){return new ev(t)}function GB(t,e,n){let r=n.path.split("/");if(r.length>t.length||n.pathMatch==="full"&&(e.hasChildren()||r.length<t.length))return null;let i={};for(let s=0;s<r.length;s++){let o=r[s],a=t[s];if(o.startsWith(":"))i[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:t.slice(0,r.length),posParams:i}}function zB(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(!nr(t[n],e[n]))return!1;return!0}function nr(t,e){let n=t?tv(t):void 0,r=e?tv(e):void 0;if(!n||!r||n.length!=r.length)return!1;let i;for(let s=0;s<n.length;s++)if(i=n[s],!WA(t[i],e[i]))return!1;return!0}function tv(t){return[...Object.keys(t),...Object.getOwnPropertySymbols(t)]}function WA(t,e){if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return!1;let n=[...t].sort(),r=[...e].sort();return n.every((i,s)=>r[s]===i)}else return t===e}function KA(t){return t.length>0?t[t.length-1]:null}function di(t){return Fm(t)?t:ds(t)?fe(Promise.resolve(t)):V(t)}var WB={exact:YA,subset:ZA},QA={exact:KB,subset:QB,ignored:()=>!0};function jA(t,e,n){return WB[n.paths](t.root,e.root,n.matrixParams)&&QA[n.queryParams](t.queryParams,e.queryParams)&&!(n.fragment==="exact"&&t.fragment!==e.fragment)}function KB(t,e){return nr(t,e)}function YA(t,e,n){if(!gs(t.segments,e.segments)||!Zh(t.segments,e.segments,n)||t.numberOfChildren!==e.numberOfChildren)return!1;for(let r in e.children)if(!t.children[r]||!YA(t.children[r],e.children[r],n))return!1;return!0}function QB(t,e){return Object.keys(e).length<=Object.keys(t).length&&Object.keys(e).every(n=>WA(t[n],e[n]))}function ZA(t,e,n){return XA(t,e,e.segments,n)}function XA(t,e,n,r){if(t.segments.length>n.length){let i=t.segments.slice(0,n.length);return!(!gs(i,n)||e.hasChildren()||!Zh(i,n,r))}else if(t.segments.length===n.length){if(!gs(t.segments,n)||!Zh(t.segments,n,r))return!1;for(let i in e.children)if(!t.children[i]||!ZA(t.children[i],e.children[i],r))return!1;return!0}else{let i=n.slice(0,t.segments.length),s=n.slice(t.segments.length);return!gs(t.segments,i)||!Zh(t.segments,i,r)||!t.children[X]?!1:XA(t.children[X],e,s,r)}}function Zh(t,e,n){return e.every((r,i)=>QA[n](t[i].parameters,r.parameters))}var ui=class{constructor(e=new ye([],{}),n={},r=null){this.root=e,this.queryParams=n,this.fragment=r}get queryParamMap(){return this._queryParamMap??=Yo(this.queryParams),this._queryParamMap}toString(){return XB.serialize(this)}},ye=class{constructor(e,n){this.segments=e,this.children=n,this.parent=null,Object.values(n).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Xh(this)}},ps=class{constructor(e,n){this.path=e,this.parameters=n}get parameterMap(){return this._parameterMap??=Yo(this.parameters),this._parameterMap}toString(){return ex(this)}};function YB(t,e){return gs(t,e)&&t.every((n,r)=>nr(n.parameters,e[r].parameters))}function gs(t,e){return t.length!==e.length?!1:t.every((n,r)=>n.path===e[r].path)}function ZB(t,e){let n=[];return Object.entries(t.children).forEach(([r,i])=>{r===X&&(n=n.concat(e(i,r)))}),Object.entries(t.children).forEach(([r,i])=>{r!==X&&(n=n.concat(e(i,r)))}),n}var oc=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=k({token:e,factory:()=>new Zu,providedIn:"root"});let t=e;return t})(),Zu=class{parse(e){let n=new rv(e);return new ui(n.parseRootSegment(),n.parseQueryParams(),n.parseFragment())}serialize(e){let n=`/${Gu(e.root,!0)}`,r=t$(e.queryParams),i=typeof e.fragment=="string"?`#${JB(e.fragment)}`:"";return`${n}${r}${i}`}},XB=new Zu;function Xh(t){return t.segments.map(e=>ex(e)).join("/")}function Gu(t,e){if(!t.hasChildren())return Xh(t);if(e){let n=t.children[X]?Gu(t.children[X],!1):"",r=[];return Object.entries(t.children).forEach(([i,s])=>{i!==X&&r.push(`${i}:${Gu(s,!1)}`)}),r.length>0?`${n}(${r.join("//")})`:n}else{let n=ZB(t,(r,i)=>i===X?[Gu(t.children[X],!1)]:[`${i}:${Gu(r,!1)}`]);return Object.keys(t.children).length===1&&t.children[X]!=null?`${Xh(t)}/${n[0]}`:`${Xh(t)}/(${n.join("//")})`}}function JA(t){return encodeURIComponent(t).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Qh(t){return JA(t).replace(/%3B/gi,";")}function JB(t){return encodeURI(t)}function nv(t){return JA(t).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Jh(t){return decodeURIComponent(t)}function UA(t){return Jh(t.replace(/\+/g,"%20"))}function ex(t){return`${nv(t.path)}${e$(t.parameters)}`}function e$(t){return Object.entries(t).map(([e,n])=>`;${nv(e)}=${nv(n)}`).join("")}function t$(t){let e=Object.entries(t).map(([n,r])=>Array.isArray(r)?r.map(i=>`${Qh(n)}=${Qh(i)}`).join("&"):`${Qh(n)}=${Qh(r)}`).filter(n=>n);return e.length?`?${e.join("&")}`:""}var n$=/^[^\/()?;#]+/;function Y_(t){let e=t.match(n$);return e?e[0]:""}var r$=/^[^\/()?;=#]+/;function i$(t){let e=t.match(r$);return e?e[0]:""}var s$=/^[^=?&#]+/;function o$(t){let e=t.match(s$);return e?e[0]:""}var a$=/^[^&#]+/;function u$(t){let e=t.match(a$);return e?e[0]:""}var rv=class{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new ye([],{}):new ye([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let n={};this.peekStartsWith("/(")&&(this.capture("/"),n=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(n).length>0)&&(r[X]=new ye(e,n)),r}parseSegment(){let e=Y_(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new U(4009,!1);return this.capture(e),new ps(Jh(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let n=i$(this.remaining);if(!n)return;this.capture(n);let r="";if(this.consumeOptional("=")){let i=Y_(this.remaining);i&&(r=i,this.capture(r))}e[Jh(n)]=Jh(r)}parseQueryParam(e){let n=o$(this.remaining);if(!n)return;this.capture(n);let r="";if(this.consumeOptional("=")){let o=u$(this.remaining);o&&(r=o,this.capture(r))}let i=UA(n),s=UA(r);if(e.hasOwnProperty(i)){let o=e[i];Array.isArray(o)||(o=[o],e[i]=o),o.push(s)}else e[i]=s}parseParens(e){let n={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let r=Y_(this.remaining),i=this.remaining[r.length];if(i!=="/"&&i!==")"&&i!==";")throw new U(4010,!1);let s;r.indexOf(":")>-1?(s=r.slice(0,r.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=X);let o=this.parseChildren();n[s]=Object.keys(o).length===1?o[X]:new ye([],o),this.consumeOptional("//")}return n}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new U(4011,!1)}};function tx(t){return t.segments.length>0?new ye([],{[X]:t}):t}function nx(t){let e={};for(let[r,i]of Object.entries(t.children)){let s=nx(i);if(r===X&&s.segments.length===0&&s.hasChildren())for(let[o,a]of Object.entries(s.children))e[o]=a;else(s.segments.length>0||s.hasChildren())&&(e[r]=s)}let n=new ye(t.segments,e);return c$(n)}function c$(t){if(t.numberOfChildren===1&&t.children[X]){let e=t.children[X];return new ye(t.segments.concat(e.segments),e.children)}return t}function Zo(t){return t instanceof ui}function l$(t,e,n=null,r=null){let i=rx(t);return ix(i,e,n,r)}function rx(t){let e;function n(s){let o={};for(let u of s.children){let c=n(u);o[u.outlet]=c}let a=new ye(s.url,o);return s===t&&(e=a),a}let r=n(t.root),i=tx(r);return e??i}function ix(t,e,n,r){let i=t;for(;i.parent;)i=i.parent;if(e.length===0)return Z_(i,i,i,n,r);let s=d$(e);if(s.toRoot())return Z_(i,i,new ye([],{}),n,r);let o=h$(s,i,t),a=o.processChildren?Ku(o.segmentGroup,o.index,s.commands):ox(o.segmentGroup,o.index,s.commands);return Z_(i,o.segmentGroup,a,n,r)}function ef(t){return typeof t=="object"&&t!=null&&!t.outlets&&!t.segmentPath}function Xu(t){return typeof t=="object"&&t!=null&&t.outlets}function Z_(t,e,n,r,i){let s={};r&&Object.entries(r).forEach(([u,c])=>{s[u]=Array.isArray(c)?c.map(l=>`${l}`):`${c}`});let o;t===e?o=n:o=sx(t,e,n);let a=tx(nx(o));return new ui(a,s,i)}function sx(t,e,n){let r={};return Object.entries(t.children).forEach(([i,s])=>{s===e?r[i]=n:r[i]=sx(s,e,n)}),new ye(t.segments,r)}var tf=class{constructor(e,n,r){if(this.isAbsolute=e,this.numberOfDoubleDots=n,this.commands=r,e&&r.length>0&&ef(r[0]))throw new U(4003,!1);let i=r.find(Xu);if(i&&i!==KA(r))throw new U(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function d$(t){if(typeof t[0]=="string"&&t.length===1&&t[0]==="/")return new tf(!0,0,t);let e=0,n=!1,r=t.reduce((i,s,o)=>{if(typeof s=="object"&&s!=null){if(s.outlets){let a={};return Object.entries(s.outlets).forEach(([u,c])=>{a[u]=typeof c=="string"?c.split("/"):c}),[...i,{outlets:a}]}if(s.segmentPath)return[...i,s.segmentPath]}return typeof s!="string"?[...i,s]:o===0?(s.split("/").forEach((a,u)=>{u==0&&a==="."||(u==0&&a===""?n=!0:a===".."?e++:a!=""&&i.push(a))}),i):[...i,s]},[]);return new tf(n,e,r)}var Ko=class{constructor(e,n,r){this.segmentGroup=e,this.processChildren=n,this.index=r}};function h$(t,e,n){if(t.isAbsolute)return new Ko(e,!0,0);if(!n)return new Ko(e,!1,NaN);if(n.parent===null)return new Ko(n,!0,0);let r=ef(t.commands[0])?0:1,i=n.segments.length-1+r;return f$(n,i,t.numberOfDoubleDots)}function f$(t,e,n){let r=t,i=e,s=n;for(;s>i;){if(s-=i,r=r.parent,!r)throw new U(4005,!1);i=r.segments.length}return new Ko(r,!1,i-s)}function p$(t){return Xu(t[0])?t[0].outlets:{[X]:t}}function ox(t,e,n){if(t??=new ye([],{}),t.segments.length===0&&t.hasChildren())return Ku(t,e,n);let r=g$(t,e,n),i=n.slice(r.commandIndex);if(r.match&&r.pathIndex<t.segments.length){let s=new ye(t.segments.slice(0,r.pathIndex),{});return s.children[X]=new ye(t.segments.slice(r.pathIndex),t.children),Ku(s,0,i)}else return r.match&&i.length===0?new ye(t.segments,{}):r.match&&!t.hasChildren()?iv(t,e,n):r.match?Ku(t,0,i):iv(t,e,n)}function Ku(t,e,n){if(n.length===0)return new ye(t.segments,{});{let r=p$(n),i={};if(Object.keys(r).some(s=>s!==X)&&t.children[X]&&t.numberOfChildren===1&&t.children[X].segments.length===0){let s=Ku(t.children[X],e,n);return new ye(t.segments,s.children)}return Object.entries(r).forEach(([s,o])=>{typeof o=="string"&&(o=[o]),o!==null&&(i[s]=ox(t.children[s],e,o))}),Object.entries(t.children).forEach(([s,o])=>{r[s]===void 0&&(i[s]=o)}),new ye(t.segments,i)}}function g$(t,e,n){let r=0,i=e,s={match:!1,pathIndex:0,commandIndex:0};for(;i<t.segments.length;){if(r>=n.length)return s;let o=t.segments[i],a=n[r];if(Xu(a))break;let u=`${a}`,c=r<n.length-1?n[r+1]:null;if(i>0&&u===void 0)break;if(u&&c&&typeof c=="object"&&c.outlets===void 0){if(!$A(u,c,o))return s;r+=2}else{if(!$A(u,{},o))return s;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}function iv(t,e,n){let r=t.segments.slice(0,e),i=0;for(;i<n.length;){let s=n[i];if(Xu(s)){let u=m$(s.outlets);return new ye(r,u)}if(i===0&&ef(n[0])){let u=t.segments[e];r.push(new ps(u.path,BA(n[0]))),i++;continue}let o=Xu(s)?s.outlets[X]:`${s}`,a=i<n.length-1?n[i+1]:null;o&&a&&ef(a)?(r.push(new ps(o,BA(a))),i+=2):(r.push(new ps(o,{})),i++)}return new ye(r,{})}function m$(t){let e={};return Object.entries(t).forEach(([n,r])=>{typeof r=="string"&&(r=[r]),r!==null&&(e[n]=iv(new ye([],{}),0,r))}),e}function BA(t){let e={};return Object.entries(t).forEach(([n,r])=>e[n]=`${r}`),e}function $A(t,e,n){return t==n.path&&nr(e,n.parameters)}var Qu="imperative",at=function(t){return t[t.NavigationStart=0]="NavigationStart",t[t.NavigationEnd=1]="NavigationEnd",t[t.NavigationCancel=2]="NavigationCancel",t[t.NavigationError=3]="NavigationError",t[t.RoutesRecognized=4]="RoutesRecognized",t[t.ResolveStart=5]="ResolveStart",t[t.ResolveEnd=6]="ResolveEnd",t[t.GuardsCheckStart=7]="GuardsCheckStart",t[t.GuardsCheckEnd=8]="GuardsCheckEnd",t[t.RouteConfigLoadStart=9]="RouteConfigLoadStart",t[t.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",t[t.ChildActivationStart=11]="ChildActivationStart",t[t.ChildActivationEnd=12]="ChildActivationEnd",t[t.ActivationStart=13]="ActivationStart",t[t.ActivationEnd=14]="ActivationEnd",t[t.Scroll=15]="Scroll",t[t.NavigationSkipped=16]="NavigationSkipped",t}(at||{}),mn=class{constructor(e,n){this.id=e,this.url=n}},Xo=class extends mn{constructor(e,n,r="imperative",i=null){super(e,n),this.type=at.NavigationStart,this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},Rr=class extends mn{constructor(e,n,r){super(e,n),this.urlAfterRedirects=r,this.type=at.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},gn=function(t){return t[t.Redirect=0]="Redirect",t[t.SupersededByNewNavigation=1]="SupersededByNewNavigation",t[t.NoDataFromResolver=2]="NoDataFromResolver",t[t.GuardRejected=3]="GuardRejected",t}(gn||{}),nf=function(t){return t[t.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",t[t.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",t}(nf||{}),ci=class extends mn{constructor(e,n,r,i){super(e,n),this.reason=r,this.code=i,this.type=at.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},li=class extends mn{constructor(e,n,r,i){super(e,n),this.reason=r,this.code=i,this.type=at.NavigationSkipped}},Ju=class extends mn{constructor(e,n,r,i){super(e,n),this.error=r,this.target=i,this.type=at.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},rf=class extends mn{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=at.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},sv=class extends mn{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=at.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},ov=class extends mn{constructor(e,n,r,i,s){super(e,n),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=s,this.type=at.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},av=class extends mn{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=at.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},uv=class extends mn{constructor(e,n,r,i){super(e,n),this.urlAfterRedirects=r,this.state=i,this.type=at.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},cv=class{constructor(e){this.route=e,this.type=at.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},lv=class{constructor(e){this.route=e,this.type=at.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},dv=class{constructor(e){this.snapshot=e,this.type=at.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},hv=class{constructor(e){this.snapshot=e,this.type=at.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},fv=class{constructor(e){this.snapshot=e,this.type=at.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},pv=class{constructor(e){this.snapshot=e,this.type=at.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},sf=class{constructor(e,n,r){this.routerEvent=e,this.position=n,this.anchor=r,this.type=at.Scroll}toString(){let e=this.position?`${this.position[0]}, ${this.position[1]}`:null;return`Scroll(anchor: '${this.anchor}', position: '${e}')`}},ec=class{},tc=class{constructor(e){this.url=e}};var gv=class{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new ac,this.attachRef=null}},ac=(()=>{let e=class e{constructor(){this.contexts=new Map}onChildOutletCreated(r,i){let s=this.getOrCreateContext(r);s.outlet=i,this.contexts.set(r,s)}onChildOutletDestroyed(r){let i=this.getContext(r);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){let r=this.contexts;return this.contexts=new Map,r}onOutletReAttached(r){this.contexts=r}getOrCreateContext(r){let i=this.getContext(r);return i||(i=new gv,this.contexts.set(r,i)),i}getContext(r){return this.contexts.get(r)||null}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=k({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),of=class{constructor(e){this._root=e}get root(){return this._root.value}parent(e){let n=this.pathFromRoot(e);return n.length>1?n[n.length-2]:null}children(e){let n=mv(e,this._root);return n?n.children.map(r=>r.value):[]}firstChild(e){let n=mv(e,this._root);return n&&n.children.length>0?n.children[0].value:null}siblings(e){let n=yv(e,this._root);return n.length<2?[]:n[n.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return yv(e,this._root).map(n=>n.value)}};function mv(t,e){if(t===e.value)return e;for(let n of e.children){let r=mv(t,n);if(r)return r}return null}function yv(t,e){if(t===e.value)return[e];for(let n of e.children){let r=yv(t,n);if(r.length)return r.unshift(e),r}return[]}var Yt=class{constructor(e,n){this.value=e,this.children=n}toString(){return`TreeNode(${this.value})`}};function Wo(t){let e={};return t&&t.children.forEach(n=>e[n.value.outlet]=n),e}var af=class extends of{constructor(e,n){super(e),this.snapshot=n,Sv(this,e)}toString(){return this.snapshot.toString()}};function ax(t){let e=y$(t),n=new mt([new ps("",{})]),r=new mt({}),i=new mt({}),s=new mt({}),o=new mt(""),a=new Jo(n,r,s,o,i,X,t,e.root);return a.snapshot=e.root,new af(new Yt(a,[]),e)}function y$(t){let e={},n={},r={},i="",s=new nc([],e,r,i,n,X,t,null,{});return new uf("",new Yt(s,[]))}var Jo=class{constructor(e,n,r,i,s,o,a,u){this.urlSubject=e,this.paramsSubject=n,this.queryParamsSubject=r,this.fragmentSubject=i,this.dataSubject=s,this.outlet=o,this.component=a,this._futureSnapshot=u,this.title=this.dataSubject?.pipe(F(c=>c[sc]))??V(void 0),this.url=e,this.params=n,this.queryParams=r,this.fragment=i,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(F(e=>Yo(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(F(e=>Yo(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function bv(t,e,n="emptyOnly"){let r,{routeConfig:i}=t;return e!==null&&(n==="always"||i?.path===""||!e.component&&!e.routeConfig?.loadComponent)?r={params:S(S({},e.params),t.params),data:S(S({},e.data),t.data),resolve:S(S(S(S({},t.data),e.data),i?.data),t._resolvedData)}:r={params:S({},t.params),data:S({},t.data),resolve:S(S({},t.data),t._resolvedData??{})},i&&cx(i)&&(r.resolve[sc]=i.title),r}var nc=class{get title(){return this.data?.[sc]}constructor(e,n,r,i,s,o,a,u,c){this.url=e,this.params=n,this.queryParams=r,this.fragment=i,this.data=s,this.outlet=o,this.component=a,this.routeConfig=u,this._resolve=c}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=Yo(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=Yo(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(r=>r.toString()).join("/"),n=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${n}')`}},uf=class extends of{constructor(e,n){super(n),this.url=e,Sv(this,n)}toString(){return ux(this._root)}};function Sv(t,e){e.value._routerState=t,e.children.forEach(n=>Sv(t,n))}function ux(t){let e=t.children.length>0?` { ${t.children.map(ux).join(", ")} } `:"";return`${t.value}${e}`}function X_(t){if(t.snapshot){let e=t.snapshot,n=t._futureSnapshot;t.snapshot=n,nr(e.queryParams,n.queryParams)||t.queryParamsSubject.next(n.queryParams),e.fragment!==n.fragment&&t.fragmentSubject.next(n.fragment),nr(e.params,n.params)||t.paramsSubject.next(n.params),zB(e.url,n.url)||t.urlSubject.next(n.url),nr(e.data,n.data)||t.dataSubject.next(n.data)}else t.snapshot=t._futureSnapshot,t.dataSubject.next(t._futureSnapshot.data)}function _v(t,e){let n=nr(t.params,e.params)&&YB(t.url,e.url),r=!t.parent!=!e.parent;return n&&!r&&(!t.parent||_v(t.parent,e.parent))}function cx(t){return typeof t.title=="string"||t.title===null}var _$=(()=>{let e=class e{constructor(){this.activated=null,this._activatedRoute=null,this.name=X,this.activateEvents=new it,this.deactivateEvents=new it,this.attachEvents=new it,this.detachEvents=new it,this.parentContexts=R(ac),this.location=R(ju),this.changeDetector=R($o),this.environmentInjector=R(Qt),this.inputBinder=R(ff,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(r){if(r.name){let{firstChange:i,previousValue:s}=r.name;if(i)return;this.isTrackedInParentContexts(s)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(s)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(r){return this.parentContexts.getContext(r)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let r=this.parentContexts.getContext(this.name);r?.route&&(r.attachRef?this.attach(r.attachRef,r.route):this.activateWith(r.route,r.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new U(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new U(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new U(4012,!1);this.location.detach();let r=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(r.instance),r}attach(r,i){this.activated=r,this._activatedRoute=i,this.location.insert(r.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(r.instance)}deactivate(){if(this.activated){let r=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(r)}}activateWith(r,i){if(this.isActivated)throw new U(4013,!1);this._activatedRoute=r;let s=this.location,a=r.snapshot.component,u=this.parentContexts.getOrCreateContext(this.name).children,c=new vv(r,u,s.injector);this.activated=s.createComponent(a,{index:s.length,injector:c,environmentInjector:i??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=$t({type:e,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[Lo]});let t=e;return t})(),vv=class{constructor(e,n,r){this.route=e,this.childContexts=n,this.parent=r}get(e,n){return e===Jo?this.route:e===ac?this.childContexts:this.parent.get(e,n)}},ff=new P(""),HA=(()=>{let e=class e{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(r){this.unsubscribeFromRouteData(r),this.subscribeToRouteData(r)}unsubscribeFromRouteData(r){this.outletDataSubscriptions.get(r)?.unsubscribe(),this.outletDataSubscriptions.delete(r)}subscribeToRouteData(r){let{activatedRoute:i}=r,s=_u([i.queryParams,i.params,i.data]).pipe(Re(([o,a,u],c)=>(u=S(S(S({},o),a),u),c===0?V(u):Promise.resolve(u)))).subscribe(o=>{if(!r.isActivated||!r.activatedComponentRef||r.activatedRoute!==i||i.component===null){this.unsubscribeFromRouteData(r);return}let a=gA(i.component);if(!a){this.unsubscribeFromRouteData(r);return}for(let{templateName:u}of a.inputs)r.activatedComponentRef.setInput(u,o[u])});this.outletDataSubscriptions.set(r,s)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=k({token:e,factory:e.\u0275fac});let t=e;return t})();function v$(t,e,n){let r=rc(t,e._root,n?n._root:void 0);return new af(r,e)}function rc(t,e,n){if(n&&t.shouldReuseRoute(e.value,n.value.snapshot)){let r=n.value;r._futureSnapshot=e.value;let i=w$(t,e,n);return new Yt(r,i)}else{if(t.shouldAttach(e.value)){let s=t.retrieve(e.value);if(s!==null){let o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>rc(t,a)),o}}let r=E$(e.value),i=e.children.map(s=>rc(t,s));return new Yt(r,i)}}function w$(t,e,n){return e.children.map(r=>{for(let i of n.children)if(t.shouldReuseRoute(r.value,i.value.snapshot))return rc(t,r,i);return rc(t,r)})}function E$(t){return new Jo(new mt(t.url),new mt(t.params),new mt(t.queryParams),new mt(t.fragment),new mt(t.data),t.outlet,t.component,t)}var lx="ngNavigationCancelingError";function dx(t,e){let{redirectTo:n,navigationBehaviorOptions:r}=Zo(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=hx(!1,gn.Redirect);return i.url=n,i.navigationBehaviorOptions=r,i}function hx(t,e){let n=new Error(`NavigationCancelingError: ${t||""}`);return n[lx]=!0,n.cancellationCode=e,n}function I$(t){return fx(t)&&Zo(t.url)}function fx(t){return!!t&&t[lx]}var C$=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=Fo({type:e,selectors:[["ng-component"]],standalone:!0,features:[sA],decls:1,vars:0,template:function(i,s){i&1&&er(0,"router-outlet")},dependencies:[_$],encapsulation:2});let t=e;return t})();function D$(t,e){return t.providers&&!t._injector&&(t._injector=Vh(t.providers,e,`Route: ${t.path}`)),t._injector??e}function Av(t){let e=t.children&&t.children.map(Av),n=e?ce(S({},t),{children:e}):S({},t);return!n.component&&!n.loadComponent&&(e||n.loadChildren)&&n.outlet&&n.outlet!==X&&(n.component=C$),n}function rr(t){return t.outlet||X}function T$(t,e){let n=t.filter(r=>rr(r)===e);return n.push(...t.filter(r=>rr(r)!==e)),n}function uc(t){if(!t)return null;if(t.routeConfig?._injector)return t.routeConfig._injector;for(let e=t.parent;e;e=e.parent){let n=e.routeConfig;if(n?._loadedInjector)return n._loadedInjector;if(n?._injector)return n._injector}return null}var b$=(t,e,n,r)=>F(i=>(new wv(e,i.targetRouterState,i.currentRouterState,n,r).activate(t),i)),wv=class{constructor(e,n,r,i,s){this.routeReuseStrategy=e,this.futureState=n,this.currState=r,this.forwardEvent=i,this.inputBindingEnabled=s}activate(e){let n=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(n,r,e),X_(this.futureState.root),this.activateChildRoutes(n,r,e)}deactivateChildRoutes(e,n,r){let i=Wo(n);e.children.forEach(s=>{let o=s.value.outlet;this.deactivateRoutes(s,i[o],r),delete i[o]}),Object.values(i).forEach(s=>{this.deactivateRouteAndItsChildren(s,r)})}deactivateRoutes(e,n,r){let i=e.value,s=n?n.value:null;if(i===s)if(i.component){let o=r.getContext(i.outlet);o&&this.deactivateChildRoutes(e,n,o.children)}else this.deactivateChildRoutes(e,n,r);else s&&this.deactivateRouteAndItsChildren(n,r)}deactivateRouteAndItsChildren(e,n){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,n):this.deactivateRouteAndOutlet(e,n)}detachAndStoreRouteSubtree(e,n){let r=n.getContext(e.value.outlet),i=r&&e.value.component?r.children:n,s=Wo(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);if(r&&r.outlet){let o=r.outlet.detach(),a=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,n){let r=n.getContext(e.value.outlet),i=r&&e.value.component?r.children:n,s=Wo(e);for(let o of Object.values(s))this.deactivateRouteAndItsChildren(o,i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(e,n,r){let i=Wo(n);e.children.forEach(s=>{this.activateRoutes(s,i[s.value.outlet],r),this.forwardEvent(new pv(s.value.snapshot))}),e.children.length&&this.forwardEvent(new hv(e.value.snapshot))}activateRoutes(e,n,r){let i=e.value,s=n?n.value:null;if(X_(i),i===s)if(i.component){let o=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,n,o.children)}else this.activateChildRoutes(e,n,r);else if(i.component){let o=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){let a=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),X_(a.route.value),this.activateChildRoutes(e,null,o.children)}else{let a=uc(i.snapshot);o.attachRef=null,o.route=i,o.injector=a,o.outlet&&o.outlet.activateWith(i,o.injector),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,r)}},cf=class{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},Qo=class{constructor(e,n){this.component=e,this.route=n}};function S$(t,e,n){let r=t._root,i=e?e._root:null;return zu(r,i,n,[r.value])}function A$(t){let e=t.routeConfig?t.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:t,guards:e}}function ta(t,e){let n=Symbol(),r=e.get(t,n);return r===n?typeof t=="function"&&!ub(t)?t:e.get(t):r}function zu(t,e,n,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=Wo(e);return t.children.forEach(o=>{x$(o,s[o.value.outlet],n,r.concat([o.value]),i),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,a])=>Yu(a,n.getContext(o),i)),i}function x$(t,e,n,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=t.value,o=e?e.value:null,a=n?n.getContext(t.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){let u=M$(o,s,s.routeConfig.runGuardsAndResolvers);u?i.canActivateChecks.push(new cf(r)):(s.data=o.data,s._resolvedData=o._resolvedData),s.component?zu(t,e,a?a.children:null,r,i):zu(t,e,n,r,i),u&&a&&a.outlet&&a.outlet.isActivated&&i.canDeactivateChecks.push(new Qo(a.outlet.component,o))}else o&&Yu(e,a,i),i.canActivateChecks.push(new cf(r)),s.component?zu(t,null,a?a.children:null,r,i):zu(t,null,n,r,i);return i}function M$(t,e,n){if(typeof n=="function")return n(t,e);switch(n){case"pathParamsChange":return!gs(t.url,e.url);case"pathParamsOrQueryParamsChange":return!gs(t.url,e.url)||!nr(t.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!_v(t,e)||!nr(t.queryParams,e.queryParams);case"paramsChange":default:return!_v(t,e)}}function Yu(t,e,n){let r=Wo(t),i=t.value;Object.entries(r).forEach(([s,o])=>{i.component?e?Yu(o,e.children.getContext(s),n):Yu(o,null,n):Yu(o,e,n)}),i.component?e&&e.outlet&&e.outlet.isActivated?n.canDeactivateChecks.push(new Qo(e.outlet.component,i)):n.canDeactivateChecks.push(new Qo(null,i)):n.canDeactivateChecks.push(new Qo(null,i))}function cc(t){return typeof t=="function"}function R$(t){return typeof t=="boolean"}function N$(t){return t&&cc(t.canLoad)}function P$(t){return t&&cc(t.canActivate)}function k$(t){return t&&cc(t.canActivateChild)}function O$(t){return t&&cc(t.canDeactivate)}function F$(t){return t&&cc(t.canMatch)}function px(t){return t instanceof Cr||t?.name==="EmptyError"}var Yh=Symbol("INITIAL_VALUE");function ea(){return Re(t=>_u(t.map(e=>e.pipe(Dr(1),Xi(Yh)))).pipe(F(e=>{for(let n of e)if(n!==!0){if(n===Yh)return Yh;if(n===!1||n instanceof ui)return n}return!0}),yt(e=>e!==Yh),Dr(1)))}function V$(t,e){return We(n=>{let{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:s,canDeactivateChecks:o}}=n;return o.length===0&&s.length===0?V(ce(S({},n),{guardsResult:!0})):L$(o,r,i,t).pipe(We(a=>a&&R$(a)?j$(r,s,t,e):V(a)),F(a=>ce(S({},n),{guardsResult:a})))})}function L$(t,e,n,r){return fe(t).pipe(We(i=>q$(i.component,i.route,n,e,r)),cn(i=>i!==!0,!0))}function j$(t,e,n,r){return fe(e).pipe(Zi(i=>vo(B$(i.route.parent,r),U$(i.route,r),H$(t,i.path,n),$$(t,i.route,n))),cn(i=>i!==!0,!0))}function U$(t,e){return t!==null&&e&&e(new fv(t)),V(!0)}function B$(t,e){return t!==null&&e&&e(new dv(t)),V(!0)}function $$(t,e,n){let r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||r.length===0)return V(!0);let i=r.map(s=>qd(()=>{let o=uc(e)??n,a=ta(s,o),u=P$(a)?a.canActivate(e,t):si(o,()=>a(e,t));return di(u).pipe(cn())}));return V(i).pipe(ea())}function H$(t,e,n){let r=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>A$(o)).filter(o=>o!==null).map(o=>qd(()=>{let a=o.guards.map(u=>{let c=uc(o.node)??n,l=ta(u,c),d=k$(l)?l.canActivateChild(r,t):si(c,()=>l(r,t));return di(d).pipe(cn())});return V(a).pipe(ea())}));return V(s).pipe(ea())}function q$(t,e,n,r,i){let s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!s||s.length===0)return V(!0);let o=s.map(a=>{let u=uc(e)??i,c=ta(a,u),l=O$(c)?c.canDeactivate(t,e,n,r):si(u,()=>c(t,e,n,r));return di(l).pipe(cn())});return V(o).pipe(ea())}function G$(t,e,n,r){let i=e.canLoad;if(i===void 0||i.length===0)return V(!0);let s=i.map(o=>{let a=ta(o,t),u=N$(a)?a.canLoad(e,n):si(t,()=>a(e,n));return di(u)});return V(s).pipe(ea(),gx(r))}function gx(t){return Mm(Ke(e=>{if(Zo(e))throw dx(t,e)}),F(e=>e===!0))}function z$(t,e,n,r){let i=e.canMatch;if(!i||i.length===0)return V(!0);let s=i.map(o=>{let a=ta(o,t),u=F$(a)?a.canMatch(e,n):si(t,()=>a(e,n));return di(u)});return V(s).pipe(ea(),gx(r))}var ic=class{constructor(e){this.segmentGroup=e||null}},lf=class extends Error{constructor(e){super(),this.urlTree=e}};function zo(t){return _o(new ic(t))}function W$(t){return _o(new U(4e3,!1))}function K$(t){return _o(hx(!1,gn.GuardRejected))}var Ev=class{constructor(e,n){this.urlSerializer=e,this.urlTree=n}lineralizeSegments(e,n){let r=[],i=n.root;for(;;){if(r=r.concat(i.segments),i.numberOfChildren===0)return V(r);if(i.numberOfChildren>1||!i.children[X])return W$(e.redirectTo);i=i.children[X]}}applyRedirectCommands(e,n,r){let i=this.applyRedirectCreateUrlTree(n,this.urlSerializer.parse(n),e,r);if(n.startsWith("/"))throw new lf(i);return i}applyRedirectCreateUrlTree(e,n,r,i){let s=this.createSegmentGroup(e,n.root,r,i);return new ui(s,this.createQueryParams(n.queryParams,this.urlTree.queryParams),n.fragment)}createQueryParams(e,n){let r={};return Object.entries(e).forEach(([i,s])=>{if(typeof s=="string"&&s.startsWith(":")){let a=s.substring(1);r[i]=n[a]}else r[i]=s}),r}createSegmentGroup(e,n,r,i){let s=this.createSegments(e,n.segments,r,i),o={};return Object.entries(n.children).forEach(([a,u])=>{o[a]=this.createSegmentGroup(e,u,r,i)}),new ye(s,o)}createSegments(e,n,r,i){return n.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,i):this.findOrReturn(s,r))}findPosParam(e,n,r){let i=r[n.path.substring(1)];if(!i)throw new U(4001,!1);return i}findOrReturn(e,n){let r=0;for(let i of n){if(i.path===e.path)return n.splice(r),i;r++}return e}},Iv={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function Q$(t,e,n,r,i){let s=xv(t,e,n);return s.matched?(r=D$(e,r),z$(r,e,n,i).pipe(F(o=>o===!0?s:S({},Iv)))):V(s)}function xv(t,e,n){if(e.path==="**")return Y$(n);if(e.path==="")return e.pathMatch==="full"&&(t.hasChildren()||n.length>0)?S({},Iv):{matched:!0,consumedSegments:[],remainingSegments:n,parameters:{},positionalParamSegments:{}};let i=(e.matcher||GB)(n,t,e);if(!i)return S({},Iv);let s={};Object.entries(i.posParams??{}).forEach(([a,u])=>{s[a]=u.path});let o=i.consumed.length>0?S(S({},s),i.consumed[i.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:i.consumed,remainingSegments:n.slice(i.consumed.length),parameters:o,positionalParamSegments:i.posParams??{}}}function Y$(t){return{matched:!0,parameters:t.length>0?KA(t).parameters:{},consumedSegments:t,remainingSegments:[],positionalParamSegments:{}}}function qA(t,e,n,r){return n.length>0&&J$(t,n,r)?{segmentGroup:new ye(e,X$(r,new ye(n,t.children))),slicedSegments:[]}:n.length===0&&eH(t,n,r)?{segmentGroup:new ye(t.segments,Z$(t,n,r,t.children)),slicedSegments:n}:{segmentGroup:new ye(t.segments,t.children),slicedSegments:n}}function Z$(t,e,n,r){let i={};for(let s of n)if(pf(t,e,s)&&!r[rr(s)]){let o=new ye([],{});i[rr(s)]=o}return S(S({},r),i)}function X$(t,e){let n={};n[X]=e;for(let r of t)if(r.path===""&&rr(r)!==X){let i=new ye([],{});n[rr(r)]=i}return n}function J$(t,e,n){return n.some(r=>pf(t,e,r)&&rr(r)!==X)}function eH(t,e,n){return n.some(r=>pf(t,e,r))}function pf(t,e,n){return(t.hasChildren()||e.length>0)&&n.pathMatch==="full"?!1:n.path===""}function tH(t,e,n,r){return rr(t)!==r&&(r===X||!pf(e,n,t))?!1:xv(e,t,n).matched}function nH(t,e,n){return e.length===0&&!t.children[n]}var Cv=class{};function rH(t,e,n,r,i,s,o="emptyOnly"){return new Dv(t,e,n,r,i,o,s).recognize()}var iH=31,Dv=class{constructor(e,n,r,i,s,o,a){this.injector=e,this.configLoader=n,this.rootComponentType=r,this.config=i,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=a,this.applyRedirects=new Ev(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(e){return new U(4002,`'${e.segmentGroup}'`)}recognize(){let e=qA(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(F(n=>{let r=new nc([],Object.freeze({}),Object.freeze(S({},this.urlTree.queryParams)),this.urlTree.fragment,{},X,this.rootComponentType,null,{}),i=new Yt(r,n),s=new uf("",i),o=l$(r,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),this.inheritParamsAndData(s._root,null),{state:s,tree:o}}))}match(e){return this.processSegmentGroup(this.injector,this.config,e,X).pipe(Qr(r=>{if(r instanceof lf)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof ic?this.noMatchError(r):r}))}inheritParamsAndData(e,n){let r=e.value,i=bv(r,n,this.paramsInheritanceStrategy);r.params=Object.freeze(i.params),r.data=Object.freeze(i.data),e.children.forEach(s=>this.inheritParamsAndData(s,r))}processSegmentGroup(e,n,r,i){return r.segments.length===0&&r.hasChildren()?this.processChildren(e,n,r):this.processSegment(e,n,r,r.segments,i,!0).pipe(F(s=>s instanceof Yt?[s]:[]))}processChildren(e,n,r){let i=[];for(let s of Object.keys(r.children))s==="primary"?i.unshift(s):i.push(s);return fe(i).pipe(Zi(s=>{let o=r.children[s],a=T$(n,s);return this.processSegmentGroup(e,a,o,s)}),Gn((s,o)=>(s.push(...o),s)),Yr(null),jm(),We(s=>{if(s===null)return zo(r);let o=mx(s);return sH(o),V(o)}))}processSegment(e,n,r,i,s,o){return fe(n).pipe(Zi(a=>this.processSegmentAgainstRoute(a._injector??e,n,a,r,i,s,o).pipe(Qr(u=>{if(u instanceof ic)return V(null);throw u}))),cn(a=>!!a),Qr(a=>{if(px(a))return nH(r,i,s)?V(new Cv):zo(r);throw a}))}processSegmentAgainstRoute(e,n,r,i,s,o,a){return tH(r,i,s,o)?r.redirectTo===void 0?this.matchSegmentAgainstRoute(e,i,r,s,o):this.allowRedirects&&a?this.expandSegmentAgainstRouteUsingRedirect(e,i,n,r,s,o):zo(i):zo(i)}expandSegmentAgainstRouteUsingRedirect(e,n,r,i,s,o){let{matched:a,consumedSegments:u,positionalParamSegments:c,remainingSegments:l}=xv(n,i,s);if(!a)return zo(n);i.redirectTo.startsWith("/")&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>iH&&(this.allowRedirects=!1));let d=this.applyRedirects.applyRedirectCommands(u,i.redirectTo,c);return this.applyRedirects.lineralizeSegments(i,d).pipe(We(h=>this.processSegment(e,r,n,h.concat(l),o,!1)))}matchSegmentAgainstRoute(e,n,r,i,s){let o=Q$(n,r,i,e,this.urlSerializer);return r.path==="**"&&(n.children={}),o.pipe(Re(a=>a.matched?(e=r._injector??e,this.getChildConfig(e,r,i).pipe(Re(({routes:u})=>{let c=r._loadedInjector??e,{consumedSegments:l,remainingSegments:d,parameters:h}=a,f=new nc(l,h,Object.freeze(S({},this.urlTree.queryParams)),this.urlTree.fragment,aH(r),rr(r),r.component??r._loadedComponent??null,r,uH(r)),{segmentGroup:p,slicedSegments:g}=qA(n,l,d,u);if(g.length===0&&p.hasChildren())return this.processChildren(c,u,p).pipe(F(C=>C===null?null:new Yt(f,C)));if(u.length===0&&g.length===0)return V(new Yt(f,[]));let _=rr(r)===s;return this.processSegment(c,u,p,g,_?X:s,!0).pipe(F(C=>new Yt(f,C instanceof Yt?[C]:[])))}))):zo(n)))}getChildConfig(e,n,r){return n.children?V({routes:n.children,injector:e}):n.loadChildren?n._loadedRoutes!==void 0?V({routes:n._loadedRoutes,injector:n._loadedInjector}):G$(e,n,r,this.urlSerializer).pipe(We(i=>i?this.configLoader.loadChildren(e,n).pipe(Ke(s=>{n._loadedRoutes=s.routes,n._loadedInjector=s.injector})):K$(n))):V({routes:[],injector:e})}};function sH(t){t.sort((e,n)=>e.value.outlet===X?-1:n.value.outlet===X?1:e.value.outlet.localeCompare(n.value.outlet))}function oH(t){let e=t.value.routeConfig;return e&&e.path===""}function mx(t){let e=[],n=new Set;for(let r of t){if(!oH(r)){e.push(r);continue}let i=e.find(s=>r.value.routeConfig===s.value.routeConfig);i!==void 0?(i.children.push(...r.children),n.add(i)):e.push(r)}for(let r of n){let i=mx(r.children);e.push(new Yt(r.value,i))}return e.filter(r=>!n.has(r))}function aH(t){return t.data||{}}function uH(t){return t.resolve||{}}function cH(t,e,n,r,i,s){return We(o=>rH(t,e,n,r,o.extractedUrl,i,s).pipe(F(({state:a,tree:u})=>ce(S({},o),{targetSnapshot:a,urlAfterRedirects:u}))))}function lH(t,e){return We(n=>{let{targetSnapshot:r,guards:{canActivateChecks:i}}=n;if(!i.length)return V(n);let s=new Set(i.map(u=>u.route)),o=new Set;for(let u of s)if(!o.has(u))for(let c of yx(u))o.add(c);let a=0;return fe(o).pipe(Zi(u=>s.has(u)?dH(u,r,t,e):(u.data=bv(u,u.parent,t).resolve,V(void 0))),Ke(()=>a++),Eo(1),We(u=>a===o.size?V(n):jt))})}function yx(t){let e=t.children.map(n=>yx(n)).flat();return[t,...e]}function dH(t,e,n,r){let i=t.routeConfig,s=t._resolve;return i?.title!==void 0&&!cx(i)&&(s[sc]=i.title),hH(s,t,e,r).pipe(F(o=>(t._resolvedData=o,t.data=bv(t,t.parent,n).resolve,null)))}function hH(t,e,n,r){let i=tv(t);if(i.length===0)return V({});let s={};return fe(i).pipe(We(o=>fH(t[o],e,n,r).pipe(cn(),Ke(a=>{s[o]=a}))),Eo(1),Lm(s),Qr(o=>px(o)?jt:_o(o)))}function fH(t,e,n,r){let i=uc(e)??r,s=ta(t,i),o=s.resolve?s.resolve(e,n):si(i,()=>s(e,n));return di(o)}function J_(t){return Re(e=>{let n=t(e);return n?fe(n).pipe(F(()=>e)):V(e)})}var _x=(()=>{let e=class e{buildTitle(r){let i,s=r.root;for(;s!==void 0;)i=this.getResolvedTitleForRoute(s)??i,s=s.children.find(o=>o.outlet===X);return i}getResolvedTitleForRoute(r){return r.data[sc]}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=k({token:e,factory:()=>R(pH),providedIn:"root"});let t=e;return t})(),pH=(()=>{let e=class e extends _x{constructor(r){super(),this.title=r}updateTitle(r){let i=this.buildTitle(r);i!==void 0&&this.title.setTitle(i)}};e.\u0275fac=function(i){return new(i||e)(I(VA))},e.\u0275prov=k({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),lc=new P("",{providedIn:"root",factory:()=>({})}),df=new P(""),Mv=(()=>{let e=class e{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=R(Uh)}loadComponent(r){if(this.componentLoaders.get(r))return this.componentLoaders.get(r);if(r._loadedComponent)return V(r._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(r);let i=di(r.loadComponent()).pipe(F(vx),Ke(o=>{this.onLoadEndListener&&this.onLoadEndListener(r),r._loadedComponent=o}),wu(()=>{this.componentLoaders.delete(r)})),s=new fo(i,()=>new rt).pipe(ho());return this.componentLoaders.set(r,s),s}loadChildren(r,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return V({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);let o=gH(i,this.compiler,r,this.onLoadEndListener).pipe(wu(()=>{this.childrenLoaders.delete(i)})),a=new fo(o,()=>new rt).pipe(ho());return this.childrenLoaders.set(i,a),a}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=k({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function gH(t,e,n,r){return di(t.loadChildren()).pipe(F(vx),We(i=>i instanceof ku||Array.isArray(i)?V(i):fe(e.compileModuleAsync(i))),F(i=>{r&&r(t);let s,o,a=!1;return Array.isArray(i)?(o=i,a=!0):(s=i.create(n).injector,o=s.get(df,[],{optional:!0,self:!0}).flat()),{routes:o.map(Av),injector:s}}))}function mH(t){return t&&typeof t=="object"&&"default"in t}function vx(t){return mH(t)?t.default:t}var Rv=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=k({token:e,factory:()=>R(yH),providedIn:"root"});let t=e;return t})(),yH=(()=>{let e=class e{shouldProcessUrl(r){return!0}extract(r){return r}merge(r,i){return r}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=k({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),wx=new P(""),Ex=new P("");function _H(t,e,n){let r=t.get(Ex),i=t.get(qt);return t.get(se).runOutsideAngular(()=>{if(!i.startViewTransition||r.skipNextTransition)return r.skipNextTransition=!1,Promise.resolve();let s,o=new Promise(c=>{s=c}),a=i.startViewTransition(()=>(s(),vH(t))),{onViewTransitionCreated:u}=r;return u&&si(t,()=>u({transition:a,from:e,to:n})),o})}function vH(t){return new Promise(e=>{I_(e,{injector:t})})}var Nv=(()=>{let e=class e{get hasRequestedNavigation(){return this.navigationId!==0}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new rt,this.transitionAbortSubject=new rt,this.configLoader=R(Mv),this.environmentInjector=R(Qt),this.urlSerializer=R(oc),this.rootContexts=R(ac),this.location=R(Go),this.inputBindingEnabled=R(ff,{optional:!0})!==null,this.titleStrategy=R(_x),this.options=R(lc,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=R(Rv),this.createViewTransition=R(wx,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>V(void 0),this.rootComponentType=null;let r=s=>this.events.next(new cv(s)),i=s=>this.events.next(new lv(s));this.configLoader.onLoadEndListener=i,this.configLoader.onLoadStartListener=r}complete(){this.transitions?.complete()}handleNavigationRequest(r){let i=++this.navigationId;this.transitions?.next(ce(S(S({},this.transitions.value),r),{id:i}))}setupNavigations(r,i,s){return this.transitions=new mt({id:0,currentUrlTree:i,currentRawUrl:i,extractedUrl:this.urlHandlingStrategy.extract(i),urlAfterRedirects:this.urlHandlingStrategy.extract(i),rawUrl:i,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:Qu,restoredState:null,currentSnapshot:s.snapshot,targetSnapshot:null,currentRouterState:s,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(yt(o=>o.id!==0),F(o=>ce(S({},o),{extractedUrl:this.urlHandlingStrategy.extract(o.rawUrl)})),Re(o=>{this.currentTransition=o;let a=!1,u=!1;return V(o).pipe(Ke(c=>{this.currentNavigation={id:c.id,initialUrl:c.rawUrl,extractedUrl:c.extractedUrl,trigger:c.source,extras:c.extras,previousNavigation:this.lastSuccessfulNavigation?ce(S({},this.lastSuccessfulNavigation),{previousNavigation:null}):null}}),Re(c=>{let l=!r.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),d=c.extras.onSameUrlNavigation??r.onSameUrlNavigation;if(!l&&d!=="reload"){let h="";return this.events.next(new li(c.id,this.urlSerializer.serialize(c.rawUrl),h,nf.IgnoredSameUrlNavigation)),c.resolve(null),jt}if(this.urlHandlingStrategy.shouldProcessUrl(c.rawUrl))return V(c).pipe(Re(h=>{let f=this.transitions?.getValue();return this.events.next(new Xo(h.id,this.urlSerializer.serialize(h.extractedUrl),h.source,h.restoredState)),f!==this.transitions?.getValue()?jt:Promise.resolve(h)}),cH(this.environmentInjector,this.configLoader,this.rootComponentType,r.config,this.urlSerializer,this.paramsInheritanceStrategy),Ke(h=>{o.targetSnapshot=h.targetSnapshot,o.urlAfterRedirects=h.urlAfterRedirects,this.currentNavigation=ce(S({},this.currentNavigation),{finalUrl:h.urlAfterRedirects});let f=new rf(h.id,this.urlSerializer.serialize(h.extractedUrl),this.urlSerializer.serialize(h.urlAfterRedirects),h.targetSnapshot);this.events.next(f)}));if(l&&this.urlHandlingStrategy.shouldProcessUrl(c.currentRawUrl)){let{id:h,extractedUrl:f,source:p,restoredState:g,extras:_}=c,C=new Xo(h,this.urlSerializer.serialize(f),p,g);this.events.next(C);let M=ax(this.rootComponentType).snapshot;return this.currentTransition=o=ce(S({},c),{targetSnapshot:M,urlAfterRedirects:f,extras:ce(S({},_),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=f,V(o)}else{let h="";return this.events.next(new li(c.id,this.urlSerializer.serialize(c.extractedUrl),h,nf.IgnoredByUrlHandlingStrategy)),c.resolve(null),jt}}),Ke(c=>{let l=new sv(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(l)}),F(c=>(this.currentTransition=o=ce(S({},c),{guards:S$(c.targetSnapshot,c.currentSnapshot,this.rootContexts)}),o)),V$(this.environmentInjector,c=>this.events.next(c)),Ke(c=>{if(o.guardsResult=c.guardsResult,Zo(c.guardsResult))throw dx(this.urlSerializer,c.guardsResult);let l=new ov(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot,!!c.guardsResult);this.events.next(l)}),yt(c=>c.guardsResult?!0:(this.cancelNavigationTransition(c,"",gn.GuardRejected),!1)),J_(c=>{if(c.guards.canActivateChecks.length)return V(c).pipe(Ke(l=>{let d=new av(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(d)}),Re(l=>{let d=!1;return V(l).pipe(lH(this.paramsInheritanceStrategy,this.environmentInjector),Ke({next:()=>d=!0,complete:()=>{d||this.cancelNavigationTransition(l,"",gn.NoDataFromResolver)}}))}),Ke(l=>{let d=new uv(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(d)}))}),J_(c=>{let l=d=>{let h=[];d.routeConfig?.loadComponent&&!d.routeConfig._loadedComponent&&h.push(this.configLoader.loadComponent(d.routeConfig).pipe(Ke(f=>{d.component=f}),F(()=>{})));for(let f of d.children)h.push(...l(f));return h};return _u(l(c.targetSnapshot.root)).pipe(Yr(null),Dr(1))}),J_(()=>this.afterPreactivation()),Re(()=>{let{currentSnapshot:c,targetSnapshot:l}=o,d=this.createViewTransition?.(this.environmentInjector,c.root,l.root);return d?fe(d).pipe(F(()=>o)):V(o)}),F(c=>{let l=v$(r.routeReuseStrategy,c.targetSnapshot,c.currentRouterState);return this.currentTransition=o=ce(S({},c),{targetRouterState:l}),this.currentNavigation.targetRouterState=l,o}),Ke(()=>{this.events.next(new ec)}),b$(this.rootContexts,r.routeReuseStrategy,c=>this.events.next(c),this.inputBindingEnabled),Dr(1),Ke({next:c=>{a=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new Rr(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects))),this.titleStrategy?.updateTitle(c.targetRouterState.snapshot),c.resolve(!0)},complete:()=>{a=!0}}),$m(this.transitionAbortSubject.pipe(Ke(c=>{throw c}))),wu(()=>{!a&&!u&&this.cancelNavigationTransition(o,"",gn.SupersededByNewNavigation),this.currentNavigation?.id===o.id&&(this.currentNavigation=null)}),Qr(c=>{if(u=!0,fx(c))this.events.next(new ci(o.id,this.urlSerializer.serialize(o.extractedUrl),c.message,c.cancellationCode)),I$(c)?this.events.next(new tc(c.url)):o.resolve(!1);else{this.events.next(new Ju(o.id,this.urlSerializer.serialize(o.extractedUrl),c,o.targetSnapshot??void 0));try{o.resolve(r.errorHandler(c))}catch(l){this.options.resolveNavigationPromiseOnError?o.resolve(!1):o.reject(l)}}return jt}))}))}cancelNavigationTransition(r,i,s){let o=new ci(r.id,this.urlSerializer.serialize(r.extractedUrl),i,s);this.events.next(o),r.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){return this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))).toString()!==this.currentTransition?.extractedUrl.toString()&&!this.currentTransition?.extras.skipLocationChange}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=k({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function wH(t){return t!==Qu}var EH=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=k({token:e,factory:()=>R(IH),providedIn:"root"});let t=e;return t})(),Tv=class{shouldDetach(e){return!1}store(e,n){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,n){return e.routeConfig===n.routeConfig}},IH=(()=>{let e=class e extends Tv{};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=cs(e)))(s||e)}})(),e.\u0275prov=k({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),Ix=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=k({token:e,factory:()=>R(CH),providedIn:"root"});let t=e;return t})(),CH=(()=>{let e=class e extends Ix{constructor(){super(...arguments),this.location=R(Go),this.urlSerializer=R(oc),this.options=R(lc,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=R(Rv),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new ui,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=ax(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(r){return this.location.subscribe(i=>{i.type==="popstate"&&r(i.url,i.state)})}handleRouterEvent(r,i){if(r instanceof Xo)this.stateMemento=this.createStateMemento();else if(r instanceof li)this.rawUrlTree=i.initialUrl;else if(r instanceof rf){if(this.urlUpdateStrategy==="eager"&&!i.extras.skipLocationChange){let s=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl);this.setBrowserUrl(s,i)}}else r instanceof ec?(this.currentUrlTree=i.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl),this.routerState=i.targetRouterState,this.urlUpdateStrategy==="deferred"&&(i.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,i))):r instanceof ci&&(r.code===gn.GuardRejected||r.code===gn.NoDataFromResolver)?this.restoreHistory(i):r instanceof Ju?this.restoreHistory(i,!0):r instanceof Rr&&(this.lastSuccessfulId=r.id,this.currentPageId=this.browserPageId)}setBrowserUrl(r,i){let s=this.urlSerializer.serialize(r);if(this.location.isCurrentPathEqualTo(s)||i.extras.replaceUrl){let o=this.browserPageId,a=S(S({},i.extras.state),this.generateNgRouterState(i.id,o));this.location.replaceState(s,"",a)}else{let o=S(S({},i.extras.state),this.generateNgRouterState(i.id,this.browserPageId+1));this.location.go(s,"",o)}}restoreHistory(r,i=!1){if(this.canceledNavigationResolution==="computed"){let s=this.browserPageId,o=this.currentPageId-s;o!==0?this.location.historyGo(o):this.currentUrlTree===r.finalUrl&&o===0&&(this.resetState(r),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(i&&this.resetState(r),this.resetUrlToCurrentUrlTree())}resetState(r){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,r.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(r,i){return this.canceledNavigationResolution==="computed"?{navigationId:r,\u0275routerPageId:i}:{navigationId:r}}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=cs(e)))(s||e)}})(),e.\u0275prov=k({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),Wu=function(t){return t[t.COMPLETE=0]="COMPLETE",t[t.FAILED=1]="FAILED",t[t.REDIRECTING=2]="REDIRECTING",t}(Wu||{});function Cx(t,e){t.events.pipe(yt(n=>n instanceof Rr||n instanceof ci||n instanceof Ju||n instanceof li),F(n=>n instanceof Rr||n instanceof li?Wu.COMPLETE:(n instanceof ci?n.code===gn.Redirect||n.code===gn.SupersededByNewNavigation:!1)?Wu.REDIRECTING:Wu.FAILED),yt(n=>n!==Wu.REDIRECTING),Dr(1)).subscribe(()=>{e()})}function DH(t){throw t}var TH={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},bH={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},ms=(()=>{let e=class e{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.isNgZoneEnabled=!1,this.console=R(jh),this.stateManager=R(Ix),this.options=R(lc,{optional:!0})||{},this.pendingTasks=R(Lh),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=R(Nv),this.urlSerializer=R(oc),this.location=R(Go),this.urlHandlingStrategy=R(Rv),this._events=new rt,this.errorHandler=this.options.errorHandler||DH,this.navigated=!1,this.routeReuseStrategy=R(EH),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=R(df,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!R(ff,{optional:!0}),this.eventsSubscription=new Ue,this.isNgZoneEnabled=R(se)instanceof se&&se.isInAngularZone(),this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:r=>{this.console.warn(r)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){let r=this.navigationTransitions.events.subscribe(i=>{try{let s=this.navigationTransitions.currentTransition,o=this.navigationTransitions.currentNavigation;if(s!==null&&o!==null){if(this.stateManager.handleRouterEvent(i,o),i instanceof ci&&i.code!==gn.Redirect&&i.code!==gn.SupersededByNewNavigation)this.navigated=!0;else if(i instanceof Rr)this.navigated=!0;else if(i instanceof tc){let a=this.urlHandlingStrategy.merge(i.url,s.currentRawUrl),u={info:s.extras.info,skipLocationChange:s.extras.skipLocationChange,replaceUrl:this.urlUpdateStrategy==="eager"||wH(s.source)};this.scheduleNavigation(a,Qu,null,u,{resolve:s.resolve,reject:s.reject,promise:s.promise})}}AH(i)&&this._events.next(i)}catch(s){this.navigationTransitions.transitionAbortSubject.next(s)}});this.eventsSubscription.add(r)}resetRootComponentType(r){this.routerState.root.component=r,this.navigationTransitions.rootComponentType=r}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),Qu,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((r,i)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(r,"popstate",i)},0)})}navigateToSyncWithBrowser(r,i,s){let o={replaceUrl:!0},a=s?.navigationId?s:null;if(s){let c=S({},s);delete c.navigationId,delete c.\u0275routerPageId,Object.keys(c).length!==0&&(o.state=c)}let u=this.parseUrl(r);this.scheduleNavigation(u,i,a,o)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(r){this.config=r.map(Av),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(r,i={}){let{relativeTo:s,queryParams:o,fragment:a,queryParamsHandling:u,preserveFragment:c}=i,l=c?this.currentUrlTree.fragment:a,d=null;switch(u){case"merge":d=S(S({},this.currentUrlTree.queryParams),o);break;case"preserve":d=this.currentUrlTree.queryParams;break;default:d=o||null}d!==null&&(d=this.removeEmptyProps(d));let h;try{let f=s?s.snapshot:this.routerState.snapshot.root;h=rx(f)}catch{(typeof r[0]!="string"||!r[0].startsWith("/"))&&(r=[]),h=this.currentUrlTree.root}return ix(h,r,d,l??null)}navigateByUrl(r,i={skipLocationChange:!1}){let s=Zo(r)?r:this.parseUrl(r),o=this.urlHandlingStrategy.merge(s,this.rawUrlTree);return this.scheduleNavigation(o,Qu,null,i)}navigate(r,i={skipLocationChange:!1}){return SH(r),this.navigateByUrl(this.createUrlTree(r,i),i)}serializeUrl(r){return this.urlSerializer.serialize(r)}parseUrl(r){try{return this.urlSerializer.parse(r)}catch{return this.urlSerializer.parse("/")}}isActive(r,i){let s;if(i===!0?s=S({},TH):i===!1?s=S({},bH):s=i,Zo(r))return jA(this.currentUrlTree,r,s);let o=this.parseUrl(r);return jA(this.currentUrlTree,o,s)}removeEmptyProps(r){return Object.entries(r).reduce((i,[s,o])=>(o!=null&&(i[s]=o),i),{})}scheduleNavigation(r,i,s,o,a){if(this.disposed)return Promise.resolve(!1);let u,c,l;a?(u=a.resolve,c=a.reject,l=a.promise):l=new Promise((h,f)=>{u=h,c=f});let d=this.pendingTasks.add();return Cx(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(d))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:s,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:r,extras:o,resolve:u,reject:c,promise:l,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),l.catch(h=>Promise.reject(h))}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=k({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();function SH(t){for(let e=0;e<t.length;e++)if(t[e]==null)throw new U(4008,!1)}function AH(t){return!(t instanceof ec)&&!(t instanceof tc)}var hf=class{};var xH=(()=>{let e=class e{constructor(r,i,s,o,a){this.router=r,this.injector=s,this.preloadingStrategy=o,this.loader=a}setUpPreloading(){this.subscription=this.router.events.pipe(yt(r=>r instanceof Rr),Zi(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(r,i){let s=[];for(let o of i){o.providers&&!o._injector&&(o._injector=Vh(o.providers,r,`Route: ${o.path}`));let a=o._injector??r,u=o._loadedInjector??a;(o.loadChildren&&!o._loadedRoutes&&o.canLoad===void 0||o.loadComponent&&!o._loadedComponent)&&s.push(this.preloadConfig(a,o)),(o.children||o._loadedRoutes)&&s.push(this.processRoutes(u,o.children??o._loadedRoutes))}return fe(s).pipe(Kr())}preloadConfig(r,i){return this.preloadingStrategy.preload(i,()=>{let s;i.loadChildren&&i.canLoad===void 0?s=this.loader.loadChildren(r,i):s=V(null);let o=s.pipe(We(a=>a===null?V(void 0):(i._loadedRoutes=a.routes,i._loadedInjector=a.injector,this.processRoutes(a.injector??r,a.routes))));if(i.loadComponent&&!i._loadedComponent){let a=this.loader.loadComponent(i);return fe([o,a]).pipe(Kr())}else return o})}};e.\u0275fac=function(i){return new(i||e)(I(ms),I(Uh),I(Qt),I(hf),I(Mv))},e.\u0275prov=k({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),Dx=new P(""),MH=(()=>{let e=class e{constructor(r,i,s,o,a={}){this.urlSerializer=r,this.transitions=i,this.viewportScroller=s,this.zone=o,this.options=a,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},a.scrollPositionRestoration||="disabled",a.anchorScrolling||="disabled"}init(){this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(r=>{r instanceof Xo?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=r.navigationTrigger,this.restoredId=r.restoredState?r.restoredState.navigationId:0):r instanceof Rr?(this.lastId=r.id,this.scheduleScrollEvent(r,this.urlSerializer.parse(r.urlAfterRedirects).fragment)):r instanceof li&&r.code===nf.IgnoredSameUrlNavigation&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(r,this.urlSerializer.parse(r.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(r=>{r instanceof sf&&(r.position?this.options.scrollPositionRestoration==="top"?this.viewportScroller.scrollToPosition([0,0]):this.options.scrollPositionRestoration==="enabled"&&this.viewportScroller.scrollToPosition(r.position):r.anchor&&this.options.anchorScrolling==="enabled"?this.viewportScroller.scrollToAnchor(r.anchor):this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(r,i){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new sf(r,this.lastSource==="popstate"?this.store[this.restoredId]:null,i))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}};e.\u0275fac=function(i){PS()},e.\u0275prov=k({token:e,factory:e.\u0275fac});let t=e;return t})();function RH(t){return t.routerState.root}function dc(t,e){return{\u0275kind:t,\u0275providers:e}}function NH(){let t=R(Pn);return e=>{let n=t.get(qo);if(e!==n.components[0])return;let r=t.get(ms),i=t.get(Tx);t.get(Pv)===1&&r.initialNavigation(),t.get(bx,null,ne.Optional)?.setUpPreloading(),t.get(Dx,null,ne.Optional)?.init(),r.resetRootComponentType(n.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}var Tx=new P("",{factory:()=>new rt}),Pv=new P("",{providedIn:"root",factory:()=>1});function PH(){return dc(2,[{provide:Pv,useValue:0},{provide:Hh,multi:!0,deps:[Pn],useFactory:e=>{let n=e.get(EA,Promise.resolve());return()=>n.then(()=>new Promise(r=>{let i=e.get(ms),s=e.get(Tx);Cx(i,()=>{r(!0)}),e.get(Nv).afterPreactivation=()=>(r(!0),s.closed?V(void 0):s),i.initialNavigation()}))}}])}function kH(){return dc(3,[{provide:Hh,multi:!0,useFactory:()=>{let e=R(ms);return()=>{e.setUpLocationChangeListener()}}},{provide:Pv,useValue:2}])}var bx=new P("");function OH(t){return dc(0,[{provide:bx,useExisting:xH},{provide:hf,useExisting:t}])}function FH(){return dc(8,[HA,{provide:ff,useExisting:HA}])}function VH(t){let e=[{provide:wx,useValue:_H},{provide:Ex,useValue:S({skipNextTransition:!!t?.skipInitialTransition},t)}];return dc(9,e)}var GA=new P("ROUTER_FORROOT_GUARD"),LH=[Go,{provide:oc,useClass:Zu},ms,ac,{provide:Jo,useFactory:RH,deps:[ms]},Mv,[]],kv=(()=>{let e=class e{constructor(r){}static forRoot(r,i){return{ngModule:e,providers:[LH,[],{provide:df,multi:!0,useValue:r},{provide:GA,useFactory:$H,deps:[[ms,new Uo,new s_]]},{provide:lc,useValue:i||{}},i?.useHash?UH():BH(),jH(),i?.preloadingStrategy?OH(i.preloadingStrategy).\u0275providers:[],i?.initialNavigation?HH(i):[],i?.bindToComponentInputs?FH().\u0275providers:[],i?.enableViewTransitions?VH().\u0275providers:[],qH()]}}static forChild(r){return{ngModule:e,providers:[{provide:df,multi:!0,useValue:r}]}}};e.\u0275fac=function(i){return new(i||e)(I(GA,8))},e.\u0275mod=Ye({type:e}),e.\u0275inj=Qe({});let t=e;return t})();function jH(){return{provide:Dx,useFactory:()=>{let t=R(SA),e=R(se),n=R(lc),r=R(Nv),i=R(oc);return n.scrollOffset&&t.setOffset(n.scrollOffset),new MH(i,r,t,e,n)}}}function UH(){return{provide:hs,useClass:CA}}function BH(){return{provide:hs,useClass:U_}}function $H(t){return"guarded"}function HH(t){return[t.initialNavigation==="disabled"?kH().\u0275providers:[],t.initialNavigation==="enabledBlocking"?PH().\u0275providers:[]]}var zA=new P("");function qH(){return[{provide:zA,useFactory:NH},{provide:R_,multi:!0,useExisting:zA}]}var GH=[],Sx=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Ye({type:e}),e.\u0275inj=Qe({imports:[kv.forRoot(GH),kv]});let t=e;return t})();var ys=class{constructor(){this.id="",this.nombre="",this.rfc="",this.domicilio="",this.tipoCliente=""}};var gf=class{constructor(){this.id=0,this.descripcion=""}};var zH="firebase",WH="10.8.0";Tn(zH,WH,"app");var _s=new br("ANGULARFIRE2_VERSION");var KH=(t,e)=>{let n=e?[e]:z0(),r=[];return n.forEach(i=>{i.container.getProvider(t).instances.forEach(o=>{r.includes(o)||r.push(o)})}),r},Nr=class{constructor(){return KH(QH)}},QH="app-check";function Ov(){}var mf=class{zone;delegate;constructor(e,n=km){this.zone=e,this.delegate=n}now(){return this.delegate.now()}schedule(e,n,r){let i=this.zone,s=function(o){i.runGuarded(()=>{e.apply(this,[o])})};return this.delegate.schedule(s,n,r)}},Fv=class{zone;task=null;constructor(e){this.zone=e}call(e,n){let r=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Ov,{},Ov,Ov)),n.pipe(Ke({next:r,complete:r,error:r})).subscribe(e).add(r)}unscheduleTask(){setTimeout(()=>{this.task!=null&&this.task.state==="scheduled"&&(this.task.invoke(),this.task=null)},10)}},na=(()=>{class t{ngZone;outsideAngular;insideAngular;constructor(n){this.ngZone=n,this.outsideAngular=n.runOutsideAngular(()=>new mf(Zone.current)),this.insideAngular=n.run(()=>new mf(Zone.current,Yi)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(r){return new(r||t)(I(se))};static \u0275prov=k({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function YH(){let t=globalThis.\u0275AngularFireScheduler;if(!t)throw new Error(`Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using
provideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).`);return t}function $e(t){return ZH(YH())(t)}function ZH(t){return function(n){return n=n.lift(new Fv(t.ngZone)),n.pipe(Sn(t.outsideAngular),un(t.insideAngular))}}var XH=new Map,JH={activated:!1,tokenObservers:[]},eq={initialized:!1,enabled:!1};function kn(t){return XH.get(t)||Object.assign({},JH)}function kx(){return eq}var tq="https://content-firebaseappcheck.googleapis.com/v1";var nq="exchangeDebugToken",Ax={OFFSET_DURATION:5*60*1e3,RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:16*60*1e3},_J=24*60*60*1e3;var jv=class{constructor(e,n,r,i,s){if(this.operation=e,this.retryPolicy=n,this.getWaitDuration=r,this.lowerBound=i,this.upperBound=s,this.pending=null,this.nextErrorWaitInterval=i,i>s)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){return v(this,null,function*(){this.stop();try{this.pending=new ot,this.pending.promise.catch(n=>{}),yield rq(this.getNextRun(e)),this.pending.resolve(),yield this.pending.promise,this.pending=new ot,this.pending.promise.catch(n=>{}),yield this.operation(),this.pending.resolve(),yield this.pending.promise,this.process(!0).catch(()=>{})}catch(n){this.retryPolicy(n)?this.process(!1).catch(()=>{}):this.stop()}})}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{let n=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),n}}};function rq(t){return new Promise(e=>{setTimeout(e,t)})}var iq={"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"},hi=new U0("appCheck","AppCheck",iq);function Ox(t){if(!kn(t).activated)throw hi.create("use-before-activation",{appName:t.name})}function Fx(r,i){return v(this,arguments,function*({url:t,body:e},n){let s={"Content-Type":"application/json"},o=n.getImmediate({optional:!0});if(o){let f=yield o.getHeartbeatsHeader();f&&(s["X-Firebase-Client"]=f)}let a={method:"POST",body:JSON.stringify(e),headers:s},u;try{u=yield fetch(t,a)}catch(f){throw hi.create("fetch-network-error",{originalErrorMessage:f?.message})}if(u.status!==200)throw hi.create("fetch-status-error",{httpStatus:u.status});let c;try{c=yield u.json()}catch(f){throw hi.create("fetch-parse-error",{originalErrorMessage:f?.message})}let l=c.ttl.match(/^([\d.]+)(s)$/);if(!l||!l[2]||isNaN(Number(l[1])))throw hi.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${c.ttl}`});let d=Number(l[1])*1e3,h=Date.now();return{token:c.token,expireTimeMillis:h+d,issuedAtTimeMillis:h}})}function Vx(t,e){let{projectId:n,appId:r,apiKey:i}=t.options;return{url:`${tq}/projects/${n}/apps/${r}:${nq}?key=${i}`,body:{debug_token:e}}}var sq="firebase-app-check-database",oq=1,Uv="firebase-app-check-store";var yf=null;function aq(){return yf||(yf=new Promise((t,e)=>{try{let n=indexedDB.open(sq,oq);n.onsuccess=r=>{t(r.target.result)},n.onerror=r=>{var i;e(hi.create("storage-open",{originalErrorMessage:(i=r.target.error)===null||i===void 0?void 0:i.message}))},n.onupgradeneeded=r=>{let i=r.target.result;switch(r.oldVersion){case 0:i.createObjectStore(Uv,{keyPath:"compositeKey"})}}}catch(n){e(hi.create("storage-open",{originalErrorMessage:n?.message}))}}),yf)}function uq(t,e){return cq(lq(t),e)}function cq(t,e){return v(this,null,function*(){let r=(yield aq()).transaction(Uv,"readwrite"),s=r.objectStore(Uv).put({compositeKey:t,value:e});return new Promise((o,a)=>{s.onsuccess=u=>{o()},r.onerror=u=>{var c;a(hi.create("storage-set",{originalErrorMessage:(c=u.target.error)===null||c===void 0?void 0:c.message}))}})})}function lq(t){return`${t.options.appId}-${t.name}`}var Bv=new Wr("@firebase/app-check");function Lv(t,e){return md()?uq(t,e).catch(n=>{Bv.warn(`Failed to write token to IndexedDB. Error: ${n}`)}):Promise.resolve()}function Lx(){return kx().enabled}function jx(){return v(this,null,function*(){let t=kx();if(t.enabled&&t.token)return t.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)})}var dq={error:"UNKNOWN_ERROR"};function hq(t){return pd.encodeString(JSON.stringify(t),!1)}function $v(t,e=!1){return v(this,null,function*(){let n=t.app;Ox(n);let r=kn(n),i=r.token,s;if(i&&!hc(i)&&(r.token=void 0,i=void 0),!i){let u=yield r.cachedTokenPromise;u&&(hc(u)?i=u:yield Lv(n,void 0))}if(!e&&i&&hc(i))return{token:i.token};let o=!1;if(Lx()){r.exchangeTokenPromise||(r.exchangeTokenPromise=Fx(Vx(n,yield jx()),t.heartbeatServiceProvider).finally(()=>{r.exchangeTokenPromise=void 0}),o=!0);let u=yield r.exchangeTokenPromise;return yield Lv(n,u),r.token=u,{token:u.token}}try{r.exchangeTokenPromise||(r.exchangeTokenPromise=r.provider.getToken().finally(()=>{r.exchangeTokenPromise=void 0}),o=!0),i=yield kn(n).exchangeTokenPromise}catch(u){u.code==="appCheck/throttled"?Bv.warn(u.message):Bv.error(u),s=u}let a;return i?s?hc(i)?a={token:i.token,internalError:s}:a=Mx(s):(a={token:i.token},r.token=i,yield Lv(n,i)):a=Mx(s),o&&mq(n,a),a})}function fq(t){return v(this,null,function*(){let e=t.app;Ox(e);let{provider:n}=kn(e);if(Lx()){let r=yield jx(),{token:i}=yield Fx(Vx(e,r),t.heartbeatServiceProvider);return{token:i}}else{let{token:r}=yield n.getToken();return{token:r}}})}function pq(t,e,n,r){let{app:i}=t,s=kn(i),o={next:n,error:r,type:e};if(s.tokenObservers=[...s.tokenObservers,o],s.token&&hc(s.token)){let a=s.token;Promise.resolve().then(()=>{n({token:a.token}),xx(t)}).catch(()=>{})}s.cachedTokenPromise.then(()=>xx(t))}function Ux(t,e){let n=kn(t),r=n.tokenObservers.filter(i=>i.next!==e);r.length===0&&n.tokenRefresher&&n.tokenRefresher.isRunning()&&n.tokenRefresher.stop(),n.tokenObservers=r}function xx(t){let{app:e}=t,n=kn(e),r=n.tokenRefresher;r||(r=gq(t),n.tokenRefresher=r),!r.isRunning()&&n.isTokenAutoRefreshEnabled&&r.start()}function gq(t){let{app:e}=t;return new jv(()=>v(this,null,function*(){let n=kn(e),r;if(n.token?r=yield $v(t,!0):r=yield $v(t),r.error)throw r.error;if(r.internalError)throw r.internalError}),()=>!0,()=>{let n=kn(e);if(n.token){let r=n.token.issuedAtTimeMillis+(n.token.expireTimeMillis-n.token.issuedAtTimeMillis)*.5+3e5,i=n.token.expireTimeMillis-5*60*1e3;return r=Math.min(r,i),Math.max(0,r-Date.now())}else return 0},Ax.RETRIAL_MIN_WAIT,Ax.RETRIAL_MAX_WAIT)}function mq(t,e){let n=kn(t).tokenObservers;for(let r of n)try{r.type==="EXTERNAL"&&e.error!=null?r.error(e.error):r.next(e)}catch{}}function hc(t){return t.expireTimeMillis-Date.now()>0}function Mx(t){return{token:hq(dq),error:t}}var Hv=class{constructor(e,n){this.app=e,this.heartbeatServiceProvider=n}_delete(){let{tokenObservers:e}=kn(this.app);for(let n of e)Ux(this.app,n.next);return Promise.resolve()}};function yq(t,e){return new Hv(t,e)}function _q(t){return{getToken:e=>$v(t,e),getLimitedUseToken:()=>fq(t),addTokenListener:e=>pq(t,"INTERNAL",e),removeTokenListener:e=>Ux(t.app,e)}}var vq="@firebase/app-check",wq="0.8.2";var Eq="app-check",Rx="app-check-internal";function Iq(){Gi(new zt(Eq,t=>{let e=t.getProvider("app").getImmediate(),n=t.getProvider("heartbeat");return yq(e,n)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((t,e,n)=>{t.getProvider(Rx).initialize()})),Gi(new zt(Rx,t=>{let e=t.getProvider("app-check").getImmediate();return _q(e)},"PUBLIC").setInstantiationMode("EXPLICIT")),Tn(vq,wq)}Iq();var Cq=["localhost","0.0.0.0","127.0.0.1"],MJ=typeof window<"u"&&Cq.includes(window.location.hostname);var Dq="firebase",Tq="10.8.0";pt.registerVersion(Dq,Tq,"app-compat");var bq=["ngOnDestroy"],$x=(t,e,n,r={})=>new Proxy(t,{get:(i,s)=>n.runOutsideAngular(()=>{if(t[s])return r?.spy?.get&&r.spy.get(s,t[s]),t[s];if(bq.indexOf(s)>-1)return()=>{};let o=e.toPromise().then(a=>{let u=a?.[s];return typeof u=="function"?u.bind(a):u?.then?u.then(c=>n.run(()=>c)):n.run(()=>u)});return new Proxy(()=>{},{get:(a,u)=>o[u],apply:(a,u,c)=>o.then(l=>{let d=l?.(...c);return r?.spy?.apply&&r.spy.apply(s,c,d),d})})})});var _f=class{constructor(e){return e}},fi=new P("angularfire2.app.options"),pi=new P("angularfire2.app.name");function vs(t,e,n){let r=typeof n=="string"&&n||"[DEFAULT]",i=typeof n=="object"&&n||{};i.name=i.name||r;let o=pt.apps.filter(a=>a&&a.name===i.name)[0]||e.runOutsideAngular(()=>pt.initializeApp(t,i));try{if(JSON.stringify(t)!==JSON.stringify(o.options)){let a=!!module.hot;Sq("error",`${o.name} Firebase App already initialized with different options${a?", you may need to reload as Firebase is not HMR aware.":"."}`)}}catch{}return new _f(o)}var Sq=(t,...e)=>{k_()&&typeof console<"u"&&console[t](...e)},Aq={provide:_f,useFactory:vs,deps:[fi,se,[new Uo,pi]]},Hx=(()=>{class t{static initializeApp(n,r){return{ngModule:t,providers:[{provide:fi,useValue:n},{provide:pi,useValue:r}]}}constructor(n){pt.registerVersion("angularfire",_s.full,"core"),pt.registerVersion("angularfire",_s.full,"app-compat"),pt.registerVersion("angular",oA.full,n.toString())}static \u0275fac=function(r){return new(r||t)(I(Ct))};static \u0275mod=Ye({type:t});static \u0275inj=Qe({providers:[Aq]})}return t})();function ra(t,e,n,r,i){let[,s,o]=globalThis.\u0275AngularfireInstanceCache.find(a=>a[0]===t)||[];if(s)return xq(i,o)||(Bx("error",`${e} was already initialized on the ${n} Firebase App with different settings.${Mq?" You may need to reload as Firebase is not HMR aware.":""}`),Bx("warn",{is:i,was:o})),s;{let a=r();return globalThis.\u0275AngularfireInstanceCache.push([t,a,i]),a}}function xq(t,e){try{return t.toString()===e.toString()}catch{return t===e}}var Mq=typeof module<"u"&&!!module.hot,Bx=(t,...e)=>{k_()&&typeof console<"u"&&console[t](...e)};globalThis.\u0275AngularfireInstanceCache||=[];var fc=new P("angularfire2.auth.use-emulator"),pc=new P("angularfire2.auth.settings"),gc=new P("angularfire2.auth.tenant-id"),mc=new P("angularfire2.auth.langugage-code"),yc=new P("angularfire2.auth.use-device-language"),_c=new P("angularfire.auth.persistence"),vc=(t,e,n,r,i,s,o,a)=>ra(`${t.name}.auth`,"AngularFireAuth",t.name,()=>{let u=e.runOutsideAngular(()=>t.auth());if(n&&u.useEmulator(...n),r&&(u.tenantId=r),u.languageCode=i,s&&u.useDeviceLanguage(),o)for(let[c,l]of Object.entries(o))u.settings[c]=l;return a&&u.setPersistence(a),u},[n,r,i,s,o,a]),vf=(()=>{class t{authState;idToken;user;idTokenResult;credential;constructor(n,r,i,s,o,a,u,c,l,d,h,f){let p=new rt,g=V(void 0).pipe(un(o.outsideAngular),Re(()=>s.runOutsideAngular(()=>import("./chunk-2UTFESB6.js"))),F(()=>vs(n,s,r)),F(_=>vc(_,s,a,c,l,d,u,h)),zd({bufferSize:1,refCount:!1}));if(fs(i))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=V(null);else{g.pipe(cn()).subscribe();let _=g.pipe(Re(T=>T.getRedirectResult().then(j=>j,()=>null)),$e,zd({bufferSize:1,refCount:!1})),C=g.pipe(Re(T=>new J(j=>({unsubscribe:s.runOutsideAngular(()=>T.onAuthStateChanged($=>j.next($),$=>j.error($),()=>j.complete()))})))),M=g.pipe(Re(T=>new J(j=>({unsubscribe:s.runOutsideAngular(()=>T.onIdTokenChanged($=>j.next($),$=>j.error($),()=>j.complete()))}))));this.authState=_.pipe(Wd(C),Sn(o.outsideAngular),un(o.insideAngular)),this.user=_.pipe(Wd(M),Sn(o.outsideAngular),un(o.insideAngular)),this.idToken=this.user.pipe(Re(T=>T?fe(T.getIdToken()):V(null))),this.idTokenResult=this.user.pipe(Re(T=>T?fe(T.getIdTokenResult()):V(null))),this.credential=wo(_,p,this.authState.pipe(yt(T=>!T))).pipe(F(T=>T?.user?T:null),Sn(o.outsideAngular),un(o.insideAngular))}return $x(this,g,s,{spy:{apply:(_,C,M)=>{(_.startsWith("signIn")||_.startsWith("createUser"))&&M.then(T=>p.next(T))}}})}static \u0275fac=function(r){return new(r||t)(I(fi),I(pi,8),I(Ct),I(se),I(na),I(fc,8),I(pc,8),I(gc,8),I(mc,8),I(yc,8),I(_c,8),I(Nr,8))};static \u0275prov=k({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})();var Rq=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Fn={},A,hw=hw||{},z=Rq||self;function Pf(t){var e=typeof t;return e=e!="object"?e:t?Array.isArray(t)?"array":e:"null",e=="array"||e=="object"&&typeof t.length=="number"}function Pc(t){var e=typeof t;return e=="object"&&t!=null||e=="function"}function Nq(t){return Object.prototype.hasOwnProperty.call(t,Gv)&&t[Gv]||(t[Gv]=++Pq)}var Gv="closure_uid_"+(1e9*Math.random()>>>0),Pq=0;function kq(t,e,n){return t.call.apply(t.bind,arguments)}function Oq(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var i=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(i,r),t.apply(e,i)}}return function(){return t.apply(e,arguments)}}function Dt(t,e,n){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?Dt=kq:Dt=Oq,Dt.apply(null,arguments)}function wf(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var r=n.slice();return r.push.apply(r,arguments),t.apply(this,r)}}function ct(t,e){function n(){}n.prototype=e.prototype,t.$=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.ac=function(r,i,s){for(var o=Array(arguments.length-2),a=2;a<arguments.length;a++)o[a-2]=arguments[a];return e.prototype[i].apply(r,o)}}function gi(){this.s=this.s,this.o=this.o}var Fq=0;gi.prototype.s=!1;gi.prototype.sa=function(){!this.s&&(this.s=!0,this.N(),Fq!=0)&&Nq(this)};gi.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var rM=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(typeof t=="string")return typeof e!="string"||e.length!=1?-1:t.indexOf(e,0);for(let n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1};function fw(t){let e=t.length;if(0<e){let n=Array(e);for(let r=0;r<e;r++)n[r]=t[r];return n}return[]}function Gx(t,e){for(let n=1;n<arguments.length;n++){let r=arguments[n];if(Pf(r)){let i=t.length||0,s=r.length||0;t.length=i+s;for(let o=0;o<s;o++)t[i+o]=r[o]}else t.push(r)}}function Tt(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}Tt.prototype.h=function(){this.defaultPrevented=!0};var Vq=function(){if(!z.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{let n=()=>{};z.addEventListener("test",n,e),z.removeEventListener("test",n,e)}catch{}return t}();function Tc(t){return/^[\s\xa0]*$/.test(t)}function kf(){var t=z.navigator;return t&&(t=t.userAgent)?t:""}function ir(t){return kf().indexOf(t)!=-1}function pw(t){return pw[" "](t),t}pw[" "]=function(){};function Lq(t,e){var n=b4;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}var jq=ir("Opera"),aa=ir("Trident")||ir("MSIE"),iM=ir("Edge"),Yv=iM||aa,sM=ir("Gecko")&&!(kf().toLowerCase().indexOf("webkit")!=-1&&!ir("Edge"))&&!(ir("Trident")||ir("MSIE"))&&!ir("Edge"),Uq=kf().toLowerCase().indexOf("webkit")!=-1&&!ir("Edge");function oM(){var t=z.document;return t?t.documentMode:void 0}var Zv;e:{if(Ef="",If=function(){var t=kf();if(sM)return/rv:([^\);]+)(\)|;)/.exec(t);if(iM)return/Edge\/([\d\.]+)/.exec(t);if(aa)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t);if(Uq)return/WebKit\/(\S+)/.exec(t);if(jq)return/(?:Version)[ \/]?(\S+)/.exec(t)}(),If&&(Ef=If?If[1]:""),aa&&(Cf=oM(),Cf!=null&&Cf>parseFloat(Ef))){Zv=String(Cf);break e}Zv=Ef}var Ef,If,Cf,Xv;z.document&&aa?(zv=oM(),Xv=zv||parseInt(Zv,10)||void 0):Xv=void 0;var zv,Bq=Xv;function bc(t,e){if(Tt.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(sM){e:{try{pw(e.nodeName);var i=!0;break e}catch{}i=!1}i||(e=null)}}else n=="mouseover"?e=t.fromElement:n=="mouseout"&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=r.clientX!==void 0?r.clientX:r.pageX,this.clientY=r.clientY!==void 0?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=t.clientX!==void 0?t.clientX:t.pageX,this.clientY=t.clientY!==void 0?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=typeof t.pointerType=="string"?t.pointerType:$q[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&bc.$.h.call(this)}}ct(bc,Tt);var $q={2:"touch",3:"pen",4:"mouse"};bc.prototype.h=function(){bc.$.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var kc="closure_listenable_"+(1e6*Math.random()|0),Hq=0;function qq(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.la=i,this.key=++Hq,this.fa=this.ia=!1}function Of(t){t.fa=!0,t.listener=null,t.proxy=null,t.src=null,t.la=null}function gw(t,e,n){for(let r in t)e.call(n,t[r],r,t)}function Gq(t,e){for(let n in t)e.call(void 0,t[n],n,t)}function aM(t){let e={};for(let n in t)e[n]=t[n];return e}var zx="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function uM(t,e){let n,r;for(let i=1;i<arguments.length;i++){r=arguments[i];for(n in r)t[n]=r[n];for(let s=0;s<zx.length;s++)n=zx[s],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function Ff(t){this.src=t,this.g={},this.h=0}Ff.prototype.add=function(t,e,n,r,i){var s=t.toString();t=this.g[s],t||(t=this.g[s]=[],this.h++);var o=ew(t,e,r,i);return-1<o?(e=t[o],n||(e.ia=!1)):(e=new qq(e,this.src,s,!!r,i),e.ia=n,t.push(e)),e};function Jv(t,e){var n=e.type;if(n in t.g){var r=t.g[n],i=rM(r,e),s;(s=0<=i)&&Array.prototype.splice.call(r,i,1),s&&(Of(e),t.g[n].length==0&&(delete t.g[n],t.h--))}}function ew(t,e,n,r){for(var i=0;i<t.length;++i){var s=t[i];if(!s.fa&&s.listener==e&&s.capture==!!n&&s.la==r)return i}return-1}var mw="closure_lm_"+(1e6*Math.random()|0),Wv={};function cM(t,e,n,r,i){if(r&&r.once)return dM(t,e,n,r,i);if(Array.isArray(e)){for(var s=0;s<e.length;s++)cM(t,e[s],n,r,i);return null}return n=vw(n),t&&t[kc]?t.O(e,n,Pc(r)?!!r.capture:!!r,i):lM(t,e,n,!1,r,i)}function lM(t,e,n,r,i,s){if(!e)throw Error("Invalid event type");var o=Pc(i)?!!i.capture:!!i,a=_w(t);if(a||(t[mw]=a=new Ff(t)),n=a.add(e,n,r,o,s),n.proxy)return n;if(r=zq(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)Vq||(i=o),i===void 0&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(fM(e.toString()),r);else if(t.addListener&&t.removeListener)t.addListener(r);else throw Error("addEventListener and attachEvent are unavailable.");return n}function zq(){function t(n){return e.call(t.src,t.listener,n)}let e=Wq;return t}function dM(t,e,n,r,i){if(Array.isArray(e)){for(var s=0;s<e.length;s++)dM(t,e[s],n,r,i);return null}return n=vw(n),t&&t[kc]?t.P(e,n,Pc(r)?!!r.capture:!!r,i):lM(t,e,n,!0,r,i)}function hM(t,e,n,r,i){if(Array.isArray(e))for(var s=0;s<e.length;s++)hM(t,e[s],n,r,i);else r=Pc(r)?!!r.capture:!!r,n=vw(n),t&&t[kc]?(t=t.i,e=String(e).toString(),e in t.g&&(s=t.g[e],n=ew(s,n,r,i),-1<n&&(Of(s[n]),Array.prototype.splice.call(s,n,1),s.length==0&&(delete t.g[e],t.h--)))):t&&(t=_w(t))&&(e=t.g[e.toString()],t=-1,e&&(t=ew(e,n,r,i)),(n=-1<t?e[t]:null)&&yw(n))}function yw(t){if(typeof t!="number"&&t&&!t.fa){var e=t.src;if(e&&e[kc])Jv(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(fM(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=_w(e))?(Jv(n,t),n.h==0&&(n.src=null,e[mw]=null)):Of(t)}}}function fM(t){return t in Wv?Wv[t]:Wv[t]="on"+t}function Wq(t,e){if(t.fa)t=!0;else{e=new bc(e,this);var n=t.listener,r=t.la||t.src;t.ia&&yw(t),t=n.call(r,e)}return t}function _w(t){return t=t[mw],t instanceof Ff?t:null}var Kv="__closure_events_fn_"+(1e9*Math.random()>>>0);function vw(t){return typeof t=="function"?t:(t[Kv]||(t[Kv]=function(e){return t.handleEvent(e)}),t[Kv])}function ut(){gi.call(this),this.i=new Ff(this),this.S=this,this.J=null}ct(ut,gi);ut.prototype[kc]=!0;ut.prototype.removeEventListener=function(t,e,n,r){hM(this,t,e,n,r)};function vt(t,e){var n,r=t.J;if(r)for(n=[];r;r=r.J)n.push(r);if(t=t.S,r=e.type||e,typeof e=="string")e=new Tt(e,t);else if(e instanceof Tt)e.target=e.target||t;else{var i=e;e=new Tt(r,t),uM(e,i)}if(i=!0,n)for(var s=n.length-1;0<=s;s--){var o=e.g=n[s];i=Df(o,r,!0,e)&&i}if(o=e.g=t,i=Df(o,r,!0,e)&&i,i=Df(o,r,!1,e)&&i,n)for(s=0;s<n.length;s++)o=e.g=n[s],i=Df(o,r,!1,e)&&i}ut.prototype.N=function(){if(ut.$.N.call(this),this.i){var t=this.i,e;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)Of(n[r]);delete t.g[e],t.h--}}this.J=null};ut.prototype.O=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)};ut.prototype.P=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};function Df(t,e,n,r){if(e=t.i.g[String(e)],!e)return!0;e=e.concat();for(var i=!0,s=0;s<e.length;++s){var o=e[s];if(o&&!o.fa&&o.capture==n){var a=o.listener,u=o.la||o.src;o.ia&&Jv(t.i,o),i=a.call(u,r)!==!1&&i}}return i&&!r.defaultPrevented}var ww=z.JSON.stringify,tw=class{constructor(e,n){this.i=e,this.j=n,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}};function Kq(){var t=Ew;let e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var nw=class{constructor(){this.h=this.g=null}add(e,n){let r=pM.get();r.set(e,n),this.h?this.h.next=r:this.g=r,this.h=r}},pM=new tw(()=>new rw,t=>t.reset()),rw=class{constructor(){this.next=this.g=this.h=null}set(e,n){this.h=e,this.g=n,this.next=null}reset(){this.next=this.g=this.h=null}};function Qq(t){var e=1;t=t.split(":");let n=[];for(;0<e&&t.length;)n.push(t.shift()),e--;return t.length&&n.push(t.join(":")),n}function Yq(t){z.setTimeout(()=>{throw t},0)}var Sc,Ac=!1,Ew=new nw,gM=()=>{let t=z.Promise.resolve(void 0);Sc=()=>{t.then(Zq)}},Zq=()=>{for(var t;t=Kq();){try{t.h.call(t.g)}catch(n){Yq(n)}var e=pM;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}Ac=!1};function Vf(t,e){ut.call(this),this.h=t||1,this.g=e||z,this.j=Dt(this.qb,this),this.l=Date.now()}ct(Vf,ut);A=Vf.prototype;A.ga=!1;A.T=null;A.qb=function(){if(this.ga){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-t):(this.T&&(this.g.clearTimeout(this.T),this.T=null),vt(this,"tick"),this.ga&&(Iw(this),this.start()))}};A.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function Iw(t){t.ga=!1,t.T&&(t.g.clearTimeout(t.T),t.T=null)}A.N=function(){Vf.$.N.call(this),Iw(this),delete this.g};function Cw(t,e,n){if(typeof t=="function")n&&(t=Dt(t,n));else if(t&&typeof t.handleEvent=="function")t=Dt(t.handleEvent,t);else throw Error("Invalid listener argument");return 2147483647<Number(e)?-1:z.setTimeout(t,e||0)}function mM(t){t.g=Cw(()=>{t.g=null,t.i&&(t.i=!1,mM(t))},t.j);let e=t.h;t.h=null,t.m.apply(null,e)}var iw=class extends gi{constructor(e,n){super(),this.m=e,this.j=n,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:mM(this)}N(){super.N(),this.g&&(z.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}};function xc(t){gi.call(this),this.h=t,this.g={}}ct(xc,gi);var Wx=[];function yM(t,e,n,r){Array.isArray(n)||(n&&(Wx[0]=n.toString()),n=Wx);for(var i=0;i<n.length;i++){var s=cM(e,n[i],r||t.handleEvent,!1,t.h||t);if(!s)break;t.g[s.key]=s}}function _M(t){gw(t.g,function(e,n){this.g.hasOwnProperty(n)&&yw(e)},t),t.g={}}xc.prototype.N=function(){xc.$.N.call(this),_M(this)};xc.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function Lf(){this.g=!0}Lf.prototype.Ea=function(){this.g=!1};function Xq(t,e,n,r,i,s){t.info(function(){if(t.g)if(s)for(var o="",a=s.split("&"),u=0;u<a.length;u++){var c=a[u].split("=");if(1<c.length){var l=c[0];c=c[1];var d=l.split("_");o=2<=d.length&&d[1]=="type"?o+(l+"="+c+"&"):o+(l+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+`
`+n+`
`+o})}function Jq(t,e,n,r,i,s,o){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+`
`+n+`
`+s+" "+o})}function sa(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+t4(t,n)+(r?" "+r:"")})}function e4(t,e){t.info(function(){return"TIMEOUT: "+e})}Lf.prototype.info=function(){};function t4(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n){for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if(s!="noop"&&s!="stop"&&s!="close")for(var o=1;o<i.length;o++)i[o]=""}}}}return ww(n)}catch{return e}}var Cs={},Kx=null;function jf(){return Kx=Kx||new ut}Cs.Ta="serverreachability";function vM(t){Tt.call(this,Cs.Ta,t)}ct(vM,Tt);function Mc(t){let e=jf();vt(e,new vM(e))}Cs.STAT_EVENT="statevent";function wM(t,e){Tt.call(this,Cs.STAT_EVENT,t),this.stat=e}ct(wM,Tt);function Rt(t){let e=jf();vt(e,new wM(e,t))}Cs.Ua="timingevent";function EM(t,e){Tt.call(this,Cs.Ua,t),this.size=e}ct(EM,Tt);function Oc(t,e){if(typeof t!="function")throw Error("Fn must not be null and must be a function");return z.setTimeout(function(){t()},e)}var Uf={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},IM={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function Dw(){}Dw.prototype.h=null;function Qx(t){return t.h||(t.h=t.i())}function CM(){}var Fc={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function Tw(){Tt.call(this,"d")}ct(Tw,Tt);function bw(){Tt.call(this,"c")}ct(bw,Tt);var sw;function Bf(){}ct(Bf,Dw);Bf.prototype.g=function(){return new XMLHttpRequest};Bf.prototype.i=function(){return{}};sw=new Bf;function Vc(t,e,n,r){this.l=t,this.j=e,this.m=n,this.W=r||1,this.U=new xc(this),this.P=n4,t=Yv?125:void 0,this.V=new Vf(t),this.I=null,this.i=!1,this.u=this.B=this.A=this.L=this.G=this.Y=this.C=null,this.F=[],this.g=null,this.o=0,this.s=this.v=null,this.ca=-1,this.J=!1,this.O=0,this.M=null,this.ba=this.K=this.aa=this.S=!1,this.h=new DM}function DM(){this.i=null,this.g="",this.h=!1}var n4=45e3,TM={},ow={};A=Vc.prototype;A.setTimeout=function(t){this.P=t};function aw(t,e,n){t.L=1,t.A=Hf(kr(e)),t.u=n,t.S=!0,bM(t,null)}function bM(t,e){t.G=Date.now(),Lc(t),t.B=kr(t.A);var n=t.B,r=t.W;Array.isArray(r)||(r=[String(r)]),kM(n.i,"t",r),t.o=0,n=t.l.J,t.h=new DM,t.g=tR(t.l,n?e:null,!t.u),0<t.O&&(t.M=new iw(Dt(t.Pa,t,t.g),t.O)),yM(t.U,t.g,"readystatechange",t.nb),e=t.I?aM(t.I):{},t.u?(t.v||(t.v="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ha(t.B,t.v,t.u,e)):(t.v="GET",t.g.ha(t.B,t.v,null,e)),Mc(),Xq(t.j,t.v,t.B,t.m,t.W,t.u)}A.nb=function(t){t=t.target;let e=this.M;e&&sr(t)==3?e.l():this.Pa(t)};A.Pa=function(t){try{if(t==this.g)e:{let l=sr(this.g);var e=this.g.Ia();let d=this.g.da();if(!(3>l)&&(l!=3||Yv||this.g&&(this.h.h||this.g.ja()||Jx(this.g)))){this.J||l!=4||e==7||(e==8||0>=d?Mc(3):Mc(2)),$f(this);var n=this.g.da();this.ca=n;t:if(SM(this)){var r=Jx(this.g);t="";var i=r.length,s=sr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){ws(this),Dc(this);var o="";break t}this.h.i=new z.TextDecoder}for(e=0;e<i;e++)this.h.h=!0,t+=this.h.i.decode(r[e],{stream:s&&e==i-1});r.length=0,this.h.g+=t,this.o=0,o=this.h.g}else o=this.g.ja();if(this.i=n==200,Jq(this.j,this.v,this.B,this.m,this.W,l,n),this.i){if(this.aa&&!this.K){t:{if(this.g){var a,u=this.g;if((a=u.g?u.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Tc(a)){var c=a;break t}}c=null}if(n=c)sa(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,uw(this,n);else{this.i=!1,this.s=3,Rt(12),ws(this),Dc(this);break e}}this.S?(AM(this,l,o),Yv&&this.i&&l==3&&(yM(this.U,this.V,"tick",this.mb),this.V.start())):(sa(this.j,this.m,o,null),uw(this,o)),l==4&&ws(this),this.i&&!this.J&&(l==4?ZM(this.l,this):(this.i=!1,Lc(this)))}else C4(this.g),n==400&&0<o.indexOf("Unknown SID")?(this.s=3,Rt(12)):(this.s=0,Rt(13)),ws(this),Dc(this)}}}catch{}finally{}};function SM(t){return t.g?t.v=="GET"&&t.L!=2&&t.l.Ha:!1}function AM(t,e,n){let r=!0,i;for(;!t.J&&t.o<n.length;)if(i=r4(t,n),i==ow){e==4&&(t.s=4,Rt(14),r=!1),sa(t.j,t.m,null,"[Incomplete Response]");break}else if(i==TM){t.s=4,Rt(15),sa(t.j,t.m,n,"[Invalid Chunk]"),r=!1;break}else sa(t.j,t.m,i,null),uw(t,i);SM(t)&&t.o!=0&&(t.h.g=t.h.g.slice(t.o),t.o=0),e!=4||n.length!=0||t.h.h||(t.s=1,Rt(16),r=!1),t.i=t.i&&r,r?0<n.length&&!t.ba&&(t.ba=!0,e=t.l,e.g==t&&e.ca&&!e.M&&(e.l.info("Great, no buffering proxy detected. Bytes received: "+n.length),Nw(e),e.M=!0,Rt(11))):(sa(t.j,t.m,n,"[Invalid Chunked Response]"),ws(t),Dc(t))}A.mb=function(){if(this.g){var t=sr(this.g),e=this.g.ja();this.o<e.length&&($f(this),AM(this,t,e),this.i&&t!=4&&Lc(this))}};function r4(t,e){var n=t.o,r=e.indexOf(`
`,n);return r==-1?ow:(n=Number(e.substring(n,r)),isNaN(n)?TM:(r+=1,r+n>e.length?ow:(e=e.slice(r,r+n),t.o=r+n,e)))}A.cancel=function(){this.J=!0,ws(this)};function Lc(t){t.Y=Date.now()+t.P,xM(t,t.P)}function xM(t,e){if(t.C!=null)throw Error("WatchDog timer not null");t.C=Oc(Dt(t.lb,t),e)}function $f(t){t.C&&(z.clearTimeout(t.C),t.C=null)}A.lb=function(){this.C=null;let t=Date.now();0<=t-this.Y?(e4(this.j,this.B),this.L!=2&&(Mc(),Rt(17)),ws(this),this.s=2,Dc(this)):xM(this,this.Y-t)};function Dc(t){t.l.H==0||t.J||ZM(t.l,t)}function ws(t){$f(t);var e=t.M;e&&typeof e.sa=="function"&&e.sa(),t.M=null,Iw(t.V),_M(t.U),t.g&&(e=t.g,t.g=null,e.abort(),e.sa())}function uw(t,e){try{var n=t.l;if(n.H!=0&&(n.g==t||cw(n.i,t))){if(!t.K&&cw(n.i,t)&&n.H==3){try{var r=n.Ja.g.parse(e)}catch{r=null}if(Array.isArray(r)&&r.length==3){var i=r;if(i[0]==0){e:if(!n.u){if(n.g)if(n.g.G+3e3<t.G)xf(n),zf(n);else break e;Rw(n),Rt(18)}}else n.Fa=i[1],0<n.Fa-n.V&&37500>i[2]&&n.G&&n.A==0&&!n.v&&(n.v=Oc(Dt(n.ib,n),6e3));if(1>=VM(n.i)&&n.oa){try{n.oa()}catch{}n.oa=void 0}}else Es(n,11)}else if((t.K||n.g==t)&&xf(n),!Tc(e))for(i=n.Ja.g.parse(e),e=0;e<i.length;e++){let c=i[e];if(n.V=c[0],c=c[1],n.H==2)if(c[0]=="c"){n.K=c[1],n.pa=c[2];let l=c[3];l!=null&&(n.ra=l,n.l.info("VER="+n.ra));let d=c[4];d!=null&&(n.Ga=d,n.l.info("SVER="+n.Ga));let h=c[5];h!=null&&typeof h=="number"&&0<h&&(r=1.5*h,n.L=r,n.l.info("backChannelRequestTimeoutMs_="+r)),r=n;let f=t.g;if(f){let p=f.g?f.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(p){var s=r.i;s.g||p.indexOf("spdy")==-1&&p.indexOf("quic")==-1&&p.indexOf("h2")==-1||(s.j=s.l,s.g=new Set,s.h&&(Sw(s,s.h),s.h=null))}if(r.F){let g=f.g?f.g.getResponseHeader("X-HTTP-Session-Id"):null;g&&(r.Da=g,Ae(r.I,r.F,g))}}n.H=3,n.h&&n.h.Ba(),n.ca&&(n.S=Date.now()-t.G,n.l.info("Handshake RTT: "+n.S+"ms")),r=n;var o=t;if(r.wa=eR(r,r.J?r.pa:null,r.Y),o.K){LM(r.i,o);var a=o,u=r.L;u&&a.setTimeout(u),a.C&&($f(a),Lc(a)),r.g=o}else QM(r);0<n.j.length&&Wf(n)}else c[0]!="stop"&&c[0]!="close"||Es(n,7);else n.H==3&&(c[0]=="stop"||c[0]=="close"?c[0]=="stop"?Es(n,7):Mw(n):c[0]!="noop"&&n.h&&n.h.Aa(c),n.A=0)}}Mc(4)}catch{}}function i4(t){if(t.Z&&typeof t.Z=="function")return t.Z();if(typeof Map<"u"&&t instanceof Map||typeof Set<"u"&&t instanceof Set)return Array.from(t.values());if(typeof t=="string")return t.split("");if(Pf(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}e=[],n=0;for(r in t)e[n++]=t[r];return e}function s4(t){if(t.ta&&typeof t.ta=="function")return t.ta();if(!t.Z||typeof t.Z!="function"){if(typeof Map<"u"&&t instanceof Map)return Array.from(t.keys());if(!(typeof Set<"u"&&t instanceof Set)){if(Pf(t)||typeof t=="string"){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}e=[],n=0;for(let r in t)e[n++]=r;return e}}}function MM(t,e){if(t.forEach&&typeof t.forEach=="function")t.forEach(e,void 0);else if(Pf(t)||typeof t=="string")Array.prototype.forEach.call(t,e,void 0);else for(var n=s4(t),r=i4(t),i=r.length,s=0;s<i;s++)e.call(void 0,r[s],n&&n[s],t)}var RM=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function o4(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var s=t[n].substring(0,r);i=t[n].substring(r+1)}else s=t[n];e(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}function Is(t){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,t instanceof Is){this.h=t.h,Sf(this,t.j),this.s=t.s,this.g=t.g,Af(this,t.m),this.l=t.l;var e=t.i,n=new Rc;n.i=e.i,e.g&&(n.g=new Map(e.g),n.h=e.h),Yx(this,n),this.o=t.o}else t&&(e=String(t).match(RM))?(this.h=!1,Sf(this,e[1]||"",!0),this.s=Ic(e[2]||""),this.g=Ic(e[3]||"",!0),Af(this,e[4]),this.l=Ic(e[5]||"",!0),Yx(this,e[6]||"",!0),this.o=Ic(e[7]||"")):(this.h=!1,this.i=new Rc(null,this.h))}Is.prototype.toString=function(){var t=[],e=this.j;e&&t.push(Cc(e,Zx,!0),":");var n=this.g;return(n||e=="file")&&(t.push("//"),(e=this.s)&&t.push(Cc(e,Zx,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n=this.m,n!=null&&t.push(":",String(n))),(n=this.l)&&(this.g&&n.charAt(0)!="/"&&t.push("/"),t.push(Cc(n,n.charAt(0)=="/"?c4:u4,!0))),(n=this.i.toString())&&t.push("?",n),(n=this.o)&&t.push("#",Cc(n,d4)),t.join("")};function kr(t){return new Is(t)}function Sf(t,e,n){t.j=n?Ic(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function Af(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function Yx(t,e,n){e instanceof Rc?(t.i=e,h4(t.i,t.h)):(n||(e=Cc(e,l4)),t.i=new Rc(e,t.h))}function Ae(t,e,n){t.i.set(e,n)}function Hf(t){return Ae(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function Ic(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Cc(t,e,n){return typeof t=="string"?(t=encodeURI(t).replace(e,a4),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function a4(t){return t=t.charCodeAt(0),"%"+(t>>4&15).toString(16)+(t&15).toString(16)}var Zx=/[#\/\?@]/g,u4=/[#\?:]/g,c4=/[#\?]/g,l4=/[#\?@]/g,d4=/#/g;function Rc(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function mi(t){t.g||(t.g=new Map,t.h=0,t.i&&o4(t.i,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}A=Rc.prototype;A.add=function(t,e){mi(this),this.i=null,t=ua(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this};function NM(t,e){mi(t),e=ua(t,e),t.g.has(e)&&(t.i=null,t.h-=t.g.get(e).length,t.g.delete(e))}function PM(t,e){return mi(t),e=ua(t,e),t.g.has(e)}A.forEach=function(t,e){mi(this),this.g.forEach(function(n,r){n.forEach(function(i){t.call(e,i,r,this)},this)},this)};A.ta=function(){mi(this);let t=Array.from(this.g.values()),e=Array.from(this.g.keys()),n=[];for(let r=0;r<e.length;r++){let i=t[r];for(let s=0;s<i.length;s++)n.push(e[r])}return n};A.Z=function(t){mi(this);let e=[];if(typeof t=="string")PM(this,t)&&(e=e.concat(this.g.get(ua(this,t))));else{t=Array.from(this.g.values());for(let n=0;n<t.length;n++)e=e.concat(t[n])}return e};A.set=function(t,e){return mi(this),this.i=null,t=ua(this,t),PM(this,t)&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this};A.get=function(t,e){return t?(t=this.Z(t),0<t.length?String(t[0]):e):e};function kM(t,e,n){NM(t,e),0<n.length&&(t.i=null,t.g.set(ua(t,e),fw(n)),t.h+=n.length)}A.toString=function(){if(this.i)return this.i;if(!this.g)return"";let t=[],e=Array.from(this.g.keys());for(var n=0;n<e.length;n++){var r=e[n];let s=encodeURIComponent(String(r)),o=this.Z(r);for(r=0;r<o.length;r++){var i=s;o[r]!==""&&(i+="="+encodeURIComponent(String(o[r]))),t.push(i)}}return this.i=t.join("&")};function ua(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function h4(t,e){e&&!t.j&&(mi(t),t.i=null,t.g.forEach(function(n,r){var i=r.toLowerCase();r!=i&&(NM(this,r),kM(this,i,n))},t)),t.j=e}var f4=class{constructor(t,e){this.g=t,this.map=e}};function OM(t){this.l=t||p4,z.PerformanceNavigationTiming?(t=z.performance.getEntriesByType("navigation"),t=0<t.length&&(t[0].nextHopProtocol=="hq"||t[0].nextHopProtocol=="h2")):t=!!(z.g&&z.g.Ka&&z.g.Ka()&&z.g.Ka().dc),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var p4=10;function FM(t){return t.h?!0:t.g?t.g.size>=t.j:!1}function VM(t){return t.h?1:t.g?t.g.size:0}function cw(t,e){return t.h?t.h==e:t.g?t.g.has(e):!1}function Sw(t,e){t.g?t.g.add(e):t.h=e}function LM(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}OM.prototype.cancel=function(){if(this.i=jM(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let t of this.g.values())t.cancel();this.g.clear()}};function jM(t){if(t.h!=null)return t.i.concat(t.h.F);if(t.g!=null&&t.g.size!==0){let e=t.i;for(let n of t.g.values())e=e.concat(n.F);return e}return fw(t.i)}var g4=class{stringify(t){return z.JSON.stringify(t,void 0)}parse(t){return z.JSON.parse(t,void 0)}};function m4(){this.g=new g4}function y4(t,e,n){let r=n||"";try{MM(t,function(i,s){let o=i;Pc(i)&&(o=ww(i)),e.push(r+s+"="+encodeURIComponent(o))})}catch(i){throw e.push(r+"type="+encodeURIComponent("_badmap")),i}}function _4(t,e){let n=new Lf;if(z.Image){let r=new Image;r.onload=wf(Tf,n,r,"TestLoadImage: loaded",!0,e),r.onerror=wf(Tf,n,r,"TestLoadImage: error",!1,e),r.onabort=wf(Tf,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=wf(Tf,n,r,"TestLoadImage: timeout",!1,e),z.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}function Tf(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch{}}function jc(t){this.l=t.ec||null,this.j=t.ob||!1}ct(jc,Dw);jc.prototype.g=function(){return new qf(this.l,this.j)};jc.prototype.i=function(t){return function(){return t}}({});function qf(t,e){ut.call(this),this.F=t,this.u=e,this.m=void 0,this.readyState=Aw,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}ct(qf,ut);var Aw=0;A=qf.prototype;A.open=function(t,e){if(this.readyState!=Aw)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,Nc(this)};A.send=function(t){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.F||z).fetch(new Request(this.B,e)).then(this.$a.bind(this),this.ka.bind(this))};A.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Uc(this)),this.readyState=Aw};A.$a=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,Nc(this)),this.g&&(this.readyState=3,Nc(this),this.g)))if(this.responseType==="arraybuffer")t.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(typeof z.ReadableStream<"u"&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;UM(this)}else t.text().then(this.Za.bind(this),this.ka.bind(this))};function UM(t){t.j.read().then(t.Xa.bind(t)).catch(t.ka.bind(t))}A.Xa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?Uc(this):Nc(this),this.readyState==3&&UM(this)}};A.Za=function(t){this.g&&(this.response=this.responseText=t,Uc(this))};A.Ya=function(t){this.g&&(this.response=t,Uc(this))};A.ka=function(){this.g&&Uc(this)};function Uc(t){t.readyState=4,t.l=null,t.j=null,t.A=null,Nc(t)}A.setRequestHeader=function(t,e){this.v.append(t,e)};A.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""};A.getAllResponseHeaders=function(){if(!this.h)return"";let t=[],e=this.h.entries();for(var n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join(`\r
`)};function Nc(t){t.onreadystatechange&&t.onreadystatechange.call(t)}Object.defineProperty(qf.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(t){this.m=t?"include":"same-origin"}});var v4=z.JSON.parse;function Ve(t){ut.call(this),this.headers=new Map,this.u=t||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=BM,this.L=this.M=!1}ct(Ve,ut);var BM="",w4=/^https?$/i,E4=["POST","PUT"];A=Ve.prototype;A.Oa=function(t){this.M=t};A.ha=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+t);e=e?e.toUpperCase():"GET",this.I=t,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():sw.g(),this.C=this.u?Qx(this.u):Qx(sw),this.g.onreadystatechange=Dt(this.La,this);try{this.G=!0,this.g.open(e,String(t),!0),this.G=!1}catch(s){Xx(this,s);return}if(t=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)n.set(i,r[i]);else if(typeof r.keys=="function"&&typeof r.get=="function")for(let s of r.keys())n.set(s,r.get(s));else throw Error("Unknown input type for opt_headers: "+String(r));r=Array.from(n.keys()).find(s=>s.toLowerCase()=="content-type"),i=z.FormData&&t instanceof z.FormData,!(0<=rM(E4,e))||r||i||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[s,o]of n)this.g.setRequestHeader(s,o);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{qM(this),0<this.B&&((this.L=I4(this.g))?(this.g.timeout=this.B,this.g.ontimeout=Dt(this.ua,this)):this.A=Cw(this.ua,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(s){Xx(this,s)}};function I4(t){return aa&&typeof t.timeout=="number"&&t.ontimeout!==void 0}A.ua=function(){typeof hw<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,vt(this,"timeout"),this.abort(8))};function Xx(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,$M(t),Gf(t)}function $M(t){t.F||(t.F=!0,vt(t,"complete"),vt(t,"error"))}A.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,vt(this,"complete"),vt(this,"abort"),Gf(this))};A.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Gf(this,!0)),Ve.$.N.call(this)};A.La=function(){this.s||(this.G||this.v||this.l?HM(this):this.kb())};A.kb=function(){HM(this)};function HM(t){if(t.h&&typeof hw<"u"&&(!t.C[1]||sr(t)!=4||t.da()!=2)){if(t.v&&sr(t)==4)Cw(t.La,0,t);else if(vt(t,"readystatechange"),sr(t)==4){t.h=!1;try{let o=t.da();e:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var n;if(!(n=e)){var r;if(r=o===0){var i=String(t.I).match(RM)[1]||null;!i&&z.self&&z.self.location&&(i=z.self.location.protocol.slice(0,-1)),r=!w4.test(i?i.toLowerCase():"")}n=r}if(n)vt(t,"complete"),vt(t,"success");else{t.m=6;try{var s=2<sr(t)?t.g.statusText:""}catch{s=""}t.j=s+" ["+t.da()+"]",$M(t)}}finally{Gf(t)}}}}function Gf(t,e){if(t.g){qM(t);let n=t.g,r=t.C[0]?()=>{}:null;t.g=null,t.C=null,e||vt(t,"ready");try{n.onreadystatechange=r}catch{}}}function qM(t){t.g&&t.L&&(t.g.ontimeout=null),t.A&&(z.clearTimeout(t.A),t.A=null)}A.isActive=function(){return!!this.g};function sr(t){return t.g?t.g.readyState:0}A.da=function(){try{return 2<sr(this)?this.g.status:-1}catch{return-1}};A.ja=function(){try{return this.g?this.g.responseText:""}catch{return""}};A.Wa=function(t){if(this.g){var e=this.g.responseText;return t&&e.indexOf(t)==0&&(e=e.substring(t.length)),v4(e)}};function Jx(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.K){case BM:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch{return null}}function C4(t){let e={};t=(t.g&&2<=sr(t)&&t.g.getAllResponseHeaders()||"").split(`\r
`);for(let r=0;r<t.length;r++){if(Tc(t[r]))continue;var n=Qq(t[r]);let i=n[0];if(n=n[1],typeof n!="string")continue;n=n.trim();let s=e[i]||[];e[i]=s,s.push(n)}Gq(e,function(r){return r.join(", ")})}A.Ia=function(){return this.m};A.Sa=function(){return typeof this.j=="string"?this.j:String(this.j)};function GM(t){let e="";return gw(t,function(n,r){e+=r,e+=":",e+=n,e+=`\r
`}),e}function xw(t,e,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=GM(n),typeof t=="string"?n!=null&&encodeURIComponent(String(n)):Ae(t,e,n))}function wc(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function zM(t){this.Ga=0,this.j=[],this.l=new Lf,this.pa=this.wa=this.I=this.Y=this.g=this.Da=this.F=this.na=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=wc("failFast",!1,t),this.G=this.v=this.u=this.m=this.h=null,this.aa=!0,this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=wc("baseRetryDelayMs",5e3,t),this.hb=wc("retryDelaySeedMs",1e4,t),this.eb=wc("forwardChannelMaxRetries",2,t),this.xa=wc("forwardChannelRequestTimeoutMs",2e4,t),this.va=t&&t.xmlHttpFactory||void 0,this.Ha=t&&t.useFetchStreams||!1,this.L=void 0,this.J=t&&t.supportsCrossDomainXhr||!1,this.K="",this.i=new OM(t&&t.concurrentRequestLimit),this.Ja=new m4,this.P=t&&t.fastHandshake||!1,this.O=t&&t.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=t&&t.bc||!1,t&&t.Ea&&this.l.Ea(),t&&t.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&t&&t.detectBufferingProxy||!1,this.qa=void 0,t&&t.longPollingTimeout&&0<t.longPollingTimeout&&(this.qa=t.longPollingTimeout),this.oa=void 0,this.S=0,this.M=!1,this.ma=this.B=null}A=zM.prototype;A.ra=8;A.H=1;function Mw(t){if(WM(t),t.H==3){var e=t.W++,n=kr(t.I);if(Ae(n,"SID",t.K),Ae(n,"RID",e),Ae(n,"TYPE","terminate"),Bc(t,n),e=new Vc(t,t.l,e),e.L=2,e.A=Hf(kr(n)),n=!1,z.navigator&&z.navigator.sendBeacon)try{n=z.navigator.sendBeacon(e.A.toString(),"")}catch{}!n&&z.Image&&(new Image().src=e.A,n=!0),n||(e.g=tR(e.l,null),e.g.ha(e.A)),e.G=Date.now(),Lc(e)}JM(t)}function zf(t){t.g&&(Nw(t),t.g.cancel(),t.g=null)}function WM(t){zf(t),t.u&&(z.clearTimeout(t.u),t.u=null),xf(t),t.i.cancel(),t.m&&(typeof t.m=="number"&&z.clearTimeout(t.m),t.m=null)}function Wf(t){if(!FM(t.i)&&!t.m){t.m=!0;var e=t.Na;Sc||gM(),Ac||(Sc(),Ac=!0),Ew.add(e,t),t.C=0}}function D4(t,e){return VM(t.i)>=t.i.j-(t.m?1:0)?!1:t.m?(t.j=e.F.concat(t.j),!0):t.H==1||t.H==2||t.C>=(t.cb?0:t.eb)?!1:(t.m=Oc(Dt(t.Na,t,e),XM(t,t.C)),t.C++,!0)}A.Na=function(t){if(this.m)if(this.m=null,this.H==1){if(!t){this.W=Math.floor(1e5*Math.random()),t=this.W++;let i=new Vc(this,this.l,t),s=this.s;if(this.U&&(s?(s=aM(s),uM(s,this.U)):s=this.U),this.o!==null||this.O||(i.I=s,s=null),this.P)e:{for(var e=0,n=0;n<this.j.length;n++){t:{var r=this.j[n];if("__data__"in r.map&&(r=r.map.__data__,typeof r=="string")){r=r.length;break t}r=void 0}if(r===void 0)break;if(e+=r,4096<e){e=n;break e}if(e===4096||n===this.j.length-1){e=n+1;break e}}e=1e3}else e=1e3;e=KM(this,i,e),n=kr(this.I),Ae(n,"RID",t),Ae(n,"CVER",22),this.F&&Ae(n,"X-HTTP-Session-Id",this.F),Bc(this,n),s&&(this.O?e="headers="+encodeURIComponent(String(GM(s)))+"&"+e:this.o&&xw(n,this.o,s)),Sw(this.i,i),this.bb&&Ae(n,"TYPE","init"),this.P?(Ae(n,"$req",e),Ae(n,"SID","null"),i.aa=!0,aw(i,n,null)):aw(i,n,e),this.H=2}}else this.H==3&&(t?eM(this,t):this.j.length==0||FM(this.i)||eM(this))};function eM(t,e){var n;e?n=e.m:n=t.W++;let r=kr(t.I);Ae(r,"SID",t.K),Ae(r,"RID",n),Ae(r,"AID",t.V),Bc(t,r),t.o&&t.s&&xw(r,t.o,t.s),n=new Vc(t,t.l,n,t.C+1),t.o===null&&(n.I=t.s),e&&(t.j=e.F.concat(t.j)),e=KM(t,n,1e3),n.setTimeout(Math.round(.5*t.xa)+Math.round(.5*t.xa*Math.random())),Sw(t.i,n),aw(n,r,e)}function Bc(t,e){t.na&&gw(t.na,function(n,r){Ae(e,r,n)}),t.h&&MM({},function(n,r){Ae(e,r,n)})}function KM(t,e,n){n=Math.min(t.j.length,n);var r=t.h?Dt(t.h.Va,t.h,t):null;e:{var i=t.j;let s=-1;for(;;){let o=["count="+n];s==-1?0<n?(s=i[0].g,o.push("ofs="+s)):s=0:o.push("ofs="+s);let a=!0;for(let u=0;u<n;u++){let c=i[u].g,l=i[u].map;if(c-=s,0>c)s=Math.max(0,i[u].g-100),a=!1;else try{y4(l,o,"req"+c+"_")}catch{r&&r(l)}}if(a){r=o.join("&");break e}}}return t=t.j.splice(0,n),e.F=t,r}function QM(t){if(!t.g&&!t.u){t.ba=1;var e=t.Ma;Sc||gM(),Ac||(Sc(),Ac=!0),Ew.add(e,t),t.A=0}}function Rw(t){return t.g||t.u||3<=t.A?!1:(t.ba++,t.u=Oc(Dt(t.Ma,t),XM(t,t.A)),t.A++,!0)}A.Ma=function(){if(this.u=null,YM(this),this.ca&&!(this.M||this.g==null||0>=this.S)){var t=2*this.S;this.l.info("BP detection timer enabled: "+t),this.B=Oc(Dt(this.jb,this),t)}};A.jb=function(){this.B&&(this.B=null,this.l.info("BP detection timeout reached."),this.l.info("Buffering proxy detected and switch to long-polling!"),this.G=!1,this.M=!0,Rt(10),zf(this),YM(this))};function Nw(t){t.B!=null&&(z.clearTimeout(t.B),t.B=null)}function YM(t){t.g=new Vc(t,t.l,"rpc",t.ba),t.o===null&&(t.g.I=t.s),t.g.O=0;var e=kr(t.wa);Ae(e,"RID","rpc"),Ae(e,"SID",t.K),Ae(e,"AID",t.V),Ae(e,"CI",t.G?"0":"1"),!t.G&&t.qa&&Ae(e,"TO",t.qa),Ae(e,"TYPE","xmlhttp"),Bc(t,e),t.o&&t.s&&xw(e,t.o,t.s),t.L&&t.g.setTimeout(t.L);var n=t.g;t=t.pa,n.L=1,n.A=Hf(kr(e)),n.u=null,n.S=!0,bM(n,t)}A.ib=function(){this.v!=null&&(this.v=null,zf(this),Rw(this),Rt(19))};function xf(t){t.v!=null&&(z.clearTimeout(t.v),t.v=null)}function ZM(t,e){var n=null;if(t.g==e){xf(t),Nw(t),t.g=null;var r=2}else if(cw(t.i,e))n=e.F,LM(t.i,e),r=1;else return;if(t.H!=0){if(e.i)if(r==1){n=e.u?e.u.length:0,e=Date.now()-e.G;var i=t.C;r=jf(),vt(r,new EM(r,n)),Wf(t)}else QM(t);else if(i=e.s,i==3||i==0&&0<e.ca||!(r==1&&D4(t,e)||r==2&&Rw(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),i){case 1:Es(t,5);break;case 4:Es(t,10);break;case 3:Es(t,6);break;default:Es(t,2)}}}function XM(t,e){let n=t.ab+Math.floor(Math.random()*t.hb);return t.isActive()||(n*=2),n*e}function Es(t,e){if(t.l.info("Error code "+e),e==2){var n=null;t.h&&(n=null);var r=Dt(t.pb,t);n||(n=new Is("//www.google.com/images/cleardot.gif"),z.location&&z.location.protocol=="http"||Sf(n,"https"),Hf(n)),_4(n.toString(),r)}else Rt(2);t.H=0,t.h&&t.h.za(e),JM(t),WM(t)}A.pb=function(t){t?(this.l.info("Successfully pinged google.com"),Rt(2)):(this.l.info("Failed to ping google.com"),Rt(1))};function JM(t){if(t.H=0,t.ma=[],t.h){let e=jM(t.i);(e.length!=0||t.j.length!=0)&&(Gx(t.ma,e),Gx(t.ma,t.j),t.i.i.length=0,fw(t.j),t.j.length=0),t.h.ya()}}function eR(t,e,n){var r=n instanceof Is?kr(n):new Is(n);if(r.g!="")e&&(r.g=e+"."+r.g),Af(r,r.m);else{var i=z.location;r=i.protocol,e=e?e+"."+i.hostname:i.hostname,i=+i.port;var s=new Is(null);r&&Sf(s,r),e&&(s.g=e),i&&Af(s,i),n&&(s.l=n),r=s}return n=t.F,e=t.Da,n&&e&&Ae(r,n,e),Ae(r,"VER",t.ra),Bc(t,r),r}function tR(t,e,n){if(e&&!t.J)throw Error("Can't create secondary domain capable XhrIo object.");return e=t.Ha&&!t.va?new Ve(new jc({ob:n})):new Ve(t.va),e.Oa(t.J),e}A.isActive=function(){return!!this.h&&this.h.isActive(this)};function nR(){}A=nR.prototype;A.Ba=function(){};A.Aa=function(){};A.za=function(){};A.ya=function(){};A.isActive=function(){return!0};A.Va=function(){};function Mf(){if(aa&&!(10<=Number(Bq)))throw Error("Environmental error: no available transport.")}Mf.prototype.g=function(t,e){return new Zt(t,e)};function Zt(t,e){ut.call(this),this.g=new zM(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ca&&(t?t["X-WebChannel-Client-Profile"]=e.Ca:t={"X-WebChannel-Client-Profile":e.Ca}),this.g.U=t,(t=e&&e.cc)&&!Tc(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!Tc(e)&&(this.g.F=e,t=this.h,t!==null&&e in t&&(t=this.h,e in t&&delete t[e])),this.j=new ca(this)}ct(Zt,ut);Zt.prototype.m=function(){this.g.h=this.j,this.A&&(this.g.J=!0);var t=this.g,e=this.l,n=this.h||void 0;Rt(0),t.Y=e,t.na=n||{},t.G=t.aa,t.I=eR(t,null,t.Y),Wf(t)};Zt.prototype.close=function(){Mw(this.g)};Zt.prototype.u=function(t){var e=this.g;if(typeof t=="string"){var n={};n.__data__=t,t=n}else this.v&&(n={},n.__data__=ww(t),t=n);e.j.push(new f4(e.fb++,t)),e.H==3&&Wf(e)};Zt.prototype.N=function(){this.g.h=null,delete this.j,Mw(this.g),delete this.g,Zt.$.N.call(this)};function rR(t){Tw.call(this),t.__headers__&&(this.headers=t.__headers__,this.statusCode=t.__status__,delete t.__headers__,delete t.__status__);var e=t.__sm__;if(e){e:{for(let n in e){t=n;break e}t=void 0}(this.i=t)&&(t=this.i,e=e!==null&&t in e?e[t]:void 0),this.data=e}else this.data=t}ct(rR,Tw);function iR(){bw.call(this),this.status=1}ct(iR,bw);function ca(t){this.g=t}ct(ca,nR);ca.prototype.Ba=function(){vt(this.g,"a")};ca.prototype.Aa=function(t){vt(this.g,new rR(t))};ca.prototype.za=function(t){vt(this.g,new iR)};ca.prototype.ya=function(){vt(this.g,"b")};function T4(){this.blockSize=-1}function On(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}ct(On,T4);On.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0};function Qv(t,e,n){n||(n=0);var r=Array(16);if(typeof e=="string")for(var i=0;16>i;++i)r[i]=e.charCodeAt(n++)|e.charCodeAt(n++)<<8|e.charCodeAt(n++)<<16|e.charCodeAt(n++)<<24;else for(i=0;16>i;++i)r[i]=e[n++]|e[n++]<<8|e[n++]<<16|e[n++]<<24;e=t.g[0],n=t.g[1],i=t.g[2];var s=t.g[3],o=e+(s^n&(i^s))+r[0]+3614090360&4294967295;e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[1]+3905402710&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[2]+606105819&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[3]+3250441966&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(s^n&(i^s))+r[4]+4118548399&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[5]+1200080426&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[6]+2821735955&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[7]+4249261313&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(s^n&(i^s))+r[8]+1770035416&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[9]+2336552879&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[10]+4294925233&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[11]+2304563134&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(s^n&(i^s))+r[12]+1804603682&4294967295,e=n+(o<<7&4294967295|o>>>25),o=s+(i^e&(n^i))+r[13]+4254626195&4294967295,s=e+(o<<12&4294967295|o>>>20),o=i+(n^s&(e^n))+r[14]+2792965006&4294967295,i=s+(o<<17&4294967295|o>>>15),o=n+(e^i&(s^e))+r[15]+1236535329&4294967295,n=i+(o<<22&4294967295|o>>>10),o=e+(i^s&(n^i))+r[1]+4129170786&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[6]+3225465664&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[11]+643717713&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[0]+3921069994&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(n^i))+r[5]+3593408605&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[10]+38016083&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[15]+3634488961&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[4]+3889429448&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(n^i))+r[9]+568446438&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[14]+3275163606&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[3]+4107603335&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[8]+1163531501&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(i^s&(n^i))+r[13]+2850285829&4294967295,e=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(e^n))+r[2]+4243563512&4294967295,s=e+(o<<9&4294967295|o>>>23),o=i+(e^n&(s^e))+r[7]+1735328473&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^e&(i^s))+r[12]+2368359562&4294967295,n=i+(o<<20&4294967295|o>>>12),o=e+(n^i^s)+r[5]+4294588738&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[8]+2272392833&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[11]+1839030562&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[14]+4259657740&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(n^i^s)+r[1]+2763975236&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[4]+1272893353&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[7]+4139469664&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[10]+3200236656&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(n^i^s)+r[13]+681279174&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[0]+3936430074&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[3]+3572445317&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[6]+76029189&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(n^i^s)+r[9]+3654602809&4294967295,e=n+(o<<4&4294967295|o>>>28),o=s+(e^n^i)+r[12]+3873151461&4294967295,s=e+(o<<11&4294967295|o>>>21),o=i+(s^e^n)+r[15]+530742520&4294967295,i=s+(o<<16&4294967295|o>>>16),o=n+(i^s^e)+r[2]+3299628645&4294967295,n=i+(o<<23&4294967295|o>>>9),o=e+(i^(n|~s))+r[0]+4096336452&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[7]+1126891415&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[14]+2878612391&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[5]+4237533241&4294967295,n=i+(o<<21&4294967295|o>>>11),o=e+(i^(n|~s))+r[12]+1700485571&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[3]+2399980690&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[10]+4293915773&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[1]+2240044497&4294967295,n=i+(o<<21&4294967295|o>>>11),o=e+(i^(n|~s))+r[8]+1873313359&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[15]+4264355552&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[6]+2734768916&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[13]+1309151649&4294967295,n=i+(o<<21&4294967295|o>>>11),o=e+(i^(n|~s))+r[4]+4149444226&4294967295,e=n+(o<<6&4294967295|o>>>26),o=s+(n^(e|~i))+r[11]+3174756917&4294967295,s=e+(o<<10&4294967295|o>>>22),o=i+(e^(s|~n))+r[2]+718787259&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~e))+r[9]+3951481745&4294967295,t.g[0]=t.g[0]+e&4294967295,t.g[1]=t.g[1]+(i+(o<<21&4294967295|o>>>11))&4294967295,t.g[2]=t.g[2]+i&4294967295,t.g[3]=t.g[3]+s&4294967295}On.prototype.j=function(t,e){e===void 0&&(e=t.length);for(var n=e-this.blockSize,r=this.m,i=this.h,s=0;s<e;){if(i==0)for(;s<=n;)Qv(this,t,s),s+=this.blockSize;if(typeof t=="string"){for(;s<e;)if(r[i++]=t.charCodeAt(s++),i==this.blockSize){Qv(this,r),i=0;break}}else for(;s<e;)if(r[i++]=t[s++],i==this.blockSize){Qv(this,r),i=0;break}}this.h=i,this.i+=e};On.prototype.l=function(){var t=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);t[0]=128;for(var e=1;e<t.length-8;++e)t[e]=0;var n=8*this.i;for(e=t.length-8;e<t.length;++e)t[e]=n&255,n/=256;for(this.j(t),t=Array(16),e=n=0;4>e;++e)for(var r=0;32>r;r+=8)t[n++]=this.g[e]>>>r&255;return t};function ve(t,e){this.h=e;for(var n=[],r=!0,i=t.length-1;0<=i;i--){var s=t[i]|0;r&&s==e||(n[i]=s,r=!1)}this.g=n}var b4={};function Pw(t){return-128<=t&&128>t?Lq(t,function(e){return new ve([e|0],0>e?-1:0)}):new ve([t|0],0>t?-1:0)}function or(t){if(isNaN(t)||!isFinite(t))return oa;if(0>t)return _t(or(-t));for(var e=[],n=1,r=0;t>=n;r++)e[r]=t/n|0,n*=lw;return new ve(e,0)}function sR(t,e){if(t.length==0)throw Error("number format error: empty string");if(e=e||10,2>e||36<e)throw Error("radix out of range: "+e);if(t.charAt(0)=="-")return _t(sR(t.substring(1),e));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var n=or(Math.pow(e,8)),r=oa,i=0;i<t.length;i+=8){var s=Math.min(8,t.length-i),o=parseInt(t.substring(i,i+s),e);8>s?(s=or(Math.pow(e,s)),r=r.R(s).add(or(o))):(r=r.R(n),r=r.add(or(o)))}return r}var lw=4294967296,oa=Pw(0),dw=Pw(1),tM=Pw(16777216);A=ve.prototype;A.ea=function(){if(yn(this))return-_t(this).ea();for(var t=0,e=1,n=0;n<this.g.length;n++){var r=this.D(n);t+=(0<=r?r:lw+r)*e,e*=lw}return t};A.toString=function(t){if(t=t||10,2>t||36<t)throw Error("radix out of range: "+t);if(Pr(this))return"0";if(yn(this))return"-"+_t(this).toString(t);for(var e=or(Math.pow(t,6)),n=this,r="";;){var i=Nf(n,e).g;n=Rf(n,i.R(e));var s=((0<n.g.length?n.g[0]:n.h)>>>0).toString(t);if(n=i,Pr(n))return s+r;for(;6>s.length;)s="0"+s;r=s+r}};A.D=function(t){return 0>t?0:t<this.g.length?this.g[t]:this.h};function Pr(t){if(t.h!=0)return!1;for(var e=0;e<t.g.length;e++)if(t.g[e]!=0)return!1;return!0}function yn(t){return t.h==-1}A.X=function(t){return t=Rf(this,t),yn(t)?-1:Pr(t)?0:1};function _t(t){for(var e=t.g.length,n=[],r=0;r<e;r++)n[r]=~t.g[r];return new ve(n,~t.h).add(dw)}A.abs=function(){return yn(this)?_t(this):this};A.add=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0,i=0;i<=e;i++){var s=r+(this.D(i)&65535)+(t.D(i)&65535),o=(s>>>16)+(this.D(i)>>>16)+(t.D(i)>>>16);r=o>>>16,s&=65535,o&=65535,n[i]=o<<16|s}return new ve(n,n[n.length-1]&-2147483648?-1:0)};function Rf(t,e){return t.add(_t(e))}A.R=function(t){if(Pr(this)||Pr(t))return oa;if(yn(this))return yn(t)?_t(this).R(_t(t)):_t(_t(this).R(t));if(yn(t))return _t(this.R(_t(t)));if(0>this.X(tM)&&0>t.X(tM))return or(this.ea()*t.ea());for(var e=this.g.length+t.g.length,n=[],r=0;r<2*e;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var i=0;i<t.g.length;i++){var s=this.D(r)>>>16,o=this.D(r)&65535,a=t.D(i)>>>16,u=t.D(i)&65535;n[2*r+2*i]+=o*u,bf(n,2*r+2*i),n[2*r+2*i+1]+=s*u,bf(n,2*r+2*i+1),n[2*r+2*i+1]+=o*a,bf(n,2*r+2*i+1),n[2*r+2*i+2]+=s*a,bf(n,2*r+2*i+2)}for(r=0;r<e;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=e;r<2*e;r++)n[r]=0;return new ve(n,0)};function bf(t,e){for(;(t[e]&65535)!=t[e];)t[e+1]+=t[e]>>>16,t[e]&=65535,e++}function Ec(t,e){this.g=t,this.h=e}function Nf(t,e){if(Pr(e))throw Error("division by zero");if(Pr(t))return new Ec(oa,oa);if(yn(t))return e=Nf(_t(t),e),new Ec(_t(e.g),_t(e.h));if(yn(e))return e=Nf(t,_t(e)),new Ec(_t(e.g),e.h);if(30<t.g.length){if(yn(t)||yn(e))throw Error("slowDivide_ only works with positive integers.");for(var n=dw,r=e;0>=r.X(t);)n=nM(n),r=nM(r);var i=ia(n,1),s=ia(r,1);for(r=ia(r,2),n=ia(n,2);!Pr(r);){var o=s.add(r);0>=o.X(t)&&(i=i.add(n),s=o),r=ia(r,1),n=ia(n,1)}return e=Rf(t,i.R(e)),new Ec(i,e)}for(i=oa;0<=t.X(e);){for(n=Math.max(1,Math.floor(t.ea()/e.ea())),r=Math.ceil(Math.log(n)/Math.LN2),r=48>=r?1:Math.pow(2,r-48),s=or(n),o=s.R(e);yn(o)||0<o.X(t);)n-=r,s=or(n),o=s.R(e);Pr(s)&&(s=dw),i=i.add(s),t=Rf(t,o)}return new Ec(i,t)}A.gb=function(t){return Nf(this,t).h};A.and=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)&t.D(r);return new ve(n,this.h&t.h)};A.or=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)|t.D(r);return new ve(n,this.h|t.h)};A.xor=function(t){for(var e=Math.max(this.g.length,t.g.length),n=[],r=0;r<e;r++)n[r]=this.D(r)^t.D(r);return new ve(n,this.h^t.h)};function nM(t){for(var e=t.g.length+1,n=[],r=0;r<e;r++)n[r]=t.D(r)<<1|t.D(r-1)>>>31;return new ve(n,t.h)}function ia(t,e){var n=e>>5;e%=32;for(var r=t.g.length-n,i=[],s=0;s<r;s++)i[s]=0<e?t.D(s+n)>>>e|t.D(s+n+1)<<32-e:t.D(s+n);return new ve(i,t.h)}Mf.prototype.createWebChannel=Mf.prototype.g;Zt.prototype.send=Zt.prototype.u;Zt.prototype.open=Zt.prototype.m;Zt.prototype.close=Zt.prototype.close;Uf.NO_ERROR=0;Uf.TIMEOUT=8;Uf.HTTP_ERROR=6;IM.COMPLETE="complete";CM.EventType=Fc;Fc.OPEN="a";Fc.CLOSE="b";Fc.ERROR="c";Fc.MESSAGE="d";ut.prototype.listen=ut.prototype.O;Ve.prototype.listenOnce=Ve.prototype.P;Ve.prototype.getLastError=Ve.prototype.Sa;Ve.prototype.getLastErrorCode=Ve.prototype.Ia;Ve.prototype.getStatus=Ve.prototype.da;Ve.prototype.getResponseJson=Ve.prototype.Wa;Ve.prototype.getResponseText=Ve.prototype.ja;Ve.prototype.send=Ve.prototype.ha;Ve.prototype.setWithCredentials=Ve.prototype.Oa;On.prototype.digest=On.prototype.l;On.prototype.reset=On.prototype.reset;On.prototype.update=On.prototype.j;ve.prototype.add=ve.prototype.add;ve.prototype.multiply=ve.prototype.R;ve.prototype.modulo=ve.prototype.gb;ve.prototype.compare=ve.prototype.X;ve.prototype.toNumber=ve.prototype.ea;ve.prototype.toString=ve.prototype.toString;ve.prototype.getBits=ve.prototype.D;ve.fromNumber=or;ve.fromString=sR;var oR=Fn.createWebChannelTransport=function(){return new Mf},aR=Fn.getStatEventTarget=function(){return jf()},Kf=Fn.ErrorCode=Uf,uR=Fn.EventType=IM,cR=Fn.Event=Cs,kw=Fn.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},tee=Fn.FetchXmlHttpFactory=jc,$c=Fn.WebChannel=CM,lR=Fn.XhrIo=Ve,dR=Fn.Md5=On,Ds=Fn.Integer=ve;var hR="@firebase/firestore";var Je=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Je.UNAUTHENTICATED=new Je(null),Je.GOOGLE_CREDENTIALS=new Je("google-credentials-uid"),Je.FIRST_PARTY=new Je("first-party-uid"),Je.MOCK_USER=new Je("mock-user");var ja="10.8.0";var Ci=new Wr("@firebase/firestore");function pa(){return Ci.logLevel}function dN(t){Ci.setLogLevel(t)}function E(t,...e){if(Ci.logLevel<=an.DEBUG){let n=e.map(FI);Ci.debug(`Firestore (${ja}): ${t}`,...n)}}function He(t,...e){if(Ci.logLevel<=an.ERROR){let n=e.map(FI);Ci.error(`Firestore (${ja}): ${t}`,...n)}}function vn(t,...e){if(Ci.logLevel<=an.WARN){let n=e.map(FI);Ci.warn(`Firestore (${ja}): ${t}`,...n)}}function FI(t){if(typeof t=="string")return t;try{return function(n){return JSON.stringify(n)}(t)}catch{return t}}function N(t="Unexpected state"){let e=`FIRESTORE (${ja}) INTERNAL ASSERTION FAILED: `+t;throw He(e),new Error(e)}function O(t,e){t||N()}function hN(t,e){t||N()}function x(t,e){return t}var y={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},w=class extends j0{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var et=class{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}};var sp=class{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},jw=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Je.UNAUTHENTICATED))}shutdown(){}},Uw=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}},Bw=class{constructor(e){this.t=e,this.currentUser=Je.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){let r=this.i,i=u=>this.i!==r?(r=this.i,n(u)):Promise.resolve(),s=new et;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new et,e.enqueueRetryable(()=>i(this.currentUser))};let o=()=>{let u=s;e.enqueueRetryable(()=>v(this,null,function*(){yield u.promise,yield i(this.currentUser)}))},a=u=>{E("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(u=>a(u)),setTimeout(()=>{if(!this.auth){let u=this.t.getImmediate({optional:!0});u?a(u):(E("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new et)}},0),o()}getToken(){let e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(E("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(O(typeof r.accessToken=="string"),new sp(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){let e=this.auth&&this.auth.getUid();return O(e===null||typeof e=="string"),new Je(e)}},$w=class{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=Je.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);let e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}},Hw=class{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new $w(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(Je.FIRST_PARTY))}shutdown(){}invalidateToken(){}},qw=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},Gw=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){let r=s=>{s.error!=null&&E("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let o=s.token!==this.R;return this.R=s.token,E("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};let i=s=>{E("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){let s=this.A.getImmediate({optional:!0});s?i(s):E("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(O(typeof n.token=="string"),this.R=n.token,new qw(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}};function A4(t){let e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}var op=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length,r="";for(;r.length<20;){let i=A4(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=e.charAt(i[s]%e.length))}return r}};function K(t,e){return t<e?-1:t>e?1:0}function Ca(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}function fN(t){return t+"\0"}var Oe=class t{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new w(y.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new w(y.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new w(y.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new w(y.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return t.fromMillis(Date.now())}static fromDate(e){return t.fromMillis(e.getTime())}static fromMillis(e){let n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new t(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?K(this.nanoseconds,e.nanoseconds):K(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var L=class t{constructor(e){this.timestamp=e}static fromTimestamp(e){return new t(e)}static min(){return new t(new Oe(0,0))}static max(){return new t(new Oe(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var ap=class t{constructor(e,n,r){n===void 0?n=0:n>e.length&&N(),r===void 0?r=e.length-n:r>e.length-n&&N(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return t.comparator(this,e)===0}child(e){let n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){let r=Math.min(e.length,n.length);for(let i=0;i<r;i++){let s=e.get(i),o=n.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}},de=class t extends ap{construct(e,n,r){return new t(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let n=[];for(let r of e){if(r.indexOf("//")>=0)throw new w(y.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new t(n)}static emptyPath(){return new t([])}},x4=/^[_a-zA-Z][_a-zA-Z0-9]*$/,qe=class t extends ap{construct(e,n,r){return new t(e,n,r)}static isValidIdentifier(e){return x4.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),t.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new t(["__name__"])}static fromServerFormat(e){let n=[],r="",i=0,s=()=>{if(r.length===0)throw new w(y.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""},o=!1;for(;i<e.length;){let a=e[i];if(a==="\\"){if(i+1===e.length)throw new w(y.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let u=e[i+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new w(y.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new w(y.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new t(n)}static emptyPath(){return new t([])}};var b=class t{constructor(e){this.path=e}static fromPath(e){return new t(de.fromString(e))}static fromName(e){return new t(de.fromString(e).popFirst(5))}static empty(){return new t(de.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&de.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return de.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new t(new de(e.slice()))}};var Da=class{constructor(e,n,r,i){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=i}};function zw(t){return t.fields.find(e=>e.kind===2)}function bs(t){return t.fields.filter(e=>e.kind!==2)}Da.UNKNOWN_ID=-1;var wa=class{constructor(e,n){this.fieldPath=e,this.kind=n}};var el=class t{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new t(0,wn.min())}};function pN(t,e){let n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=L.fromTimestamp(r===1e9?new Oe(n+1,0):new Oe(n,r));return new wn(i,b.empty(),e)}function gN(t){return new wn(t.readTime,t.key,-1)}var wn=class t{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new t(L.min(),b.empty(),-1)}static max(){return new t(L.max(),b.empty(),-1)}};function VI(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=b.comparator(t.documentKey,e.documentKey),n!==0?n:K(t.largestBatchId,e.largestBatchId))}var mN="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",up=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function Pi(t){return v(this,null,function*(){if(t.code!==y.FAILED_PRECONDITION||t.message!==mN)throw t;E("LocalStore","Unexpectedly lost primary lease")})}var m=class t{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&N(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new t((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{let n=e();return n instanceof t?n:t.resolve(n)}catch(n){return t.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):t.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):t.reject(n)}static resolve(e){return new t((n,r)=>{n(e)})}static reject(e){return new t((n,r)=>{r(e)})}static waitFor(e){return new t((n,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&n()},u=>r(u))}),o=!0,s===i&&n()})}static or(e){let n=t.resolve(!1);for(let r of e)n=n.next(i=>i?t.resolve(i):r());return n}static forEach(e,n){let r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new t((r,i)=>{let s=e.length,o=new Array(s),a=0;for(let u=0;u<s;u++){let c=u;n(e[c]).next(l=>{o[c]=l,++a,a===s&&r(o)},l=>i(l))}})}static doWhile(e,n){return new t((r,i)=>{let s=()=>{e()===!0?n().next(()=>{s()},i):r()};s()})}};var cp=class t{constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.V=new et,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{n.error?this.V.reject(new Ns(e,n.error)):this.V.resolve()},this.transaction.onerror=r=>{let i=LI(r.target.error);this.V.reject(new Ns(e,i))}}static open(e,n,r,i){try{return new t(n,e.transaction(i,r))}catch(s){throw new Ns(n,s)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(E("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){let e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){let n=this.transaction.objectStore(e);return new Kw(n)}},Vr=class t{constructor(e,n,r){this.name=e,this.version=n,this.p=r,t.S(fu())===12.2&&He("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return E("SimpleDb","Removing database:",e),Ss(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!md())return!1;if(t.C())return!0;let e=fu(),n=t.S(e),r=0<n&&n<10,i=t.v(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static C(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.F)==="YES"}static M(e,n){return e.store(n)}static S(e){let n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}static v(e){let n=e.match(/Android ([\d.]+)/i),r=n?n[1].split(".").slice(0,2).join("."):"-1";return Number(r)}O(e){return v(this,null,function*(){return this.db||(E("SimpleDb","Opening database:",this.name),this.db=yield new Promise((n,r)=>{let i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{let o=s.target.result;n(o)},i.onblocked=()=>{r(new Ns(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{let o=s.target.error;o.name==="VersionError"?r(new w(y.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new w(y.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new Ns(e,o))},i.onupgradeneeded=s=>{E("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);let o=s.target.result;this.p.N(o,i.transaction,s.oldVersion,this.version).next(()=>{E("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.B&&(this.db.onversionchange=n=>this.B(n)),this.db})}L(e){this.B=e,this.db&&(this.db.onversionchange=n=>e(n))}runTransaction(e,n,r,i){return v(this,null,function*(){let s=n==="readonly",o=0;for(;;){++o;try{this.db=yield this.O(e);let a=cp.open(this.db,e,s?"readonly":"readwrite",r),u=i(a).next(c=>(a.g(),c)).catch(c=>(a.abort(c),m.reject(c))).toPromise();return u.catch(()=>{}),yield a.m,u}catch(a){let u=a,c=u.name!=="FirebaseError"&&o<3;if(E("SimpleDb","Transaction failed with error:",u.message,"Retrying:",c),this.close(),!c)return Promise.reject(u)}}})}close(){this.db&&this.db.close(),this.db=void 0}},Ww=class{constructor(e){this.k=e,this.q=!1,this.K=null}get isDone(){return this.q}get $(){return this.K}set cursor(e){this.k=e}done(){this.q=!0}U(e){this.K=e}delete(){return Ss(this.k.delete())}},Ns=class extends w{constructor(e,n){super(y.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}};function ki(t){return t.name==="IndexedDbTransactionError"}var Kw=class{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(E("SimpleDb","PUT",this.store.name,e,n),r=this.store.put(n,e)):(E("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Ss(r)}add(e){return E("SimpleDb","ADD",this.store.name,e,e),Ss(this.store.add(e))}get(e){return Ss(this.store.get(e)).next(n=>(n===void 0&&(n=null),E("SimpleDb","GET",this.store.name,e,n),n))}delete(e){return E("SimpleDb","DELETE",this.store.name,e),Ss(this.store.delete(e))}count(){return E("SimpleDb","COUNT",this.store.name),Ss(this.store.count())}W(e,n){let r=this.options(e,n),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){let s=i.getAll(r.range);return new m((o,a)=>{s.onerror=u=>{a(u.target.error)},s.onsuccess=u=>{o(u.target.result)}})}{let s=this.cursor(r),o=[];return this.G(s,(a,u)=>{o.push(u)}).next(()=>o)}}j(e,n){let r=this.store.getAll(e,n===null?void 0:n);return new m((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}})}H(e,n){E("SimpleDb","DELETE ALL",this.store.name);let r=this.options(e,n);r.J=!1;let i=this.cursor(r);return this.G(i,(s,o,a)=>a.delete())}Y(e,n){let r;n?r=e:(r={},n=e);let i=this.cursor(r);return this.G(i,n)}Z(e){let n=this.cursor({});return new m((r,i)=>{n.onerror=s=>{let o=LI(s.target.error);i(o)},n.onsuccess=s=>{let o=s.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}G(e,n){let r=[];return new m((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{let a=o.target.result;if(!a)return void i();let u=new Ww(a),c=n(a.primaryKey,a.value,u);if(c instanceof m){let l=c.catch(d=>(u.done(),m.reject(d)));r.push(l)}u.isDone?i():u.$===null?a.continue():a.continue(u.$)}}).next(()=>m.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){let r=this.store.index(e.index);return e.J?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}};function Ss(t){return new m((e,n)=>{t.onsuccess=r=>{let i=r.target.result;e(i)},t.onerror=r=>{let i=LI(r.target.error);n(i)}})}var fR=!1;function LI(t){let e=Vr.S(fu());if(e>=12.2&&e<13){let n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){let r=new w("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return fR||(fR=!0,setTimeout(()=>{throw r},0)),r}}return t}var Qw=class{constructor(e,n){this.asyncQueue=e,this.X=n,this.task=null}start(){this.ee(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}ee(e){E("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,()=>v(this,null,function*(){this.task=null;try{E("IndexBackfiller",`Documents written: ${yield this.X.te()}`)}catch(n){ki(n)?E("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",n):yield Pi(n)}yield this.ee(6e4)}))}},Yw=class{constructor(e,n){this.localStore=e,this.persistence=n}te(e=50){return v(this,null,function*(){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.ne(n,e))})}ne(e,n){let r=new Set,i=n,s=!0;return m.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return E("IndexBackfiller",`Processing collection: ${o}`),this.re(e,o,i).next(a=>{i-=a,r.add(o)});s=!1})).next(()=>n-i)}re(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(i=>this.localStore.localDocuments.getNextDocuments(e,n,i,r).next(s=>{let o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.ie(i,s)).next(a=>(E("IndexBackfiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,n,a))).next(()=>o.size)}))}ie(e,n){let r=e;return n.changes.forEach((i,s)=>{let o=gN(s);VI(o,r)>0&&(r=o)}),new wn(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}};var Xt=(()=>{class t{constructor(n,r){this.previousValue=n,r&&(r.sequenceNumberHandler=i=>this.se(i),this.oe=i=>r.writeSequenceNumber(i))}se(n){return this.previousValue=Math.max(n,this.previousValue),this.previousValue}next(){let n=++this.previousValue;return this.oe&&this.oe(n),n}}return t._e=-1,t})();function Cl(t){return t==null}function tl(t){return t===0&&1/t==-1/0}function yN(t){return typeof t=="number"&&Number.isInteger(t)&&!tl(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}function Nt(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=pR(e)),e=M4(t.get(n),e);return pR(e)}function M4(t,e){let n=e,r=t.length;for(let i=0;i<r;i++){let s=t.charAt(i);switch(s){case"\0":n+="";break;case"":n+="";break;default:n+=s}}return n}function pR(t){return t+""}function ar(t){let e=t.length;if(O(e>=2),e===2)return O(t.charAt(0)===""&&t.charAt(1)===""),de.emptyPath();let n=e-2,r=[],i="";for(let s=0;s<e;){let o=t.indexOf("",s);switch((o<0||o>n)&&N(),t.charAt(o+1)){case"":let a=t.substring(s,o),u;i.length===0?u=a:(i+=a,u=i,i=""),r.push(u);break;case"":i+=t.substring(s,o),i+="\0";break;case"":i+=t.substring(s,o+1);break;default:N()}s=o+2}return new de(r)}var gR=["userId","batchId"];function Jf(t,e){return[t,Nt(e)]}function _N(t,e,n){return[t,Nt(e),n]}var R4={},N4=["prefixPath","collectionGroup","readTime","documentId"],P4=["prefixPath","collectionGroup","documentId"],k4=["collectionGroup","readTime","prefixPath","documentId"],O4=["canonicalId","targetId"],F4=["targetId","path"],V4=["path","targetId"],L4=["collectionId","parent"],j4=["indexId","uid"],U4=["uid","sequenceNumber"],B4=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],$4=["indexId","uid","orderedDocumentKey"],H4=["userId","collectionPath","documentId"],q4=["userId","collectionPath","largestBatchId"],G4=["userId","collectionGroup","largestBatchId"],vN=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],z4=[...vN,"documentOverlays"],wN=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],EN=wN,W4=[...EN,"indexConfiguration","indexState","indexEntries"];var nl=class extends up{constructor(e,n){super(),this.ae=e,this.currentSequenceNumber=n}};function dt(t,e){let n=x(t);return Vr.M(n.ae,e)}function mR(t){let e=0;for(let n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function qs(t,e){for(let n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function IN(t){for(let e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var xe=class t{constructor(e,n){this.comparator=e,this.root=n||cr.EMPTY}insert(e,n){return new t(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,cr.BLACK,null,null))}remove(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,cr.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){let r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){let e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new va(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new va(this.root,e,this.comparator,!1)}getReverseIterator(){return new va(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new va(this.root,e,this.comparator,!0)}},va=class{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},cr=class t{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??t.RED,this.left=i??t.EMPTY,this.right=s??t.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new t(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this,s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return t.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw N();let e=this.left.check();if(e!==this.right.check())throw N();return e+(this.isRed()?0:1)}};cr.EMPTY=null,cr.RED=!0,cr.BLACK=!1;cr.EMPTY=new class{constructor(){this.size=0}get key(){throw N()}get value(){throw N()}get color(){throw N()}get left(){throw N()}get right(){throw N()}copy(e,n,r,i,s){return this}insert(e,n,r){return new cr(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var Ce=class t{constructor(e){this.comparator=e,this.data=new xe(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new lp(this.data.getIterator())}getIteratorFrom(e){return new lp(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof t)||this.size!==e.size)return!1;let n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){let i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(n=>{e.push(n)}),e}toString(){let e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){let n=new t(this.comparator);return n.data=e,n}},lp=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};function la(t){return t.hasNext()?t.getNext():void 0}var Jt=class t{constructor(e){this.fields=e,e.sort(qe.comparator)}static empty(){return new t([])}unionWith(e){let n=new Ce(qe.comparator);for(let r of this.fields)n=n.add(r);for(let r of e)n=n.add(r);return new t(n.toArray())}covers(e){for(let n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Ca(this.fields,e.fields,(n,r)=>n.isEqual(r))}};var dp=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};function CN(){return typeof atob<"u"}var lt=class t{constructor(e){this.binaryString=e}static fromBase64String(e){let n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new dp("Invalid base64 string: "+s):s}}(e);return new t(n)}static fromUint8Array(e){let n=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new t(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){let r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return K(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};lt.EMPTY_BYTE_STRING=new lt("");var K4=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Di(t){if(O(!!t),typeof t=="string"){let e=0,n=K4.exec(t);if(O(!!n),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Le(t.seconds),nanos:Le(t.nanos)}}function Le(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Ti(t){return typeof t=="string"?lt.fromBase64String(t):lt.fromUint8Array(t)}function tg(t){var e,n;return((n=(((e=t?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function jI(t){let e=t.mapValue.fields.__previous_value__;return tg(e)?jI(e):e}function rl(t){let e=Di(t.mapValue.fields.__local_write_time__.timestampValue);return new Oe(e.seconds,e.nanos)}var Zw=class{constructor(e,n,r,i,s,o,a,u,c){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=u,this.useFetchStreams=c}},bi=class t{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new t("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database}};var Ei={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},ep={nullValue:"NULL_VALUE"};function Ps(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?tg(t)?4:DN(t)?9007199254740991:10:N()}function hr(t,e){if(t===e)return!0;let n=Ps(t);if(n!==Ps(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return rl(t).isEqual(rl(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;let o=Di(i.timestampValue),a=Di(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return Ti(i.bytesValue).isEqual(Ti(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return Le(i.geoPointValue.latitude)===Le(s.geoPointValue.latitude)&&Le(i.geoPointValue.longitude)===Le(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return Le(i.integerValue)===Le(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){let o=Le(i.doubleValue),a=Le(s.doubleValue);return o===a?tl(o)===tl(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return Ca(t.arrayValue.values||[],e.arrayValue.values||[],hr);case 10:return function(i,s){let o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(mR(o)!==mR(a))return!1;for(let u in o)if(o.hasOwnProperty(u)&&(a[u]===void 0||!hr(o[u],a[u])))return!1;return!0}(t,e);default:return N()}}function il(t,e){return(t.values||[]).find(n=>hr(n,e))!==void 0}function Si(t,e){if(t===e)return 0;let n=Ps(t),r=Ps(e);if(n!==r)return K(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return K(t.booleanValue,e.booleanValue);case 2:return function(s,o){let a=Le(s.integerValue||s.doubleValue),u=Le(o.integerValue||o.doubleValue);return a<u?-1:a>u?1:a===u?0:isNaN(a)?isNaN(u)?0:-1:1}(t,e);case 3:return yR(t.timestampValue,e.timestampValue);case 4:return yR(rl(t),rl(e));case 5:return K(t.stringValue,e.stringValue);case 6:return function(s,o){let a=Ti(s),u=Ti(o);return a.compareTo(u)}(t.bytesValue,e.bytesValue);case 7:return function(s,o){let a=s.split("/"),u=o.split("/");for(let c=0;c<a.length&&c<u.length;c++){let l=K(a[c],u[c]);if(l!==0)return l}return K(a.length,u.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,o){let a=K(Le(s.latitude),Le(o.latitude));return a!==0?a:K(Le(s.longitude),Le(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(s,o){let a=s.values||[],u=o.values||[];for(let c=0;c<a.length&&c<u.length;++c){let l=Si(a[c],u[c]);if(l)return l}return K(a.length,u.length)}(t.arrayValue,e.arrayValue);case 10:return function(s,o){if(s===Ei.mapValue&&o===Ei.mapValue)return 0;if(s===Ei.mapValue)return 1;if(o===Ei.mapValue)return-1;let a=s.fields||{},u=Object.keys(a),c=o.fields||{},l=Object.keys(c);u.sort(),l.sort();for(let d=0;d<u.length&&d<l.length;++d){let h=K(u[d],l[d]);if(h!==0)return h;let f=Si(a[u[d]],c[l[d]]);if(f!==0)return f}return K(u.length,l.length)}(t.mapValue,e.mapValue);default:throw N()}}function yR(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return K(t,e);let n=Di(t),r=Di(e),i=K(n.seconds,r.seconds);return i!==0?i:K(n.nanos,r.nanos)}function Ta(t){return Xw(t)}function Xw(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){let r=Di(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return Ti(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return b.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(let s of n.values||[])i?i=!1:r+=",",r+=Xw(s);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){let r=Object.keys(n.fields||{}).sort(),i="{",s=!0;for(let o of r)s?s=!1:i+=",",i+=`${o}:${Xw(n.fields[o])}`;return i+"}"}(t.mapValue):N()}function ks(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Jw(t){return!!t&&"integerValue"in t}function sl(t){return!!t&&"arrayValue"in t}function _R(t){return!!t&&"nullValue"in t}function vR(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function tp(t){return!!t&&"mapValue"in t}function Qc(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){let e={mapValue:{fields:{}}};return qs(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Qc(r)),e}if(t.arrayValue){let e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Qc(t.arrayValue.values[n]);return e}return Object.assign({},t)}function DN(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}function Q4(t){return"nullValue"in t?ep:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?ks(bi.empty(),b.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?{mapValue:{}}:N()}function Y4(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?ks(bi.empty(),b.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?{mapValue:{}}:"mapValue"in t?Ei:N()}function wR(t,e){let n=Si(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function ER(t,e){let n=Si(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}var St=class t{constructor(e){this.value=e}static empty(){return new t({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!tp(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Qc(n)}setAll(e){let n=qe.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){let u=this.getFieldsMap(n);this.applyChanges(u,r,i),r={},i=[],n=a.popLast()}o?r[a.lastSegment()]=Qc(o):i.push(a.lastSegment())});let s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){let n=this.field(e.popLast());tp(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return hr(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];tp(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){qs(n,(i,s)=>e[i]=s);for(let i of r)delete e[i]}clone(){return new t(Qc(this.value))}};function TN(t){let e=[];return qs(t.fields,(n,r)=>{let i=new qe([n]);if(tp(r)){let s=TN(r.mapValue).fields;if(s.length===0)e.push(i);else for(let o of s)e.push(i.child(o))}else e.push(i)}),new Jt(e)}var tt=class t{constructor(e,n,r,i,s,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new t(e,0,L.min(),L.min(),L.min(),St.empty(),0)}static newFoundDocument(e,n,r,i){return new t(e,1,n,L.min(),r,i,0)}static newNoDocument(e,n){return new t(e,2,n,L.min(),L.min(),St.empty(),0)}static newUnknownDocument(e,n){return new t(e,3,n,L.min(),L.min(),St.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(L.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=St.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=St.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=L.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof t&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new t(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var fr=class{constructor(e,n){this.position=e,this.inclusive=n}};function IR(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){let s=e[i],o=t.position[i];if(s.field.isKeyField()?r=b.comparator(b.fromName(o.referenceValue),n.key):r=Si(o,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function CR(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!hr(t.position[n],e.position[n]))return!1;return!0}var Os=class{constructor(e,n="asc"){this.field=e,this.dir=n}};function Z4(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}var hp=class{},ae=class t extends hp{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new nE(e,n,r):n==="array-contains"?new sE(e,r):n==="in"?new fp(e,r):n==="not-in"?new oE(e,r):n==="array-contains-any"?new aE(e,r):new t(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new rE(e,r):new iE(e,r)}matches(e){let n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(Si(n,this.value)):n!==null&&Ps(this.value)===Ps(n)&&this.matchesComparison(Si(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return N()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},we=class t extends hp{constructor(e,n){super(),this.filters=e,this.op=n,this.ue=null}static create(e,n){return new t(e,n)}matches(e){return ba(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ue!==null||(this.ue=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ue}getFilters(){return Object.assign([],this.filters)}};function ba(t){return t.op==="and"}function eE(t){return t.op==="or"}function UI(t){return bN(t)&&ba(t)}function bN(t){for(let e of t.filters)if(e instanceof we)return!1;return!0}function tE(t){if(t instanceof ae)return t.field.canonicalString()+t.op.toString()+Ta(t.value);if(UI(t))return t.filters.map(e=>tE(e)).join(",");{let e=t.filters.map(n=>tE(n)).join(",");return`${t.op}(${e})`}}function SN(t,e){return t instanceof ae?function(r,i){return i instanceof ae&&r.op===i.op&&r.field.isEqual(i.field)&&hr(r.value,i.value)}(t,e):t instanceof we?function(r,i){return i instanceof we&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,a)=>s&&SN(o,i.filters[a]),!0):!1}(t,e):void N()}function AN(t,e){let n=t.filters.concat(e);return we.create(n,t.op)}function xN(t){return t instanceof ae?function(n){return`${n.field.canonicalString()} ${n.op} ${Ta(n.value)}`}(t):t instanceof we?function(n){return n.op.toString()+" {"+n.getFilters().map(xN).join(" ,")+"}"}(t):"Filter"}var nE=class extends ae{constructor(e,n,r){super(e,n,r),this.key=b.fromName(r.referenceValue)}matches(e){let n=b.comparator(e.key,this.key);return this.matchesComparison(n)}},rE=class extends ae{constructor(e,n){super(e,"in",n),this.keys=MN("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}},iE=class extends ae{constructor(e,n){super(e,"not-in",n),this.keys=MN("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}};function MN(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>b.fromName(r.referenceValue))}var sE=class extends ae{constructor(e,n){super(e,"array-contains",n)}matches(e){let n=e.data.field(this.field);return sl(n)&&il(n.arrayValue,this.value)}},fp=class extends ae{constructor(e,n){super(e,"in",n)}matches(e){let n=e.data.field(this.field);return n!==null&&il(this.value.arrayValue,n)}},oE=class extends ae{constructor(e,n){super(e,"not-in",n)}matches(e){if(il(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let n=e.data.field(this.field);return n!==null&&!il(this.value.arrayValue,n)}},aE=class extends ae{constructor(e,n){super(e,"array-contains-any",n)}matches(e){let n=e.data.field(this.field);return!(!sl(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>il(this.value.arrayValue,r))}};var uE=class{constructor(e,n=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.ce=null}};function cE(t,e=null,n=[],r=[],i=null,s=null,o=null){return new uE(t,e,n,r,i,s,o)}function Fs(t){let e=x(t);if(e.ce===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>tE(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),Cl(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Ta(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Ta(r)).join(",")),e.ce=n}return e.ce}function Dl(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!Z4(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!SN(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!CR(t.startAt,e.startAt)&&CR(t.endAt,e.endAt)}function pp(t){return b.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function gp(t,e){return t.filters.filter(n=>n instanceof ae&&n.field.isEqual(e))}function DR(t,e,n){let r=ep,i=!0;for(let s of gp(t,e)){let o=ep,a=!0;switch(s.op){case"<":case"<=":o=Q4(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=ep}wR({value:r,inclusive:i},{value:o,inclusive:a})<0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){let o=n.position[s];wR({value:r,inclusive:i},{value:o,inclusive:n.inclusive})<0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}function TR(t,e,n){let r=Ei,i=!0;for(let s of gp(t,e)){let o=Ei,a=!0;switch(s.op){case">=":case">":o=Y4(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=Ei}ER({value:r,inclusive:i},{value:o,inclusive:a})>0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){let o=n.position[s];ER({value:r,inclusive:i},{value:o,inclusive:n.inclusive})>0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}var Vn=class{constructor(e,n=null,r=[],i=[],s=null,o="F",a=null,u=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=u,this.le=null,this.he=null,this.Pe=null,this.startAt,this.endAt}};function RN(t,e,n,r,i,s,o,a){return new Vn(t,e,n,r,i,s,o,a)}function Ua(t){return new Vn(t)}function bR(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function BI(t){return t.collectionGroup!==null}function Ea(t){let e=x(t);if(e.le===null){e.le=[];let n=new Set;for(let s of e.explicitOrderBy)e.le.push(s),n.add(s.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Ce(qe.comparator);return o.filters.forEach(u=>{u.getFlattenedFilters().forEach(c=>{c.isInequality()&&(a=a.add(c.field))})}),a})(e).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||e.le.push(new Os(s,r))}),n.has(qe.keyField().canonicalString())||e.le.push(new Os(qe.keyField(),r))}return e.le}function Pt(t){let e=x(t);return e.he||(e.he=X4(e,Ea(t))),e.he}function X4(t,e){if(t.limitType==="F")return cE(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{let s=i.dir==="desc"?"asc":"desc";return new Os(i.field,s)});let n=t.endAt?new fr(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new fr(t.startAt.position,t.startAt.inclusive):null;return cE(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function lE(t,e){let n=t.filters.concat([e]);return new Vn(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function mp(t,e,n){return new Vn(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Tl(t,e){return Dl(Pt(t),Pt(e))&&t.limitType===e.limitType}function NN(t){return`${Fs(Pt(t))}|lt:${t.limitType}`}function ga(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>xN(i)).join(", ")}]`),Cl(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>Ta(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>Ta(i)).join(",")),`Target(${r})`}(Pt(t))}; limitType=${t.limitType})`}function bl(t,e){return e.isFoundDocument()&&function(r,i){let s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):b.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(t,e)&&function(r,i){for(let s of Ea(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(r,i){for(let s of r.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(r,i){return!(r.startAt&&!function(o,a,u){let c=IR(o,a,u);return o.inclusive?c<=0:c<0}(r.startAt,Ea(r),i)||r.endAt&&!function(o,a,u){let c=IR(o,a,u);return o.inclusive?c>=0:c>0}(r.endAt,Ea(r),i))}(t,e)}function PN(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function kN(t){return(e,n)=>{let r=!1;for(let i of Ea(t)){let s=J4(i,e,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function J4(t,e,n){let r=t.field.isKeyField()?b.comparator(e.key,n.key):function(s,o,a){let u=o.data.field(s),c=a.data.field(s);return u!==null&&c!==null?Si(u,c):N()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return N()}}var pr=class{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){let n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(let[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){let n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){qs(this.inner,(n,r)=>{for(let[i,s]of r)e(i,s)})}isEmpty(){return IN(this.inner)}size(){return this.innerSize}};var eG=new xe(b.comparator);function Gt(){return eG}var ON=new xe(b.comparator);function Wc(...t){let e=ON;for(let n of t)e=e.insert(n.key,n);return e}function FN(t){let e=ON;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function ur(){return Yc()}function VN(){return Yc()}function Yc(){return new pr(t=>t.toString(),(t,e)=>t.isEqual(e))}var tG=new xe(b.comparator),nG=new Ce(b.comparator);function Z(...t){let e=nG;for(let n of t)e=e.add(n);return e}var rG=new Ce(K);function $I(){return rG}function LN(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:tl(e)?"-0":e}}function jN(t){return{integerValue:""+t}}function UN(t,e){return yN(e)?jN(e):LN(t,e)}var Sa=class{constructor(){this._=void 0}};function iG(t,e,n){return t instanceof Ai?function(i,s){let o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&tg(s)&&(s=jI(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(n,e):t instanceof Lr?$N(t,e):t instanceof jr?HN(t,e):function(i,s){let o=BN(i,s),a=SR(o)+SR(i.Ie);return Jw(o)&&Jw(i.Ie)?jN(a):LN(i.serializer,a)}(t,e)}function sG(t,e,n){return t instanceof Lr?$N(t,e):t instanceof jr?HN(t,e):n}function BN(t,e){return t instanceof xi?function(r){return Jw(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}var Ai=class extends Sa{},Lr=class extends Sa{constructor(e){super(),this.elements=e}};function $N(t,e){let n=qN(e);for(let r of t.elements)n.some(i=>hr(i,r))||n.push(r);return{arrayValue:{values:n}}}var jr=class extends Sa{constructor(e){super(),this.elements=e}};function HN(t,e){let n=qN(e);for(let r of t.elements)n=n.filter(i=>!hr(i,r));return{arrayValue:{values:n}}}var xi=class extends Sa{constructor(e,n){super(),this.serializer=e,this.Ie=n}};function SR(t){return Le(t.integerValue||t.doubleValue)}function qN(t){return sl(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var Vs=class{constructor(e,n){this.field=e,this.transform=n}};function oG(t,e){return t.field.isEqual(e.field)&&function(r,i){return r instanceof Lr&&i instanceof Lr||r instanceof jr&&i instanceof jr?Ca(r.elements,i.elements,hr):r instanceof xi&&i instanceof xi?hr(r.Ie,i.Ie):r instanceof Ai&&i instanceof Ai}(t.transform,e.transform)}var dE=class{constructor(e,n){this.version=e,this.transformResults=n}},je=class t{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new t}static exists(e){return new t(void 0,e)}static updateTime(e){return new t(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function np(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}var Aa=class{};function GN(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Ri(t.key,je.none()):new Mi(t.key,t.data,je.none());{let n=t.data,r=St.empty(),i=new Ce(qe.comparator);for(let s of e.fields)if(!i.has(s)){let o=n.field(s);o===null&&s.length>1&&(s=s.popLast(),o=n.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new Ln(t.key,r,new Jt(i.toArray()),je.none())}}function aG(t,e,n){t instanceof Mi?function(i,s,o){let a=i.value.clone(),u=xR(i.fieldTransforms,s,o.transformResults);a.setAll(u),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof Ln?function(i,s,o){if(!np(i.precondition,s))return void s.convertToUnknownDocument(o.version);let a=xR(i.fieldTransforms,s,o.transformResults),u=s.data;u.setAll(zN(i)),u.setAll(a),s.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(t,e,n):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function Zc(t,e,n,r){return t instanceof Mi?function(s,o,a,u){if(!np(s.precondition,o))return a;let c=s.value.clone(),l=MR(s.fieldTransforms,u,o);return c.setAll(l),o.convertToFoundDocument(o.version,c).setHasLocalMutations(),null}(t,e,n,r):t instanceof Ln?function(s,o,a,u){if(!np(s.precondition,o))return a;let c=MR(s.fieldTransforms,u,o),l=o.data;return l.setAll(zN(s)),l.setAll(c),o.convertToFoundDocument(o.version,l).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(d=>d.field))}(t,e,n,r):function(s,o,a){return np(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(t,e,n)}function uG(t,e){let n=null;for(let r of t.fieldTransforms){let i=e.data.field(r.field),s=BN(r.transform,i||null);s!=null&&(n===null&&(n=St.empty()),n.set(r.field,s))}return n||null}function AR(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Ca(r,i,(s,o)=>oG(s,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}var Mi=class extends Aa{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},Ln=class extends Aa{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function zN(t){let e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){let r=t.data.field(n);e.set(n,r)}}),e}function xR(t,e,n){let r=new Map;O(t.length===n.length);for(let i=0;i<n.length;i++){let s=t[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,sG(o,a,n[i]))}return r}function MR(t,e,n){let r=new Map;for(let i of t){let s=i.transform,o=n.data.field(i.field);r.set(i.field,iG(s,o,e))}return r}var Ri=class extends Aa{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},ol=class extends Aa{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var al=class{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){let r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){let s=this.mutations[i];s.key.isEqual(e.key)&&aG(s,e,r[i])}}applyToLocalView(e,n){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(n=Zc(r,e,n,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(n=Zc(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){let r=VN();return this.mutations.forEach(i=>{let s=e.get(i.key),o=s.overlayedDocument,a=this.applyToLocalView(o,s.mutatedFields);a=n.has(i.key)?null:a;let u=GN(o,a);u!==null&&r.set(i.key,u),o.isValidDocument()||o.convertToNoDocument(L.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),Z())}isEqual(e){return this.batchId===e.batchId&&Ca(this.mutations,e.mutations,(n,r)=>AR(n,r))&&Ca(this.baseMutations,e.baseMutations,(n,r)=>AR(n,r))}},hE=class t{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){O(e.mutations.length===r.length);let i=function(){return tG}(),s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new t(e,n,r,i)}};var ul=class{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var fE=class{constructor(e,n){this.count=e,this.unchangedNames=n}};var Ze,le;function WN(t){switch(t){default:return N();case y.CANCELLED:case y.UNKNOWN:case y.DEADLINE_EXCEEDED:case y.RESOURCE_EXHAUSTED:case y.INTERNAL:case y.UNAVAILABLE:case y.UNAUTHENTICATED:return!1;case y.INVALID_ARGUMENT:case y.NOT_FOUND:case y.ALREADY_EXISTS:case y.PERMISSION_DENIED:case y.FAILED_PRECONDITION:case y.ABORTED:case y.OUT_OF_RANGE:case y.UNIMPLEMENTED:case y.DATA_LOSS:return!0}}function KN(t){if(t===void 0)return He("GRPC error has no .code"),y.UNKNOWN;switch(t){case Ze.OK:return y.OK;case Ze.CANCELLED:return y.CANCELLED;case Ze.UNKNOWN:return y.UNKNOWN;case Ze.DEADLINE_EXCEEDED:return y.DEADLINE_EXCEEDED;case Ze.RESOURCE_EXHAUSTED:return y.RESOURCE_EXHAUSTED;case Ze.INTERNAL:return y.INTERNAL;case Ze.UNAVAILABLE:return y.UNAVAILABLE;case Ze.UNAUTHENTICATED:return y.UNAUTHENTICATED;case Ze.INVALID_ARGUMENT:return y.INVALID_ARGUMENT;case Ze.NOT_FOUND:return y.NOT_FOUND;case Ze.ALREADY_EXISTS:return y.ALREADY_EXISTS;case Ze.PERMISSION_DENIED:return y.PERMISSION_DENIED;case Ze.FAILED_PRECONDITION:return y.FAILED_PRECONDITION;case Ze.ABORTED:return y.ABORTED;case Ze.OUT_OF_RANGE:return y.OUT_OF_RANGE;case Ze.UNIMPLEMENTED:return y.UNIMPLEMENTED;case Ze.DATA_LOSS:return y.DATA_LOSS;default:return N()}}(le=Ze||(Ze={}))[le.OK=0]="OK",le[le.CANCELLED=1]="CANCELLED",le[le.UNKNOWN=2]="UNKNOWN",le[le.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",le[le.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",le[le.NOT_FOUND=5]="NOT_FOUND",le[le.ALREADY_EXISTS=6]="ALREADY_EXISTS",le[le.PERMISSION_DENIED=7]="PERMISSION_DENIED",le[le.UNAUTHENTICATED=16]="UNAUTHENTICATED",le[le.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",le[le.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",le[le.ABORTED=10]="ABORTED",le[le.OUT_OF_RANGE=11]="OUT_OF_RANGE",le[le.UNIMPLEMENTED=12]="UNIMPLEMENTED",le[le.INTERNAL=13]="INTERNAL",le[le.UNAVAILABLE=14]="UNAVAILABLE",le[le.DATA_LOSS=15]="DATA_LOSS";var RR=null;function QN(){return new TextEncoder}var cG=new Ds([4294967295,4294967295],0);function NR(t){let e=QN().encode(t),n=new dR;return n.update(e),new Uint8Array(n.digest())}function PR(t){let e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Ds([n,r],0),new Ds([i,s],0)]}var pE=class t{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Rs(`Invalid padding: ${n}`);if(r<0)throw new Rs(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Rs(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new Rs(`Invalid padding when bitmap length is 0: ${n}`);this.Te=8*e.length-n,this.Ee=Ds.fromNumber(this.Te)}de(e,n,r){let i=e.add(n.multiply(Ds.fromNumber(r)));return i.compare(cG)===1&&(i=new Ds([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Ee).toNumber()}Ae(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Te===0)return!1;let n=NR(e),[r,i]=PR(n);for(let s=0;s<this.hashCount;s++){let o=this.de(r,i,s);if(!this.Ae(o))return!1}return!0}static create(e,n,r){let i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new t(s,i,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.Te===0)return;let n=NR(e),[r,i]=PR(n);for(let s=0;s<this.hashCount;s++){let o=this.de(r,i,s);this.Re(o)}}Re(e){let n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}},Rs=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var cl=class t{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){let i=new Map;return i.set(e,ll.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new t(L.min(),i,new xe(K),Gt(),Z())}},ll=class t{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new t(r,n,Z(),Z(),Z())}};var Ia=class{constructor(e,n,r,i){this.Ve=e,this.removedTargetIds=n,this.key=r,this.me=i}},yp=class{constructor(e,n){this.targetId=e,this.fe=n}},_p=class{constructor(e,n,r=lt.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}},vp=class{constructor(){this.ge=0,this.pe=OR(),this.ye=lt.EMPTY_BYTE_STRING,this.we=!1,this.Se=!0}get current(){return this.we}get resumeToken(){return this.ye}get be(){return this.ge!==0}get De(){return this.Se}Ce(e){e.approximateByteSize()>0&&(this.Se=!0,this.ye=e)}ve(){let e=Z(),n=Z(),r=Z();return this.pe.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:N()}}),new ll(this.ye,this.we,e,n,r)}Fe(){this.Se=!1,this.pe=OR()}Me(e,n){this.Se=!0,this.pe=this.pe.insert(e,n)}xe(e){this.Se=!0,this.pe=this.pe.remove(e)}Oe(){this.ge+=1}Ne(){this.ge-=1,O(this.ge>=0)}Be(){this.Se=!0,this.we=!0}},gE=class{constructor(e){this.Le=e,this.ke=new Map,this.qe=Gt(),this.Qe=kR(),this.Ke=new xe(K)}$e(e){for(let n of e.Ve)e.me&&e.me.isFoundDocument()?this.Ue(n,e.me):this.We(n,e.key,e.me);for(let n of e.removedTargetIds)this.We(n,e.key,e.me)}Ge(e){this.forEachTarget(e,n=>{let r=this.ze(n);switch(e.state){case 0:this.je(n)&&r.Ce(e.resumeToken);break;case 1:r.Ne(),r.be||r.Fe(),r.Ce(e.resumeToken);break;case 2:r.Ne(),r.be||this.removeTarget(n);break;case 3:this.je(n)&&(r.Be(),r.Ce(e.resumeToken));break;case 4:this.je(n)&&(this.He(n),r.Ce(e.resumeToken));break;default:N()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ke.forEach((r,i)=>{this.je(i)&&n(i)})}Je(e){let n=e.targetId,r=e.fe.count,i=this.Ye(n);if(i){let s=i.target;if(pp(s))if(r===0){let o=new b(s.path);this.We(n,o,tt.newNoDocument(o,L.min()))}else O(r===1);else{let o=this.Ze(n);if(o!==r){let a=this.Xe(e),u=a?this.et(a,e,o):1;if(u!==0){this.He(n);let c=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ke=this.Ke.insert(n,c)}RR?.tt(function(l,d,h,f,p){var g,_,C,M,T,j;let $={localCacheCount:l,existenceFilterCount:d.count,databaseId:h.database,projectId:h.projectId},Y=d.unchangedNames;return Y&&($.bloomFilter={applied:p===0,hashCount:(g=Y?.hashCount)!==null&&g!==void 0?g:0,bitmapLength:(M=(C=(_=Y?.bits)===null||_===void 0?void 0:_.bitmap)===null||C===void 0?void 0:C.length)!==null&&M!==void 0?M:0,padding:(j=(T=Y?.bits)===null||T===void 0?void 0:T.padding)!==null&&j!==void 0?j:0,mightContain:Me=>{var sn;return(sn=f?.mightContain(Me))!==null&&sn!==void 0&&sn}}),$}(o,e.fe,this.Le.nt(),a,u))}}}}Xe(e){let n=e.fe.unchangedNames;if(!n||!n.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n,o,a;try{o=Ti(r).toUint8Array()}catch(u){if(u instanceof dp)return vn("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{a=new pE(o,i,s)}catch(u){return vn(u instanceof Rs?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return a.Te===0?null:a}et(e,n,r){return n.fe.count===r-this.rt(e,n.targetId)?0:2}rt(e,n){let r=this.Le.getRemoteKeysForTarget(n),i=0;return r.forEach(s=>{let o=this.Le.nt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.We(n,s,null),i++)}),i}it(e){let n=new Map;this.ke.forEach((s,o)=>{let a=this.Ye(o);if(a){if(s.current&&pp(a.target)){let u=new b(a.target.path);this.qe.get(u)!==null||this.st(o,u)||this.We(o,u,tt.newNoDocument(u,e))}s.De&&(n.set(o,s.ve()),s.Fe())}});let r=Z();this.Qe.forEach((s,o)=>{let a=!0;o.forEachWhile(u=>{let c=this.Ye(u);return!c||c.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(s))}),this.qe.forEach((s,o)=>o.setReadTime(e));let i=new cl(e,n,this.Ke,this.qe,r);return this.qe=Gt(),this.Qe=kR(),this.Ke=new xe(K),i}Ue(e,n){if(!this.je(e))return;let r=this.st(e,n.key)?2:0;this.ze(e).Me(n.key,r),this.qe=this.qe.insert(n.key,n),this.Qe=this.Qe.insert(n.key,this.ot(n.key).add(e))}We(e,n,r){if(!this.je(e))return;let i=this.ze(e);this.st(e,n)?i.Me(n,1):i.xe(n),this.Qe=this.Qe.insert(n,this.ot(n).delete(e)),r&&(this.qe=this.qe.insert(n,r))}removeTarget(e){this.ke.delete(e)}Ze(e){let n=this.ze(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Oe(e){this.ze(e).Oe()}ze(e){let n=this.ke.get(e);return n||(n=new vp,this.ke.set(e,n)),n}ot(e){let n=this.Qe.get(e);return n||(n=new Ce(K),this.Qe=this.Qe.insert(e,n)),n}je(e){let n=this.Ye(e)!==null;return n||E("WatchChangeAggregator","Detected inactive target",e),n}Ye(e){let n=this.ke.get(e);return n&&n.be?null:this.Le._t(e)}He(e){this.ke.set(e,new vp),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.We(e,n,null)})}st(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}};function kR(){return new xe(b.comparator)}function OR(){return new xe(b.comparator)}var lG={asc:"ASCENDING",desc:"DESCENDING"},dG={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},hG={and:"AND",or:"OR"},mE=class{constructor(e,n){this.databaseId=e,this.useProto3Json=n}};function yE(t,e){return t.useProto3Json||Cl(e)?e:{value:e}}function xa(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function YN(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function fG(t,e){return xa(t,e.toTimestamp())}function Ge(t){return O(!!t),L.fromTimestamp(function(n){let r=Di(n);return new Oe(r.seconds,r.nanos)}(t))}function HI(t,e){return _E(t,e).canonicalString()}function _E(t,e){let n=function(i){return new de(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?n:n.child(e)}function ZN(t){let e=de.fromString(t);return O(aP(e)),e}function dl(t,e){return HI(t.databaseId,e.path)}function lr(t,e){let n=ZN(e);if(n.get(1)!==t.databaseId.projectId)throw new w(y.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new w(y.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new b(eP(n))}function XN(t,e){return HI(t.databaseId,e)}function JN(t){let e=ZN(t);return e.length===4?de.emptyPath():eP(e)}function vE(t){return new de(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function eP(t){return O(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function FR(t,e,n){return{name:dl(t,e),fields:n.value.mapValue.fields}}function tP(t,e,n){let r=lr(t,e.name),i=Ge(e.updateTime),s=e.createTime?Ge(e.createTime):L.min(),o=new St({mapValue:{fields:e.fields}}),a=tt.newFoundDocument(r,i,s,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function pG(t,e){return"found"in e?function(r,i){O(!!i.found),i.found.name,i.found.updateTime;let s=lr(r,i.found.name),o=Ge(i.found.updateTime),a=i.found.createTime?Ge(i.found.createTime):L.min(),u=new St({mapValue:{fields:i.found.fields}});return tt.newFoundDocument(s,o,a,u)}(t,e):"missing"in e?function(r,i){O(!!i.missing),O(!!i.readTime);let s=lr(r,i.missing),o=Ge(i.readTime);return tt.newNoDocument(s,o)}(t,e):N()}function gG(t,e){let n;if("targetChange"in e){e.targetChange;let r=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:N()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(c,l){return c.useProto3Json?(O(l===void 0||typeof l=="string"),lt.fromBase64String(l||"")):(O(l===void 0||l instanceof Uint8Array),lt.fromUint8Array(l||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(c){let l=c.code===void 0?y.UNKNOWN:KN(c.code);return new w(l,c.message||"")}(o);n=new _p(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=lr(t,r.document.name),s=Ge(r.document.updateTime),o=r.document.createTime?Ge(r.document.createTime):L.min(),a=new St({mapValue:{fields:r.document.fields}}),u=tt.newFoundDocument(i,s,o,a),c=r.targetIds||[],l=r.removedTargetIds||[];n=new Ia(c,l,u.key,u)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=lr(t,r.document),s=r.readTime?Ge(r.readTime):L.min(),o=tt.newNoDocument(i,s),a=r.removedTargetIds||[];n=new Ia([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=lr(t,r.document),s=r.removedTargetIds||[];n=new Ia([],s,i,null)}else{if(!("filter"in e))return N();{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:s}=r,o=new fE(i,s),a=r.targetId;n=new yp(a,o)}}return n}function hl(t,e){let n;if(e instanceof Mi)n={update:FR(t,e.key,e.value)};else if(e instanceof Ri)n={delete:dl(t,e.key)};else if(e instanceof Ln)n={update:FR(t,e.key,e.data),updateMask:EG(e.fieldMask)};else{if(!(e instanceof ol))return N();n={verify:dl(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,o){let a=o.transform;if(a instanceof Ai)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Lr)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof jr)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof xi)return{fieldPath:o.field.canonicalString(),increment:a.Ie};throw N()}(0,r))),e.precondition.isNone||(n.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:fG(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:N()}(t,e.precondition)),n}function wE(t,e){let n=e.currentDocument?function(s){return s.updateTime!==void 0?je.updateTime(Ge(s.updateTime)):s.exists!==void 0?je.exists(s.exists):je.none()}(e.currentDocument):je.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(o,a){let u=null;if("setToServerValue"in a)O(a.setToServerValue==="REQUEST_TIME"),u=new Ai;else if("appendMissingElements"in a){let l=a.appendMissingElements.values||[];u=new Lr(l)}else if("removeAllFromArray"in a){let l=a.removeAllFromArray.values||[];u=new jr(l)}else"increment"in a?u=new xi(o,a.increment):N();let c=qe.fromServerFormat(a.fieldPath);return new Vs(c,u)}(t,i)):[];if(e.update){e.update.name;let i=lr(t,e.update.name),s=new St({mapValue:{fields:e.update.fields}});if(e.updateMask){let o=function(u){let c=u.fieldPaths||[];return new Jt(c.map(l=>qe.fromServerFormat(l)))}(e.updateMask);return new Ln(i,s,o,n,r)}return new Mi(i,s,n,r)}if(e.delete){let i=lr(t,e.delete);return new Ri(i,n)}if(e.verify){let i=lr(t,e.verify);return new ol(i,n)}return N()}function mG(t,e){return t&&t.length>0?(O(e!==void 0),t.map(n=>function(i,s){let o=i.updateTime?Ge(i.updateTime):Ge(s);return o.isEqual(L.min())&&(o=Ge(s)),new dE(o,i.transformResults||[])}(n,e))):[]}function nP(t,e){return{documents:[XN(t,e.path)]}}function rP(t,e){let n={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=XN(t,i);let s=function(c){if(c.length!==0)return oP(we.create(c,"and"))}(e.filters);s&&(n.structuredQuery.where=s);let o=function(c){if(c.length!==0)return c.map(l=>function(h){return{field:ma(h.field),direction:_G(h.dir)}}(l))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);let a=yE(t,e.limit);return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),{ut:n,parent:i}}function iP(t){let e=JN(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){O(r===1);let l=n.from[0];l.allDescendants?i=l.collectionId:e=e.child(l.collectionId)}let s=[];n.where&&(s=function(d){let h=sP(d);return h instanceof we&&UI(h)?h.getFilters():[h]}(n.where));let o=[];n.orderBy&&(o=function(d){return d.map(h=>function(p){return new Os(ya(p.field),function(_){switch(_){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(p.direction))}(h))}(n.orderBy));let a=null;n.limit&&(a=function(d){let h;return h=typeof d=="object"?d.value:d,Cl(h)?null:h}(n.limit));let u=null;n.startAt&&(u=function(d){let h=!!d.before,f=d.values||[];return new fr(f,h)}(n.startAt));let c=null;return n.endAt&&(c=function(d){let h=!d.before,f=d.values||[];return new fr(f,h)}(n.endAt)),RN(e,i,o,s,a,"F",u,c)}function yG(t,e){let n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return N()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function sP(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":let r=ya(n.unaryFilter.field);return ae.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=ya(n.unaryFilter.field);return ae.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let s=ya(n.unaryFilter.field);return ae.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let o=ya(n.unaryFilter.field);return ae.create(o,"!=",{nullValue:"NULL_VALUE"});default:return N()}}(t):t.fieldFilter!==void 0?function(n){return ae.create(ya(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return N()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return we.create(n.compositeFilter.filters.map(r=>sP(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return N()}}(n.compositeFilter.op))}(t):N()}function _G(t){return lG[t]}function vG(t){return dG[t]}function wG(t){return hG[t]}function ma(t){return{fieldPath:t.canonicalString()}}function ya(t){return qe.fromServerFormat(t.fieldPath)}function oP(t){return t instanceof ae?function(n){if(n.op==="=="){if(vR(n.value))return{unaryFilter:{field:ma(n.field),op:"IS_NAN"}};if(_R(n.value))return{unaryFilter:{field:ma(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(vR(n.value))return{unaryFilter:{field:ma(n.field),op:"IS_NOT_NAN"}};if(_R(n.value))return{unaryFilter:{field:ma(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ma(n.field),op:vG(n.op),value:n.value}}}(t):t instanceof we?function(n){let r=n.getFilters().map(i=>oP(i));return r.length===1?r[0]:{compositeFilter:{op:wG(n.op),filters:r}}}(t):N()}function EG(t){let e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function aP(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}var Ma=class t{constructor(e,n,r,i,s=L.min(),o=L.min(),a=lt.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=u}withSequenceNumber(e){return new t(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var wp=class{constructor(e){this.ct=e}};function IG(t,e){let n;if(e.document)n=tP(t.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){let r=b.fromSegments(e.noDocument.path),i=js(e.noDocument.readTime);n=tt.newNoDocument(r,i),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return N();{let r=b.fromSegments(e.unknownDocument.path),i=js(e.unknownDocument.version);n=tt.newUnknownDocument(r,i)}}return e.readTime&&n.setReadTime(function(i){let s=new Oe(i[0],i[1]);return L.fromTimestamp(s)}(e.readTime)),n}function VR(t,e){let n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:Ep(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(s,o){return{name:dl(s,o.key),fields:o.data.value.mapValue.fields,updateTime:xa(s,o.version.toTimestamp()),createTime:xa(s,o.createTime.toTimestamp())}}(t.ct,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:Ls(e.version)};else{if(!e.isUnknownDocument())return N();r.unknownDocument={path:n.path.toArray(),version:Ls(e.version)}}return r}function Ep(t){let e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function Ls(t){let e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function js(t){let e=new Oe(t.seconds,t.nanoseconds);return L.fromTimestamp(e)}function As(t,e){let n=(e.baseMutations||[]).map(s=>wE(t.ct,s));for(let s=0;s<e.mutations.length-1;++s){let o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){let a=e.mutations[s+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}let r=e.mutations.map(s=>wE(t.ct,s)),i=Oe.fromMillis(e.localWriteTimeMs);return new al(e.batchId,i,n,r)}function Kc(t){let e=js(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?js(t.lastLimboFreeSnapshotVersion):L.min(),r;return r=function(s){return s.documents!==void 0}(t.query)?function(s){return O(s.documents.length===1),Pt(Ua(JN(s.documents[0])))}(t.query):function(s){return Pt(iP(s))}(t.query),new Ma(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,lt.fromBase64String(t.resumeToken))}function uP(t,e){let n=Ls(e.snapshotVersion),r=Ls(e.lastLimboFreeSnapshotVersion),i;i=pp(e.target)?nP(t.ct,e.target):rP(t.ct,e.target).ut;let s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Fs(e.target),readTime:n,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function qI(t){let e=iP({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?mp(e,e.limit,"L"):e}function Ow(t,e){return new ul(e.largestBatchId,wE(t.ct,e.overlayMutation))}function LR(t,e){let n=e.path.lastSegment();return[t,Nt(e.path.popLast()),n]}function jR(t,e,n,r){return{indexId:t,uid:e,sequenceNumber:n,readTime:Ls(r.readTime),documentKey:Nt(r.documentKey.path),largestBatchId:r.largestBatchId}}var EE=class{getBundleMetadata(e,n){return UR(e).get(n).next(r=>{if(r)return function(s){return{id:s.bundleId,createTime:js(s.createTime),version:s.version}}(r)})}saveBundleMetadata(e,n){return UR(e).put(function(i){return{bundleId:i.id,createTime:Ls(Ge(i.createTime)),version:i.version}}(n))}getNamedQuery(e,n){return BR(e).get(n).next(r=>{if(r)return function(s){return{name:s.name,query:qI(s.bundledQuery),readTime:js(s.readTime)}}(r)})}saveNamedQuery(e,n){return BR(e).put(function(i){return{name:i.name,readTime:Ls(Ge(i.readTime)),bundledQuery:i.bundledQuery}}(n))}};function UR(t){return dt(t,"bundles")}function BR(t){return dt(t,"namedQueries")}var Ip=class t{constructor(e,n){this.serializer=e,this.userId=n}static lt(e,n){let r=n.uid||"";return new t(e,r)}getOverlay(e,n){return Hc(e).get(LR(this.userId,n)).next(r=>r?Ow(this.serializer,r):null)}getOverlays(e,n){let r=ur();return m.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){let i=[];return r.forEach((s,o)=>{let a=new ul(n,o);i.push(this.ht(e,a))}),m.waitFor(i)}removeOverlaysForBatchId(e,n,r){let i=new Set;n.forEach(o=>i.add(Nt(o.getCollectionPath())));let s=[];return i.forEach(o=>{let a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(Hc(e).H("collectionPathOverlayIndex",a))}),m.waitFor(s)}getOverlaysForCollection(e,n,r){let i=ur(),s=Nt(n),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return Hc(e).W("collectionPathOverlayIndex",o).next(a=>{for(let u of a){let c=Ow(this.serializer,u);i.set(c.getKey(),c)}return i})}getOverlaysForCollectionGroup(e,n,r,i){let s=ur(),o,a=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return Hc(e).Y({index:"collectionGroupOverlayIndex",range:a},(u,c,l)=>{let d=Ow(this.serializer,c);s.size()<i||d.largestBatchId===o?(s.set(d.getKey(),d),o=d.largestBatchId):l.done()}).next(()=>s)}ht(e,n){return Hc(e).put(function(i,s,o){let[a,u,c]=LR(s,o.mutation.key);return{userId:s,collectionPath:u,documentId:c,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:hl(i.ct,o.mutation)}}(this.serializer,this.userId,n))}};function Hc(t){return dt(t,"documentOverlays")}var Or=class{constructor(){}Pt(e,n){this.It(e,n),n.Tt()}It(e,n){if("nullValue"in e)this.Et(n,5);else if("booleanValue"in e)this.Et(n,10),n.dt(e.booleanValue?1:0);else if("integerValue"in e)this.Et(n,15),n.dt(Le(e.integerValue));else if("doubleValue"in e){let r=Le(e.doubleValue);isNaN(r)?this.Et(n,13):(this.Et(n,15),tl(r)?n.dt(0):n.dt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Et(n,20),typeof r=="string"?n.At(r):(n.At(`${r.seconds||""}`),n.dt(r.nanos||0))}else if("stringValue"in e)this.Rt(e.stringValue,n),this.Vt(n);else if("bytesValue"in e)this.Et(n,30),n.ft(Ti(e.bytesValue)),this.Vt(n);else if("referenceValue"in e)this.gt(e.referenceValue,n);else if("geoPointValue"in e){let r=e.geoPointValue;this.Et(n,45),n.dt(r.latitude||0),n.dt(r.longitude||0)}else"mapValue"in e?DN(e)?this.Et(n,Number.MAX_SAFE_INTEGER):(this.yt(e.mapValue,n),this.Vt(n)):"arrayValue"in e?(this.wt(e.arrayValue,n),this.Vt(n)):N()}Rt(e,n){this.Et(n,25),this.St(e,n)}St(e,n){n.At(e)}yt(e,n){let r=e.fields||{};this.Et(n,55);for(let i of Object.keys(r))this.Rt(i,n),this.It(r[i],n)}wt(e,n){let r=e.values||[];this.Et(n,50);for(let i of r)this.It(i,n)}gt(e,n){this.Et(n,37),b.fromName(e).path.forEach(r=>{this.Et(n,60),this.St(r,n)})}Et(e,n){e.dt(n)}Vt(e){e.dt(2)}};Or.bt=new Or;function CG(t){if(t===0)return 8;let e=0;return!(t>>4)&&(e+=4,t<<=4),!(t>>6)&&(e+=2,t<<=2),!(t>>7)&&(e+=1),e}function $R(t){let e=64-function(r){let i=0;for(let s=0;s<8;++s){let o=CG(255&r[s]);if(i+=o,o!==8)break}return i}(t);return Math.ceil(e/8)}var IE=class{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Dt(e){let n=e[Symbol.iterator](),r=n.next();for(;!r.done;)this.Ct(r.value),r=n.next();this.vt()}Ft(e){let n=e[Symbol.iterator](),r=n.next();for(;!r.done;)this.Mt(r.value),r=n.next();this.xt()}Ot(e){for(let n of e){let r=n.charCodeAt(0);if(r<128)this.Ct(r);else if(r<2048)this.Ct(960|r>>>6),this.Ct(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Ct(480|r>>>12),this.Ct(128|63&r>>>6),this.Ct(128|63&r);else{let i=n.codePointAt(0);this.Ct(240|i>>>18),this.Ct(128|63&i>>>12),this.Ct(128|63&i>>>6),this.Ct(128|63&i)}}this.vt()}Nt(e){for(let n of e){let r=n.charCodeAt(0);if(r<128)this.Mt(r);else if(r<2048)this.Mt(960|r>>>6),this.Mt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Mt(480|r>>>12),this.Mt(128|63&r>>>6),this.Mt(128|63&r);else{let i=n.codePointAt(0);this.Mt(240|i>>>18),this.Mt(128|63&i>>>12),this.Mt(128|63&i>>>6),this.Mt(128|63&i)}}this.xt()}Bt(e){let n=this.Lt(e),r=$R(n);this.kt(1+r),this.buffer[this.position++]=255&r;for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=255&n[i]}qt(e){let n=this.Lt(e),r=$R(n);this.kt(1+r),this.buffer[this.position++]=~(255&r);for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=~(255&n[i])}Qt(){this.Kt(255),this.Kt(255)}$t(){this.Ut(255),this.Ut(255)}reset(){this.position=0}seed(e){this.kt(e.length),this.buffer.set(e,this.position),this.position+=e.length}Wt(){return this.buffer.slice(0,this.position)}Lt(e){let n=function(s){let o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),r=(128&n[0])!=0;n[0]^=r?255:128;for(let i=1;i<n.length;++i)n[i]^=r?255:0;return n}Ct(e){let n=255&e;n===0?(this.Kt(0),this.Kt(255)):n===255?(this.Kt(255),this.Kt(0)):this.Kt(n)}Mt(e){let n=255&e;n===0?(this.Ut(0),this.Ut(255)):n===255?(this.Ut(255),this.Ut(0)):this.Ut(e)}vt(){this.Kt(0),this.Kt(1)}xt(){this.Ut(0),this.Ut(1)}Kt(e){this.kt(1),this.buffer[this.position++]=e}Ut(e){this.kt(1),this.buffer[this.position++]=~e}kt(e){let n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);let i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}},CE=class{constructor(e){this.Gt=e}ft(e){this.Gt.Dt(e)}At(e){this.Gt.Ot(e)}dt(e){this.Gt.Bt(e)}Tt(){this.Gt.Qt()}},DE=class{constructor(e){this.Gt=e}ft(e){this.Gt.Ft(e)}At(e){this.Gt.Nt(e)}dt(e){this.Gt.qt(e)}Tt(){this.Gt.$t()}},xs=class{constructor(){this.Gt=new IE,this.zt=new CE(this.Gt),this.jt=new DE(this.Gt)}seed(e){this.Gt.seed(e)}Ht(e){return e===0?this.zt:this.jt}Wt(){return this.Gt.Wt()}reset(){this.Gt.reset()}};var Ms=class t{constructor(e,n,r,i){this.indexId=e,this.documentKey=n,this.arrayValue=r,this.directionalValue=i}Jt(){let e=this.directionalValue.length,n=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.directionalValue,0),n!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new t(this.indexId,this.documentKey,this.arrayValue,r)}};function yi(t,e){let n=t.indexId-e.indexId;return n!==0?n:(n=HR(t.arrayValue,e.arrayValue),n!==0?n:(n=HR(t.directionalValue,e.directionalValue),n!==0?n:b.comparator(t.documentKey,e.documentKey)))}function HR(t,e){for(let n=0;n<t.length&&n<e.length;++n){let r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}var Cp=class{constructor(e){this.Yt=new Ce((n,r)=>qe.comparator(n.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.Zt=e.orderBy,this.Xt=[];for(let n of e.filters){let r=n;r.isInequality()?this.Yt=this.Yt.add(r):this.Xt.push(r)}}get en(){return this.Yt.size>1}tn(e){if(O(e.collectionGroup===this.collectionId),this.en)return!1;let n=zw(e);if(n!==void 0&&!this.nn(n))return!1;let r=bs(e),i=new Set,s=0,o=0;for(;s<r.length&&this.nn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.Yt.size>0){let a=this.Yt.getIterator().getNext();if(!i.has(a.field.canonicalString())){let u=r[s];if(!this.rn(a,u)||!this.sn(this.Zt[o++],u))return!1}++s}for(;s<r.length;++s){let a=r[s];if(o>=this.Zt.length||!this.sn(this.Zt[o++],a))return!1}return!0}on(){if(this.en)return null;let e=new Ce(qe.comparator),n=[];for(let r of this.Xt)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")n.push(new wa(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new wa(r.field,0))}for(let r of this.Zt)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new wa(r.field,r.dir==="asc"?0:1)));return new Da(Da.UNKNOWN_ID,this.collectionId,n,el.empty())}nn(e){for(let n of this.Xt)if(this.rn(n,e))return!0;return!1}rn(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;let r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}sn(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}};function cP(t){var e,n;if(O(t instanceof ae||t instanceof we),t instanceof ae){if(t instanceof fp){let i=((n=(e=t.value.arrayValue)===null||e===void 0?void 0:e.values)===null||n===void 0?void 0:n.map(s=>ae.create(t.field,"==",s)))||[];return we.create(i,"or")}return t}let r=t.filters.map(i=>cP(i));return we.create(r,t.op)}function DG(t){if(t.getFilters().length===0)return[];let e=SE(cP(t));return O(lP(e)),TE(e)||bE(e)?[e]:e.getFilters()}function TE(t){return t instanceof ae}function bE(t){return t instanceof we&&UI(t)}function lP(t){return TE(t)||bE(t)||function(n){if(n instanceof we&&eE(n)){for(let r of n.getFilters())if(!TE(r)&&!bE(r))return!1;return!0}return!1}(t)}function SE(t){if(O(t instanceof ae||t instanceof we),t instanceof ae)return t;if(t.filters.length===1)return SE(t.filters[0]);let e=t.filters.map(r=>SE(r)),n=we.create(e,t.op);return n=Dp(n),lP(n)?n:(O(n instanceof we),O(ba(n)),O(n.filters.length>1),n.filters.reduce((r,i)=>GI(r,i)))}function GI(t,e){let n;return O(t instanceof ae||t instanceof we),O(e instanceof ae||e instanceof we),n=t instanceof ae?e instanceof ae?function(i,s){return we.create([i,s],"and")}(t,e):qR(t,e):e instanceof ae?qR(e,t):function(i,s){if(O(i.filters.length>0&&s.filters.length>0),ba(i)&&ba(s))return AN(i,s.getFilters());let o=eE(i)?i:s,a=eE(i)?s:i,u=o.filters.map(c=>GI(c,a));return we.create(u,"or")}(t,e),Dp(n)}function qR(t,e){if(ba(e))return AN(e,t.getFilters());{let n=e.filters.map(r=>GI(t,r));return we.create(n,"or")}}function Dp(t){if(O(t instanceof ae||t instanceof we),t instanceof ae)return t;let e=t.getFilters();if(e.length===1)return Dp(e[0]);if(bN(t))return t;let n=e.map(i=>Dp(i)),r=[];return n.forEach(i=>{i instanceof ae?r.push(i):i instanceof we&&(i.op===t.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:we.create(r,t.op)}var AE=class{constructor(){this._n=new fl}addToCollectionParentIndex(e,n){return this._n.add(n),m.resolve()}getCollectionParents(e,n){return m.resolve(this._n.getEntries(n))}addFieldIndex(e,n){return m.resolve()}deleteFieldIndex(e,n){return m.resolve()}deleteAllFieldIndexes(e){return m.resolve()}createTargetIndexes(e,n){return m.resolve()}getDocumentsMatchingTarget(e,n){return m.resolve(null)}getIndexType(e,n){return m.resolve(0)}getFieldIndexes(e,n){return m.resolve([])}getNextCollectionGroupToUpdate(e){return m.resolve(null)}getMinOffset(e,n){return m.resolve(wn.min())}getMinOffsetFromCollectionGroup(e,n){return m.resolve(wn.min())}updateCollectionGroup(e,n,r){return m.resolve()}updateIndexEntries(e,n){return m.resolve()}},fl=class{constructor(){this.index={}}add(e){let n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new Ce(de.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){let n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Ce(de.comparator)).toArray()}};var Qf=new Uint8Array(0),xE=class{constructor(e,n){this.databaseId=n,this.an=new fl,this.un=new pr(r=>Fs(r),(r,i)=>Dl(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.an.has(n)){let r=n.lastSegment(),i=n.popLast();e.addOnCommittedListener(()=>{this.an.add(n)});let s={collectionId:r,parent:Nt(i)};return GR(e).put(s)}return m.resolve()}getCollectionParents(e,n){let r=[],i=IDBKeyRange.bound([n,""],[fN(n),""],!1,!0);return GR(e).W(i).next(s=>{for(let o of s){if(o.collectionId!==n)break;r.push(ar(o.parent))}return r})}addFieldIndex(e,n){let r=qc(e),i=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(u=>[u.fieldPath.canonicalString(),u.kind])}}(n);delete i.indexId;let s=r.add(i);if(n.indexState){let o=ha(e);return s.next(a=>{o.put(jR(a,this.uid,n.indexState.sequenceNumber,n.indexState.offset))})}return s.next()}deleteFieldIndex(e,n){let r=qc(e),i=ha(e),s=da(e);return r.delete(n.indexId).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){let n=qc(e),r=da(e),i=ha(e);return n.H().next(()=>r.H()).next(()=>i.H())}createTargetIndexes(e,n){return m.forEach(this.cn(n),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){let s=new Cp(r).on();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,n){let r=da(e),i=!0,s=new Map;return m.forEach(this.cn(n),o=>this.ln(e,o).next(a=>{i&&(i=!!a),s.set(o,a)})).next(()=>{if(i){let o=Z(),a=[];return m.forEach(s,(u,c)=>{E("IndexedDbIndexManager",`Using index ${function(T){return`id=${T.indexId}|cg=${T.collectionGroup}|f=${T.fields.map(j=>`${j.fieldPath}:${j.kind}`).join(",")}`}(u)} to execute ${Fs(n)}`);let l=function(T,j){let $=zw(j);if($===void 0)return null;for(let Y of gp(T,$.fieldPath))switch(Y.op){case"array-contains-any":return Y.value.arrayValue.values||[];case"array-contains":return[Y.value]}return null}(c,u),d=function(T,j){let $=new Map;for(let Y of bs(j))for(let Me of gp(T,Y.fieldPath))switch(Me.op){case"==":case"in":$.set(Y.fieldPath.canonicalString(),Me.value);break;case"not-in":case"!=":return $.set(Y.fieldPath.canonicalString(),Me.value),Array.from($.values())}return null}(c,u),h=function(T,j){let $=[],Y=!0;for(let Me of bs(j)){let sn=Me.kind===0?DR(T,Me.fieldPath,T.startAt):TR(T,Me.fieldPath,T.startAt);$.push(sn.value),Y&&(Y=sn.inclusive)}return new fr($,Y)}(c,u),f=function(T,j){let $=[],Y=!0;for(let Me of bs(j)){let sn=Me.kind===0?TR(T,Me.fieldPath,T.endAt):DR(T,Me.fieldPath,T.endAt);$.push(sn.value),Y&&(Y=sn.inclusive)}return new fr($,Y)}(c,u),p=this.hn(u,c,h),g=this.hn(u,c,f),_=this.Pn(u,c,d),C=this.In(u.indexId,l,p,h.inclusive,g,f.inclusive,_);return m.forEach(C,M=>r.j(M,n.limit).next(T=>{T.forEach(j=>{let $=b.fromSegments(j.documentKey);o.has($)||(o=o.add($),a.push($))})}))}).next(()=>a)}return m.resolve(null)})}cn(e){let n=this.un.get(e);return n||(e.filters.length===0?n=[e]:n=DG(we.create(e.filters,"and")).map(r=>cE(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.un.set(e,n),n)}In(e,n,r,i,s,o,a){let u=(n!=null?n.length:1)*Math.max(r.length,s.length),c=u/(n!=null?n.length:1),l=[];for(let d=0;d<u;++d){let h=n?this.Tn(n[d/c]):Qf,f=this.En(e,h,r[d%c],i),p=this.dn(e,h,s[d%c],o),g=a.map(_=>this.En(e,h,_,!0));l.push(...this.createRange(f,p,g))}return l}En(e,n,r,i){let s=new Ms(e,b.empty(),n,r);return i?s:s.Jt()}dn(e,n,r,i){let s=new Ms(e,b.empty(),n,r);return i?s.Jt():s}ln(e,n){let r=new Cp(n),i=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let o=null;for(let a of s)r.tn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,n){let r=2,i=this.cn(n);return m.forEach(i,s=>this.ln(e,s).next(o=>{o?r!==0&&o.fields.length<function(u){let c=new Ce(qe.comparator),l=!1;for(let d of u.filters)for(let h of d.getFlattenedFilters())h.field.isKeyField()||(h.op==="array-contains"||h.op==="array-contains-any"?l=!0:c=c.add(h.field));for(let d of u.orderBy)d.field.isKeyField()||(c=c.add(d.field));return c.size+(l?1:0)}(s)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(n)&&i.length>1&&r===2?1:r)}An(e,n){let r=new xs;for(let i of bs(e)){let s=n.data.field(i.fieldPath);if(s==null)return null;let o=r.Ht(i.kind);Or.bt.Pt(s,o)}return r.Wt()}Tn(e){let n=new xs;return Or.bt.Pt(e,n.Ht(0)),n.Wt()}Rn(e,n){let r=new xs;return Or.bt.Pt(ks(this.databaseId,n),r.Ht(function(s){let o=bs(s);return o.length===0?0:o[o.length-1].kind}(e))),r.Wt()}Pn(e,n,r){if(r===null)return[];let i=[];i.push(new xs);let s=0;for(let o of bs(e)){let a=r[s++];for(let u of i)if(this.Vn(n,o.fieldPath)&&sl(a))i=this.mn(i,o,a);else{let c=u.Ht(o.kind);Or.bt.Pt(a,c)}}return this.fn(i)}hn(e,n,r){return this.Pn(e,n,r.position)}fn(e){let n=[];for(let r=0;r<e.length;++r)n[r]=e[r].Wt();return n}mn(e,n,r){let i=[...e],s=[];for(let o of r.arrayValue.values||[])for(let a of i){let u=new xs;u.seed(a.Wt()),Or.bt.Pt(o,u.Ht(n.kind)),s.push(u)}return s}Vn(e,n){return!!e.filters.find(r=>r instanceof ae&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){let r=qc(e),i=ha(e);return(n?r.W("collectionGroupIndex",IDBKeyRange.bound(n,n)):r.W()).next(s=>{let o=[];return m.forEach(s,a=>i.get([a.indexId,this.uid]).next(u=>{o.push(function(l,d){let h=d?new el(d.sequenceNumber,new wn(js(d.readTime),new b(ar(d.documentKey)),d.largestBatchId)):el.empty(),f=l.fields.map(([p,g])=>new wa(qe.fromServerFormat(p),g));return new Da(l.indexId,l.collectionGroup,f,h)}(a,u))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,i)=>{let s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:K(r.collectionGroup,i.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){let i=qc(e),s=ha(e);return this.gn(e).next(o=>i.W("collectionGroupIndex",IDBKeyRange.bound(n,n)).next(a=>m.forEach(a,u=>s.put(jR(u.indexId,this.uid,o,r)))))}updateIndexEntries(e,n){let r=new Map;return m.forEach(n,(i,s)=>{let o=r.get(i.collectionGroup);return(o?m.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),m.forEach(a,u=>this.pn(e,i,u).next(c=>{let l=this.yn(s,u);return c.isEqual(l)?m.resolve():this.wn(e,s,u,c,l)}))))})}Sn(e,n,r,i){return da(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.Rn(r,n.key),documentKey:n.key.path.toArray()})}bn(e,n,r,i){return da(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.Rn(r,n.key),n.key.path.toArray()])}pn(e,n,r){let i=da(e),s=new Ce(yi);return i.Y({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.Rn(r,n)])},(o,a)=>{s=s.add(new Ms(r.indexId,n,a.arrayValue,a.directionalValue))}).next(()=>s)}yn(e,n){let r=new Ce(yi),i=this.An(n,e);if(i==null)return r;let s=zw(n);if(s!=null){let o=e.data.field(s.fieldPath);if(sl(o))for(let a of o.arrayValue.values||[])r=r.add(new Ms(n.indexId,e.key,this.Tn(a),i))}else r=r.add(new Ms(n.indexId,e.key,Qf,i));return r}wn(e,n,r,i,s){E("IndexedDbIndexManager","Updating index entries for document '%s'",n.key);let o=[];return function(u,c,l,d,h){let f=u.getIterator(),p=c.getIterator(),g=la(f),_=la(p);for(;g||_;){let C=!1,M=!1;if(g&&_){let T=l(g,_);T<0?M=!0:T>0&&(C=!0)}else g!=null?M=!0:C=!0;C?(d(_),_=la(p)):M?(h(g),g=la(f)):(g=la(f),_=la(p))}}(i,s,yi,a=>{o.push(this.Sn(e,n,r,a))},a=>{o.push(this.bn(e,n,r,a))}),m.waitFor(o)}gn(e){let n=1;return ha(e).Y({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),n=i.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((o,a)=>yi(o,a)).filter((o,a,u)=>!a||yi(o,u[a-1])!==0);let i=[];i.push(e);for(let o of r){let a=yi(o,e),u=yi(o,n);if(a===0)i[0]=e.Jt();else if(a>0&&u<0)i.push(o),i.push(o.Jt());else if(u>0)break}i.push(n);let s=[];for(let o=0;o<i.length;o+=2){if(this.Dn(i[o],i[o+1]))return[];let a=[i[o].indexId,this.uid,i[o].arrayValue,i[o].directionalValue,Qf,[]],u=[i[o+1].indexId,this.uid,i[o+1].arrayValue,i[o+1].directionalValue,Qf,[]];s.push(IDBKeyRange.bound(a,u))}return s}Dn(e,n){return yi(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(zR)}getMinOffset(e,n){return m.mapArray(this.cn(n),r=>this.ln(e,r).next(i=>i||N())).next(zR)}};function GR(t){return dt(t,"collectionParents")}function da(t){return dt(t,"indexEntries")}function qc(t){return dt(t,"indexConfiguration")}function ha(t){return dt(t,"indexState")}function zR(t){O(t.length!==0);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){let i=t[r].indexState.offset;VI(i,e)<0&&(e=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new wn(e.readTime,e.documentKey,n)}var WR={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},_n=class t{constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new t(e,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};function dP(t,e,n){let r=t.store("mutations"),i=t.store("documentMutations"),s=[],o=IDBKeyRange.only(n.batchId),a=0,u=r.Y({range:o},(l,d,h)=>(a++,h.delete()));s.push(u.next(()=>{O(a===1)}));let c=[];for(let l of n.mutations){let d=_N(e,l.key.path,n.batchId);s.push(i.delete(d)),c.push(l.key)}return m.waitFor(s).next(()=>c)}function Tp(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw N();e=t.noDocument}return JSON.stringify(e).length}_n.DEFAULT_COLLECTION_PERCENTILE=10,_n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,_n.DEFAULT=new _n(41943040,_n.DEFAULT_COLLECTION_PERCENTILE,_n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),_n.DISABLED=new _n(-1,0,0);var bp=class t{constructor(e,n,r,i){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=i,this.Cn={}}static lt(e,n,r,i){O(e.uid!=="");let s=e.isAuthenticated()?e.uid:"";return new t(s,n,r,i)}checkEmpty(e){let n=!0,r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return _i(e).Y({index:"userMutationsIndex",range:r},(i,s,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,r,i){let s=_a(e),o=_i(e);return o.add({}).next(a=>{O(typeof a=="number");let u=new al(a,n,r,i),c=function(f,p,g){let _=g.baseMutations.map(M=>hl(f.ct,M)),C=g.mutations.map(M=>hl(f.ct,M));return{userId:p,batchId:g.batchId,localWriteTimeMs:g.localWriteTime.toMillis(),baseMutations:_,mutations:C}}(this.serializer,this.userId,u),l=[],d=new Ce((h,f)=>K(h.canonicalString(),f.canonicalString()));for(let h of i){let f=_N(this.userId,h.key.path,a);d=d.add(h.key.path.popLast()),l.push(o.put(c)),l.push(s.put(f,R4))}return d.forEach(h=>{l.push(this.indexManager.addToCollectionParentIndex(e,h))}),e.addOnCommittedListener(()=>{this.Cn[a]=u.keys()}),m.waitFor(l).next(()=>u)})}lookupMutationBatch(e,n){return _i(e).get(n).next(r=>r?(O(r.userId===this.userId),As(this.serializer,r)):null)}vn(e,n){return this.Cn[n]?m.resolve(this.Cn[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){let i=r.keys();return this.Cn[n]=i,i}return null})}getNextMutationBatchAfterBatchId(e,n){let r=n+1,i=IDBKeyRange.lowerBound([this.userId,r]),s=null;return _i(e).Y({index:"userMutationsIndex",range:i},(o,a,u)=>{a.userId===this.userId&&(O(a.batchId>=r),s=As(this.serializer,a)),u.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){let n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return _i(e).Y({index:"userMutationsIndex",range:n,reverse:!0},(i,s,o)=>{r=s.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){let n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return _i(e).W("userMutationsIndex",n).next(r=>r.map(i=>As(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,n){let r=Jf(this.userId,n.path),i=IDBKeyRange.lowerBound(r),s=[];return _a(e).Y({range:i},(o,a,u)=>{let[c,l,d]=o,h=ar(l);if(c===this.userId&&n.path.isEqual(h))return _i(e).get(d).next(f=>{if(!f)throw N();O(f.userId===this.userId),s.push(As(this.serializer,f))});u.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Ce(K),i=[];return n.forEach(s=>{let o=Jf(this.userId,s.path),a=IDBKeyRange.lowerBound(o),u=_a(e).Y({range:a},(c,l,d)=>{let[h,f,p]=c,g=ar(f);h===this.userId&&s.path.isEqual(g)?r=r.add(p):d.done()});i.push(u)}),m.waitFor(i).next(()=>this.Fn(e,r))}getAllMutationBatchesAffectingQuery(e,n){let r=n.path,i=r.length+1,s=Jf(this.userId,r),o=IDBKeyRange.lowerBound(s),a=new Ce(K);return _a(e).Y({range:o},(u,c,l)=>{let[d,h,f]=u,p=ar(h);d===this.userId&&r.isPrefixOf(p)?p.length===i&&(a=a.add(f)):l.done()}).next(()=>this.Fn(e,a))}Fn(e,n){let r=[],i=[];return n.forEach(s=>{i.push(_i(e).get(s).next(o=>{if(o===null)throw N();O(o.userId===this.userId),r.push(As(this.serializer,o))}))}),m.waitFor(i).next(()=>r)}removeMutationBatch(e,n){return dP(e.ae,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.Mn(n.batchId)}),m.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}Mn(e){delete this.Cn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return m.resolve();let r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),i=[];return _a(e).Y({range:r},(s,o,a)=>{if(s[0]===this.userId){let u=ar(s[1]);i.push(u)}else a.done()}).next(()=>{O(i.length===0)})})}containsKey(e,n){return hP(e,this.userId,n)}xn(e){return fP(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}};function hP(t,e,n){let r=Jf(e,n.path),i=r[1],s=IDBKeyRange.lowerBound(r),o=!1;return _a(t).Y({range:s,J:!0},(a,u,c)=>{let[l,d,h]=a;l===e&&d===i&&(o=!0),c.done()}).next(()=>o)}function _i(t){return dt(t,"mutations")}function _a(t){return dt(t,"documentMutations")}function fP(t){return dt(t,"mutationQueues")}var Ra=class t{constructor(e){this.On=e}next(){return this.On+=2,this.On}static Nn(){return new t(0)}static Bn(){return new t(-1)}};var ME=class{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.Ln(e).next(n=>{let r=new Ra(n.highestTargetId);return n.highestTargetId=r.next(),this.kn(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.Ln(e).next(n=>L.fromTimestamp(new Oe(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.Ln(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.Ln(e).next(i=>(i.highestListenSequenceNumber=n,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),n>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=n),this.kn(e,i)))}addTargetData(e,n){return this.qn(e,n).next(()=>this.Ln(e).next(r=>(r.targetCount+=1,this.Qn(n,r),this.kn(e,r))))}updateTargetData(e,n){return this.qn(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>fa(e).delete(n.targetId)).next(()=>this.Ln(e)).next(r=>(O(r.targetCount>0),r.targetCount-=1,this.kn(e,r)))}removeTargets(e,n,r){let i=0,s=[];return fa(e).Y((o,a)=>{let u=Kc(a);u.sequenceNumber<=n&&r.get(u.targetId)===null&&(i++,s.push(this.removeTargetData(e,u)))}).next(()=>m.waitFor(s)).next(()=>i)}forEachTarget(e,n){return fa(e).Y((r,i)=>{let s=Kc(i);n(s)})}Ln(e){return KR(e).get("targetGlobalKey").next(n=>(O(n!==null),n))}kn(e,n){return KR(e).put("targetGlobalKey",n)}qn(e,n){return fa(e).put(uP(this.serializer,n))}Qn(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.Ln(e).next(n=>n.targetCount)}getTargetData(e,n){let r=Fs(n),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]),s=null;return fa(e).Y({range:i,index:"queryTargetsIndex"},(o,a,u)=>{let c=Kc(a);Dl(n,c.target)&&(s=c,u.done())}).next(()=>s)}addMatchingKeys(e,n,r){let i=[],s=vi(e);return n.forEach(o=>{let a=Nt(o.path);i.push(s.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,o))}),m.waitFor(i)}removeMatchingKeys(e,n,r){let i=vi(e);return m.forEach(n,s=>{let o=Nt(s.path);return m.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,n){let r=vi(e),i=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,n){let r=IDBKeyRange.bound([n],[n+1],!1,!0),i=vi(e),s=Z();return i.Y({range:r,J:!0},(o,a,u)=>{let c=ar(o[1]),l=new b(c);s=s.add(l)}).next(()=>s)}containsKey(e,n){let r=Nt(n.path),i=IDBKeyRange.bound([r],[fN(r)],!1,!0),s=0;return vi(e).Y({index:"documentTargetsIndex",J:!0,range:i},([o,a],u,c)=>{o!==0&&(s++,c.done())}).next(()=>s>0)}_t(e,n){return fa(e).get(n).next(r=>r?Kc(r):null)}};function fa(t){return dt(t,"targets")}function KR(t){return dt(t,"targetGlobal")}function vi(t){return dt(t,"targetDocuments")}function QR([t,e],[n,r]){let i=K(t,n);return i===0?K(e,r):i}var RE=class{constructor(e){this.Kn=e,this.buffer=new Ce(QR),this.$n=0}Un(){return++this.$n}Wn(e){let n=[e,this.Un()];if(this.buffer.size<this.Kn)this.buffer=this.buffer.add(n);else{let r=this.buffer.last();QR(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}},NE=class{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Gn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.zn(6e4)}stop(){this.Gn&&(this.Gn.cancel(),this.Gn=null)}get started(){return this.Gn!==null}zn(e){E("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Gn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,()=>v(this,null,function*(){this.Gn=null;try{yield this.localStore.collectGarbage(this.garbageCollector)}catch(n){ki(n)?E("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",n):yield Pi(n)}yield this.zn(3e5)}))}},PE=class{constructor(e,n){this.jn=e,this.params=n}calculateTargetCount(e,n){return this.jn.Hn(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return m.resolve(Xt._e);let r=new RE(n);return this.jn.forEachTarget(e,i=>r.Wn(i.sequenceNumber)).next(()=>this.jn.Jn(e,i=>r.Wn(i))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.jn.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.jn.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(E("LruGarbageCollector","Garbage collection skipped; disabled"),m.resolve(WR)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(E("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),WR):this.Yn(e,n))}getCacheSize(e){return this.jn.getCacheSize(e)}Yn(e,n){let r,i,s,o,a,u,c,l=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(d=>(d>this.params.maximumSequenceNumbersToCollect?(E("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${d}`),i=this.params.maximumSequenceNumbersToCollect):i=d,o=Date.now(),this.nthSequenceNumber(e,i))).next(d=>(r=d,a=Date.now(),this.removeTargets(e,r,n))).next(d=>(s=d,u=Date.now(),this.removeOrphanedDocuments(e,r))).next(d=>(c=Date.now(),pa()<=an.DEBUG&&E("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-l}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${s} targets in `+(u-a)+`ms
	Removed ${d} documents in `+(c-u)+`ms
Total Duration: ${c-l}ms`),m.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:d})))}};function TG(t,e){return new PE(t,e)}var kE=class{constructor(e,n){this.db=e,this.garbageCollector=TG(this,n)}Hn(e){let n=this.Zn(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}Zn(e){let n=0;return this.Jn(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}Jn(e,n){return this.Xn(e,(r,i)=>n(i))}addReference(e,n,r){return Yf(e,r)}removeReference(e,n,r){return Yf(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return Yf(e,n)}er(e,n){return function(i,s){let o=!1;return fP(i).Z(a=>hP(i,a,s).next(u=>(u&&(o=!0),m.resolve(!u)))).next(()=>o)}(e,n)}removeOrphanedDocuments(e,n){let r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],s=0;return this.Xn(e,(o,a)=>{if(a<=n){let u=this.er(e,o).next(c=>{if(!c)return s++,r.getEntry(e,o).next(()=>(r.removeEntry(o,L.min()),vi(e).delete(function(d){return[0,Nt(d.path)]}(o))))});i.push(u)}}).next(()=>m.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,n){let r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return Yf(e,n)}Xn(e,n){let r=vi(e),i,s=Xt._e;return r.Y({index:"documentTargetsIndex"},([o,a],{path:u,sequenceNumber:c})=>{o===0?(s!==Xt._e&&n(new b(ar(i)),s),s=c,i=u):s=Xt._e}).next(()=>{s!==Xt._e&&n(new b(ar(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}};function Yf(t,e){return vi(t).put(function(r,i){return{targetId:0,path:Nt(r.path),sequenceNumber:i}}(e,t.currentSequenceNumber))}var Sp=class{constructor(){this.changes=new pr(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,tt.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();let r=this.changes.get(n);return r!==void 0?m.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var OE=class{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return Ts(e).put(r)}removeEntry(e,n,r){return Ts(e).delete(function(s,o){let a=s.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],Ep(o),a[a.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.tr(e,r)))}getEntry(e,n){let r=tt.newInvalidDocument(n);return Ts(e).Y({index:"documentKeyIndex",range:IDBKeyRange.only(Gc(n))},(i,s)=>{r=this.nr(n,s)}).next(()=>r)}rr(e,n){let r={size:0,document:tt.newInvalidDocument(n)};return Ts(e).Y({index:"documentKeyIndex",range:IDBKeyRange.only(Gc(n))},(i,s)=>{r={document:this.nr(n,s),size:Tp(s)}}).next(()=>r)}getEntries(e,n){let r=Gt();return this.ir(e,n,(i,s)=>{let o=this.nr(i,s);r=r.insert(i,o)}).next(()=>r)}sr(e,n){let r=Gt(),i=new xe(b.comparator);return this.ir(e,n,(s,o)=>{let a=this.nr(s,o);r=r.insert(s,a),i=i.insert(s,Tp(o))}).next(()=>({documents:r,_r:i}))}ir(e,n,r){if(n.isEmpty())return m.resolve();let i=new Ce(XR);n.forEach(u=>i=i.add(u));let s=IDBKeyRange.bound(Gc(i.first()),Gc(i.last())),o=i.getIterator(),a=o.getNext();return Ts(e).Y({index:"documentKeyIndex",range:s},(u,c,l)=>{let d=b.fromSegments([...c.prefixPath,c.collectionGroup,c.documentId]);for(;a&&XR(a,d)<0;)r(a,null),a=o.getNext();a&&a.isEqual(d)&&(r(a,c),a=o.hasNext()?o.getNext():null),a?l.U(Gc(a)):l.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,n,r,i,s){let o=n.path,a=[o.popLast().toArray(),o.lastSegment(),Ep(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],u=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Ts(e).W(IDBKeyRange.bound(a,u,!0)).next(c=>{s?.incrementDocumentReadCount(c.length);let l=Gt();for(let d of c){let h=this.nr(b.fromSegments(d.prefixPath.concat(d.collectionGroup,d.documentId)),d);h.isFoundDocument()&&(bl(n,h)||i.has(h.key))&&(l=l.insert(h.key,h))}return l})}getAllFromCollectionGroup(e,n,r,i){let s=Gt(),o=ZR(n,r),a=ZR(n,wn.max());return Ts(e).Y({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(u,c,l)=>{let d=this.nr(b.fromSegments(c.prefixPath.concat(c.collectionGroup,c.documentId)),c);s=s.insert(d.key,d),s.size===i&&l.done()}).next(()=>s)}newChangeBuffer(e){return new FE(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return YR(e).get("remoteDocumentGlobalKey").next(n=>(O(!!n),n))}tr(e,n){return YR(e).put("remoteDocumentGlobalKey",n)}nr(e,n){if(n){let r=IG(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(L.min())))return r}return tt.newInvalidDocument(e)}};function pP(t){return new OE(t)}var FE=class extends Sp{constructor(e,n){super(),this.ar=e,this.trackRemovals=n,this.ur=new pr(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){let n=[],r=0,i=new Ce((s,o)=>K(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{let a=this.ur.get(s);if(n.push(this.ar.removeEntry(e,s,a.readTime)),o.isValidDocument()){let u=VR(this.ar.serializer,o);i=i.add(s.path.popLast());let c=Tp(u);r+=c-a.size,n.push(this.ar.addEntry(e,s,u))}else if(r-=a.size,this.trackRemovals){let u=VR(this.ar.serializer,o.convertToNoDocument(L.min()));n.push(this.ar.addEntry(e,s,u))}}),i.forEach(s=>{n.push(this.ar.indexManager.addToCollectionParentIndex(e,s))}),n.push(this.ar.updateMetadata(e,r)),m.waitFor(n)}getFromCache(e,n){return this.ar.rr(e,n).next(r=>(this.ur.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this.ar.sr(e,n).next(({documents:r,_r:i})=>(i.forEach((s,o)=>{this.ur.set(s,{size:o,readTime:r.get(s).readTime})}),r))}};function YR(t){return dt(t,"remoteDocumentGlobal")}function Ts(t){return dt(t,"remoteDocumentsV14")}function Gc(t){let e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function ZR(t,e){let n=e.documentKey.path.toArray();return[t,Ep(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function XR(t,e){let n=t.path.toArray(),r=e.path.toArray(),i=0;for(let s=0;s<n.length-2&&s<r.length-2;++s)if(i=K(n[s],r[s]),i)return i;return i=K(n.length,r.length),i||(i=K(n[n.length-2],r[r.length-2]),i||K(n[n.length-1],r[r.length-1]))}var VE=class{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}};var Ap=class{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(r!==null&&Zc(r.mutation,i,Jt.empty(),Oe.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,Z()).next(()=>r))}getLocalViewOfDocuments(e,n,r=Z()){let i=ur();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let o=Wc();return s.forEach((a,u)=>{o=o.insert(a,u.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){let r=ur();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,Z()))}populateOverlays(e,n,r){let i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,i){let s=Gt(),o=Yc(),a=function(){return Yc()}();return n.forEach((u,c)=>{let l=r.get(c.key);i.has(c.key)&&(l===void 0||l.mutation instanceof Ln)?s=s.insert(c.key,c):l!==void 0?(o.set(c.key,l.mutation.getFieldMask()),Zc(l.mutation,c,l.mutation.getFieldMask(),Oe.now())):o.set(c.key,Jt.empty())}),this.recalculateAndSaveOverlays(e,s).next(u=>(u.forEach((c,l)=>o.set(c,l)),n.forEach((c,l)=>{var d;return a.set(c,new VE(l,(d=o.get(c))!==null&&d!==void 0?d:null))}),a))}recalculateAndSaveOverlays(e,n){let r=Yc(),i=new xe((o,a)=>o-a),s=Z();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(let a of o)a.keys().forEach(u=>{let c=n.get(u);if(c===null)return;let l=r.get(u)||Jt.empty();l=a.applyToLocalView(c,l),r.set(u,l);let d=(i.get(a.batchId)||Z()).add(u);i=i.insert(a.batchId,d)})}).next(()=>{let o=[],a=i.getReverseIterator();for(;a.hasNext();){let u=a.getNext(),c=u.key,l=u.value,d=VN();l.forEach(h=>{if(!s.has(h)){let f=GN(n.get(h),r.get(h));f!==null&&d.set(h,f),s=s.add(h)}}),o.push(this.documentOverlayCache.saveOverlays(e,c,d))}return m.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,i){return function(o){return b.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):BI(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{let o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):m.resolve(ur()),a=-1,u=s;return o.next(c=>m.forEach(c,(l,d)=>(a<d.largestBatchId&&(a=d.largestBatchId),s.get(l)?m.resolve():this.remoteDocumentCache.getEntry(e,l).next(h=>{u=u.insert(l,h)}))).next(()=>this.populateOverlays(e,c,s)).next(()=>this.computeViews(e,u,c,Z())).next(l=>({batchId:a,changes:FN(l)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new b(n)).next(r=>{let i=Wc();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){let s=n.collectionGroup,o=Wc();return this.indexManager.getCollectionParents(e,s).next(a=>m.forEach(a,u=>{let c=function(d,h){return new Vn(h,null,d.explicitOrderBy.slice(),d.filters.slice(),d.limit,d.limitType,d.startAt,d.endAt)}(n,u.child(s));return this.getDocumentsMatchingCollectionQuery(e,c,r,i).next(l=>{l.forEach((d,h)=>{o=o.insert(d,h)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s,i))).next(o=>{s.forEach((u,c)=>{let l=c.getKey();o.get(l)===null&&(o=o.insert(l,tt.newInvalidDocument(l)))});let a=Wc();return o.forEach((u,c)=>{let l=s.get(u);l!==void 0&&Zc(l.mutation,c,Jt.empty(),Oe.now()),bl(n,c)&&(a=a.insert(u,c))}),a})}};var LE=class{constructor(e){this.serializer=e,this.cr=new Map,this.lr=new Map}getBundleMetadata(e,n){return m.resolve(this.cr.get(n))}saveBundleMetadata(e,n){return this.cr.set(n.id,function(i){return{id:i.id,version:i.version,createTime:Ge(i.createTime)}}(n)),m.resolve()}getNamedQuery(e,n){return m.resolve(this.lr.get(n))}saveNamedQuery(e,n){return this.lr.set(n.name,function(i){return{name:i.name,query:qI(i.bundledQuery),readTime:Ge(i.readTime)}}(n)),m.resolve()}};var jE=class{constructor(){this.overlays=new xe(b.comparator),this.hr=new Map}getOverlay(e,n){return m.resolve(this.overlays.get(n))}getOverlays(e,n){let r=ur();return m.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.ht(e,n,s)}),m.resolve()}removeOverlaysForBatchId(e,n,r){let i=this.hr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.hr.delete(r)),m.resolve()}getOverlaysForCollection(e,n,r){let i=ur(),s=n.length+1,o=new b(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){let u=a.getNext().value,c=u.getKey();if(!n.isPrefixOf(c.path))break;c.path.length===s&&u.largestBatchId>r&&i.set(u.getKey(),u)}return m.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new xe((c,l)=>c-l),o=this.overlays.getIterator();for(;o.hasNext();){let c=o.getNext().value;if(c.getKey().getCollectionGroup()===n&&c.largestBatchId>r){let l=s.get(c.largestBatchId);l===null&&(l=ur(),s=s.insert(c.largestBatchId,l)),l.set(c.getKey(),c)}}let a=ur(),u=s.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((c,l)=>a.set(c,l)),!(a.size()>=i)););return m.resolve(a)}ht(e,n,r){let i=this.overlays.get(r.key);if(i!==null){let o=this.hr.get(i.largestBatchId).delete(r.key);this.hr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new ul(n,r));let s=this.hr.get(n);s===void 0&&(s=Z(),this.hr.set(n,s)),this.hr.set(n,s.add(r.key))}};var pl=class{constructor(){this.Pr=new Ce(Xe.Ir),this.Tr=new Ce(Xe.Er)}isEmpty(){return this.Pr.isEmpty()}addReference(e,n){let r=new Xe(e,n);this.Pr=this.Pr.add(r),this.Tr=this.Tr.add(r)}dr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Ar(new Xe(e,n))}Rr(e,n){e.forEach(r=>this.removeReference(r,n))}Vr(e){let n=new b(new de([])),r=new Xe(n,e),i=new Xe(n,e+1),s=[];return this.Tr.forEachInRange([r,i],o=>{this.Ar(o),s.push(o.key)}),s}mr(){this.Pr.forEach(e=>this.Ar(e))}Ar(e){this.Pr=this.Pr.delete(e),this.Tr=this.Tr.delete(e)}gr(e){let n=new b(new de([])),r=new Xe(n,e),i=new Xe(n,e+1),s=Z();return this.Tr.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){let n=new Xe(e,0),r=this.Pr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}},Xe=class{constructor(e,n){this.key=e,this.pr=n}static Ir(e,n){return b.comparator(e.key,n.key)||K(e.pr,n.pr)}static Er(e,n){return K(e.pr,n.pr)||b.comparator(e.key,n.key)}};var UE=class{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.yr=1,this.wr=new Ce(Xe.Ir)}checkEmpty(e){return m.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){let s=this.yr;this.yr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let o=new al(s,n,r,i);this.mutationQueue.push(o);for(let a of i)this.wr=this.wr.add(new Xe(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return m.resolve(o)}lookupMutationBatch(e,n){return m.resolve(this.Sr(n))}getNextMutationBatchAfterBatchId(e,n){let r=n+1,i=this.br(r),s=i<0?0:i;return m.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return m.resolve(this.mutationQueue.length===0?-1:this.yr-1)}getAllMutationBatches(e){return m.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){let r=new Xe(n,0),i=new Xe(n,Number.POSITIVE_INFINITY),s=[];return this.wr.forEachInRange([r,i],o=>{let a=this.Sr(o.pr);s.push(a)}),m.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Ce(K);return n.forEach(i=>{let s=new Xe(i,0),o=new Xe(i,Number.POSITIVE_INFINITY);this.wr.forEachInRange([s,o],a=>{r=r.add(a.pr)})}),m.resolve(this.Dr(r))}getAllMutationBatchesAffectingQuery(e,n){let r=n.path,i=r.length+1,s=r;b.isDocumentKey(s)||(s=s.child(""));let o=new Xe(new b(s),0),a=new Ce(K);return this.wr.forEachWhile(u=>{let c=u.key.path;return!!r.isPrefixOf(c)&&(c.length===i&&(a=a.add(u.pr)),!0)},o),m.resolve(this.Dr(a))}Dr(e){let n=[];return e.forEach(r=>{let i=this.Sr(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){O(this.Cr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.wr;return m.forEach(n.mutations,i=>{let s=new Xe(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.wr=r})}Mn(e){}containsKey(e,n){let r=new Xe(n,0),i=this.wr.firstAfterOrEqual(r);return m.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,m.resolve()}Cr(e,n){return this.br(e)}br(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Sr(e){let n=this.br(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}};var BE=class{constructor(e){this.vr=e,this.docs=function(){return new xe(b.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){let r=n.key,i=this.docs.get(r),s=i?i.size:0,o=this.vr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){let r=this.docs.get(n);return m.resolve(r?r.document.mutableCopy():tt.newInvalidDocument(n))}getEntries(e,n){let r=Gt();return n.forEach(i=>{let s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():tt.newInvalidDocument(i))}),m.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=Gt(),o=n.path,a=new b(o.child("")),u=this.docs.getIteratorFrom(a);for(;u.hasNext();){let{key:c,value:{document:l}}=u.getNext();if(!o.isPrefixOf(c.path))break;c.path.length>o.length+1||VI(gN(l),r)<=0||(i.has(l.key)||bl(n,l))&&(s=s.insert(l.key,l.mutableCopy()))}return m.resolve(s)}getAllFromCollectionGroup(e,n,r,i){N()}Fr(e,n){return m.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new $E(this)}getSize(e){return m.resolve(this.size)}},$E=class extends Sp{constructor(e){super(),this.ar=e}applyChanges(e){let n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.ar.addEntry(e,i)):this.ar.removeEntry(r)}),m.waitFor(n)}getFromCache(e,n){return this.ar.getEntry(e,n)}getAllFromCache(e,n){return this.ar.getEntries(e,n)}};var HE=class{constructor(e){this.persistence=e,this.Mr=new pr(n=>Fs(n),Dl),this.lastRemoteSnapshotVersion=L.min(),this.highestTargetId=0,this.Or=0,this.Nr=new pl,this.targetCount=0,this.Br=Ra.Nn()}forEachTarget(e,n){return this.Mr.forEach((r,i)=>n(i)),m.resolve()}getLastRemoteSnapshotVersion(e){return m.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return m.resolve(this.Or)}allocateTargetId(e){return this.highestTargetId=this.Br.next(),m.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Or&&(this.Or=n),m.resolve()}qn(e){this.Mr.set(e.target,e);let n=e.targetId;n>this.highestTargetId&&(this.Br=new Ra(n),this.highestTargetId=n),e.sequenceNumber>this.Or&&(this.Or=e.sequenceNumber)}addTargetData(e,n){return this.qn(n),this.targetCount+=1,m.resolve()}updateTargetData(e,n){return this.qn(n),m.resolve()}removeTargetData(e,n){return this.Mr.delete(n.target),this.Nr.Vr(n.targetId),this.targetCount-=1,m.resolve()}removeTargets(e,n,r){let i=0,s=[];return this.Mr.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.Mr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),m.waitFor(s).next(()=>i)}getTargetCount(e){return m.resolve(this.targetCount)}getTargetData(e,n){let r=this.Mr.get(n)||null;return m.resolve(r)}addMatchingKeys(e,n,r){return this.Nr.dr(n,r),m.resolve()}removeMatchingKeys(e,n,r){this.Nr.Rr(n,r);let i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),m.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this.Nr.Vr(n),m.resolve()}getMatchingKeysForTargetId(e,n){let r=this.Nr.gr(n);return m.resolve(r)}containsKey(e,n){return m.resolve(this.Nr.containsKey(n))}};var xp=class{constructor(e,n){this.Lr={},this.overlays={},this.kr=new Xt(0),this.qr=!1,this.qr=!0,this.referenceDelegate=e(this),this.Qr=new HE(this),this.indexManager=new AE,this.remoteDocumentCache=function(i){return new BE(i)}(r=>this.referenceDelegate.Kr(r)),this.serializer=new wp(n),this.$r=new LE(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.qr=!1,Promise.resolve()}get started(){return this.qr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new jE,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.Lr[e.toKey()];return r||(r=new UE(n,this.referenceDelegate),this.Lr[e.toKey()]=r),r}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.$r}runTransaction(e,n,r){E("MemoryPersistence","Starting transaction:",e);let i=new qE(this.kr.next());return this.referenceDelegate.Ur(),r(i).next(s=>this.referenceDelegate.Wr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Gr(e,n){return m.or(Object.values(this.Lr).map(r=>()=>r.containsKey(e,n)))}},qE=class extends up{constructor(e){super(),this.currentSequenceNumber=e}},Mp=class t{constructor(e){this.persistence=e,this.zr=new pl,this.jr=null}static Hr(e){return new t(e)}get Jr(){if(this.jr)return this.jr;throw N()}addReference(e,n,r){return this.zr.addReference(r,n),this.Jr.delete(r.toString()),m.resolve()}removeReference(e,n,r){return this.zr.removeReference(r,n),this.Jr.add(r.toString()),m.resolve()}markPotentiallyOrphaned(e,n){return this.Jr.add(n.toString()),m.resolve()}removeTarget(e,n){this.zr.Vr(n.targetId).forEach(i=>this.Jr.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.Jr.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}Ur(){this.jr=new Set}Wr(e){let n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return m.forEach(this.Jr,r=>{let i=b.fromPath(r);return this.Yr(e,i).next(s=>{s||n.removeEntry(i,L.min())})}).next(()=>(this.jr=null,n.apply(e)))}updateLimboDocument(e,n){return this.Yr(e,n).next(r=>{r?this.Jr.delete(n.toString()):this.Jr.add(n.toString())})}Kr(e){return 0}Yr(e,n){return m.or([()=>m.resolve(this.zr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Gr(e,n)])}};var GE=class{constructor(e){this.serializer=e}N(e,n,r,i){let s=new cp("createOrUpgrade",n);r<1&&i>=1&&(function(u){u.createObjectStore("owner")}(e),function(u){u.createObjectStore("mutationQueues",{keyPath:"userId"}),u.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",gR,{unique:!0}),u.createObjectStore("documentMutations")}(e),JR(e),function(u){u.createObjectStore("remoteDocuments")}(e));let o=m.resolve();return r<3&&i>=3&&(r!==0&&(function(u){u.deleteObjectStore("targetDocuments"),u.deleteObjectStore("targets"),u.deleteObjectStore("targetGlobal")}(e),JR(e)),o=o.next(()=>function(u){let c=u.store("targetGlobal"),l={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:L.min().toTimestamp(),targetCount:0};return c.put("targetGlobalKey",l)}(s))),r<4&&i>=4&&(r!==0&&(o=o.next(()=>function(u,c){return c.store("mutations").W().next(l=>{u.deleteObjectStore("mutations"),u.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",gR,{unique:!0});let d=c.store("mutations"),h=l.map(f=>d.put(f));return m.waitFor(h)})}(e,s))),o=o.next(()=>{(function(u){u.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&i>=5&&(o=o.next(()=>this.Xr(s))),r<6&&i>=6&&(o=o.next(()=>(function(u){u.createObjectStore("remoteDocumentGlobal")}(e),this.ei(s)))),r<7&&i>=7&&(o=o.next(()=>this.ti(s))),r<8&&i>=8&&(o=o.next(()=>this.ni(e,s))),r<9&&i>=9&&(o=o.next(()=>{(function(u){u.objectStoreNames.contains("remoteDocumentChanges")&&u.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(o=o.next(()=>this.ri(s))),r<11&&i>=11&&(o=o.next(()=>{(function(u){u.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(u){u.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(o=o.next(()=>{(function(u){let c=u.createObjectStore("documentOverlays",{keyPath:H4});c.createIndex("collectionPathOverlayIndex",q4,{unique:!1}),c.createIndex("collectionGroupOverlayIndex",G4,{unique:!1})})(e)})),r<13&&i>=13&&(o=o.next(()=>function(u){let c=u.createObjectStore("remoteDocumentsV14",{keyPath:N4});c.createIndex("documentKeyIndex",P4),c.createIndex("collectionGroupIndex",k4)}(e)).next(()=>this.ii(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(o=o.next(()=>this.si(e,s))),r<15&&i>=15&&(o=o.next(()=>function(u){u.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),u.createObjectStore("indexState",{keyPath:j4}).createIndex("sequenceNumberIndex",U4,{unique:!1}),u.createObjectStore("indexEntries",{keyPath:B4}).createIndex("documentKeyIndex",$4,{unique:!1})}(e))),o}ei(e){let n=0;return e.store("remoteDocuments").Y((r,i)=>{n+=Tp(i)}).next(()=>{let r={byteSize:n};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}Xr(e){let n=e.store("mutationQueues"),r=e.store("mutations");return n.W().next(i=>m.forEach(i,s=>{let o=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return r.W("userMutationsIndex",o).next(a=>m.forEach(a,u=>{O(u.userId===s.userId);let c=As(this.serializer,u);return dP(e,s.userId,c).next(()=>{})}))}))}ti(e){let n=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{let s=[];return r.Y((o,a)=>{let u=new de(o),c=function(d){return[0,Nt(d)]}(u);s.push(n.get(c).next(l=>l?m.resolve():(d=>n.put({targetId:0,path:Nt(d),sequenceNumber:i.highestListenSequenceNumber}))(u)))}).next(()=>m.waitFor(s))})}ni(e,n){e.createObjectStore("collectionParents",{keyPath:L4});let r=n.store("collectionParents"),i=new fl,s=o=>{if(i.add(o)){let a=o.lastSegment(),u=o.popLast();return r.put({collectionId:a,parent:Nt(u)})}};return n.store("remoteDocuments").Y({J:!0},(o,a)=>{let u=new de(o);return s(u.popLast())}).next(()=>n.store("documentMutations").Y({J:!0},([o,a,u],c)=>{let l=ar(a);return s(l.popLast())}))}ri(e){let n=e.store("targets");return n.Y((r,i)=>{let s=Kc(i),o=uP(this.serializer,s);return n.put(o)})}ii(e,n){let r=n.store("remoteDocuments"),i=[];return r.Y((s,o)=>{let a=n.store("remoteDocumentsV14"),u=function(d){return d.document?new b(de.fromString(d.document.name).popFirst(5)):d.noDocument?b.fromSegments(d.noDocument.path):d.unknownDocument?b.fromSegments(d.unknownDocument.path):N()}(o).path.toArray(),c={prefixPath:u.slice(0,u.length-2),collectionGroup:u[u.length-2],documentId:u[u.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(a.put(c))}).next(()=>m.waitFor(i))}si(e,n){let r=n.store("mutations"),i=pP(this.serializer),s=new xp(Mp.Hr,this.serializer.ct);return r.W().next(o=>{let a=new Map;return o.forEach(u=>{var c;let l=(c=a.get(u.userId))!==null&&c!==void 0?c:Z();As(this.serializer,u).keys().forEach(d=>l=l.add(d)),a.set(u.userId,l)}),m.forEach(a,(u,c)=>{let l=new Je(c),d=Ip.lt(this.serializer,l),h=s.getIndexManager(l),f=bp.lt(l,this.serializer,h,s.referenceDelegate);return new Ap(i,f,d,h).recalculateAndSaveOverlaysForDocumentKeys(new nl(n,Xt._e),u).next()})})}};function JR(t){t.createObjectStore("targetDocuments",{keyPath:F4}).createIndex("documentTargetsIndex",V4,{unique:!0}),t.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",O4,{unique:!0}),t.createObjectStore("targetGlobal")}var Fw="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",zE=class t{constructor(e,n,r,i,s,o,a,u,c,l,d=15){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.oi=s,this.window=o,this.document=a,this._i=c,this.ai=l,this.ui=d,this.kr=null,this.qr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ci=null,this.inForeground=!1,this.li=null,this.hi=null,this.Pi=Number.NEGATIVE_INFINITY,this.Ii=h=>Promise.resolve(),!t.D())throw new w(y.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new kE(this,i),this.Ti=n+"main",this.serializer=new wp(u),this.Ei=new Vr(this.Ti,this.ui,new GE(this.serializer)),this.Qr=new ME(this.referenceDelegate,this.serializer),this.remoteDocumentCache=pP(this.serializer),this.$r=new EE,this.window&&this.window.localStorage?this.di=this.window.localStorage:(this.di=null,l===!1&&He("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Ai().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new w(y.FAILED_PRECONDITION,Fw);return this.Ri(),this.Vi(),this.mi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Qr.getHighestSequenceNumber(e))}).then(e=>{this.kr=new Xt(e,this._i)}).then(()=>{this.qr=!0}).catch(e=>(this.Ei&&this.Ei.close(),Promise.reject(e)))}fi(e){return this.Ii=n=>v(this,null,function*(){if(this.started)return e(n)}),e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ei.L(n=>v(this,null,function*(){n.newVersion===null&&(yield e())}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.oi.enqueueAndForget(()=>v(this,null,function*(){this.started&&(yield this.Ai())})))}Ai(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Zf(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.gi(e).next(n=>{n||(this.isPrimary=!1,this.oi.enqueueRetryable(()=>this.Ii(!1)))})}).next(()=>this.pi(e)).next(n=>this.isPrimary&&!n?this.yi(e).next(()=>!1):!!n&&this.wi(e).next(()=>!0))).catch(e=>{if(ki(e))return E("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return E("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.oi.enqueueRetryable(()=>this.Ii(e)),this.isPrimary=e})}gi(e){return zc(e).get("owner").next(n=>m.resolve(this.Si(n)))}bi(e){return Zf(e).delete(this.clientId)}Di(){return v(this,null,function*(){if(this.isPrimary&&!this.Ci(this.Pi,18e5)){this.Pi=Date.now();let e=yield this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{let r=dt(n,"clientMetadata");return r.W().next(i=>{let s=this.vi(i,18e5),o=i.filter(a=>s.indexOf(a)===-1);return m.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.di)for(let n of e)this.di.removeItem(this.Fi(n.clientId))}})}mi(){this.hi=this.oi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Ai().then(()=>this.Di()).then(()=>this.mi()))}Si(e){return!!e&&e.ownerId===this.clientId}pi(e){return this.ai?m.resolve(!0):zc(e).get("owner").next(n=>{if(n!==null&&this.Ci(n.leaseTimestampMs,5e3)&&!this.Mi(n.ownerId)){if(this.Si(n)&&this.networkEnabled)return!0;if(!this.Si(n)){if(!n.allowTabSynchronization)throw new w(y.FAILED_PRECONDITION,Fw);return!1}}return!(!this.networkEnabled||!this.inForeground)||Zf(e).W().next(r=>this.vi(r,5e3).find(i=>{if(this.clientId!==i.clientId){let s=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,a=this.networkEnabled===i.networkEnabled;if(s||o&&a)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&E("IndexedDbPersistence",`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}shutdown(){return v(this,null,function*(){this.qr=!1,this.xi(),this.hi&&(this.hi.cancel(),this.hi=null),this.Oi(),this.Ni(),yield this.Ei.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{let n=new nl(e,Xt._e);return this.yi(n).next(()=>this.bi(n))}),this.Ei.close(),this.Bi()})}vi(e,n){return e.filter(r=>this.Ci(r.updateTimeMs,n)&&!this.Mi(r.clientId))}Li(){return this.runTransaction("getActiveClients","readonly",e=>Zf(e).W().next(n=>this.vi(n,18e5).map(r=>r.clientId)))}get started(){return this.qr}getMutationQueue(e,n){return bp.lt(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.Qr}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new xE(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return Ip.lt(this.serializer,e)}getBundleCache(){return this.$r}runTransaction(e,n,r){E("IndexedDbPersistence","Starting transaction:",e);let i=n==="readonly"?"readonly":"readwrite",s=function(u){return u===15?W4:u===14?EN:u===13?wN:u===12?z4:u===11?vN:void N()}(this.ui),o;return this.Ei.runTransaction(e,i,s,a=>(o=new nl(a,this.kr?this.kr.next():Xt._e),n==="readwrite-primary"?this.gi(o).next(u=>!!u||this.pi(o)).next(u=>{if(!u)throw He(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.oi.enqueueRetryable(()=>this.Ii(!1)),new w(y.FAILED_PRECONDITION,mN);return r(o)}).next(u=>this.wi(o).next(()=>u)):this.ki(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}ki(e){return zc(e).get("owner").next(n=>{if(n!==null&&this.Ci(n.leaseTimestampMs,5e3)&&!this.Mi(n.ownerId)&&!this.Si(n)&&!(this.ai||this.allowTabSynchronization&&n.allowTabSynchronization))throw new w(y.FAILED_PRECONDITION,Fw)})}wi(e){let n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return zc(e).put("owner",n)}static D(){return Vr.D()}yi(e){let n=zc(e);return n.get("owner").next(r=>this.Si(r)?(E("IndexedDbPersistence","Releasing primary lease."),n.delete("owner")):m.resolve())}Ci(e,n){let r=Date.now();return!(e<r-n)&&(!(e>r)||(He(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Ri(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.li=()=>{this.oi.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.Ai()))},this.document.addEventListener("visibilitychange",this.li),this.inForeground=this.document.visibilityState==="visible")}Oi(){this.li&&(this.document.removeEventListener("visibilitychange",this.li),this.li=null)}Vi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.ci=()=>{this.xi();let n=/(?:Version|Mobile)\/1[456]/;ym()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.oi.enterRestrictedMode(!0),this.oi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.ci))}Ni(){this.ci&&(this.window.removeEventListener("pagehide",this.ci),this.ci=null)}Mi(e){var n;try{let r=((n=this.di)===null||n===void 0?void 0:n.getItem(this.Fi(e)))!==null;return E("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return He("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}xi(){if(this.di)try{this.di.setItem(this.Fi(this.clientId),String(Date.now()))}catch(e){He("Failed to set zombie client id.",e)}}Bi(){if(this.di)try{this.di.removeItem(this.Fi(this.clientId))}catch{}}Fi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}};function zc(t){return dt(t,"owner")}function Zf(t){return dt(t,"clientMetadata")}function zI(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var WE=class t{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.qi=r,this.Qi=i}static Ki(e,n){let r=Z(),i=Z();for(let s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new t(e,n.fromCache,r,i)}};var KE=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var Rp=class{constructor(){this.$i=!1,this.Ui=!1,this.Wi=100,this.Gi=function(){return ym()?8:Vr.v(fu())>0?6:4}()}initialize(e,n){this.zi=e,this.indexManager=n,this.$i=!0}getDocumentsMatchingQuery(e,n,r,i){let s={result:null};return this.ji(e,n).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.Hi(e,n,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;let o=new KE;return this.Ji(e,n,o).next(a=>{if(s.result=a,this.Ui)return this.Yi(e,n,o,a.size)})}).next(()=>s.result)}Yi(e,n,r,i){return r.documentReadCount<this.Wi?(pa()<=an.DEBUG&&E("QueryEngine","SDK will not create cache indexes for query:",ga(n),"since it only creates cache indexes for collection contains","more than or equal to",this.Wi,"documents"),m.resolve()):(pa()<=an.DEBUG&&E("QueryEngine","Query:",ga(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Gi*i?(pa()<=an.DEBUG&&E("QueryEngine","The SDK decides to create cache indexes for query:",ga(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Pt(n))):m.resolve())}ji(e,n){if(bR(n))return m.resolve(null);let r=Pt(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=mp(n,null,"F"),r=Pt(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{let o=Z(...s);return this.zi.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(u=>{let c=this.Zi(n,a);return this.Xi(n,c,o,u.readTime)?this.ji(e,mp(n,null,"F")):this.es(e,c,n,u)}))})))}Hi(e,n,r,i){return bR(n)||i.isEqual(L.min())?m.resolve(null):this.zi.getDocuments(e,r).next(s=>{let o=this.Zi(n,s);return this.Xi(n,o,r,i)?m.resolve(null):(pa()<=an.DEBUG&&E("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),ga(n)),this.es(e,o,n,pN(i,-1)).next(a=>a))})}Zi(e,n){let r=new Ce(kN(e));return n.forEach((i,s)=>{bl(e,s)&&(r=r.add(s))}),r}Xi(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;let s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ji(e,n,r){return pa()<=an.DEBUG&&E("QueryEngine","Using full collection scan to execute query:",ga(n)),this.zi.getDocumentsMatchingQuery(e,n,wn.min(),r)}es(e,n,r,i){return this.zi.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}};var QE=class{constructor(e,n,r,i){this.persistence=e,this.ts=n,this.serializer=i,this.ns=new xe(K),this.rs=new pr(s=>Fs(s),Dl),this.ss=new Map,this.os=e.getRemoteDocumentCache(),this.Qr=e.getTargetCache(),this.$r=e.getBundleCache(),this._s(r)}_s(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Ap(this.os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.os.setIndexManager(this.indexManager),this.ts.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.ns))}};function gP(t,e,n,r){return new QE(t,e,n,r)}function mP(t,e){return v(this,null,function*(){let n=x(t);return yield n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n._s(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{let o=[],a=[],u=Z();for(let c of i){o.push(c.batchId);for(let l of c.mutations)u=u.add(l.key)}for(let c of s){a.push(c.batchId);for(let l of c.mutations)u=u.add(l.key)}return n.localDocuments.getDocuments(r,u).next(c=>({us:c,removedBatchIds:o,addedBatchIds:a}))})})})}function bG(t,e){let n=x(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),s=n.os.newChangeBuffer({trackRemovals:!0});return function(a,u,c,l){let d=c.batch,h=d.keys(),f=m.resolve();return h.forEach(p=>{f=f.next(()=>l.getEntry(u,p)).next(g=>{let _=c.docVersions.get(p);O(_!==null),g.version.compareTo(_)<0&&(d.applyToRemoteDocument(g,c),g.isValidDocument()&&(g.setReadTime(c.commitVersion),l.addEntry(g)))})}),f.next(()=>a.mutationQueue.removeMutationBatch(u,d))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let u=Z();for(let c=0;c<a.mutationResults.length;++c)a.mutationResults[c].transformResults.length>0&&(u=u.add(a.batch.mutations[c].key));return u}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function yP(t){let e=x(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Qr.getLastRemoteSnapshotVersion(n))}function SG(t,e){let n=x(t),r=e.snapshotVersion,i=n.ns;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let o=n.os.newChangeBuffer({trackRemovals:!0});i=n.ns;let a=[];e.targetChanges.forEach((l,d)=>{let h=i.get(d);if(!h)return;a.push(n.Qr.removeMatchingKeys(s,l.removedDocuments,d).next(()=>n.Qr.addMatchingKeys(s,l.addedDocuments,d)));let f=h.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(d)!==null?f=f.withResumeToken(lt.EMPTY_BYTE_STRING,L.min()).withLastLimboFreeSnapshotVersion(L.min()):l.resumeToken.approximateByteSize()>0&&(f=f.withResumeToken(l.resumeToken,r)),i=i.insert(d,f),function(g,_,C){return g.resumeToken.approximateByteSize()===0||_.snapshotVersion.toMicroseconds()-g.snapshotVersion.toMicroseconds()>=3e8?!0:C.addedDocuments.size+C.modifiedDocuments.size+C.removedDocuments.size>0}(h,f,l)&&a.push(n.Qr.updateTargetData(s,f))});let u=Gt(),c=Z();if(e.documentUpdates.forEach(l=>{e.resolvedLimboDocuments.has(l)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(s,l))}),a.push(_P(s,o,e.documentUpdates).next(l=>{u=l.cs,c=l.ls})),!r.isEqual(L.min())){let l=n.Qr.getLastRemoteSnapshotVersion(s).next(d=>n.Qr.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(l)}return m.waitFor(a).next(()=>o.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,u,c)).next(()=>u)}).then(s=>(n.ns=i,s))}function _P(t,e,n){let r=Z(),i=Z();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let o=Gt();return n.forEach((a,u)=>{let c=s.get(a);u.isFoundDocument()!==c.isFoundDocument()&&(i=i.add(a)),u.isNoDocument()&&u.version.isEqual(L.min())?(e.removeEntry(a,u.readTime),o=o.insert(a,u)):!c.isValidDocument()||u.version.compareTo(c.version)>0||u.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(u),o=o.insert(a,u)):E("LocalStore","Ignoring outdated watch update for ",a,". Current version:",c.version," Watch version:",u.version)}),{cs:o,ls:i}})}function AG(t,e){let n=x(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function Na(t,e){let n=x(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.Qr.getTargetData(r,e).next(s=>s?(i=s,m.resolve(i)):n.Qr.allocateTargetId(r).next(o=>(i=new Ma(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Qr.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=n.ns.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.ns=n.ns.insert(r.targetId,r),n.rs.set(e,r.targetId)),r})}function Pa(t,e,n){return v(this,null,function*(){let r=x(t),i=r.ns.get(e),s=n?"readwrite":"readwrite-primary";try{n||(yield r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i)))}catch(o){if(!ki(o))throw o;E("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.ns=r.ns.remove(e),r.rs.delete(i.target)})}function Np(t,e,n){let r=x(t),i=L.min(),s=Z();return r.persistence.runTransaction("Execute query","readwrite",o=>function(u,c,l){let d=x(u),h=d.rs.get(l);return h!==void 0?m.resolve(d.ns.get(h)):d.Qr.getTargetData(c,l)}(r,o,Pt(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Qr.getMatchingKeysForTargetId(o,a.targetId).next(u=>{s=u})}).next(()=>r.ts.getDocumentsMatchingQuery(o,e,n?i:L.min(),n?s:Z())).next(a=>(EP(r,PN(e),a),{documents:a,hs:s})))}function vP(t,e){let n=x(t),r=x(n.Qr),i=n.ns.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",s=>r._t(s,e).next(o=>o?o.target:null))}function wP(t,e){let n=x(t),r=n.ss.get(e)||L.min();return n.persistence.runTransaction("Get new document changes","readonly",i=>n.os.getAllFromCollectionGroup(i,e,pN(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(EP(n,e,i),i))}function EP(t,e,n){let r=t.ss.get(e)||L.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t.ss.set(e,r)}function xG(t,e,n,r){return v(this,null,function*(){let i=x(t),s=Z(),o=Gt();for(let c of n){let l=e.Ps(c.metadata.name);c.document&&(s=s.add(l));let d=e.Is(c);d.setReadTime(e.Ts(c.metadata.readTime)),o=o.insert(l,d)}let a=i.os.newChangeBuffer({trackRemovals:!0}),u=yield Na(i,function(l){return Pt(Ua(de.fromString(`__bundle__/docs/${l}`)))}(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",c=>_P(c,a,o).next(l=>(a.apply(c),l)).next(l=>i.Qr.removeMatchingKeysForTargetId(c,u.targetId).next(()=>i.Qr.addMatchingKeys(c,s,u.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(c,l.cs,l.ls)).next(()=>l.cs)))})}function MG(r,i){return v(this,arguments,function*(t,e,n=Z()){let s=yield Na(t,Pt(qI(e.bundledQuery))),o=x(t);return o.persistence.runTransaction("Save named query","readwrite",a=>{let u=Ge(e.readTime);if(s.snapshotVersion.compareTo(u)>=0)return o.$r.saveNamedQuery(a,e);let c=s.withResumeToken(lt.EMPTY_BYTE_STRING,u);return o.ns=o.ns.insert(c.targetId,c),o.Qr.updateTargetData(a,c).next(()=>o.Qr.removeMatchingKeysForTargetId(a,s.targetId)).next(()=>o.Qr.addMatchingKeys(a,n,s.targetId)).next(()=>o.$r.saveNamedQuery(a,e))})})}function eN(t,e){return`firestore_clients_${t}_${e}`}function tN(t,e,n){let r=`firestore_mutations_${t}_${n}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function Vw(t,e){return`firestore_targets_${t}_${e}`}var Pp=class t{constructor(e,n,r,i){this.user=e,this.batchId=n,this.state=r,this.error=i}static Es(e,n,r){let i=JSON.parse(r),s,o=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return o&&i.error&&(o=typeof i.error.message=="string"&&typeof i.error.code=="string",o&&(s=new w(i.error.code,i.error.message))),o?new t(e,n,i.state,s):(He("SharedClientState",`Failed to parse mutation state for ID '${n}': ${r}`),null)}ds(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},Xc=class t{constructor(e,n,r){this.targetId=e,this.state=n,this.error=r}static Es(e,n){let r=JSON.parse(n),i,s=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return s&&r.error&&(s=typeof r.error.message=="string"&&typeof r.error.code=="string",s&&(i=new w(r.error.code,r.error.message))),s?new t(e,r.state,i):(He("SharedClientState",`Failed to parse target state for ID '${e}': ${n}`),null)}ds(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}},kp=class t{constructor(e,n){this.clientId=e,this.activeTargetIds=n}static Es(e,n){let r=JSON.parse(n),i=typeof r=="object"&&r.activeTargetIds instanceof Array,s=$I();for(let o=0;i&&o<r.activeTargetIds.length;++o)i=yN(r.activeTargetIds[o]),s=s.add(r.activeTargetIds[o]);return i?new t(e,s):(He("SharedClientState",`Failed to parse client data for instance '${e}': ${n}`),null)}},YE=class t{constructor(e,n){this.clientId=e,this.onlineState=n}static Es(e){let n=JSON.parse(e);return typeof n=="object"&&["Unknown","Online","Offline"].indexOf(n.onlineState)!==-1&&typeof n.clientId=="string"?new t(n.clientId,n.onlineState):(He("SharedClientState",`Failed to parse online state: ${e}`),null)}},gl=class{constructor(){this.activeTargetIds=$I()}As(e){this.activeTargetIds=this.activeTargetIds.add(e)}Rs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}ds(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}},Jc=class{constructor(e,n,r,i,s){this.window=e,this.oi=n,this.persistenceKey=r,this.Vs=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.fs=this.gs.bind(this),this.ps=new xe(K),this.started=!1,this.ys=[];let o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.ws=eN(this.persistenceKey,this.Vs),this.Ss=function(u){return`firestore_sequence_number_${u}`}(this.persistenceKey),this.ps=this.ps.insert(this.Vs,new gl),this.bs=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.Ds=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.Cs=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.vs=function(u){return`firestore_online_state_${u}`}(this.persistenceKey),this.Fs=function(u){return`firestore_bundle_loaded_v2_${u}`}(this.persistenceKey),this.window.addEventListener("storage",this.fs)}static D(e){return!(!e||!e.localStorage)}start(){return v(this,null,function*(){let e=yield this.syncEngine.Li();for(let r of e){if(r===this.Vs)continue;let i=this.getItem(eN(this.persistenceKey,r));if(i){let s=kp.Es(r,i);s&&(this.ps=this.ps.insert(s.clientId,s))}}this.Ms();let n=this.storage.getItem(this.vs);if(n){let r=this.xs(n);r&&this.Os(r)}for(let r of this.ys)this.gs(r);this.ys=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0})}writeSequenceNumber(e){this.setItem(this.Ss,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Ns(this.ps)}isActiveQueryTarget(e){let n=!1;return this.ps.forEach((r,i)=>{i.activeTargetIds.has(e)&&(n=!0)}),n}addPendingMutation(e){this.Bs(e,"pending")}updateMutationState(e,n,r){this.Bs(e,n,r),this.Ls(e)}addLocalQueryTarget(e){let n="not-current";if(this.isActiveQueryTarget(e)){let r=this.storage.getItem(Vw(this.persistenceKey,e));if(r){let i=Xc.Es(e,r);i&&(n=i.state)}}return this.ks.As(e),this.Ms(),n}removeLocalQueryTarget(e){this.ks.Rs(e),this.Ms()}isLocalQueryTarget(e){return this.ks.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Vw(this.persistenceKey,e))}updateQueryState(e,n,r){this.qs(e,n,r)}handleUserChange(e,n,r){n.forEach(i=>{this.Ls(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.Qs(e)}notifyBundleLoaded(e){this.Ks(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.fs),this.removeItem(this.ws),this.started=!1)}getItem(e){let n=this.storage.getItem(e);return E("SharedClientState","READ",e,n),n}setItem(e,n){E("SharedClientState","SET",e,n),this.storage.setItem(e,n)}removeItem(e){E("SharedClientState","REMOVE",e),this.storage.removeItem(e)}gs(e){let n=e;if(n.storageArea===this.storage){if(E("SharedClientState","EVENT",n.key,n.newValue),n.key===this.ws)return void He("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.oi.enqueueRetryable(()=>v(this,null,function*(){if(this.started){if(n.key!==null){if(this.bs.test(n.key)){if(n.newValue==null){let r=this.$s(n.key);return this.Us(r,null)}{let r=this.Ws(n.key,n.newValue);if(r)return this.Us(r.clientId,r)}}else if(this.Ds.test(n.key)){if(n.newValue!==null){let r=this.Gs(n.key,n.newValue);if(r)return this.zs(r)}}else if(this.Cs.test(n.key)){if(n.newValue!==null){let r=this.js(n.key,n.newValue);if(r)return this.Hs(r)}}else if(n.key===this.vs){if(n.newValue!==null){let r=this.xs(n.newValue);if(r)return this.Os(r)}}else if(n.key===this.Ss){let r=function(s){let o=Xt._e;if(s!=null)try{let a=JSON.parse(s);O(typeof a=="number"),o=a}catch(a){He("SharedClientState","Failed to read sequence number from WebStorage",a)}return o}(n.newValue);r!==Xt._e&&this.sequenceNumberHandler(r)}else if(n.key===this.Fs){let r=this.Js(n.newValue);yield Promise.all(r.map(i=>this.syncEngine.Ys(i)))}}}else this.ys.push(n)}))}}get ks(){return this.ps.get(this.Vs)}Ms(){this.setItem(this.ws,this.ks.ds())}Bs(e,n,r){let i=new Pp(this.currentUser,e,n,r),s=tN(this.persistenceKey,this.currentUser,e);this.setItem(s,i.ds())}Ls(e){let n=tN(this.persistenceKey,this.currentUser,e);this.removeItem(n)}Qs(e){let n={clientId:this.Vs,onlineState:e};this.storage.setItem(this.vs,JSON.stringify(n))}qs(e,n,r){let i=Vw(this.persistenceKey,e),s=new Xc(e,n,r);this.setItem(i,s.ds())}Ks(e){let n=JSON.stringify(Array.from(e));this.setItem(this.Fs,n)}$s(e){let n=this.bs.exec(e);return n?n[1]:null}Ws(e,n){let r=this.$s(e);return kp.Es(r,n)}Gs(e,n){let r=this.Ds.exec(e),i=Number(r[1]),s=r[2]!==void 0?r[2]:null;return Pp.Es(new Je(s),i,n)}js(e,n){let r=this.Cs.exec(e),i=Number(r[1]);return Xc.Es(i,n)}xs(e){return YE.Es(e)}Js(e){return JSON.parse(e)}zs(e){return v(this,null,function*(){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Zs(e.batchId,e.state,e.error);E("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})}Hs(e){return this.syncEngine.Xs(e.targetId,e.state,e.error)}Us(e,n){let r=n?this.ps.insert(e,n):this.ps.remove(e),i=this.Ns(this.ps),s=this.Ns(r),o=[],a=[];return s.forEach(u=>{i.has(u)||o.push(u)}),i.forEach(u=>{s.has(u)||a.push(u)}),this.syncEngine.eo(o,a).then(()=>{this.ps=r})}Os(e){this.ps.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Ns(e){let n=$I();return e.forEach((r,i)=>{n=n.unionWith(i.activeTargetIds)}),n}},Op=class{constructor(){this.no=new gl,this.ro={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e){return this.no.As(e),this.ro[e]||"not-current"}updateQueryState(e,n,r){this.ro[e]=n}removeLocalQueryTarget(e){this.no.Rs(e)}isLocalQueryTarget(e){return this.no.activeTargetIds.has(e)}clearQueryState(e){delete this.ro[e]}getAllActiveQueryTargets(){return this.no.activeTargetIds}isActiveQueryTarget(e){return this.no.activeTargetIds.has(e)}start(){return this.no=new gl,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var ZE=class{io(e){}shutdown(){}};var Fp=class{constructor(){this.so=()=>this.oo(),this._o=()=>this.ao(),this.uo=[],this.co()}io(e){this.uo.push(e)}shutdown(){window.removeEventListener("online",this.so),window.removeEventListener("offline",this._o)}co(){window.addEventListener("online",this.so),window.addEventListener("offline",this._o)}oo(){E("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.uo)e(0)}ao(){E("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.uo)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var Xf=null;function Lw(){return Xf===null?Xf=function(){return 268435456+Math.round(2147483648*Math.random())}():Xf++,"0x"+Xf.toString(16)}var RG={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var XE=class{constructor(e){this.lo=e.lo,this.ho=e.ho}Po(e){this.Io=e}To(e){this.Eo=e}onMessage(e){this.Ao=e}close(){this.ho()}send(e){this.lo(e)}Ro(){this.Io()}Vo(e){this.Eo(e)}mo(e){this.Ao(e)}};var bt="WebChannelConnection",JE=class extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;let r=n.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.fo=r+"://"+n.host,this.po=`projects/${i}/databases/${s}`,this.yo=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get wo(){return!1}So(n,r,i,s,o){let a=Lw(),u=this.bo(n,r.toUriEncodedString());E("RestConnection",`Sending RPC '${n}' ${a}:`,u,i);let c={"google-cloud-resource-prefix":this.po,"x-goog-request-params":this.yo};return this.Do(c,s,o),this.Co(n,u,c,i).then(l=>(E("RestConnection",`Received RPC '${n}' ${a}: `,l),l),l=>{throw vn("RestConnection",`RPC '${n}' ${a} failed with error: `,l,"url: ",u,"request:",i),l})}vo(n,r,i,s,o,a){return this.So(n,r,i,s,o)}Do(n,r,i){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+ja}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,o)=>n[o]=s),i&&i.headers.forEach((s,o)=>n[o]=s)}bo(n,r){let i=RG[n];return`${this.fo}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Co(e,n,r,i){let s=Lw();return new Promise((o,a)=>{let u=new lR;u.setWithCredentials(!0),u.listenOnce(uR.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case Kf.NO_ERROR:let l=u.getResponseJson();E(bt,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(l)),o(l);break;case Kf.TIMEOUT:E(bt,`RPC '${e}' ${s} timed out`),a(new w(y.DEADLINE_EXCEEDED,"Request time out"));break;case Kf.HTTP_ERROR:let d=u.getStatus();if(E(bt,`RPC '${e}' ${s} failed with status:`,d,"response text:",u.getResponseText()),d>0){let h=u.getResponseJson();Array.isArray(h)&&(h=h[0]);let f=h?.error;if(f&&f.status&&f.message){let p=function(_){let C=_.toLowerCase().replace(/_/g,"-");return Object.values(y).indexOf(C)>=0?C:y.UNKNOWN}(f.status);a(new w(p,f.message))}else a(new w(y.UNKNOWN,"Server responded with status "+u.getStatus()))}else a(new w(y.UNAVAILABLE,"Connection failed."));break;default:N()}}finally{E(bt,`RPC '${e}' ${s} completed.`)}});let c=JSON.stringify(i);E(bt,`RPC '${e}' ${s} sending request:`,i),u.send(n,"POST",c,r,15)})}Fo(e,n,r){let i=Lw(),s=[this.fo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=oR(),a=aR(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(u.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(u.useFetchStreams=!0),this.Do(u.initMessageHeaders,n,r),u.encodeInitMessageHeaders=!0;let l=s.join("");E(bt,`Creating RPC '${e}' stream ${i}: ${l}`,u);let d=o.createWebChannel(l,u),h=!1,f=!1,p=new XE({lo:_=>{f?E(bt,`Not sending because RPC '${e}' stream ${i} is closed:`,_):(h||(E(bt,`Opening RPC '${e}' stream ${i} transport.`),d.open(),h=!0),E(bt,`RPC '${e}' stream ${i} sending:`,_),d.send(_))},ho:()=>d.close()}),g=(_,C,M)=>{_.listen(C,T=>{try{M(T)}catch(j){setTimeout(()=>{throw j},0)}})};return g(d,$c.EventType.OPEN,()=>{f||E(bt,`RPC '${e}' stream ${i} transport opened.`)}),g(d,$c.EventType.CLOSE,()=>{f||(f=!0,E(bt,`RPC '${e}' stream ${i} transport closed`),p.Vo())}),g(d,$c.EventType.ERROR,_=>{f||(f=!0,vn(bt,`RPC '${e}' stream ${i} transport errored:`,_),p.Vo(new w(y.UNAVAILABLE,"The operation could not be completed")))}),g(d,$c.EventType.MESSAGE,_=>{var C;if(!f){let M=_.data[0];O(!!M);let T=M,j=T.error||((C=T[0])===null||C===void 0?void 0:C.error);if(j){E(bt,`RPC '${e}' stream ${i} received error:`,j);let $=j.status,Y=function(pm){let N0=Ze[pm];if(N0!==void 0)return KN(N0)}($),Me=j.message;Y===void 0&&(Y=y.INTERNAL,Me="Unknown error status: "+$+" with message "+j.message),f=!0,p.Vo(new w(Y,Me)),d.close()}else E(bt,`RPC '${e}' stream ${i} received:`,M),p.mo(M)}}),g(a,cR.STAT_EVENT,_=>{_.stat===kw.PROXY?E(bt,`RPC '${e}' stream ${i} detected buffering proxy`):_.stat===kw.NOPROXY&&E(bt,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{p.Ro()},0),p}};function IP(){return typeof window<"u"?window:null}function rp(){return typeof document<"u"?document:null}function Sl(t){return new mE(t,!0)}var ml=class{constructor(e,n,r=1e3,i=1.5,s=6e4){this.oi=e,this.timerId=n,this.Mo=r,this.xo=i,this.Oo=s,this.No=0,this.Bo=null,this.Lo=Date.now(),this.reset()}reset(){this.No=0}ko(){this.No=this.Oo}qo(e){this.cancel();let n=Math.floor(this.No+this.Qo()),r=Math.max(0,Date.now()-this.Lo),i=Math.max(0,n-r);i>0&&E("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.No} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.Bo=this.oi.enqueueAfterDelay(this.timerId,i,()=>(this.Lo=Date.now(),e())),this.No*=this.xo,this.No<this.Mo&&(this.No=this.Mo),this.No>this.Oo&&(this.No=this.Oo)}Ko(){this.Bo!==null&&(this.Bo.skipDelay(),this.Bo=null)}cancel(){this.Bo!==null&&(this.Bo.cancel(),this.Bo=null)}Qo(){return(Math.random()-.5)*this.No}};var Vp=class{constructor(e,n,r,i,s,o,a,u){this.oi=e,this.$o=r,this.Uo=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=u,this.state=0,this.Wo=0,this.Go=null,this.zo=null,this.stream=null,this.jo=new ml(e,n)}Ho(){return this.state===1||this.state===5||this.Jo()}Jo(){return this.state===2||this.state===3}start(){this.state!==4?this.auth():this.Yo()}stop(){return v(this,null,function*(){this.Ho()&&(yield this.close(0))})}Zo(){this.state=0,this.jo.reset()}Xo(){this.Jo()&&this.Go===null&&(this.Go=this.oi.enqueueAfterDelay(this.$o,6e4,()=>this.e_()))}t_(e){this.n_(),this.stream.send(e)}e_(){return v(this,null,function*(){if(this.Jo())return this.close(0)})}n_(){this.Go&&(this.Go.cancel(),this.Go=null)}r_(){this.zo&&(this.zo.cancel(),this.zo=null)}close(e,n){return v(this,null,function*(){this.n_(),this.r_(),this.jo.cancel(),this.Wo++,e!==4?this.jo.reset():n&&n.code===y.RESOURCE_EXHAUSTED?(He(n.toString()),He("Using maximum backoff delay to prevent overloading the backend."),this.jo.ko()):n&&n.code===y.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.i_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.To(n)})}i_(){}auth(){this.state=1;let e=this.s_(this.Wo),n=this.Wo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Wo===n&&this.o_(r,i)},r=>{e(()=>{let i=new w(y.UNKNOWN,"Fetching auth token failed: "+r.message);return this.__(i)})})}o_(e,n){let r=this.s_(this.Wo);this.stream=this.a_(e,n),this.stream.Po(()=>{r(()=>(this.state=2,this.zo=this.oi.enqueueAfterDelay(this.Uo,1e4,()=>(this.Jo()&&(this.state=3),Promise.resolve())),this.listener.Po()))}),this.stream.To(i=>{r(()=>this.__(i))}),this.stream.onMessage(i=>{r(()=>this.onMessage(i))})}Yo(){this.state=5,this.jo.qo(()=>v(this,null,function*(){this.state=0,this.start()}))}__(e){return E("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}s_(e){return n=>{this.oi.enqueueAndForget(()=>this.Wo===e?n():(E("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},eI=class extends Vp{constructor(e,n,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}a_(e,n){return this.connection.Fo("Listen",e,n)}onMessage(e){this.jo.reset();let n=gG(this.serializer,e),r=function(s){if(!("targetChange"in s))return L.min();let o=s.targetChange;return o.targetIds&&o.targetIds.length?L.min():o.readTime?Ge(o.readTime):L.min()}(e);return this.listener.u_(n,r)}c_(e){let n={};n.database=vE(this.serializer),n.addTarget=function(s,o){let a,u=o.target;if(a=pp(u)?{documents:nP(s,u)}:{query:rP(s,u).ut},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=YN(s,o.resumeToken);let c=yE(s,o.expectedCount);c!==null&&(a.expectedCount=c)}else if(o.snapshotVersion.compareTo(L.min())>0){a.readTime=xa(s,o.snapshotVersion.toTimestamp());let c=yE(s,o.expectedCount);c!==null&&(a.expectedCount=c)}return a}(this.serializer,e);let r=yG(this.serializer,e);r&&(n.labels=r),this.t_(n)}l_(e){let n={};n.database=vE(this.serializer),n.removeTarget=e,this.t_(n)}},tI=class extends Vp{constructor(e,n,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s,this.h_=!1}get P_(){return this.h_}start(){this.h_=!1,this.lastStreamToken=void 0,super.start()}i_(){this.h_&&this.I_([])}a_(e,n){return this.connection.Fo("Write",e,n)}onMessage(e){if(O(!!e.streamToken),this.lastStreamToken=e.streamToken,this.h_){this.jo.reset();let n=mG(e.writeResults,e.commitTime),r=Ge(e.commitTime);return this.listener.T_(r,n)}return O(!e.writeResults||e.writeResults.length===0),this.h_=!0,this.listener.E_()}d_(){let e={};e.database=vE(this.serializer),this.t_(e)}I_(e){let n={streamToken:this.lastStreamToken,writes:e.map(r=>hl(this.serializer,r))};this.t_(n)}};var nI=class extends class{}{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.A_=!1}R_(){if(this.A_)throw new w(y.FAILED_PRECONDITION,"The client has already been terminated.")}So(e,n,r,i){return this.R_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.So(e,_E(n,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===y.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new w(y.UNKNOWN,s.toString())})}vo(e,n,r,i,s){return this.R_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.vo(e,_E(n,r),i,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===y.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new w(y.UNKNOWN,o.toString())})}terminate(){this.A_=!0,this.connection.terminate()}};var rI=class{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.m_=0,this.f_=null,this.g_=!0}p_(){this.m_===0&&(this.y_("Unknown"),this.f_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.f_=null,this.w_("Backend didn't respond within 10 seconds."),this.y_("Offline"),Promise.resolve())))}S_(e){this.state==="Online"?this.y_("Unknown"):(this.m_++,this.m_>=1&&(this.b_(),this.w_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.y_("Offline")))}set(e){this.b_(),this.m_=0,e==="Online"&&(this.g_=!1),this.y_(e)}y_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}w_(e){let n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.g_?(He(n),this.g_=!1):E("OnlineStateTracker",n)}b_(){this.f_!==null&&(this.f_.cancel(),this.f_=null)}};var iI=class{constructor(e,n,r,i,s){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.D_=[],this.C_=new Map,this.v_=new Set,this.F_=[],this.M_=s,this.M_.io(o=>{r.enqueueAndForget(()=>v(this,null,function*(){Oi(this)&&(E("RemoteStore","Restarting streams for network reachability change."),yield function(u){return v(this,null,function*(){let c=x(u);c.v_.add(4),yield Ba(c),c.x_.set("Unknown"),c.v_.delete(4),yield Al(c)})}(this))}))}),this.x_=new rI(r,i)}};function Al(t){return v(this,null,function*(){if(Oi(t))for(let e of t.F_)yield e(!0)})}function Ba(t){return v(this,null,function*(){for(let e of t.F_)yield e(!1)})}function ng(t,e){let n=x(t);n.C_.has(e.targetId)||(n.C_.set(e.targetId,e),QI(n)?KI(n):Ha(n).Jo()&&WI(n,e))}function yl(t,e){let n=x(t),r=Ha(n);n.C_.delete(e),r.Jo()&&CP(n,e),n.C_.size===0&&(r.Jo()?r.Xo():Oi(n)&&n.x_.set("Unknown"))}function WI(t,e){if(t.O_.Oe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(L.min())>0){let n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Ha(t).c_(e)}function CP(t,e){t.O_.Oe(e),Ha(t).l_(e)}function KI(t){t.O_=new gE({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),_t:e=>t.C_.get(e)||null,nt:()=>t.datastore.serializer.databaseId}),Ha(t).start(),t.x_.p_()}function QI(t){return Oi(t)&&!Ha(t).Ho()&&t.C_.size>0}function Oi(t){return x(t).v_.size===0}function DP(t){t.O_=void 0}function NG(t){return v(this,null,function*(){t.C_.forEach((e,n)=>{WI(t,e)})})}function PG(t,e){return v(this,null,function*(){DP(t),QI(t)?(t.x_.S_(e),KI(t)):t.x_.set("Unknown")})}function kG(t,e,n){return v(this,null,function*(){if(t.x_.set("Online"),e instanceof _p&&e.state===2&&e.cause)try{yield function(i,s){return v(this,null,function*(){let o=s.cause;for(let a of s.targetIds)i.C_.has(a)&&(yield i.remoteSyncer.rejectListen(a,o),i.C_.delete(a),i.O_.removeTarget(a))})}(t,e)}catch(r){E("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield Lp(t,r)}else if(e instanceof Ia?t.O_.$e(e):e instanceof yp?t.O_.Je(e):t.O_.Ge(e),!n.isEqual(L.min()))try{let r=yield yP(t.localStore);n.compareTo(r)>=0&&(yield function(s,o){let a=s.O_.it(o);return a.targetChanges.forEach((u,c)=>{if(u.resumeToken.approximateByteSize()>0){let l=s.C_.get(c);l&&s.C_.set(c,l.withResumeToken(u.resumeToken,o))}}),a.targetMismatches.forEach((u,c)=>{let l=s.C_.get(u);if(!l)return;s.C_.set(u,l.withResumeToken(lt.EMPTY_BYTE_STRING,l.snapshotVersion)),CP(s,u);let d=new Ma(l.target,u,c,l.sequenceNumber);WI(s,d)}),s.remoteSyncer.applyRemoteEvent(a)}(t,n))}catch(r){E("RemoteStore","Failed to raise snapshot:",r),yield Lp(t,r)}})}function Lp(t,e,n){return v(this,null,function*(){if(!ki(e))throw e;t.v_.add(1),yield Ba(t),t.x_.set("Offline"),n||(n=()=>yP(t.localStore)),t.asyncQueue.enqueueRetryable(()=>v(this,null,function*(){E("RemoteStore","Retrying IndexedDB access"),yield n(),t.v_.delete(1),yield Al(t)}))})}function TP(t,e){return e().catch(n=>Lp(t,n,e))}function $a(t){return v(this,null,function*(){let e=x(t),n=Ni(e),r=e.D_.length>0?e.D_[e.D_.length-1].batchId:-1;for(;OG(e);)try{let i=yield AG(e.localStore,r);if(i===null){e.D_.length===0&&n.Xo();break}r=i.batchId,FG(e,i)}catch(i){yield Lp(e,i)}bP(e)&&SP(e)})}function OG(t){return Oi(t)&&t.D_.length<10}function FG(t,e){t.D_.push(e);let n=Ni(t);n.Jo()&&n.P_&&n.I_(e.mutations)}function bP(t){return Oi(t)&&!Ni(t).Ho()&&t.D_.length>0}function SP(t){Ni(t).start()}function VG(t){return v(this,null,function*(){Ni(t).d_()})}function LG(t){return v(this,null,function*(){let e=Ni(t);for(let n of t.D_)e.I_(n.mutations)})}function jG(t,e,n){return v(this,null,function*(){let r=t.D_.shift(),i=hE.from(r,e,n);yield TP(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),yield $a(t)})}function UG(t,e){return v(this,null,function*(){e&&Ni(t).P_&&(yield function(r,i){return v(this,null,function*(){if(function(o){return WN(o)&&o!==y.ABORTED}(i.code)){let s=r.D_.shift();Ni(r).Zo(),yield TP(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),yield $a(r)}})}(t,e)),bP(t)&&SP(t)})}function nN(t,e){return v(this,null,function*(){let n=x(t);n.asyncQueue.verifyOperationInProgress(),E("RemoteStore","RemoteStore received new credentials");let r=Oi(n);n.v_.add(3),yield Ba(n),r&&n.x_.set("Unknown"),yield n.remoteSyncer.handleCredentialChange(e),n.v_.delete(3),yield Al(n)})}function sI(t,e){return v(this,null,function*(){let n=x(t);e?(n.v_.delete(2),yield Al(n)):e||(n.v_.add(2),yield Ba(n),n.x_.set("Unknown"))})}function Ha(t){return t.N_||(t.N_=function(n,r,i){let s=x(n);return s.R_(),new eI(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Po:NG.bind(null,t),To:PG.bind(null,t),u_:kG.bind(null,t)}),t.F_.push(e=>v(this,null,function*(){e?(t.N_.Zo(),QI(t)?KI(t):t.x_.set("Unknown")):(yield t.N_.stop(),DP(t))}))),t.N_}function Ni(t){return t.B_||(t.B_=function(n,r,i){let s=x(n);return s.R_(),new tI(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Po:VG.bind(null,t),To:UG.bind(null,t),E_:LG.bind(null,t),T_:jG.bind(null,t)}),t.F_.push(e=>v(this,null,function*(){e?(t.B_.Zo(),yield $a(t)):(yield t.B_.stop(),t.D_.length>0&&(E("RemoteStore",`Stopping write stream with ${t.D_.length} pending writes`),t.D_=[]))}))),t.B_}var oI=class t{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new et,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,s){let o=Date.now()+r,a=new t(e,n,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new w(y.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function qa(t,e){if(He("AsyncQueue",`${e}: ${t}`),ki(t))return new w(y.UNAVAILABLE,`${e}: ${t}`);throw t}var jp=class t{constructor(e){this.comparator=e?(n,r)=>e(n,r)||b.comparator(n.key,r.key):(n,r)=>b.comparator(n.key,r.key),this.keyedMap=Wc(),this.sortedSet=new xe(this.comparator)}static emptySet(e){return new t(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){let n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){let n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof t)||this.size!==e.size)return!1;let n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){let i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){let r=new t;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}};var Up=class{constructor(){this.L_=new xe(b.comparator)}track(e){let n=e.doc.key,r=this.L_.get(n);r?e.type!==0&&r.type===3?this.L_=this.L_.insert(n,e):e.type===3&&r.type!==1?this.L_=this.L_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.L_=this.L_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.L_=this.L_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.L_=this.L_.remove(n):e.type===1&&r.type===2?this.L_=this.L_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.L_=this.L_.insert(n,{type:2,doc:e.doc}):N():this.L_=this.L_.insert(n,e)}k_(){let e=[];return this.L_.inorderTraversal((n,r)=>{e.push(r)}),e}},ka=class t{constructor(e,n,r,i,s,o,a,u,c){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=u,this.hasCachedResults=c}static fromInitialDocuments(e,n,r,i,s){let o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new t(e,n,jp.emptySet(n),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Tl(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}};var aI=class{constructor(){this.q_=void 0,this.Q_=[]}},uI=class{constructor(){this.queries=new pr(e=>NN(e),Tl),this.onlineState="Unknown",this.K_=new Set}};function YI(t,e){return v(this,null,function*(){let n=x(t),r=e.query,i=!1,s=n.queries.get(r);if(s||(i=!0,s=new aI),i)try{s.q_=yield n.onListen(r)}catch(o){let a=qa(o,`Initialization of query '${ga(e.query)}' failed`);return void e.onError(a)}n.queries.set(r,s),s.Q_.push(e),e.U_(n.onlineState),s.q_&&e.W_(s.q_)&&XI(n)})}function ZI(t,e){return v(this,null,function*(){let n=x(t),r=e.query,i=!1,s=n.queries.get(r);if(s){let o=s.Q_.indexOf(e);o>=0&&(s.Q_.splice(o,1),i=s.Q_.length===0)}if(i)return n.queries.delete(r),n.onUnlisten(r)})}function BG(t,e){let n=x(t),r=!1;for(let i of e){let s=i.query,o=n.queries.get(s);if(o){for(let a of o.Q_)a.W_(i)&&(r=!0);o.q_=i}}r&&XI(n)}function $G(t,e,n){let r=x(t),i=r.queries.get(e);if(i)for(let s of i.Q_)s.onError(n);r.queries.delete(e)}function XI(t){t.K_.forEach(e=>{e.next()})}var _l=class{constructor(e,n,r){this.query=e,this.G_=n,this.z_=!1,this.j_=null,this.onlineState="Unknown",this.options=r||{}}W_(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new ka(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.z_?this.H_(e)&&(this.G_.next(e),n=!0):this.J_(e,this.onlineState)&&(this.Y_(e),n=!0),this.j_=e,n}onError(e){this.G_.error(e)}U_(e){this.onlineState=e;let n=!1;return this.j_&&!this.z_&&this.J_(this.j_,e)&&(this.Y_(this.j_),n=!0),n}J_(e,n){if(!e.fromCache)return!0;let r=n!=="Offline";return(!this.options.Z_||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}H_(e){if(e.docChanges.length>0)return!0;let n=this.j_&&this.j_.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}Y_(e){e=ka.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.z_=!0,this.G_.next(e)}};var cI=class{constructor(e,n){this.X_=e,this.byteLength=n}ea(){return"metadata"in this.X_}};var Bp=class{constructor(e){this.serializer=e}Ps(e){return lr(this.serializer,e)}Is(e){return e.metadata.exists?tP(this.serializer,e.document,!1):tt.newNoDocument(this.Ps(e.metadata.name),this.Ts(e.metadata.readTime))}Ts(e){return Ge(e)}},lI=class{constructor(e,n,r){this.ta=e,this.localStore=n,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=AP(e)}na(e){this.progress.bytesLoaded+=e.byteLength;let n=this.progress.documentsLoaded;if(e.X_.namedQuery)this.queries.push(e.X_.namedQuery);else if(e.X_.documentMetadata){this.documents.push({metadata:e.X_.documentMetadata}),e.X_.documentMetadata.exists||++n;let r=de.fromString(e.X_.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.X_.document&&(this.documents[this.documents.length-1].document=e.X_.document,++n);return n!==this.progress.documentsLoaded?(this.progress.documentsLoaded=n,Object.assign({},this.progress)):null}ra(e){let n=new Map,r=new Bp(this.serializer);for(let i of e)if(i.metadata.queries){let s=r.Ps(i.metadata.name);for(let o of i.metadata.queries){let a=(n.get(o)||Z()).add(s);n.set(o,a)}}return n}complete(){return v(this,null,function*(){let e=yield xG(this.localStore,new Bp(this.serializer),this.documents,this.ta.id),n=this.ra(this.documents);for(let r of this.queries)yield MG(this.localStore,r,n.get(r.name));return this.progress.taskState="Success",{progress:this.progress,ia:this.collectionGroups,sa:e}})}};function AP(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}var $p=class{constructor(e){this.key=e}},Hp=class{constructor(e){this.key=e}},qp=class{constructor(e,n){this.query=e,this.oa=n,this._a=null,this.hasCachedResults=!1,this.current=!1,this.aa=Z(),this.mutatedKeys=Z(),this.ua=kN(e),this.ca=new jp(this.ua)}get la(){return this.oa}ha(e,n){let r=n?n.Pa:new Up,i=n?n.ca:this.ca,s=n?n.mutatedKeys:this.mutatedKeys,o=i,a=!1,u=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,c=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((l,d)=>{let h=i.get(l),f=bl(this.query,d)?d:null,p=!!h&&this.mutatedKeys.has(h.key),g=!!f&&(f.hasLocalMutations||this.mutatedKeys.has(f.key)&&f.hasCommittedMutations),_=!1;h&&f?h.data.isEqual(f.data)?p!==g&&(r.track({type:3,doc:f}),_=!0):this.Ia(h,f)||(r.track({type:2,doc:f}),_=!0,(u&&this.ua(f,u)>0||c&&this.ua(f,c)<0)&&(a=!0)):!h&&f?(r.track({type:0,doc:f}),_=!0):h&&!f&&(r.track({type:1,doc:h}),_=!0,(u||c)&&(a=!0)),_&&(f?(o=o.add(f),s=g?s.add(l):s.delete(l)):(o=o.delete(l),s=s.delete(l)))}),this.query.limit!==null)for(;o.size>this.query.limit;){let l=this.query.limitType==="F"?o.last():o.first();o=o.delete(l.key),s=s.delete(l.key),r.track({type:1,doc:l})}return{ca:o,Pa:r,Xi:a,mutatedKeys:s}}Ia(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){let s=this.ca;this.ca=e.ca,this.mutatedKeys=e.mutatedKeys;let o=e.Pa.k_();o.sort((l,d)=>function(f,p){let g=_=>{switch(_){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return N()}};return g(f)-g(p)}(l.type,d.type)||this.ua(l.doc,d.doc)),this.Ta(r),i=i!=null&&i;let a=n&&!i?this.Ea():[],u=this.aa.size===0&&this.current&&!i?1:0,c=u!==this._a;return this._a=u,o.length!==0||c?{snapshot:new ka(this.query,e.ca,s,o,e.mutatedKeys,u===0,c,!1,!!r&&r.resumeToken.approximateByteSize()>0),da:a}:{da:a}}U_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({ca:this.ca,Pa:new Up,mutatedKeys:this.mutatedKeys,Xi:!1},!1)):{da:[]}}Aa(e){return!this.oa.has(e)&&!!this.ca.has(e)&&!this.ca.get(e).hasLocalMutations}Ta(e){e&&(e.addedDocuments.forEach(n=>this.oa=this.oa.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.oa=this.oa.delete(n)),this.current=e.current)}Ea(){if(!this.current)return[];let e=this.aa;this.aa=Z(),this.ca.forEach(r=>{this.Aa(r.key)&&(this.aa=this.aa.add(r.key))});let n=[];return e.forEach(r=>{this.aa.has(r)||n.push(new Hp(r))}),this.aa.forEach(r=>{e.has(r)||n.push(new $p(r))}),n}Ra(e){this.oa=e.hs,this.aa=Z();let n=this.ha(e.documents);return this.applyChanges(n,!0)}Va(){return ka.fromInitialDocuments(this.query,this.ca,this.mutatedKeys,this._a===0,this.hasCachedResults)}},dI=class{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}},hI=class{constructor(e){this.key=e,this.ma=!1}},fI=class{constructor(e,n,r,i,s,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.fa={},this.ga=new pr(a=>NN(a),Tl),this.pa=new Map,this.ya=new Set,this.wa=new xe(b.comparator),this.Sa=new Map,this.ba=new pl,this.Da={},this.Ca=new Map,this.va=Ra.Bn(),this.onlineState="Unknown",this.Fa=void 0}get isPrimaryClient(){return this.Fa===!0}};function HG(t,e){return v(this,null,function*(){let n=rC(t),r,i,s=n.ga.get(e);if(s)r=s.targetId,n.sharedClientState.addLocalQueryTarget(r),i=s.view.Va();else{let o=yield Na(n.localStore,Pt(e)),a=n.sharedClientState.addLocalQueryTarget(o.targetId);r=o.targetId,i=yield JI(n,e,r,a==="current",o.resumeToken),n.isPrimaryClient&&ng(n.remoteStore,o)}return i})}function JI(t,e,n,r,i){return v(this,null,function*(){t.Ma=(d,h,f)=>function(g,_,C,M){return v(this,null,function*(){let T=_.view.ha(C);T.Xi&&(T=yield Np(g.localStore,_.query,!1).then(({documents:Me})=>_.view.ha(Me,T)));let j=M&&M.targetChanges.get(_.targetId),$=M&&M.targetMismatches.get(_.targetId)!=null,Y=_.view.applyChanges(T,g.isPrimaryClient,j,$);return pI(g,_.targetId,Y.da),Y.snapshot})}(t,d,h,f);let s=yield Np(t.localStore,e,!0),o=new qp(e,s.hs),a=o.ha(s.documents),u=ll.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),c=o.applyChanges(a,t.isPrimaryClient,u);pI(t,n,c.da);let l=new dI(e,n,o);return t.ga.set(e,l),t.pa.has(n)?t.pa.get(n).push(e):t.pa.set(n,[e]),c.snapshot})}function qG(t,e){return v(this,null,function*(){let n=x(t),r=n.ga.get(e),i=n.pa.get(r.targetId);if(i.length>1)return n.pa.set(r.targetId,i.filter(s=>!Tl(s,e))),void n.ga.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)||(yield Pa(n.localStore,r.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(r.targetId),yl(n.remoteStore,r.targetId),Oa(n,r.targetId)}).catch(Pi))):(Oa(n,r.targetId),yield Pa(n.localStore,r.targetId,!0))})}function GG(t,e,n){return v(this,null,function*(){let r=iC(t);try{let i=yield function(o,a){let u=x(o),c=Oe.now(),l=a.reduce((f,p)=>f.add(p.key),Z()),d,h;return u.persistence.runTransaction("Locally write mutations","readwrite",f=>{let p=Gt(),g=Z();return u.os.getEntries(f,l).next(_=>{p=_,p.forEach((C,M)=>{M.isValidDocument()||(g=g.add(C))})}).next(()=>u.localDocuments.getOverlayedDocuments(f,p)).next(_=>{d=_;let C=[];for(let M of a){let T=uG(M,d.get(M.key).overlayedDocument);T!=null&&C.push(new Ln(M.key,T,TN(T.value.mapValue),je.exists(!0)))}return u.mutationQueue.addMutationBatch(f,c,C,a)}).next(_=>{h=_;let C=_.applyToLocalDocumentSet(d,g);return u.documentOverlayCache.saveOverlays(f,_.batchId,C)})}).then(()=>({batchId:h.batchId,changes:FN(d)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,a,u){let c=o.Da[o.currentUser.toKey()];c||(c=new xe(K)),c=c.insert(a,u),o.Da[o.currentUser.toKey()]=c}(r,i.batchId,n),yield $r(r,i.changes),yield $a(r.remoteStore)}catch(i){let s=qa(i,"Failed to persist write");n.reject(s)}})}function xP(t,e){return v(this,null,function*(){let n=x(t);try{let r=yield SG(n.localStore,e);e.targetChanges.forEach((i,s)=>{let o=n.Sa.get(s);o&&(O(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.ma=!0:i.modifiedDocuments.size>0?O(o.ma):i.removedDocuments.size>0&&(O(o.ma),o.ma=!1))}),yield $r(n,r,e)}catch(r){yield Pi(r)}})}function rN(t,e,n){let r=x(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){let i=[];r.ga.forEach((s,o)=>{let a=o.view.U_(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){let u=x(o);u.onlineState=a;let c=!1;u.queries.forEach((l,d)=>{for(let h of d.Q_)h.U_(a)&&(c=!0)}),c&&XI(u)}(r.eventManager,e),i.length&&r.fa.u_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function zG(t,e,n){return v(this,null,function*(){let r=x(t);r.sharedClientState.updateQueryState(e,"rejected",n);let i=r.Sa.get(e),s=i&&i.key;if(s){let o=new xe(b.comparator);o=o.insert(s,tt.newNoDocument(s,L.min()));let a=Z().add(s),u=new cl(L.min(),new Map,new xe(K),o,a);yield xP(r,u),r.wa=r.wa.remove(s),r.Sa.delete(e),nC(r)}else yield Pa(r.localStore,e,!1).then(()=>Oa(r,e,n)).catch(Pi)})}function WG(t,e){return v(this,null,function*(){let n=x(t),r=e.batch.batchId;try{let i=yield bG(n.localStore,e);tC(n,r,null),eC(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),yield $r(n,i)}catch(i){yield Pi(i)}})}function KG(t,e,n){return v(this,null,function*(){let r=x(t);try{let i=yield function(o,a){let u=x(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let l;return u.mutationQueue.lookupMutationBatch(c,a).next(d=>(O(d!==null),l=d.keys(),u.mutationQueue.removeMutationBatch(c,d))).next(()=>u.mutationQueue.performConsistencyCheck(c)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(c,l,a)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,l)).next(()=>u.localDocuments.getDocuments(c,l))})}(r.localStore,e);tC(r,e,n),eC(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),yield $r(r,i)}catch(i){yield Pi(i)}})}function QG(t,e){return v(this,null,function*(){let n=x(t);Oi(n.remoteStore)||E("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{let r=yield function(o){let a=x(o);return a.persistence.runTransaction("Get highest unacknowledged batch id","readonly",u=>a.mutationQueue.getHighestUnacknowledgedBatchId(u))}(n.localStore);if(r===-1)return void e.resolve();let i=n.Ca.get(r)||[];i.push(e),n.Ca.set(r,i)}catch(r){let i=qa(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}})}function eC(t,e){(t.Ca.get(e)||[]).forEach(n=>{n.resolve()}),t.Ca.delete(e)}function tC(t,e,n){let r=x(t),i=r.Da[r.currentUser.toKey()];if(i){let s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.Da[r.currentUser.toKey()]=i}}function Oa(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(let r of t.pa.get(e))t.ga.delete(r),n&&t.fa.xa(r,n);t.pa.delete(e),t.isPrimaryClient&&t.ba.Vr(e).forEach(r=>{t.ba.containsKey(r)||MP(t,r)})}function MP(t,e){t.ya.delete(e.path.canonicalString());let n=t.wa.get(e);n!==null&&(yl(t.remoteStore,n),t.wa=t.wa.remove(e),t.Sa.delete(n),nC(t))}function pI(t,e,n){for(let r of n)r instanceof $p?(t.ba.addReference(r.key,e),YG(t,r)):r instanceof Hp?(E("SyncEngine","Document no longer in limbo: "+r.key),t.ba.removeReference(r.key,e),t.ba.containsKey(r.key)||MP(t,r.key)):N()}function YG(t,e){let n=e.key,r=n.path.canonicalString();t.wa.get(n)||t.ya.has(r)||(E("SyncEngine","New document in limbo: "+n),t.ya.add(r),nC(t))}function nC(t){for(;t.ya.size>0&&t.wa.size<t.maxConcurrentLimboResolutions;){let e=t.ya.values().next().value;t.ya.delete(e);let n=new b(de.fromString(e)),r=t.va.next();t.Sa.set(r,new hI(n)),t.wa=t.wa.insert(n,r),ng(t.remoteStore,new Ma(Pt(Ua(n.path)),r,"TargetPurposeLimboResolution",Xt._e))}}function $r(t,e,n){return v(this,null,function*(){let r=x(t),i=[],s=[],o=[];r.ga.isEmpty()||(r.ga.forEach((a,u)=>{o.push(r.Ma(u,e,n).then(c=>{if((c||n)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(u.targetId,c?.fromCache?"not-current":"current"),c){i.push(c);let l=WE.Ki(u.targetId,c);s.push(l)}}))}),yield Promise.all(o),r.fa.u_(i),yield function(u,c){return v(this,null,function*(){let l=x(u);try{yield l.persistence.runTransaction("notifyLocalViewChanges","readwrite",d=>m.forEach(c,h=>m.forEach(h.qi,f=>l.persistence.referenceDelegate.addReference(d,h.targetId,f)).next(()=>m.forEach(h.Qi,f=>l.persistence.referenceDelegate.removeReference(d,h.targetId,f)))))}catch(d){if(!ki(d))throw d;E("LocalStore","Failed to update sequence numbers: "+d)}for(let d of c){let h=d.targetId;if(!d.fromCache){let f=l.ns.get(h),p=f.snapshotVersion,g=f.withLastLimboFreeSnapshotVersion(p);l.ns=l.ns.insert(h,g)}}})}(r.localStore,s))})}function ZG(t,e){return v(this,null,function*(){let n=x(t);if(!n.currentUser.isEqual(e)){E("SyncEngine","User change. New user:",e.toKey());let r=yield mP(n.localStore,e);n.currentUser=e,function(s,o){s.Ca.forEach(a=>{a.forEach(u=>{u.reject(new w(y.CANCELLED,o))})}),s.Ca.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield $r(n,r.us)}})}function XG(t,e){let n=x(t),r=n.Sa.get(e);if(r&&r.ma)return Z().add(r.key);{let i=Z(),s=n.pa.get(e);if(!s)return i;for(let o of s){let a=n.ga.get(o);i=i.unionWith(a.view.la)}return i}}function JG(t,e){return v(this,null,function*(){let n=x(t),r=yield Np(n.localStore,e.query,!0),i=e.view.Ra(r);return n.isPrimaryClient&&pI(n,e.targetId,i.da),i})}function ez(t,e){return v(this,null,function*(){let n=x(t);return wP(n.localStore,e).then(r=>$r(n,r))})}function tz(t,e,n,r){return v(this,null,function*(){let i=x(t),s=yield function(a,u){let c=x(a),l=x(c.mutationQueue);return c.persistence.runTransaction("Lookup mutation documents","readonly",d=>l.vn(d,u).next(h=>h?c.localDocuments.getDocuments(d,h):m.resolve(null)))}(i.localStore,e);s!==null?(n==="pending"?yield $a(i.remoteStore):n==="acknowledged"||n==="rejected"?(tC(i,e,r||null),eC(i,e),function(a,u){x(x(a).mutationQueue).Mn(u)}(i.localStore,e)):N(),yield $r(i,s)):E("SyncEngine","Cannot apply mutation batch with id: "+e)})}function nz(t,e){return v(this,null,function*(){let n=x(t);if(rC(n),iC(n),e===!0&&n.Fa!==!0){let r=n.sharedClientState.getAllActiveQueryTargets(),i=yield iN(n,r.toArray());n.Fa=!0,yield sI(n.remoteStore,!0);for(let s of i)ng(n.remoteStore,s)}else if(e===!1&&n.Fa!==!1){let r=[],i=Promise.resolve();n.pa.forEach((s,o)=>{n.sharedClientState.isLocalQueryTarget(o)?r.push(o):i=i.then(()=>(Oa(n,o),Pa(n.localStore,o,!0))),yl(n.remoteStore,o)}),yield i,yield iN(n,r),function(o){let a=x(o);a.Sa.forEach((u,c)=>{yl(a.remoteStore,c)}),a.ba.mr(),a.Sa=new Map,a.wa=new xe(b.comparator)}(n),n.Fa=!1,yield sI(n.remoteStore,!1)}})}function iN(t,e,n){return v(this,null,function*(){let r=x(t),i=[],s=[];for(let o of e){let a,u=r.pa.get(o);if(u&&u.length!==0){a=yield Na(r.localStore,Pt(u[0]));for(let c of u){let l=r.ga.get(c),d=yield JG(r,l);d.snapshot&&s.push(d.snapshot)}}else{let c=yield vP(r.localStore,o);a=yield Na(r.localStore,c),yield JI(r,RP(c),o,!1,a.resumeToken)}i.push(a)}return r.fa.u_(s),i})}function RP(t){return RN(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function rz(t){return function(n){return x(x(n).persistence).Li()}(x(t).localStore)}function iz(t,e,n,r){return v(this,null,function*(){let i=x(t);if(i.Fa)return void E("SyncEngine","Ignoring unexpected query state notification.");let s=i.pa.get(e);if(s&&s.length>0)switch(n){case"current":case"not-current":{let o=yield wP(i.localStore,PN(s[0])),a=cl.createSynthesizedRemoteEventForCurrentChange(e,n==="current",lt.EMPTY_BYTE_STRING);yield $r(i,o,a);break}case"rejected":yield Pa(i.localStore,e,!0),Oa(i,e,r);break;default:N()}})}function sz(t,e,n){return v(this,null,function*(){let r=rC(t);if(r.Fa){for(let i of e){if(r.pa.has(i)){E("SyncEngine","Adding an already active target "+i);continue}let s=yield vP(r.localStore,i),o=yield Na(r.localStore,s);yield JI(r,RP(s),o.targetId,!1,o.resumeToken),ng(r.remoteStore,o)}for(let i of n)r.pa.has(i)&&(yield Pa(r.localStore,i,!1).then(()=>{yl(r.remoteStore,i),Oa(r,i)}).catch(Pi))}})}function rC(t){let e=x(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=xP.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=XG.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=zG.bind(null,e),e.fa.u_=BG.bind(null,e.eventManager),e.fa.xa=$G.bind(null,e.eventManager),e}function iC(t){let e=x(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=WG.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=KG.bind(null,e),e}function oz(t,e,n){let r=x(t);(function(s,o,a){return v(this,null,function*(){try{let u=yield o.getMetadata();if(yield function(f,p){let g=x(f),_=Ge(p.createTime);return g.persistence.runTransaction("hasNewerBundle","readonly",C=>g.$r.getBundleMetadata(C,p.id)).then(C=>!!C&&C.createTime.compareTo(_)>=0)}(s.localStore,u))return yield o.close(),a._completeWith(function(f){return{taskState:"Success",documentsLoaded:f.totalDocuments,bytesLoaded:f.totalBytes,totalDocuments:f.totalDocuments,totalBytes:f.totalBytes}}(u)),Promise.resolve(new Set);a._updateProgress(AP(u));let c=new lI(u,s.localStore,o.serializer),l=yield o.Oa();for(;l;){let h=yield c.na(l);h&&a._updateProgress(h),l=yield o.Oa()}let d=yield c.complete();return yield $r(s,d.sa,void 0),yield function(f,p){let g=x(f);return g.persistence.runTransaction("Save bundle","readwrite",_=>g.$r.saveBundleMetadata(_,p))}(s.localStore,u),a._completeWith(d.progress),Promise.resolve(d.ia)}catch(u){return vn("SyncEngine",`Loading bundle failed with ${u}`),a._failWith(u),Promise.resolve(new Set)}})})(r,e,n).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}var vl=class{constructor(){this.synchronizeTabs=!1}initialize(e){return v(this,null,function*(){this.serializer=Sl(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),yield this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)})}createGarbageCollectionScheduler(e,n){return null}createIndexBackfillerScheduler(e,n){return null}createLocalStore(e){return gP(this.persistence,new Rp,e.initialUser,this.serializer)}createPersistence(e){return new xp(Mp.Hr,this.serializer)}createSharedClientState(e){return new Op}terminate(){return v(this,null,function*(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}};var Gp=class t extends vl{constructor(e,n,r){super(),this.Na=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.synchronizeTabs=!1}initialize(e){return v(this,null,function*(){yield gm(t.prototype,this,"initialize").call(this,e),yield this.Na.initialize(this,e),yield iC(this.Na.syncEngine),yield $a(this.Na.remoteStore),yield this.persistence.fi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))})}createLocalStore(e){return gP(this.persistence,new Rp,e.initialUser,this.serializer)}createGarbageCollectionScheduler(e,n){let r=this.persistence.referenceDelegate.garbageCollector;return new NE(r,e.asyncQueue,n)}createIndexBackfillerScheduler(e,n){let r=new Yw(n,this.persistence);return new Qw(e.asyncQueue,r)}createPersistence(e){let n=zI(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?_n.withCacheSize(this.cacheSizeBytes):_n.DEFAULT;return new zE(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,IP(),rp(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new Op}},gI=class t extends Gp{constructor(e,n){super(e,n,!1),this.Na=e,this.cacheSizeBytes=n,this.synchronizeTabs=!0}initialize(e){return v(this,null,function*(){yield gm(t.prototype,this,"initialize").call(this,e);let n=this.Na.syncEngine;this.sharedClientState instanceof Jc&&(this.sharedClientState.syncEngine={Zs:tz.bind(null,n),Xs:iz.bind(null,n),eo:sz.bind(null,n),Li:rz.bind(null,n),Ys:ez.bind(null,n)},yield this.sharedClientState.start()),yield this.persistence.fi(r=>v(this,null,function*(){yield nz(this.Na.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())}))})}createSharedClientState(e){let n=IP();if(!Jc.D(n))throw new w(y.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");let r=zI(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Jc(n,e.asyncQueue,r,e.clientId,e.initialUser)}},wl=class{initialize(e,n){return v(this,null,function*(){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>rN(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=ZG.bind(null,this.syncEngine),yield sI(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(e){return function(){return new uI}()}createDatastore(e){let n=Sl(e.databaseInfo.databaseId),r=function(s){return new JE(s)}(e.databaseInfo);return function(s,o,a,u){return new nI(s,o,a,u)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,i,s,o,a){return new iI(r,i,s,o,a)}(this.localStore,this.datastore,e.asyncQueue,n=>rN(this.syncEngine,n,0),function(){return Fp.D()?new Fp:new ZE}())}createSyncEngine(e,n){return function(i,s,o,a,u,c,l){let d=new fI(i,s,o,a,u,c);return l&&(d.Fa=!0),d}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}terminate(){return v(this,null,function*(){var e;yield function(r){return v(this,null,function*(){let i=x(r);E("RemoteStore","RemoteStore shutting down."),i.v_.add(5),yield Ba(i),i.M_.shutdown(),i.x_.set("Unknown")})}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate()})}};function sN(t,e=10240){let n=0;return{read(){return v(this,null,function*(){if(n<t.byteLength){let i={value:t.slice(n,n+e),done:!1};return n+=e,i}return{done:!0}})},cancel(){return v(this,null,function*(){})},releaseLock(){},closed:Promise.resolve()}}var Fa=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Ba(this.observer.next,e)}error(e){this.observer.error?this.Ba(this.observer.error,e):He("Uncaught Error in snapshot listener:",e.toString())}La(){this.muted=!0}Ba(e,n){this.muted||setTimeout(()=>{this.muted||e(n)},0)}};var mI=class{constructor(e,n){this.ka=e,this.serializer=n,this.metadata=new et,this.buffer=new Uint8Array,this.qa=function(){return new TextDecoder("utf-8")}(),this.Qa().then(r=>{r&&r.ea()?this.metadata.resolve(r.X_.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(r?.X_)}`))},r=>this.metadata.reject(r))}close(){return this.ka.cancel()}getMetadata(){return v(this,null,function*(){return this.metadata.promise})}Oa(){return v(this,null,function*(){return yield this.getMetadata(),this.Qa()})}Qa(){return v(this,null,function*(){let e=yield this.Ka();if(e===null)return null;let n=this.qa.decode(e),r=Number(n);isNaN(r)&&this.$a(`length string (${n}) is not valid number`);let i=yield this.Ua(r);return new cI(JSON.parse(i),e.length+r)})}Wa(){return this.buffer.findIndex(e=>e===123)}Ka(){return v(this,null,function*(){for(;this.Wa()<0&&!(yield this.Ga()););if(this.buffer.length===0)return null;let e=this.Wa();e<0&&this.$a("Reached the end of bundle when a length string is expected.");let n=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),n})}Ua(e){return v(this,null,function*(){for(;this.buffer.length<e;)(yield this.Ga())&&this.$a("Reached the end of bundle when more is expected.");let n=this.qa.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),n})}$a(e){throw this.ka.cancel(),new Error(`Invalid bundle format: ${e}`)}Ga(){return v(this,null,function*(){let e=yield this.ka.read();if(!e.done){let n=new Uint8Array(this.buffer.length+e.value.length);n.set(this.buffer),n.set(e.value,this.buffer.length),this.buffer=n}return e.done})}};var yI=class{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}lookup(e){return v(this,null,function*(){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new w(y.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;let n=yield function(i,s){return v(this,null,function*(){let o=x(i),a={documents:s.map(d=>dl(o.serializer,d))},u=yield o.vo("BatchGetDocuments",o.serializer.databaseId,de.emptyPath(),a,s.length),c=new Map;u.forEach(d=>{let h=pG(o.serializer,d);c.set(h.key.toString(),h)});let l=[];return s.forEach(d=>{let h=c.get(d.toString());O(!!h),l.push(h)}),l})}(this.datastore,e);return n.forEach(r=>this.recordVersion(r)),n})}set(e,n){this.write(n.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,n){try{this.write(n.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new Ri(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){return v(this,null,function*(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;let e=this.readVersions;this.mutations.forEach(n=>{e.delete(n.key.toString())}),e.forEach((n,r)=>{let i=b.fromPath(r);this.mutations.push(new ol(i,this.precondition(i)))}),yield function(r,i){return v(this,null,function*(){let s=x(r),o={writes:i.map(a=>hl(s.serializer,a))};yield s.So("Commit",s.serializer.databaseId,de.emptyPath(),o)})}(this.datastore,this.mutations),this.committed=!0})}recordVersion(e){let n;if(e.isFoundDocument())n=e.version;else{if(!e.isNoDocument())throw N();n=L.min()}let r=this.readVersions.get(e.key.toString());if(r){if(!n.isEqual(r))throw new w(y.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),n)}precondition(e){let n=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&n?n.isEqual(L.min())?je.exists(!1):je.updateTime(n):je.none()}preconditionForUpdate(e){let n=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&n){if(n.isEqual(L.min()))throw new w(y.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return je.updateTime(n)}return je.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}};var _I=class{constructor(e,n,r,i,s){this.asyncQueue=e,this.datastore=n,this.options=r,this.updateFunction=i,this.deferred=s,this.za=r.maxAttempts,this.jo=new ml(this.asyncQueue,"transaction_retry")}ja(){this.za-=1,this.Ha()}Ha(){this.jo.qo(()=>v(this,null,function*(){let e=new yI(this.datastore),n=this.Ja(e);n&&n.then(r=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(r)}).catch(i=>{this.Ya(i)}))}).catch(r=>{this.Ya(r)})}))}Ja(e){try{let n=this.updateFunction(e);return!Cl(n)&&n.catch&&n.then?n:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(n){return this.deferred.reject(n),null}}Ya(e){this.za>0&&this.Za(e)?(this.za-=1,this.asyncQueue.enqueueAndForget(()=>(this.Ha(),Promise.resolve()))):this.deferred.reject(e)}Za(e){if(e.name==="FirebaseError"){let n=e.code;return n==="aborted"||n==="failed-precondition"||n==="already-exists"||!WN(n)}return!1}};var vI=class{constructor(e,n,r,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=Je.UNAUTHENTICATED,this.clientId=op.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(r,s=>v(this,null,function*(){E("FirestoreClient","Received user=",s.uid),yield this.authCredentialListener(s),this.user=s})),this.appCheckCredentials.start(r,s=>(E("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new w(y.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();let e=new et;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>v(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){let r=qa(n,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function ip(t,e){return v(this,null,function*(){t.asyncQueue.verifyOperationInProgress(),E("FirestoreClient","Initializing OfflineComponentProvider");let n=t.configuration;yield e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(i=>v(this,null,function*(){r.isEqual(i)||(yield mP(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e})}function wI(t,e){return v(this,null,function*(){t.asyncQueue.verifyOperationInProgress();let n=yield sC(t);E("FirestoreClient","Initializing OnlineComponentProvider"),yield e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>nN(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,i)=>nN(e.remoteStore,i)),t._onlineComponents=e})}function NP(t){return t.name==="FirebaseError"?t.code===y.FAILED_PRECONDITION||t.code===y.UNIMPLEMENTED:!(typeof DOMException<"u"&&t instanceof DOMException)||t.code===22||t.code===20||t.code===11}function sC(t){return v(this,null,function*(){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){E("FirestoreClient","Using user provided OfflineComponentProvider");try{yield ip(t,t._uninitializedComponentsProvider._offline)}catch(e){let n=e;if(!NP(n))throw n;vn("Error using user provided cache. Falling back to memory cache: "+n),yield ip(t,new vl)}}else E("FirestoreClient","Using default OfflineComponentProvider"),yield ip(t,new vl);return t._offlineComponents})}function rg(t){return v(this,null,function*(){return t._onlineComponents||(t._uninitializedComponentsProvider?(E("FirestoreClient","Using user provided OnlineComponentProvider"),yield wI(t,t._uninitializedComponentsProvider._online)):(E("FirestoreClient","Using default OnlineComponentProvider"),yield wI(t,new wl))),t._onlineComponents})}function PP(t){return sC(t).then(e=>e.persistence)}function oC(t){return sC(t).then(e=>e.localStore)}function kP(t){return rg(t).then(e=>e.remoteStore)}function aC(t){return rg(t).then(e=>e.syncEngine)}function az(t){return rg(t).then(e=>e.datastore)}function Va(t){return v(this,null,function*(){let e=yield rg(t),n=e.eventManager;return n.onListen=HG.bind(null,e.syncEngine),n.onUnlisten=qG.bind(null,e.syncEngine),n})}function uz(t){return t.asyncQueue.enqueue(()=>v(this,null,function*(){let e=yield PP(t),n=yield kP(t);return e.setNetworkEnabled(!0),function(i){let s=x(i);return s.v_.delete(0),Al(s)}(n)}))}function cz(t){return t.asyncQueue.enqueue(()=>v(this,null,function*(){let e=yield PP(t),n=yield kP(t);return e.setNetworkEnabled(!1),function(i){return v(this,null,function*(){let s=x(i);s.v_.add(0),yield Ba(s),s.x_.set("Offline")})}(n)}))}function lz(t,e){let n=new et;return t.asyncQueue.enqueueAndForget(()=>v(this,null,function*(){return function(i,s,o){return v(this,null,function*(){try{let a=yield function(c,l){let d=x(c);return d.persistence.runTransaction("read document","readonly",h=>d.localDocuments.getDocument(h,l))}(i,s);a.isFoundDocument()?o.resolve(a):a.isNoDocument()?o.resolve(null):o.reject(new w(y.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(a){let u=qa(a,`Failed to get document '${s} from cache`);o.reject(u)}})}(yield oC(t),e,n)})),n.promise}function OP(t,e,n={}){let r=new et;return t.asyncQueue.enqueueAndForget(()=>v(this,null,function*(){return function(s,o,a,u,c){let l=new Fa({next:h=>{o.enqueueAndForget(()=>ZI(s,d));let f=h.docs.has(a);!f&&h.fromCache?c.reject(new w(y.UNAVAILABLE,"Failed to get document because the client is offline.")):f&&h.fromCache&&u&&u.source==="server"?c.reject(new w(y.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(h)},error:h=>c.reject(h)}),d=new _l(Ua(a.path),l,{includeMetadataChanges:!0,Z_:!0});return YI(s,d)}(yield Va(t),t.asyncQueue,e,n,r)})),r.promise}function dz(t,e){let n=new et;return t.asyncQueue.enqueueAndForget(()=>v(this,null,function*(){return function(i,s,o){return v(this,null,function*(){try{let a=yield Np(i,s,!0),u=new qp(s,a.hs),c=u.ha(a.documents),l=u.applyChanges(c,!1);o.resolve(l.snapshot)}catch(a){let u=qa(a,`Failed to execute query '${s} against cache`);o.reject(u)}})}(yield oC(t),e,n)})),n.promise}function FP(t,e,n={}){let r=new et;return t.asyncQueue.enqueueAndForget(()=>v(this,null,function*(){return function(s,o,a,u,c){let l=new Fa({next:h=>{o.enqueueAndForget(()=>ZI(s,d)),h.fromCache&&u.source==="server"?c.reject(new w(y.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(h)},error:h=>c.reject(h)}),d=new _l(a,l,{includeMetadataChanges:!0,Z_:!0});return YI(s,d)}(yield Va(t),t.asyncQueue,e,n,r)})),r.promise}function hz(t,e){let n=new Fa(e);return t.asyncQueue.enqueueAndForget(()=>v(this,null,function*(){return function(i,s){x(i).K_.add(s),s.next()}(yield Va(t),n)})),()=>{n.La(),t.asyncQueue.enqueueAndForget(()=>v(this,null,function*(){return function(i,s){x(i).K_.delete(s)}(yield Va(t),n)}))}}function fz(t,e,n,r){let i=function(o,a){let u;return u=typeof o=="string"?QN().encode(o):o,function(l,d){return new mI(l,d)}(function(l,d){if(l instanceof Uint8Array)return sN(l,d);if(l instanceof ArrayBuffer)return sN(new Uint8Array(l),d);if(l instanceof ReadableStream)return l.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(u),a)}(n,Sl(e));t.asyncQueue.enqueueAndForget(()=>v(this,null,function*(){oz(yield aC(t),i,r)}))}function pz(t,e){return t.asyncQueue.enqueue(()=>v(this,null,function*(){return function(r,i){let s=x(r);return s.persistence.runTransaction("Get named query","readonly",o=>s.$r.getNamedQuery(o,i))}(yield oC(t),e)}))}function VP(t){let e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}var oN=new Map;function uC(t,e,n){if(!n)throw new w(y.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function cC(t,e,n,r){if(e===!0&&r===!0)throw new w(y.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function aN(t){if(!b.isDocumentKey(t))throw new w(y.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function uN(t){if(b.isDocumentKey(t))throw new w(y.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function ig(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{let e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":N()}function he(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new w(y.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let n=ig(t);throw new w(y.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function LP(t,e){if(e<=0)throw new w(y.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}var zp=class{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new w(y.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new w(y.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}cC("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=VP((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new w(y.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new w(y.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new w(y.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},Us=class{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new zp({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new w(y.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(e){if(this._settingsFrozen)throw new w(y.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new zp(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new jw;switch(r.type){case"firstParty":return new Hw(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new w(y.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){let r=oN.get(n);r&&(E("ComponentProvider","Removing Datastore"),oN.delete(n),r.terminate())}(this),Promise.resolve()}};function jP(t,e,n,r={}){var i;let s=(t=he(t,Us))._getSettings(),o=`${e}:${n}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&vn("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let a,u;if(typeof r.mockUserToken=="string")a=r.mockUserToken,u=Je.MOCK_USER;else{a=gd(r.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);let c=r.mockUserToken.sub||r.mockUserToken.user_id;if(!c)throw new w(y.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new Je(c)}t._authCredentials=new Uw(new sp(a,u))}}var wt=class t{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new t(this.firestore,e,this._query)}},be=class t{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new dr(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new t(this.firestore,e,this._key)}},dr=class t extends wt{constructor(e,n,r){super(e,n,Ua(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new be(this.firestore,null,new b(e))}withConverter(e){return new t(this.firestore,e,this._path)}};function lC(t,e,...n){if(t=ie(t),uC("collection","path",e),t instanceof Us){let r=de.fromString(e,...n);return uN(r),new dr(t,null,r)}{if(!(t instanceof be||t instanceof dr))throw new w(y.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=t._path.child(de.fromString(e,...n));return uN(r),new dr(t.firestore,null,r)}}function UP(t,e){if(t=he(t,Us),uC("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new w(y.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new wt(t,null,function(r){return new Vn(de.emptyPath(),r)}(e))}function xl(t,e,...n){if(t=ie(t),arguments.length===1&&(e=op.newId()),uC("doc","path",e),t instanceof Us){let r=de.fromString(e,...n);return aN(r),new be(t,null,new b(r))}{if(!(t instanceof be||t instanceof dr))throw new w(y.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=t._path.child(de.fromString(e,...n));return aN(r),new be(t.firestore,t instanceof dr?t.converter:null,new b(r))}}function dC(t,e){return t=ie(t),e=ie(e),(t instanceof be||t instanceof dr)&&(e instanceof be||e instanceof dr)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function hC(t,e){return t=ie(t),e=ie(e),t instanceof wt&&e instanceof wt&&t.firestore===e.firestore&&Tl(t._query,e._query)&&t.converter===e.converter}var EI=class{constructor(){this.Xa=Promise.resolve(),this.eu=[],this.tu=!1,this.nu=[],this.ru=null,this.iu=!1,this.su=!1,this.ou=[],this.jo=new ml(this,"async_queue_retry"),this._u=()=>{let n=rp();n&&E("AsyncQueue","Visibility state changed to "+n.visibilityState),this.jo.Ko()};let e=rp();e&&typeof e.addEventListener=="function"&&e.addEventListener("visibilitychange",this._u)}get isShuttingDown(){return this.tu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.au(),this.uu(e)}enterRestrictedMode(e){if(!this.tu){this.tu=!0,this.su=e||!1;let n=rp();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._u)}}enqueue(e){if(this.au(),this.tu)return new Promise(()=>{});let n=new et;return this.uu(()=>this.tu&&this.su?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.eu.push(e),this.cu()))}cu(){return v(this,null,function*(){if(this.eu.length!==0){try{yield this.eu[0](),this.eu.shift(),this.jo.reset()}catch(e){if(!ki(e))throw e;E("AsyncQueue","Operation failed with retryable error: "+e)}this.eu.length>0&&this.jo.qo(()=>this.cu())}})}uu(e){let n=this.Xa.then(()=>(this.iu=!0,e().catch(r=>{this.ru=r,this.iu=!1;let i=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(r);throw He("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.iu=!1,r))));return this.Xa=n,n}enqueueAfterDelay(e,n,r){this.au(),this.ou.indexOf(e)>-1&&(n=0);let i=oI.createAndSchedule(this,e,n,r,s=>this.lu(s));return this.nu.push(i),i}au(){this.ru&&N()}verifyOperationInProgress(){}hu(){return v(this,null,function*(){let e;do e=this.Xa,yield e;while(e!==this.Xa)})}Pu(e){for(let n of this.nu)if(n.timerId===e)return!0;return!1}Iu(e){return this.hu().then(()=>{this.nu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(let n of this.nu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.hu()})}Tu(e){this.ou.push(e)}lu(e){let n=this.nu.indexOf(e);this.nu.splice(n,1)}};function II(t){return function(n,r){if(typeof n!="object"||n===null)return!1;let i=n;for(let s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(t,["next","error","complete"])}var CI=class{constructor(){this._progressObserver={},this._taskCompletionResolver=new et,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,n,r){this._progressObserver={next:e,error:n,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,n){return this._taskCompletionResolver.promise.then(e,n)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}};var BP=-1,Pe=class extends Us{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=function(){return new EI}(),this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||$P(this),this._firestoreClient.terminate()}};function st(t){return t._firestoreClient||$P(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function $P(t){var e,n,r;let i=t._freezeSettings(),s=function(a,u,c,l){return new Zw(a,u,c,l.host,l.ssl,l.experimentalForceLongPolling,l.experimentalAutoDetectLongPolling,VP(l.experimentalLongPollingOptions),l.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._firestoreClient=new vI(t._authCredentials,t._appCheckCredentials,t._queue,s),!((n=i.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._firestoreClient._uninitializedComponentsProvider={_offlineKind:i.localCache.kind,_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider})}function HP(t,e){XP(t=he(t,Pe));let n=st(t);if(n._uninitializedComponentsProvider)throw new w(y.FAILED_PRECONDITION,"SDK cache is already specified.");vn("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let r=t._freezeSettings(),i=new wl;return GP(n,i,new Gp(i,r.cacheSizeBytes,e?.forceOwnership))}function qP(t){XP(t=he(t,Pe));let e=st(t);if(e._uninitializedComponentsProvider)throw new w(y.FAILED_PRECONDITION,"SDK cache is already specified.");vn("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let n=t._freezeSettings(),r=new wl;return GP(e,r,new gI(r,n.cacheSizeBytes))}function GP(t,e,n){let r=new et;return t.asyncQueue.enqueue(()=>v(this,null,function*(){try{yield ip(t,n),yield wI(t,e),r.resolve()}catch(i){let s=i;if(!NP(s))throw s;vn("Error enabling indexeddb cache. Falling back to memory cache: "+s),r.reject(s)}})).then(()=>r.promise)}function zP(t){if(t._initialized&&!t._terminated)throw new w(y.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");let e=new et;return t._queue.enqueueAndForgetEvenWhileRestricted(()=>v(this,null,function*(){try{yield function(r){return v(this,null,function*(){if(!Vr.D())return Promise.resolve();let i=r+"main";yield Vr.delete(i)})}(zI(t._databaseId,t._persistenceKey)),e.resolve()}catch(n){e.reject(n)}})),e.promise}function WP(t){return function(n){let r=new et;return n.asyncQueue.enqueueAndForget(()=>v(this,null,function*(){return QG(yield aC(n),r)})),r.promise}(st(t=he(t,Pe)))}function KP(t){return uz(st(t=he(t,Pe)))}function QP(t){return cz(st(t=he(t,Pe)))}function YP(t,e){let n=st(t=he(t,Pe)),r=new CI;return fz(n,t._databaseId,e,r),r}function ZP(t,e){return pz(st(t=he(t,Pe)),e).then(n=>n?new wt(t,null,n.query):null)}function XP(t){if(t._initialized||t._terminated)throw new w(y.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var gr=class t{constructor(e){this._byteString=e}static fromBase64String(e){try{return new t(lt.fromBase64String(e))}catch(n){throw new w(y.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new t(lt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var jn=class{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new w(y.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new qe(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var Ur=class{constructor(e){this._methodName=e}};var Bs=class{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new w(y.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new w(y.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return K(this._lat,e._lat)||K(this._long,e._long)}};var gz=/^__.*__$/,DI=class{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new Ln(e,this.data,this.fieldMask,n,this.fieldTransforms):new Mi(e,this.data,n,this.fieldTransforms)}},Wp=class{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new Ln(e,this.data,this.fieldMask,n,this.fieldTransforms)}};function JP(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw N()}}var Kp=class t{constructor(e,n,r,i,s,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Eu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get du(){return this.settings.du}Au(e){return new t(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Ru(e){var n;let r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Au({path:r,Vu:!1});return i.mu(e),i}fu(e){var n;let r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Au({path:r,Vu:!1});return i.Eu(),i}gu(e){return this.Au({path:void 0,Vu:!0})}pu(e){return Qp(e,this.settings.methodName,this.settings.yu||!1,this.path,this.settings.wu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Eu(){if(this.path)for(let e=0;e<this.path.length;e++)this.mu(this.path.get(e))}mu(e){if(e.length===0)throw this.pu("Document fields must not be empty");if(JP(this.du)&&gz.test(e))throw this.pu('Document fields cannot begin and end with "__"')}},TI=class{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Sl(e)}Su(e,n,r,i=!1){return new Kp({du:e,methodName:n,wu:r,path:qe.emptyPath(),Vu:!1,yu:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function Gs(t){let e=t._freezeSettings(),n=Sl(t._databaseId);return new TI(t._databaseId,!!e.ignoreUndefinedProperties,n)}function sg(t,e,n,r,i,s={}){let o=t.Su(s.merge||s.mergeFields?2:0,e,n,i);gC("Data must be an object, but it was:",o,r);let a=nk(r,o),u,c;if(s.merge)u=new Jt(o.fieldMask),c=o.fieldTransforms;else if(s.mergeFields){let l=[];for(let d of s.mergeFields){let h=MI(e,d,n);if(!o.contains(h))throw new w(y.INVALID_ARGUMENT,`Field '${h}' is specified in your field mask but missing from your input data.`);ik(l,h)||l.push(h)}u=new Jt(l),c=o.fieldTransforms.filter(d=>u.covers(d.field))}else u=null,c=o.fieldTransforms;return new DI(new St(a),u,c)}var El=class t extends Ur{_toFieldTransform(e){if(e.du!==2)throw e.du===1?e.pu(`${this._methodName}() can only appear at the top level of your update data`):e.pu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof t}};function ek(t,e,n){return new Kp({du:3,wu:e.settings.wu,methodName:t._methodName,Vu:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}var bI=class t extends Ur{_toFieldTransform(e){return new Vs(e.path,new Ai)}isEqual(e){return e instanceof t}},SI=class t extends Ur{constructor(e,n){super(e),this.bu=n}_toFieldTransform(e){let n=ek(this,e,!0),r=this.bu.map(s=>zs(s,n)),i=new Lr(r);return new Vs(e.path,i)}isEqual(e){return e instanceof t&&_m(this.bu,e.bu)}},AI=class t extends Ur{constructor(e,n){super(e),this.bu=n}_toFieldTransform(e){let n=ek(this,e,!0),r=this.bu.map(s=>zs(s,n)),i=new jr(r);return new Vs(e.path,i)}isEqual(e){return e instanceof t&&_m(this.bu,e.bu)}},xI=class t extends Ur{constructor(e,n){super(e),this.Du=n}_toFieldTransform(e){let n=new xi(e.serializer,UN(e.serializer,this.Du));return new Vs(e.path,n)}isEqual(e){return e instanceof t&&this.Du===e.Du}};function fC(t,e,n,r){let i=t.Su(1,e,n);gC("Data must be an object, but it was:",i,r);let s=[],o=St.empty();qs(r,(u,c)=>{let l=mC(e,u,n);c=ie(c);let d=i.fu(l);if(c instanceof El)s.push(l);else{let h=zs(c,d);h!=null&&(s.push(l),o.set(l,h))}});let a=new Jt(s);return new Wp(o,a,i.fieldTransforms)}function pC(t,e,n,r,i,s){let o=t.Su(1,e,n),a=[MI(e,r,n)],u=[i];if(s.length%2!=0)throw new w(y.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let h=0;h<s.length;h+=2)a.push(MI(e,s[h])),u.push(s[h+1]);let c=[],l=St.empty();for(let h=a.length-1;h>=0;--h)if(!ik(c,a[h])){let f=a[h],p=u[h];p=ie(p);let g=o.fu(f);if(p instanceof El)c.push(f);else{let _=zs(p,g);_!=null&&(c.push(f),l.set(f,_))}}let d=new Jt(c);return new Wp(l,d,o.fieldTransforms)}function tk(t,e,n,r=!1){return zs(n,t.Su(r?4:3,e))}function zs(t,e){if(rk(t=ie(t)))return gC("Unsupported field value:",e,t),nk(t,e);if(t instanceof Ur)return function(r,i){if(!JP(i.du))throw i.pu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.pu(`${r._methodName}() is not currently supported inside arrays`);let s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.Vu&&e.du!==4)throw e.pu("Nested arrays are not supported");return function(r,i){let s=[],o=0;for(let a of r){let u=zs(a,i.gu(o));u==null&&(u={nullValue:"NULL_VALUE"}),s.push(u),o++}return{arrayValue:{values:s}}}(t,e)}return function(r,i){if((r=ie(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return UN(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let s=Oe.fromDate(r);return{timestampValue:xa(i.serializer,s)}}if(r instanceof Oe){let s=new Oe(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:xa(i.serializer,s)}}if(r instanceof Bs)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof gr)return{bytesValue:YN(i.serializer,r._byteString)};if(r instanceof be){let s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.pu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:HI(r.firestore._databaseId||i.databaseId,r._key.path)}}throw i.pu(`Unsupported field value: ${ig(r)}`)}(t,e)}function nk(t,e){let n={};return IN(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):qs(t,(r,i)=>{let s=zs(i,e.Ru(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function rk(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Oe||t instanceof Bs||t instanceof gr||t instanceof be||t instanceof Ur)}function gC(t,e,n){if(!rk(n)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(n)){let r=ig(n);throw r==="an object"?e.pu(t+" a custom object"):e.pu(t+" "+r)}}function MI(t,e,n){if((e=ie(e))instanceof jn)return e._internalPath;if(typeof e=="string")return mC(t,e);throw Qp("Field path arguments must be of type string or ",t,!1,void 0,n)}var mz=new RegExp("[~\\*/\\[\\]]");function mC(t,e,n){if(e.search(mz)>=0)throw Qp(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new jn(...e.split("."))._internalPath}catch{throw Qp(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Qp(t,e,n,r,i){let s=r&&!r.isEmpty(),o=i!==void 0,a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let u="";return(s||o)&&(u+=" (found",s&&(u+=` in field ${r}`),o&&(u+=` in document ${i}`),u+=")"),new w(y.INVALID_ARGUMENT,a+t+u)}function ik(t,e){return t.some(n=>n.isEqual(e))}var $s=class{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new be(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new RI(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let n=this._document.data.field(og("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}},RI=class extends $s{data(){return super.data()}};function og(t,e){return typeof e=="string"?mC(t,e):e instanceof jn?e._internalPath:e._delegate._internalPath}function sk(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new w(y.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Il=class{},Hs=class extends Il{};function Hr(t,e,...n){let r=[];e instanceof Il&&r.push(e),r=r.concat(n),function(s){let o=s.filter(u=>u instanceof NI).length,a=s.filter(u=>u instanceof Yp).length;if(o>1||o>0&&a>0)throw new w(y.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(let i of r)t=i._apply(t);return t}var Yp=class t extends Hs{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new t(e,n,r)}_apply(e){let n=this._parse(e);return gk(e._query,n),new wt(e.firestore,e.converter,lE(e._query,n))}_parse(e){let n=Gs(e.firestore);return function(s,o,a,u,c,l,d){let h;if(c.isKeyField()){if(l==="array-contains"||l==="array-contains-any")throw new w(y.INVALID_ARGUMENT,`Invalid Query. You can't perform '${l}' queries on documentId().`);if(l==="in"||l==="not-in"){lN(d,l);let f=[];for(let p of d)f.push(cN(u,s,p));h={arrayValue:{values:f}}}else h=cN(u,s,d)}else l!=="in"&&l!=="not-in"&&l!=="array-contains-any"||lN(d,l),h=tk(a,o,d,l==="in"||l==="not-in");return ae.create(c,l,h)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}};function ok(t,e,n){let r=e,i=og("where",t);return Yp._create(i,r,n)}var NI=class t extends Il{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new t(e,n)}_parse(e){let n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:we.create(n,this._getOperator())}_apply(e){let n=this._parse(e);return n.getFilters().length===0?e:(function(i,s){let o=i,a=s.getFlattenedFilters();for(let u of a)gk(o,u),o=lE(o,u)}(e._query,n),new wt(e.firestore,e.converter,lE(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};var PI=class t extends Hs{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new t(e,n)}_apply(e){let n=function(i,s,o){if(i.startAt!==null)throw new w(y.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new w(y.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Os(s,o)}(e._query,this._field,this._direction);return new wt(e.firestore,e.converter,function(i,s){let o=i.explicitOrderBy.concat([s]);return new Vn(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,n))}};function ak(t,e="asc"){let n=e,r=og("orderBy",t);return PI._create(r,n)}var Zp=class t extends Hs{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new t(e,n,r)}_apply(e){return new wt(e.firestore,e.converter,mp(e._query,this._limit,this._limitType))}};function uk(t){return LP("limit",t),Zp._create("limit",t,"F")}function ck(t){return LP("limitToLast",t),Zp._create("limitToLast",t,"L")}var Xp=class t extends Hs{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new t(e,n,r)}_apply(e){let n=pk(e,this.type,this._docOrFields,this._inclusive);return new wt(e.firestore,e.converter,function(i,s){return new Vn(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,s,i.endAt)}(e._query,n))}};function lk(...t){return Xp._create("startAt",t,!0)}function dk(...t){return Xp._create("startAfter",t,!1)}var Jp=class t extends Hs{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new t(e,n,r)}_apply(e){let n=pk(e,this.type,this._docOrFields,this._inclusive);return new wt(e.firestore,e.converter,function(i,s){return new Vn(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,s)}(e._query,n))}};function hk(...t){return Jp._create("endBefore",t,!1)}function fk(...t){return Jp._create("endAt",t,!0)}function pk(t,e,n,r){if(n[0]=ie(n[0]),n[0]instanceof $s)return function(s,o,a,u,c){if(!u)throw new w(y.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);let l=[];for(let d of Ea(s))if(d.field.isKeyField())l.push(ks(o,u.key));else{let h=u.data.field(d.field);if(tg(h))throw new w(y.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+d.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(h===null){let f=d.field.canonicalString();throw new w(y.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${f}' (used as the orderBy) does not exist.`)}l.push(h)}return new fr(l,c)}(t._query,t.firestore._databaseId,e,n[0]._document,r);{let i=Gs(t.firestore);return function(o,a,u,c,l,d){let h=o.explicitOrderBy;if(l.length>h.length)throw new w(y.INVALID_ARGUMENT,`Too many arguments provided to ${c}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);let f=[];for(let p=0;p<l.length;p++){let g=l[p];if(h[p].field.isKeyField()){if(typeof g!="string")throw new w(y.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${c}(), but got a ${typeof g}`);if(!BI(o)&&g.indexOf("/")!==-1)throw new w(y.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${c}() must be a plain document ID, but '${g}' contains a slash.`);let _=o.path.child(de.fromString(g));if(!b.isDocumentKey(_))throw new w(y.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${c}() must result in a valid document path, but '${_}' is not because it contains an odd number of segments.`);let C=new b(_);f.push(ks(a,C))}else{let _=tk(u,c,g);f.push(_)}}return new fr(f,d)}(t._query,t.firestore._databaseId,i,e,n,r)}}function cN(t,e,n){if(typeof(n=ie(n))=="string"){if(n==="")throw new w(y.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!BI(e)&&n.indexOf("/")!==-1)throw new w(y.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);let r=e.path.child(de.fromString(n));if(!b.isDocumentKey(r))throw new w(y.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return ks(t,new b(r))}if(n instanceof be)return ks(t,n._key);throw new w(y.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${ig(n)}.`)}function lN(t,e){if(!Array.isArray(t)||t.length===0)throw new w(y.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function gk(t,e){let n=function(i,s){for(let o of i)for(let a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new w(y.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new w(y.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}var La=class{convertValue(e,n="none"){switch(Ps(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Le(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Ti(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 10:return this.convertObject(e.mapValue,n);default:throw N()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){let r={};return qs(e,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertGeoPoint(e){return new Bs(Le(e.latitude),Le(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":let r=jI(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(rl(e));default:return null}}convertTimestamp(e){let n=Di(e);return new Oe(n.seconds,n.nanos)}convertDocumentKey(e,n){let r=de.fromString(e);O(aP(r));let i=new bi(r.get(1),r.get(3)),s=new b(r.popFirst(5));return i.isEqual(n)||He(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}};function ag(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}var kI=class extends La{constructor(e){super(),this.firestore=e}convertBytes(e){return new gr(e)}convertReference(e){let n=this.convertDocumentKey(e,this.firestore._databaseId);return new be(this.firestore,null,n)}};var Fr=class{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},En=class extends $s{constructor(e,n,r,i,s,o){super(e,n,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let n=new Ii(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){let r=this._document.data.field(og("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}},Ii=class extends En{data(e={}){return super.data(e)}},Un=class{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new Fr(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Ii(this._firestore,this._userDataWriter,r.key,r,new Fr(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new w(y.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{let u=new Ii(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Fr(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{let u=new Ii(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Fr(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter),c=-1,l=-1;return a.type!==0&&(c=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),l=o.indexOf(a.doc.key)),{type:yz(a.type),doc:u,oldIndex:c,newIndex:l}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}};function yz(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return N()}}function yC(t,e){return t instanceof En&&e instanceof En?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(t._document===null?e._document===null:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof Un&&e instanceof Un&&t._firestore===e._firestore&&hC(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}function mk(t){t=he(t,be);let e=he(t.firestore,Pe);return OP(st(e),t._key).then(n=>EC(e,t,n))}var Br=class extends La{constructor(e){super(),this.firestore=e}convertBytes(e){return new gr(e)}convertReference(e){let n=this.convertDocumentKey(e,this.firestore._databaseId);return new be(this.firestore,null,n)}};function yk(t){t=he(t,be);let e=he(t.firestore,Pe),n=st(e),r=new Br(e);return lz(n,t._key).then(i=>new En(e,r,t._key,i,new Fr(i!==null&&i.hasLocalMutations,!0),t.converter))}function _k(t){t=he(t,be);let e=he(t.firestore,Pe);return OP(st(e),t._key,{source:"server"}).then(n=>EC(e,t,n))}function vk(t){t=he(t,wt);let e=he(t.firestore,Pe),n=st(e),r=new Br(e);return sk(t._query),FP(n,t._query).then(i=>new Un(e,r,t,i))}function wk(t){t=he(t,wt);let e=he(t.firestore,Pe),n=st(e),r=new Br(e);return dz(n,t._query).then(i=>new Un(e,r,t,i))}function Ek(t){t=he(t,wt);let e=he(t.firestore,Pe),n=st(e),r=new Br(e);return FP(n,t._query,{source:"server"}).then(i=>new Un(e,r,t,i))}function _C(t,e,n){t=he(t,be);let r=he(t.firestore,Pe),i=ag(t.converter,e,n);return Ga(r,[sg(Gs(r),"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,je.none())])}function vC(t,e,n,...r){t=he(t,be);let i=he(t.firestore,Pe),s=Gs(i),o;return o=typeof(e=ie(e))=="string"||e instanceof jn?pC(s,"updateDoc",t._key,e,n,r):fC(s,"updateDoc",t._key,e),Ga(i,[o.toMutation(t._key,je.exists(!0))])}function Ik(t){return Ga(he(t.firestore,Pe),[new Ri(t._key,je.none())])}function Ck(t,e){let n=he(t.firestore,Pe),r=xl(t),i=ag(t.converter,e);return Ga(n,[sg(Gs(t.firestore),"addDoc",r._key,i,t.converter!==null,{}).toMutation(r._key,je.exists(!1))]).then(()=>r)}function wC(t,...e){var n,r,i;t=ie(t);let s={includeMetadataChanges:!1},o=0;typeof e[o]!="object"||II(e[o])||(s=e[o],o++);let a={includeMetadataChanges:s.includeMetadataChanges};if(II(e[o])){let d=e[o];e[o]=(n=d.next)===null||n===void 0?void 0:n.bind(d),e[o+1]=(r=d.error)===null||r===void 0?void 0:r.bind(d),e[o+2]=(i=d.complete)===null||i===void 0?void 0:i.bind(d)}let u,c,l;if(t instanceof be)c=he(t.firestore,Pe),l=Ua(t._key.path),u={next:d=>{e[o]&&e[o](EC(c,t,d))},error:e[o+1],complete:e[o+2]};else{let d=he(t,wt);c=he(d.firestore,Pe),l=d._query;let h=new Br(c);u={next:f=>{e[o]&&e[o](new Un(c,h,d,f))},error:e[o+1],complete:e[o+2]},sk(t._query)}return function(h,f,p,g){let _=new Fa(g),C=new _l(f,_,p);return h.asyncQueue.enqueueAndForget(()=>v(this,null,function*(){return YI(yield Va(h),C)})),()=>{_.La(),h.asyncQueue.enqueueAndForget(()=>v(this,null,function*(){return ZI(yield Va(h),C)}))}}(st(c),l,a,u)}function Dk(t,e){return hz(st(t=he(t,Pe)),II(e)?e:{next:e})}function Ga(t,e){return function(r,i){let s=new et;return r.asyncQueue.enqueueAndForget(()=>v(this,null,function*(){return GG(yield aC(r),i,s)})),s.promise}(st(t),e)}function EC(t,e,n){let r=n.docs.get(e._key),i=new Br(t);return new En(t,i,e._key,r,new Fr(n.hasPendingWrites,n.fromCache),e.converter)}var _z={maxAttempts:5};var eg=class{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=Gs(e)}set(e,n,r){this._verifyNotCommitted();let i=wi(e,this._firestore),s=ag(i.converter,n,r),o=sg(this._dataReader,"WriteBatch.set",i._key,s,i.converter!==null,r);return this._mutations.push(o.toMutation(i._key,je.none())),this}update(e,n,r,...i){this._verifyNotCommitted();let s=wi(e,this._firestore),o;return o=typeof(n=ie(n))=="string"||n instanceof jn?pC(this._dataReader,"WriteBatch.update",s._key,n,r,i):fC(this._dataReader,"WriteBatch.update",s._key,n),this._mutations.push(o.toMutation(s._key,je.exists(!0))),this}delete(e){this._verifyNotCommitted();let n=wi(e,this._firestore);return this._mutations=this._mutations.concat(new Ri(n._key,je.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new w(y.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function wi(t,e){if((t=ie(t)).firestore!==e)throw new w(y.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var OI=class extends class{constructor(n,r){this._firestore=n,this._transaction=r,this._dataReader=Gs(n)}get(n){let r=wi(n,this._firestore),i=new kI(this._firestore);return this._transaction.lookup([r._key]).then(s=>{if(!s||s.length!==1)return N();let o=s[0];if(o.isFoundDocument())return new $s(this._firestore,i,o.key,o,r.converter);if(o.isNoDocument())return new $s(this._firestore,i,r._key,null,r.converter);throw N()})}set(n,r,i){let s=wi(n,this._firestore),o=ag(s.converter,r,i),a=sg(this._dataReader,"Transaction.set",s._key,o,s.converter!==null,i);return this._transaction.set(s._key,a),this}update(n,r,i,...s){let o=wi(n,this._firestore),a;return a=typeof(r=ie(r))=="string"||r instanceof jn?pC(this._dataReader,"Transaction.update",o._key,r,i,s):fC(this._dataReader,"Transaction.update",o._key,r),this._transaction.update(o._key,a),this}delete(n){let r=wi(n,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,n){super(e,n),this._firestore=e}get(e){let n=wi(e,this._firestore),r=new Br(this._firestore);return super.get(e).then(i=>new En(this._firestore,r,n._key,i._document,new Fr(!1,!1),n.converter))}};function Tk(t,e,n){t=he(t,Pe);let r=Object.assign(Object.assign({},_z),n);return function(s){if(s.maxAttempts<1)throw new w(y.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(s,o,a){let u=new et;return s.asyncQueue.enqueueAndForget(()=>v(this,null,function*(){let c=yield az(s);new _I(s.asyncQueue,c,a,o,u).ja()})),u.promise}(st(t),i=>e(new OI(t,i)),r)}function bk(){return new El("deleteField")}function Sk(){return new bI("serverTimestamp")}function Ak(...t){return new SI("arrayUnion",t)}function xk(...t){return new AI("arrayRemove",t)}function Mk(t){return new xI("increment",t)}(function(e,n=!0){(function(i){ja=i})(wd),Gi(new zt("firestore",(r,{instanceIdentifier:i,options:s})=>{let o=r.getProvider("app").getImmediate(),a=new Pe(new Bw(r.getProvider("auth-internal")),new Gw(r.getProvider("app-check-internal")),function(c,l){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new w(y.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new bi(c.options.projectId,l)}(o,i),o);return s=Object.assign({useFetchStreams:n},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),Tn(hR,"4.4.2",e),Tn(hR,"4.4.2","esm2017")})();var vz="@firebase/firestore-compat",wz="0.3.25";function SC(t,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new w("invalid-argument",`Invalid options passed to function ${t}(): You cannot specify both "merge" and "mergeFields".`);return e}function Rk(){if(typeof Uint8Array>"u")throw new w("unimplemented","Uint8Arrays are not available in this environment.")}function Nk(){if(!CN())throw new w("unimplemented","Blobs are unavailable in Firestore in this environment.")}var ug=class t{constructor(e){this._delegate=e}static fromBase64String(e){return Nk(),new t(gr.fromBase64String(e))}static fromUint8Array(e){return Rk(),new t(gr.fromUint8Array(e))}toBase64(){return Nk(),this._delegate.toBase64()}toUint8Array(){return Rk(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};function IC(t){return Ez(t,["next","error","complete"])}function Ez(t,e){if(typeof t!="object"||t===null)return!1;let n=t;for(let r of e)if(r in n&&typeof n[r]=="function")return!0;return!1}var CC=class{enableIndexedDbPersistence(e,n){return HP(e._delegate,{forceOwnership:n})}enableMultiTabIndexedDbPersistence(e){return qP(e._delegate)}clearIndexedDbPersistence(e){return zP(e._delegate)}},cg=class{constructor(e,n,r){this._delegate=n,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof bi||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){let n=this._delegate._getSettings();!e.merge&&n.host!==e.host&&vn("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},n),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,n,r={}){jP(this._delegate,e,n,r)}enableNetwork(){return KP(this._delegate)}disableNetwork(){return QP(this._delegate)}enablePersistence(e){let n=!1,r=!1;return e&&(n=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,cC("synchronizeTabs",n,"experimentalForceOwningTab",r)),n?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return WP(this._delegate)}onSnapshotsInSync(e){return Dk(this._delegate,e)}get app(){if(!this._appCompat)throw new w("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new Ka(this,lC(this._delegate,e))}catch(n){throw kt(n,"collection()","Firestore.collection()")}}doc(e){try{return new mr(this,xl(this._delegate,e))}catch(n){throw kt(n,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new Ys(this,UP(this._delegate,e))}catch(n){throw kt(n,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return Tk(this._delegate,n=>e(new lg(this,n)))}batch(){return st(this._delegate),new dg(new eg(this._delegate,e=>Ga(this._delegate,e)))}loadBundle(e){return YP(this._delegate,e)}namedQuery(e){return ZP(this._delegate,e).then(n=>n?new Ys(this,n):null)}},za=class extends La{constructor(e){super(),this.firestore=e}convertBytes(e){return new ug(new gr(e))}convertReference(e){let n=this.convertDocumentKey(e,this.firestore._databaseId);return mr.forKey(n,this.firestore,null)}};function Iz(t){dN(t)}var lg=class{constructor(e,n){this._firestore=e,this._delegate=n,this._userDataWriter=new za(e)}get(e){let n=Ws(e);return this._delegate.get(n).then(r=>new Ks(this._firestore,new En(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,n.converter)))}set(e,n,r){let i=Ws(e);return r?(SC("Transaction.set",r),this._delegate.set(i,n,r)):this._delegate.set(i,n),this}update(e,n,r,...i){let s=Ws(e);return arguments.length===2?this._delegate.update(s,n):this._delegate.update(s,n,r,...i),this}delete(e){let n=Ws(e);return this._delegate.delete(n),this}},dg=class{constructor(e){this._delegate=e}set(e,n,r){let i=Ws(e);return r?(SC("WriteBatch.set",r),this._delegate.set(i,n,r)):this._delegate.set(i,n),this}update(e,n,r,...i){let s=Ws(e);return arguments.length===2?this._delegate.update(s,n):this._delegate.update(s,n,r,...i),this}delete(e){let n=Ws(e);return this._delegate.delete(n),this}commit(){return this._delegate.commit()}},Wa=class t{constructor(e,n,r){this._firestore=e,this._userDataWriter=n,this._delegate=r}fromFirestore(e,n){let r=new Ii(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new Qs(this._firestore,r),n??{})}toFirestore(e,n){return n?this._delegate.toFirestore(e,n):this._delegate.toFirestore(e)}static getInstance(e,n){let r=t.INSTANCES,i=r.get(e);i||(i=new WeakMap,r.set(e,i));let s=i.get(n);return s||(s=new t(e,new za(e),n),i.set(n,s)),s}};Wa.INSTANCES=new WeakMap;var mr=class t{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new za(e)}static forPath(e,n,r){if(e.length%2!==0)throw new w("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new t(n,new be(n._delegate,r,new b(e)))}static forKey(e,n,r){return new t(n,new be(n._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new Ka(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new Ka(this.firestore,lC(this._delegate,e))}catch(n){throw kt(n,"collection()","DocumentReference.collection()")}}isEqual(e){return e=ie(e),e instanceof be?dC(this._delegate,e):!1}set(e,n){n=SC("DocumentReference.set",n);try{return n?_C(this._delegate,e,n):_C(this._delegate,e)}catch(r){throw kt(r,"setDoc()","DocumentReference.set()")}}update(e,n,...r){try{return arguments.length===1?vC(this._delegate,e):vC(this._delegate,e,n,...r)}catch(i){throw kt(i,"updateDoc()","DocumentReference.update()")}}delete(){return Ik(this._delegate)}onSnapshot(...e){let n=Pk(e),r=kk(e,i=>new Ks(this.firestore,new En(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return wC(this._delegate,n,r)}get(e){let n;return e?.source==="cache"?n=yk(this._delegate):e?.source==="server"?n=_k(this._delegate):n=mk(this._delegate),n.then(r=>new Ks(this.firestore,new En(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new t(this.firestore,e?this._delegate.withConverter(Wa.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function kt(t,e,n){return t.message=t.message.replace(e,n),t}function Pk(t){for(let e of t)if(typeof e=="object"&&!IC(e))return e;return{}}function kk(t,e){var n,r;let i;return IC(t[0])?i=t[0]:IC(t[1])?i=t[1]:typeof t[0]=="function"?i={next:t[0],error:t[1],complete:t[2]}:i={next:t[1],error:t[2],complete:t[3]},{next:s=>{i.next&&i.next(e(s))},error:(n=i.error)===null||n===void 0?void 0:n.bind(i),complete:(r=i.complete)===null||r===void 0?void 0:r.bind(i)}}var Ks=class{constructor(e,n){this._firestore=e,this._delegate=n}get ref(){return new mr(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,n){return this._delegate.get(e,n)}isEqual(e){return yC(this._delegate,e._delegate)}},Qs=class extends Ks{data(e){let n=this._delegate.data(e);return this._delegate._converter||hN(n!==void 0,"Document in a QueryDocumentSnapshot should exist"),n}},Ys=class t{constructor(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new za(e)}where(e,n,r){try{return new t(this.firestore,Hr(this._delegate,ok(e,n,r)))}catch(i){throw kt(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,n){try{return new t(this.firestore,Hr(this._delegate,ak(e,n)))}catch(r){throw kt(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new t(this.firestore,Hr(this._delegate,uk(e)))}catch(n){throw kt(n,"limit()","Query.limit()")}}limitToLast(e){try{return new t(this.firestore,Hr(this._delegate,ck(e)))}catch(n){throw kt(n,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new t(this.firestore,Hr(this._delegate,lk(...e)))}catch(n){throw kt(n,"startAt()","Query.startAt()")}}startAfter(...e){try{return new t(this.firestore,Hr(this._delegate,dk(...e)))}catch(n){throw kt(n,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new t(this.firestore,Hr(this._delegate,hk(...e)))}catch(n){throw kt(n,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new t(this.firestore,Hr(this._delegate,fk(...e)))}catch(n){throw kt(n,"endAt()","Query.endAt()")}}isEqual(e){return hC(this._delegate,e._delegate)}get(e){let n;return e?.source==="cache"?n=wk(this._delegate):e?.source==="server"?n=Ek(this._delegate):n=vk(this._delegate),n.then(r=>new Ml(this.firestore,new Un(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){let n=Pk(e),r=kk(e,i=>new Ml(this.firestore,new Un(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return wC(this._delegate,n,r)}withConverter(e){return new t(this.firestore,e?this._delegate.withConverter(Wa.getInstance(this.firestore,e)):this._delegate.withConverter(null))}},DC=class{constructor(e,n){this._firestore=e,this._delegate=n}get type(){return this._delegate.type}get doc(){return new Qs(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}},Ml=class{constructor(e,n){this._firestore=e,this._delegate=n}get query(){return new Ys(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new Qs(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(n=>new DC(this._firestore,n))}forEach(e,n){this._delegate.forEach(r=>{e.call(n,new Qs(this._firestore,r))})}isEqual(e){return yC(this._delegate,e._delegate)}},Ka=class t extends Ys{constructor(e,n){super(e,n),this.firestore=e,this._delegate=n}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){let e=this._delegate.parent;return e?new mr(this.firestore,e):null}doc(e){try{return e===void 0?new mr(this.firestore,xl(this._delegate)):new mr(this.firestore,xl(this._delegate,e))}catch(n){throw kt(n,"doc()","CollectionReference.doc()")}}add(e){return Ck(this._delegate,e).then(n=>new mr(this.firestore,n))}isEqual(e){return dC(this._delegate,e._delegate)}withConverter(e){return new t(this.firestore,e?this._delegate.withConverter(Wa.getInstance(this.firestore,e)):this._delegate.withConverter(null))}};function Ws(t){return he(t,be)}var TC=class t{constructor(...e){this._delegate=new jn(...e)}static documentId(){return new t(qe.keyField().canonicalString())}isEqual(e){return e=ie(e),e instanceof jn?this._delegate._internalPath.isEqual(e._internalPath):!1}};var bC=class t{constructor(e){this._delegate=e}static serverTimestamp(){let e=Sk();return e._methodName="FieldValue.serverTimestamp",new t(e)}static delete(){let e=bk();return e._methodName="FieldValue.delete",new t(e)}static arrayUnion(...e){let n=Ak(...e);return n._methodName="FieldValue.arrayUnion",new t(n)}static arrayRemove(...e){let n=xk(...e);return n._methodName="FieldValue.arrayRemove",new t(n)}static increment(e){let n=Mk(e);return n._methodName="FieldValue.increment",new t(n)}isEqual(e){return this._delegate.isEqual(e._delegate)}};var Cz={Firestore:cg,GeoPoint:Bs,Timestamp:Oe,Blob:ug,Transaction:lg,WriteBatch:dg,DocumentReference:mr,DocumentSnapshot:Ks,Query:Ys,QueryDocumentSnapshot:Qs,QuerySnapshot:Ml,CollectionReference:Ka,FieldPath:TC,FieldValue:bC,setLogLevel:Iz,CACHE_SIZE_UNLIMITED:BP};function Dz(t,e){t.INTERNAL.registerComponent(new zt("firestore-compat",n=>{let r=n.getProvider("app-compat").getImmediate(),i=n.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps(Object.assign({},Cz)))}function Tz(t){Dz(t,(e,n)=>new cg(e,n,new CC)),t.registerVersion(vz,wz)}Tz(pt);function bz(t,e=Yi){return new J(n=>{let r;return e!=null?e.schedule(()=>{r=t.onSnapshot({includeMetadataChanges:!0},n)}):r=t.onSnapshot({includeMetadataChanges:!0},n),()=>{r?.()}})}function Ok(t,e){return bz(t,e)}function Sz(t,e){return Ok(t,e).pipe(Xi(void 0),Eu(),F(n=>{let[r,i]=n;return i.exists?r?.exists?{payload:i,type:"modified"}:{payload:i,type:"added"}:{payload:i,type:"removed"}}))}function MC(t,e){return Ok(t,e).pipe(F(n=>({payload:n,type:"query"})))}var hg=class{ref;afs;constructor(e,n){this.ref=e,this.afs=n}set(e,n){return this.ref.set(e,n)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,n){let r=this.ref.collection(e),{ref:i,query:s}=Lk(r,n);return new pg(i,s,this.afs)}snapshotChanges(){return Sz(this.ref,this.afs.schedulers.outsideAngular).pipe($e)}valueChanges(e={}){return this.snapshotChanges().pipe(F(({payload:n})=>e.idField?ce(S({},n.data()),{[e.idField]:n.id}):n.data()))}get(e){return fe(this.ref.get(e)).pipe($e)}};function fg(t,e){return MC(t,e).pipe(Xi(void 0),Eu(),F(n=>{let[r,i]=n,s=i.payload.docChanges(),o=s.map(a=>({type:a.type,payload:a}));return r&&JSON.stringify(r.payload.metadata)!==JSON.stringify(i.payload.metadata)&&i.payload.docs.forEach((a,u)=>{let c=s.find(d=>d.doc.ref.isEqual(a.ref)),l=r?.payload.docs.find(d=>d.ref.isEqual(a.ref));c&&JSON.stringify(c.doc.metadata)===JSON.stringify(a.metadata)||!c&&l&&JSON.stringify(l.metadata)===JSON.stringify(a.metadata)||o.push({type:"modified",payload:{oldIndex:u,newIndex:u,type:"modified",doc:a}})}),o}))}function Fk(t,e,n){return fg(t,n).pipe(Gn((r,i)=>Az(r,i.map(s=>s.payload),e),[]),vu(),F(r=>r.map(i=>({type:i.type,payload:i}))))}function Az(t,e,n){return e.forEach(r=>{n.indexOf(r.type)>-1&&(t=xz(t,r))}),t}function AC(t,e,n,...r){let i=t.slice();return i.splice(e,n,...r),i}function xz(t,e){switch(e.type){case"added":if(!(t[e.newIndex]&&t[e.newIndex].doc.ref.isEqual(e.doc.ref)))return AC(t,e.newIndex,0,e);break;case"modified":if(t[e.oldIndex]==null||t[e.oldIndex].doc.ref.isEqual(e.doc.ref))if(e.oldIndex!==e.newIndex){let n=t.slice();return n.splice(e.oldIndex,1),n.splice(e.newIndex,0,e),n}else return AC(t,e.newIndex,1,e);break;case"removed":if(t[e.oldIndex]&&t[e.oldIndex].doc.ref.isEqual(e.doc.ref))return AC(t,e.oldIndex,1);break}return t}function Vk(t){return(!t||t.length===0)&&(t=["added","removed","modified"]),t}var pg=class{ref;query;afs;constructor(e,n,r){this.ref=e,this.query=n,this.afs=r}stateChanges(e){let n=fg(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(n=n.pipe(F(r=>r.filter(i=>e.indexOf(i.type)>-1)))),n.pipe(Xi(void 0),Eu(),yt(([r,i])=>i.length>0||!r),F(([,r])=>r),$e)}auditTrail(e){return this.stateChanges(e).pipe(Gn((n,r)=>[...n,...r],[]))}snapshotChanges(e){let n=Vk(e);return Fk(this.query,n,this.afs.schedulers.outsideAngular).pipe($e)}valueChanges(e={}){return MC(this.query,this.afs.schedulers.outsideAngular).pipe(F(n=>n.payload.docs.map(r=>e.idField?ce(S({},r.data()),{[e.idField]:r.id}):r.data())),$e)}get(e){return fe(this.query.get(e)).pipe($e)}add(e){return this.ref.add(e)}doc(e){return new hg(this.ref.doc(e),this.afs)}},xC=class{query;afs;constructor(e,n){this.query=e,this.afs=n}stateChanges(e){return!e||e.length===0?fg(this.query,this.afs.schedulers.outsideAngular).pipe($e):fg(this.query,this.afs.schedulers.outsideAngular).pipe(F(n=>n.filter(r=>e.indexOf(r.type)>-1)),yt(n=>n.length>0),$e)}auditTrail(e){return this.stateChanges(e).pipe(Gn((n,r)=>[...n,...r],[]))}snapshotChanges(e){let n=Vk(e);return Fk(this.query,n,this.afs.schedulers.outsideAngular).pipe($e)}valueChanges(e={}){return MC(this.query,this.afs.schedulers.outsideAngular).pipe(F(r=>r.payload.docs.map(i=>e.idField?S({[e.idField]:i.id},i.data()):i.data())),$e)}get(e){return fe(this.query.get(e)).pipe($e)}},Mz=new P("angularfire2.enableFirestorePersistence"),Rz=new P("angularfire2.firestore.persistenceSettings"),Nz=new P("angularfire2.firestore.settings"),Pz=new P("angularfire2.firestore.use-emulator");function Lk(t,e=n=>n){return{query:e(t),ref:t}}var jk=(()=>{class t{schedulers;firestore;persistenceEnabled$;constructor(n,r,i,s,o,a,u,c,l,d,h,f,p,g,_,C,M){this.schedulers=u;let T=vs(n,a,r),j=l;d&&vc(T,a,h,p,g,_,f,C),[this.firestore,this.persistenceEnabled$]=ra(`${T.name}.firestore`,"AngularFirestore",T.name,()=>{let $=a.runOutsideAngular(()=>T.firestore());if(s&&$.settings(s),j&&$.useEmulator(...j),i&&!fs(o)){let Y=()=>{try{return fe($.enablePersistence(c||void 0).then(()=>!0,()=>!1))}catch(Me){return typeof console<"u"&&console.warn(Me),V(!1)}};return[$,a.runOutsideAngular(Y)]}else return[$,V(!1)]},[s,j,i])}collection(n,r){let i;typeof n=="string"?i=this.firestore.collection(n):i=n;let{ref:s,query:o}=Lk(i,r),a=this.schedulers.ngZone.run(()=>s);return new pg(a,o,this)}collectionGroup(n,r){let i=r||(o=>o),s=this.firestore.collectionGroup(n);return new xC(i(s),this)}doc(n){let r;typeof n=="string"?r=this.firestore.doc(n):r=n;let i=this.schedulers.ngZone.run(()=>r);return new hg(i,this)}createId(){return this.firestore.collection("_").doc().id}static \u0275fac=function(r){return new(r||t)(I(fi),I(pi,8),I(Mz,8),I(Nz,8),I(Ct),I(se),I(na),I(Rz,8),I(Pz,8),I(vf,8),I(fc,8),I(pc,8),I(gc,8),I(mc,8),I(yc,8),I(_c,8),I(Nr,8))};static \u0275prov=k({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})();var Uk=(()=>{let e=class e{constructor(r){this.firestore=r}getClientes(){return this.firestore.collection("clientes").snapshotChanges()}createCliente(r){return this.firestore.collection("clientes").add(Object.assign({},r))}updateCliente(r){this.firestore.doc("clientes/"+r.id).update(r)}deleteCliente(r){this.firestore.doc("clientes/"+r).delete()}};e.\u0275fac=function(i){return new(i||e)(I(jk))},e.\u0275prov=k({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();var Qk=(()=>{let e=class e{constructor(r,i){this._renderer=r,this._elementRef=i,this.onChange=s=>{},this.onTouched=()=>{}}setProperty(r,i){this._renderer.setProperty(this._elementRef.nativeElement,r,i)}registerOnTouched(r){this.onTouched=r}registerOnChange(r){this.onChange=r}setDisabledState(r){this.setProperty("disabled",r)}};e.\u0275fac=function(i){return new(i||e)(_e(oi),_e(xr))},e.\u0275dir=$t({type:e});let t=e;return t})(),OC=(()=>{let e=class e extends Qk{};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=cs(e)))(s||e)}})(),e.\u0275dir=$t({type:e,features:[ai]});let t=e;return t})(),_g=new P("");var Fz={provide:_g,useExisting:us(()=>vg),multi:!0};function Vz(){let t=tr()?tr().getUserAgent():"";return/android (\d+)/.test(t.toLowerCase())}var Lz=new P(""),vg=(()=>{let e=class e extends Qk{constructor(r,i,s){super(r,i),this._compositionMode=s,this._composing=!1,this._compositionMode==null&&(this._compositionMode=!Vz())}writeValue(r){let i=r??"";this.setProperty("value",i)}_handleInput(r){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(r)}_compositionStart(){this._composing=!0}_compositionEnd(r){this._composing=!1,this._compositionMode&&this.onChange(r)}};e.\u0275fac=function(i){return new(i||e)(_e(oi),_e(xr),_e(Lz,8))},e.\u0275dir=$t({type:e,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(i,s){i&1&&Mt("input",function(a){return s._handleInput(a.target.value)})("blur",function(){return s.onTouched()})("compositionstart",function(){return s._compositionStart()})("compositionend",function(a){return s._compositionEnd(a.target.value)})},features:[Uu([Fz]),ai]});let t=e;return t})();var jz=new P(""),Uz=new P("");function Yk(t){return t!=null}function Zk(t){return ds(t)?fe(t):t}function Xk(t){let e={};return t.forEach(n=>{e=n!=null?S(S({},e),n):e}),Object.keys(e).length===0?null:e}function Jk(t,e){return e.map(n=>n(t))}function Bz(t){return!t.validate}function eO(t){return t.map(e=>Bz(e)?e:n=>e.validate(n))}function $z(t){if(!t)return null;let e=t.filter(Yk);return e.length==0?null:function(n){return Xk(Jk(n,e))}}function tO(t){return t!=null?$z(eO(t)):null}function Hz(t){if(!t)return null;let e=t.filter(Yk);return e.length==0?null:function(n){let r=Jk(n,e).map(Zk);return Vm(r).pipe(F(Xk))}}function nO(t){return t!=null?Hz(eO(t)):null}function Bk(t,e){return t===null?[e]:Array.isArray(t)?[...t,e]:[t,e]}function qz(t){return t._rawValidators}function Gz(t){return t._rawAsyncValidators}function RC(t){return t?Array.isArray(t)?t:[t]:[]}function mg(t,e){return Array.isArray(t)?t.includes(e):t===e}function $k(t,e){let n=RC(e);return RC(t).forEach(i=>{mg(n,i)||n.push(i)}),n}function Hk(t,e){return RC(e).filter(n=>!mg(t,n))}var yg=class{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=tO(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=nO(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,n){return this.control?this.control.hasError(e,n):!1}getError(e,n){return this.control?this.control.getError(e,n):null}},NC=class extends yg{get formDirective(){return null}get path(){return null}},Pl=class extends yg{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}},PC=class{constructor(e){this._cd=e}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}},zz={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},Jee=ce(S({},zz),{"[class.ng-submitted]":"isSubmitted"}),rO=(()=>{let e=class e extends PC{constructor(r){super(r)}};e.\u0275fac=function(i){return new(i||e)(_e(Pl,2))},e.\u0275dir=$t({type:e,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(i,s){i&2&&S_("ng-untouched",s.isUntouched)("ng-touched",s.isTouched)("ng-pristine",s.isPristine)("ng-dirty",s.isDirty)("ng-valid",s.isValid)("ng-invalid",s.isInvalid)("ng-pending",s.isPending)},features:[ai]});let t=e;return t})();var Rl="VALID",gg="INVALID",Qa="PENDING",Nl="DISABLED";function Wz(t){return(wg(t)?t.validators:t)||null}function Kz(t){return Array.isArray(t)?tO(t):t||null}function Qz(t,e){return(wg(e)?e.asyncValidators:t)||null}function Yz(t){return Array.isArray(t)?nO(t):t||null}function wg(t){return t!=null&&!Array.isArray(t)&&typeof t=="object"}var kC=class{constructor(e,n){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(n)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===Rl}get invalid(){return this.status===gg}get pending(){return this.status==Qa}get disabled(){return this.status===Nl}get enabled(){return this.status!==Nl}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators($k(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators($k(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(Hk(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(Hk(e,this._rawAsyncValidators))}hasValidator(e){return mg(this._rawValidators,e)}hasAsyncValidator(e){return mg(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(n=>{n.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(n=>{n.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=Qa,e.emitEvent!==!1&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){let n=this._parentMarkedDirty(e.onlySelf);this.status=Nl,this.errors=null,this._forEachChild(r=>{r.disable(ce(S({},e),{onlySelf:!0}))}),this._updateValue(),e.emitEvent!==!1&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(ce(S({},e),{skipPristineCheck:n})),this._onDisabledChange.forEach(r=>r(!0))}enable(e={}){let n=this._parentMarkedDirty(e.onlySelf);this.status=Rl,this._forEachChild(r=>{r.enable(ce(S({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(ce(S({},e),{skipPristineCheck:n})),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Rl||this.status===Qa)&&this._runAsyncValidator(e.emitEvent)),e.emitEvent!==!1&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(n=>n._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Nl:Rl}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=Qa,this._hasOwnPendingAsyncValidator=!0;let n=Zk(this.asyncValidator(this));this._asyncValidationSubscription=n.subscribe(r=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(r,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,n={}){this.errors=e,this._updateControlsErrors(n.emitEvent!==!1)}get(e){let n=e;return n==null||(Array.isArray(n)||(n=n.split(".")),n.length===0)?null:n.reduce((r,i)=>r&&r._find(i),this)}getError(e,n){let r=n?this.get(n):this;return r&&r.errors?r.errors[e]:null}hasError(e,n){return!!this.getError(e,n)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new it,this.statusChanges=new it}_calculateStatus(){return this._allControlsDisabled()?Nl:this.errors?gg:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Qa)?Qa:this._anyControlsHaveStatus(gg)?gg:Rl}_anyControlsHaveStatus(e){return this._anyControls(n=>n.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){wg(e)&&e.updateOn!=null&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){let n=this._parent&&this._parent.dirty;return!e&&!!n&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=Kz(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=Yz(this._rawAsyncValidators)}};var iO=new P("CallSetDisabledState",{providedIn:"root",factory:()=>FC}),FC="always";function Zz(t,e){return[...e.path,t]}function Xz(t,e,n=FC){eW(t,e),e.valueAccessor.writeValue(t.value),(t.disabled||n==="always")&&e.valueAccessor.setDisabledState?.(t.disabled),tW(t,e),rW(t,e),nW(t,e),Jz(t,e)}function qk(t,e){t.forEach(n=>{n.registerOnValidatorChange&&n.registerOnValidatorChange(e)})}function Jz(t,e){if(e.valueAccessor.setDisabledState){let n=r=>{e.valueAccessor.setDisabledState(r)};t.registerOnDisabledChange(n),e._registerOnDestroy(()=>{t._unregisterOnDisabledChange(n)})}}function eW(t,e){let n=qz(t);e.validator!==null?t.setValidators(Bk(n,e.validator)):typeof n=="function"&&t.setValidators([n]);let r=Gz(t);e.asyncValidator!==null?t.setAsyncValidators(Bk(r,e.asyncValidator)):typeof r=="function"&&t.setAsyncValidators([r]);let i=()=>t.updateValueAndValidity();qk(e._rawValidators,i),qk(e._rawAsyncValidators,i)}function tW(t,e){e.valueAccessor.registerOnChange(n=>{t._pendingValue=n,t._pendingChange=!0,t._pendingDirty=!0,t.updateOn==="change"&&sO(t,e)})}function nW(t,e){e.valueAccessor.registerOnTouched(()=>{t._pendingTouched=!0,t.updateOn==="blur"&&t._pendingChange&&sO(t,e),t.updateOn!=="submit"&&t.markAsTouched()})}function sO(t,e){t._pendingDirty&&t.markAsDirty(),t.setValue(t._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(t._pendingValue),t._pendingChange=!1}function rW(t,e){let n=(r,i)=>{e.valueAccessor.writeValue(r),i&&e.viewToModelUpdate(r)};t.registerOnChange(n),e._registerOnDestroy(()=>{t._unregisterOnChange(n)})}function iW(t,e){if(!t.hasOwnProperty("model"))return!1;let n=t.model;return n.isFirstChange()?!0:!Object.is(e,n.currentValue)}function sW(t){return Object.getPrototypeOf(t.constructor)===OC}function oW(t,e){if(!e)return null;Array.isArray(e);let n,r,i;return e.forEach(s=>{s.constructor===vg?n=s:sW(s)?r=s:i=s}),i||r||n||null}function Gk(t,e){let n=t.indexOf(e);n>-1&&t.splice(n,1)}function zk(t){return typeof t=="object"&&t!==null&&Object.keys(t).length===2&&"value"in t&&"disabled"in t}var aW=class extends kC{constructor(e=null,n,r){super(Wz(n),Qz(r,n)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(n),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),wg(n)&&(n.nonNullable||n.initialValueIsDefault)&&(zk(e)?this.defaultValue=e.value:this.defaultValue=e)}setValue(e,n={}){this.value=this._pendingValue=e,this._onChange.length&&n.emitModelToViewChange!==!1&&this._onChange.forEach(r=>r(this.value,n.emitViewToModelChange!==!1)),this.updateValueAndValidity(n)}patchValue(e,n={}){this.setValue(e,n)}reset(e=this.defaultValue,n={}){this._applyFormState(e),this.markAsPristine(n),this.markAsUntouched(n),this.setValue(this.value,n),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){Gk(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){Gk(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(e){zk(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}};var uW={provide:Pl,useExisting:us(()=>VC)},Wk=Promise.resolve(),VC=(()=>{let e=class e extends Pl{constructor(r,i,s,o,a,u){super(),this._changeDetectorRef=a,this.callSetDisabledState=u,this.control=new aW,this._registered=!1,this.name="",this.update=new it,this._parent=r,this._setValidators(i),this._setAsyncValidators(s),this.valueAccessor=oW(this,o)}ngOnChanges(r){if(this._checkForErrors(),!this._registered||"name"in r){if(this._registered&&(this._checkName(),this.formDirective)){let i=r.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in r&&this._updateDisabled(r),iW(r,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(r){this.viewModel=r,this.update.emit(r)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){Xz(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(r){Wk.then(()=>{this.control.setValue(r,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(r){let i=r.isDisabled.currentValue,s=i!==0&&qh(i);Wk.then(()=>{s&&!this.control.disabled?this.control.disable():!s&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(r){return this._parent?Zz(r,this._parent):[r]}};e.\u0275fac=function(i){return new(i||e)(_e(NC,9),_e(jz,10),_e(Uz,10),_e(_g,10),_e($o,8),_e(iO,8))},e.\u0275dir=$t({type:e,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[fn.None,"disabled","isDisabled"],model:[fn.None,"ngModel","model"],options:[fn.None,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[Uu([uW]),ai,Lo]});let t=e;return t})();var cW={provide:_g,useExisting:us(()=>Eg),multi:!0};function oO(t,e){return t==null?`${e}`:(e&&typeof e=="object"&&(e="Object"),`${t}: ${e}`.slice(0,50))}function lW(t){return t.split(":")[0]}var Eg=(()=>{let e=class e extends OC{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(r){this._compareWith=r}writeValue(r){this.value=r;let i=this._getOptionId(r),s=oO(i,r);this.setProperty("value",s)}registerOnChange(r){this.onChange=i=>{this.value=this._getOptionValue(i),r(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(r){for(let i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i),r))return i;return null}_getOptionValue(r){let i=lW(r);return this._optionMap.has(i)?this._optionMap.get(i):r}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=cs(e)))(s||e)}})(),e.\u0275dir=$t({type:e,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(i,s){i&1&&Mt("change",function(a){return s.onChange(a.target.value)})("blur",function(){return s.onTouched()})},inputs:{compareWith:"compareWith"},features:[Uu([cW]),ai]});let t=e;return t})(),aO=(()=>{let e=class e{constructor(r,i,s){this._element=r,this._renderer=i,this._select=s,this._select&&(this.id=this._select._registerOption())}set ngValue(r){this._select!=null&&(this._select._optionMap.set(this.id,r),this._setElementValue(oO(this.id,r)),this._select.writeValue(this._select.value))}set value(r){this._setElementValue(r),this._select&&this._select.writeValue(this._select.value)}_setElementValue(r){this._renderer.setProperty(this._element.nativeElement,"value",r)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}};e.\u0275fac=function(i){return new(i||e)(_e(xr),_e(oi),_e(Eg,9))},e.\u0275dir=$t({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}});let t=e;return t})(),dW={provide:_g,useExisting:us(()=>uO),multi:!0};function Kk(t,e){return t==null?`${e}`:(typeof e=="string"&&(e=`'${e}'`),e&&typeof e=="object"&&(e="Object"),`${t}: ${e}`.slice(0,50))}function hW(t){return t.split(":")[0]}var uO=(()=>{let e=class e extends OC{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(r){this._compareWith=r}writeValue(r){this.value=r;let i;if(Array.isArray(r)){let s=r.map(o=>this._getOptionId(o));i=(o,a)=>{o._setSelected(s.indexOf(a.toString())>-1)}}else i=(s,o)=>{s._setSelected(!1)};this._optionMap.forEach(i)}registerOnChange(r){this.onChange=i=>{let s=[],o=i.selectedOptions;if(o!==void 0){let a=o;for(let u=0;u<a.length;u++){let c=a[u],l=this._getOptionValue(c.value);s.push(l)}}else{let a=i.options;for(let u=0;u<a.length;u++){let c=a[u];if(c.selected){let l=this._getOptionValue(c.value);s.push(l)}}}this.value=s,r(s)}}_registerOption(r){let i=(this._idCounter++).toString();return this._optionMap.set(i,r),i}_getOptionId(r){for(let i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i)._value,r))return i;return null}_getOptionValue(r){let i=hW(r);return this._optionMap.has(i)?this._optionMap.get(i)._value:r}};e.\u0275fac=(()=>{let r;return function(s){return(r||(r=cs(e)))(s||e)}})(),e.\u0275dir=$t({type:e,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(i,s){i&1&&Mt("change",function(a){return s.onChange(a.target)})("blur",function(){return s.onTouched()})},inputs:{compareWith:"compareWith"},features:[Uu([dW]),ai]});let t=e;return t})(),cO=(()=>{let e=class e{constructor(r,i,s){this._element=r,this._renderer=i,this._select=s,this._select&&(this.id=this._select._registerOption(this))}set ngValue(r){this._select!=null&&(this._value=r,this._setElementValue(Kk(this.id,r)),this._select.writeValue(this._select.value))}set value(r){this._select?(this._value=r,this._setElementValue(Kk(this.id,r)),this._select.writeValue(this._select.value)):this._setElementValue(r)}_setElementValue(r){this._renderer.setProperty(this._element.nativeElement,"value",r)}_setSelected(r){this._renderer.setProperty(this._element.nativeElement,"selected",r)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}};e.\u0275fac=function(i){return new(i||e)(_e(xr),_e(oi),_e(uO,9))},e.\u0275dir=$t({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}});let t=e;return t})();var fW=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Ye({type:e}),e.\u0275inj=Qe({});let t=e;return t})();var lO=(()=>{let e=class e{static withConfig(r){return{ngModule:e,providers:[{provide:iO,useValue:r.callSetDisabledState??FC}]}}};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Ye({type:e}),e.\u0275inj=Qe({imports:[fW]});let t=e;return t})();function gW(t,e){if(t&1){let n=eA();me(0,"tr")(1,"td"),Ne(2),Te(),me(3,"td"),Ne(4),Te(),me(5,"td"),Ne(6),Te(),me(7,"td"),Ne(8),Te(),me(9,"td")(10,"button",8),Mt("click",function(){let s=Fb(n).$implicit,o=nA();return Vb(o.selectCliente(s))}),Ne(11," Seleccionar "),Te()()()}if(t&2){let n=e.$implicit;Jn(2),Ho(n.nombre),Jn(2),Ho(n.rfc),Jn(2),Ho(n.domicilio),Jn(2),Ho(n.tipoCliente)}}var dO=(()=>{let e=class e{constructor(r){this.clienteService=r,this.clientes=[],this.cliente=new ys}ngOnInit(){this.clienteService.getClientes().subscribe(r=>{this.clientes=r.map(i=>ce(S({},i.payload.doc.data()),{id:i.payload.doc.id}))}),console.log(this.clientes)}getTiposCliente(){return Object.keys(gf)}insertarCliente(){this.clienteService.createCliente(this.cliente),this.cliente=new ys}selectCliente(r){this.cliente=r}updateCliente(){this.clienteService.updateCliente(this.cliente),this.cliente=new ys}deleteCliente(r){this.clienteService.deleteCliente(r),this.cliente=new ys}};e.\u0275fac=function(i){return new(i||e)(_e(Uk))},e.\u0275cmp=Fo({type:e,selectors:[["app-alta-cliente"]],decls:57,vars:5,consts:[[1,"container"],[1,"form-group"],["type","text",1,"form-control",3,"ngModel","ngModelChange"],[1,"form-select",3,"ngModel","ngModelChange"],["value","Sin definir","selected",""],["value","Clientes Activos"],["value","Clientes inactivos"],["value","clientes deudores"],["type","button",1,"btn","btn-primary",3,"click"],["type","button",1,"btn","btn-warning",3,"click"],["type","button",1,"btn","btn-danger",3,"click"],[1,"table"],[4,"ngFor","ngForOf"]],template:function(i,s){i&1&&(me(0,"div",0)(1,"h1"),Ne(2,"Alta de cliente"),Te(),me(3,"div",1)(4,"label"),Ne(5," Nombre "),me(6,"input",2),Mt("ngModelChange",function(a){return s.cliente.nombre=a}),Te()(),er(7,"br"),me(8,"label"),Ne(9," RFC "),me(10,"input",2),Mt("ngModelChange",function(a){return s.cliente.rfc=a}),Te()(),er(11,"br"),me(12,"label"),Ne(13," Domicilio "),me(14,"input",2),Mt("ngModelChange",function(a){return s.cliente.domicilio=a}),Te()(),er(15,"br"),me(16,"label"),Ne(17," Tipo de cliente "),me(18,"select",3),Mt("ngModelChange",function(a){return s.cliente.tipoCliente=a}),me(19,"option",4),Ne(20,"Sin definir"),Te(),me(21,"option",5),Ne(22,"Clientes Activos"),Te(),me(23,"option",6),Ne(24,"Clientes inactivos"),Te(),me(25,"option",7),Ne(26,"clientes deudores"),Te()()(),er(27,"br")(28,"br"),me(29,"table")(30,"tr")(31,"td")(32,"button",8),Mt("click",function(){return s.insertarCliente()}),Ne(33," Insertar "),Te()(),me(34,"td")(35,"button",9),Mt("click",function(){return s.updateCliente()}),Ne(36," Actualizar "),Te()(),me(37,"td")(38,"button",10),Mt("click",function(){return s.deleteCliente(s.cliente.id)}),Ne(39," Eliminar "),Te()()()()()(),me(40,"div",0)(41,"h1"),Ne(42,"Cat\xE1logo de clientes"),Te(),me(43,"table",11)(44,"thead")(45,"th"),Ne(46,"Nombre"),Te(),me(47,"th"),Ne(48,"RFC"),Te(),me(49,"th"),Ne(50,"Domicilio"),Te(),me(51,"th"),Ne(52,"Tipo de cliente"),Te(),me(53,"th"),Ne(54,"Seleccionar"),Te()(),me(55,"tbody"),b_(56,gW,12,4,"tr",12),Te()()()),i&2&&(Jn(6),ls("ngModel",s.cliente.nombre),Jn(4),ls("ngModel",s.cliente.rfc),Jn(4),ls("ngModel",s.cliente.domicilio),Jn(4),ls("ngModel",s.cliente.tipoCliente),Jn(38),ls("ngForOf",s.clientes))},dependencies:[TA,aO,cO,vg,Eg,rO,VC]});let t=e;return t})();var hO=(()=>{let e=class e{constructor(){this.title="libros"}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=Fo({type:e,selectors:[["app-root"]],decls:1,vars:0,template:function(i,s){i&1&&er(0,"app-alta-cliente")},dependencies:[dO]});let t=e;return t})();var fO="@firebase/database",pO="1.0.3";var QD="";function YD(t){QD=t}var GC=class{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,n){n==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),ze(n))}get(e){let n=this.domStorage_.getItem(this.prefixedName_(e));return n==null?null:yd(n)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}};var zC=class{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,n){n==null?delete this.cache_[e]:this.cache_[e]=n}get(e){return on(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}};var GO=function(t){try{if(typeof window<"u"&&typeof window[t]<"u"){let e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new GC(e)}}catch{}return new zC},Xs=GO("localStorage"),WC=GO("sessionStorage");var Ja=new Wr("@firebase/database"),zO=function(){let t=1;return function(){return t++}}(),WO=function(t){let e=G0(t),n=new q0;n.update(e);let r=n.digest();return pd.encodeByteArray(r)},rd=function(...t){let e="";for(let n=0;n<t.length;n++){let r=t[n];Array.isArray(r)||r&&typeof r=="object"&&typeof r.length=="number"?e+=rd.apply(null,r):typeof r=="object"?e+=ze(r):e+=r,e+=" "}return e},Js=null,gO=!0,KO=function(t,e){D(!e||t===!0||t===!1,"Can't turn on custom loggers persistently."),t===!0?(Ja.logLevel=an.VERBOSE,Js=Ja.log.bind(Ja),e&&WC.set("logging_enabled",!0)):typeof t=="function"?Js=t:(Js=null,WC.remove("logging_enabled"))},ht=function(...t){if(gO===!0&&(gO=!1,Js===null&&WC.get("logging_enabled")===!0&&KO(!0)),Js){let e=rd.apply(null,t);Js(e)}},id=function(t){return function(...e){ht(t,...e)}},KC=function(...t){let e="FIREBASE INTERNAL ERROR: "+rd(...t);Ja.error(e)},vr=function(...t){let e=`FIREBASE FATAL ERROR: ${rd(...t)}`;throw Ja.error(e),new Error(e)},At=function(...t){let e="FIREBASE WARNING: "+rd(...t);Ja.warn(e)},yW=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&At("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},Qg=function(t){return typeof t=="number"&&(t!==t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},_W=function(t){if(Hn()||document.readyState==="complete")t();else{let e=!1,n=function(){if(!document.body){setTimeout(n,Math.floor(10));return}e||(e=!0,t())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{document.readyState==="complete"&&n()}),window.attachEvent("onload",n))}},ji="[MIN_NAME]",qr="[MAX_NAME]",to=function(t,e){if(t===e)return 0;if(t===ji||e===qr)return-1;if(e===ji||t===qr)return 1;{let n=mO(t),r=mO(e);return n!==null?r!==null?n-r===0?t.length-e.length:n-r:-1:r!==null?1:t<e?-1:1}},vW=function(t,e){return t===e?0:t<e?-1:1},kl=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+ze(e))},ZD=function(t){if(typeof t!="object"||t===null)return ze(t);let e=[];for(let r in t)e.push(r);e.sort();let n="{";for(let r=0;r<e.length;r++)r!==0&&(n+=","),n+=ze(e[r]),n+=":",n+=ZD(t[e[r]]);return n+="}",n},QO=function(t,e){let n=t.length;if(n<=e)return[t];let r=[];for(let i=0;i<n;i+=e)i+e>n?r.push(t.substring(i,n)):r.push(t.substring(i,i+e));return r};function ft(t,e){for(let n in t)t.hasOwnProperty(n)&&e(n,t[n])}var YO=function(t){D(!Qg(t),"Invalid JSON number");let e=11,n=52,r=(1<<e-1)-1,i,s,o,a,u;t===0?(s=0,o=0,i=1/t===-1/0?1:0):(i=t<0,t=Math.abs(t),t>=Math.pow(2,1-r)?(a=Math.min(Math.floor(Math.log(t)/Math.LN2),r),s=a+r,o=Math.round(t*Math.pow(2,n-a)-Math.pow(2,n))):(s=0,o=Math.round(t/Math.pow(2,1-r-n))));let c=[];for(u=n;u;u-=1)c.push(o%2?1:0),o=Math.floor(o/2);for(u=e;u;u-=1)c.push(s%2?1:0),s=Math.floor(s/2);c.push(i?1:0),c.reverse();let l=c.join(""),d="";for(u=0;u<64;u+=8){let h=parseInt(l.substr(u,8),2).toString(16);h.length===1&&(h="0"+h),d=d+h}return d.toLowerCase()},wW=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},EW=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function IW(t,e){let n="Unknown Error";t==="too_big"?n="The data requested exceeds the maximum size that can be accessed with a single request.":t==="permission_denied"?n="Client doesn't have permission to access the desired data.":t==="unavailable"&&(n="The service is unavailable");let r=new Error(t+" at "+e._path.toString()+": "+n);return r.code=t.toUpperCase(),r}var CW=new RegExp("^-?(0*)\\d{1,10}$"),DW=-2147483648,TW=2147483647,mO=function(t){if(CW.test(t)){let e=Number(t);if(e>=DW&&e<=TW)return e}return null},uu=function(t){try{t()}catch(e){setTimeout(()=>{let n=e.stack||"";throw At("Exception was thrown by user callback.",n),e},Math.floor(0))}},bW=function(){return(typeof window=="object"&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},Ll=function(t,e){let n=setTimeout(t,e);return typeof n=="number"&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(n):typeof n=="object"&&n.unref&&n.unref(),n};var QC=class{constructor(e,n){this.appName_=e,this.appCheckProvider=n,this.appCheck=n?.getImmediate({optional:!0}),this.appCheck||n?.get().then(r=>this.appCheck=r)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((n,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){var n;(n=this.appCheckProvider)===null||n===void 0||n.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){At(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}};var YC=class{constructor(e,n,r){this.appName_=e,this.firebaseOptions_=n,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(n=>n&&n.code==="auth/token-not-initialized"?(ht("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(n)):new Promise((n,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(n,r):n(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(n=>n.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(n=>n.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',At(e)}},jl=(()=>{class t{constructor(n){this.accessToken=n}getToken(n){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(n){n(this.accessToken)}removeTokenChangeListener(n){}notifyForInvalidToken(){}}t.OWNER="owner";return t})(),Cg="5",ZO="v",XO="s",JO="r",e1="f",t1=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,n1="ls",r1="p",ZC="ac",i1="websocket",s1="long_polling";var Dg=class{constructor(e,n,r,i,s=!1,o="",a=!1,u=!1){this.secure=n,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=s,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=u,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Xs.get("host:"+e)||this._host}isCacheableHost(){return this.internalHost.substr(0,2)==="s-"}isCustomHost(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Xs.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){let e=this.secure?"https://":"http://",n=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${n}`}};function SW(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams}function o1(t,e,n){D(typeof e=="string","typeof type must == string"),D(typeof n=="object","typeof params must == object");let r;if(e===i1)r=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else if(e===s1)r=(t.secure?"https://":"http://")+t.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);SW(t)&&(n.ns=t.namespace);let i=[];return ft(n,(s,o)=>{i.push(s+"="+o)}),r+i.join("&")}var XC=class{constructor(){this.counters_={}}incrementCounter(e,n=1){on(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=n}get(){return V0(this.counters_)}};var LC={},jC={};function XD(t){let e=t.toString();return LC[e]||(LC[e]=new XC),LC[e]}function AW(t,e){let n=t.toString();return jC[n]||(jC[n]=e()),jC[n]}var JC=class{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,n){this.closeAfterResponse=e,this.onClose=n,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,n){for(this.pendingResponses[e]=n;this.pendingResponses[this.currentResponseNum];){let r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<r.length;++i)r[i]&&uu(()=>{this.onMessage_(r[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}};var yO="start",xW="close",MW="pLPCommand",RW="pRTLPCB",a1="id",u1="pw",c1="ser",NW="cb",PW="seg",kW="ts",OW="d",FW="dframe",l1=1870,d1=30,VW=l1-d1,LW=25e3,jW=3e4,Hl=class t{constructor(e,n,r,i,s,o,a){this.connId=e,this.repoInfo=n,this.applicationId=r,this.appCheckToken=i,this.authToken=s,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=id(e),this.stats_=XD(n),this.urlFn=u=>(this.appCheckToken&&(u[ZC]=this.appCheckToken),o1(n,s1,u))}open(e,n){this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new JC(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(jW)),_W(()=>{if(this.isClosed_)return;this.scriptTagHolder=new eD((...s)=>{let[o,a,u,c,l]=s;if(this.incrementIncomingBytes_(s),!!this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,o===yO)this.id=a,this.password=u;else if(o===xW)a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_();else throw new Error("Unrecognized command received: "+o)},(...s)=>{let[o,a]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);let r={};r[yO]="t",r[c1]=Math.floor(Math.random()*1e8),this.scriptTagHolder.uniqueCallbackIdentifier&&(r[NW]=this.scriptTagHolder.uniqueCallbackIdentifier),r[ZO]=Cg,this.transportSessionId&&(r[XO]=this.transportSessionId),this.lastSessionId&&(r[n1]=this.lastSessionId),this.applicationId&&(r[r1]=this.applicationId),this.appCheckToken&&(r[ZC]=this.appCheckToken),typeof location<"u"&&location.hostname&&t1.test(location.hostname)&&(r[JO]=e1);let i=this.urlFn(r);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){t.forceAllow_=!0}static forceDisallow(){t.forceDisallow_=!0}static isAvailable(){return Hn()?!1:t.forceAllow_?!0:!t.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!wW()&&!EW()}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){let n=ze(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);let r=F0(n),i=QO(r,VW);for(let s=0;s<i.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[s]),this.curSegmentNum++}addDisconnectPingFrame(e,n){if(Hn())return;this.myDisconnFrame=document.createElement("iframe");let r={};r[FW]="t",r[a1]=e,r[u1]=n,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){let n=ze(e).length;this.bytesReceived+=n,this.stats_.incrementCounter("bytes_received",n)}},eD=class t{constructor(e,n,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0,Hn())this.commandCB=e,this.onMessageCB=n;else{this.uniqueCallbackIdentifier=zO(),window[MW+this.uniqueCallbackIdentifier]=e,window[RW+this.uniqueCallbackIdentifier]=n,this.myIFrame=t.createIFrame_();let s="";this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"&&(s='<script>document.domain="'+document.domain+'";<\/script>');let o="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){ht("frame writing exception"),a.stack&&ht(a.stack),ht(a)}}}static createIFrame_(){let e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{e.contentWindow.document||ht("No IE domain setting required")}catch{let r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{this.myIFrame!==null&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));let e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,n){for(this.myID=e,this.myPW=n,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;let e={};e[a1]=this.myID,e[u1]=this.myPW,e[c1]=this.currentSerial;let n=this.urlFn(e),r="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+d1+r.length<=l1;){let o=this.pendingSegs.shift();r=r+"&"+PW+i+"="+o.seg+"&"+kW+i+"="+o.ts+"&"+OW+i+"="+o.d,i++}return n=n+r,this.addLongPollTag_(n,this.currentSerial),!0}else return!1}enqueueSegment(e,n,r){this.pendingSegs.push({seg:e,ts:n,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,n){this.outstandingRequests.add(n);let r=()=>{this.outstandingRequests.delete(n),this.newRequest_()},i=setTimeout(r,Math.floor(LW)),s=()=>{clearTimeout(i),r()};this.addTag(e,s)}addTag(e,n){Hn()?this.doNodeLongPoll(e,n):setTimeout(()=>{try{if(!this.sendNewPolls)return;let r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){let i=r.readyState;(!i||i==="loaded"||i==="complete")&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),n())},r.onerror=()=>{ht("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}};var UW=16384,BW=45e3,Tg=null;typeof MozWebSocket<"u"?Tg=MozWebSocket:typeof WebSocket<"u"&&(Tg=WebSocket);var Za=(()=>{class t{constructor(n,r,i,s,o,a,u){this.connId=n,this.applicationId=i,this.appCheckToken=s,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=id(this.connId),this.stats_=XD(r),this.connURL=t.connectionURL_(r,a,u,s,i),this.nodeAdmin=r.nodeAdmin}static connectionURL_(n,r,i,s,o){let a={};return a[ZO]=Cg,!Hn()&&typeof location<"u"&&location.hostname&&t1.test(location.hostname)&&(a[JO]=e1),r&&(a[XO]=r),i&&(a[n1]=i),s&&(a[ZC]=s),o&&(a[r1]=o),o1(n,i1,a)}open(n,r){this.onDisconnect=r,this.onMessage=n,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Xs.set("previous_websocket_failure",!0);try{let i;if(Hn()){let s=this.nodeAdmin?"AdminNode":"Node";i={headers:{"User-Agent":`Firebase/${Cg}/${QD}/${process.platform}/${s}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(i.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(i.headers["X-Firebase-AppCheck"]=this.appCheckToken);let o=process.env,a=this.connURL.indexOf("wss://")===0?o.HTTPS_PROXY||o.https_proxy:o.HTTP_PROXY||o.http_proxy;a&&(i.proxy={origin:a})}this.mySock=new Tg(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");let s=i.message||i.data;s&&this.log_(s),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");let s=i.message||i.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){t.forceDisallow_=!0}static isAvailable(){let n=!1;if(typeof navigator<"u"&&navigator.userAgent){let r=/Android ([0-9]{0,}\.[0-9]{0,})/,i=navigator.userAgent.match(r);i&&i.length>1&&parseFloat(i[1])<4.4&&(n=!0)}return!n&&Tg!==null&&!t.forceDisallow_}static previouslyFailed(){return Xs.isInMemoryStorage||Xs.get("previous_websocket_failure")===!0}markConnectionHealthy(){Xs.remove("previous_websocket_failure")}appendFrame_(n){if(this.frames.push(n),this.frames.length===this.totalFrames){let r=this.frames.join("");this.frames=null;let i=yd(r);this.onMessage(i)}}handleNewFrameCount_(n){this.totalFrames=n,this.frames=[]}extractFrameCount_(n){if(D(this.frames===null,"We already have a frame buffer"),n.length<=6){let r=Number(n);if(!isNaN(r))return this.handleNewFrameCount_(r),null}return this.handleNewFrameCount_(1),n}handleIncomingFrame(n){if(this.mySock===null)return;let r=n.data;if(this.bytesReceived+=r.length,this.stats_.incrementCounter("bytes_received",r.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(r);else{let i=this.extractFrameCount_(r);i!==null&&this.appendFrame_(i)}}send(n){this.resetKeepAlive();let r=ze(n);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);let i=QO(r,UW);i.length>1&&this.sendString_(String(i.length));for(let s=0;s<i.length;s++)this.sendString_(i[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(BW))}sendString_(n){try{this.mySock.send(n)}catch(r){this.log_("Exception thrown from WebSocket.send():",r.message||r.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}t.responsesRequiredToBeHealthy=2,t.healthyTimeout=3e4;return t})(),h1=(()=>{class t{constructor(n){this.initTransports_(n)}static get ALL_TRANSPORTS(){return[Hl,Za]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(n){let r=Za&&Za.isAvailable(),i=r&&!Za.previouslyFailed();if(n.webSocketOnly&&(r||At("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[Za];else{let s=this.transports_=[];for(let o of t.ALL_TRANSPORTS)o&&o.isAvailable()&&s.push(o);t.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}t.globalTransportInitialized_=!1;return t})(),$W=6e4,HW=5e3,qW=10*1024,GW=100*1024,UC="t",_O="d",zW="s",vO="r",WW="e",wO="o",EO="a",IO="n",CO="p",KW="h",tD=class{constructor(e,n,r,i,s,o,a,u,c,l){this.id=e,this.repoInfo_=n,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=s,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=u,this.onKill_=c,this.lastSessionId=l,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=id("c:"+this.id+":"),this.transportManager_=new h1(n),this.log_("Connection created"),this.start_()}start_(){let e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(n,r)},Math.floor(0));let i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=Ll(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>GW?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>qW?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return n=>{e===this.conn_?this.onConnectionLost_(n):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return n=>{this.state_!==2&&(e===this.rx_?this.onPrimaryMessageReceived_(n):e===this.secondaryConn_?this.onSecondaryMessageReceived_(n):this.log_("message on old connection"))}}sendRequest(e){let n={t:"d",d:e};this.sendData_(n)}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if(UC in e){let n=e[UC];n===EO?this.upgradeIfSecondaryHealthy_():n===vO?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):n===wO&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){let n=kl("t",e),r=kl("d",e);if(n==="c")this.onSecondaryControl_(r);else if(n==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+n)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:CO,d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:EO,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:IO,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){let n=kl("t",e),r=kl("d",e);n==="c"?this.onControl_(r):n==="d"&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){let n=kl(UC,e);if(_O in e){let r=e[_O];if(n===KW){let i=Object.assign({},r);this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if(n===IO){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else n===zW?this.onConnectionShutdown_(r):n===vO?this.onReset_(r):n===WW?KC("Server Error: "+r):n===wO?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):KC("Unknown control packet command: "+n)}}onHandshake_(e){let n=e.ts,r=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,n),Cg!==r&&At("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){let e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),Ll(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor($W))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,n){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(n,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Ll(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(HW))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:CO,d:{}}}))}onSecondaryConnectionLost_(){let e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Xs.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)}close(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}};var bg=class{put(e,n,r,i){}merge(e,n,r,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,n,r){}onDisconnectMerge(e,n,r){}onDisconnectCancel(e,n){}reportStats(e){}};var Sg=class{constructor(e){this.allowedEvents_=e,this.listeners_={},D(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...n){if(Array.isArray(this.listeners_[e])){let r=[...this.listeners_[e]];for(let i=0;i<r.length;i++)r[i].callback.apply(r[i].context,n)}}on(e,n,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:n,context:r});let i=this.getInitialEvent(e);i&&n.apply(r,i)}off(e,n,r){this.validateEventType_(e);let i=this.listeners_[e]||[];for(let s=0;s<i.length;s++)if(i[s].callback===n&&(!r||r===i[s].context)){i.splice(s,1);return}}validateEventType_(e){D(this.allowedEvents_.find(n=>n===e),"Unknown event: "+e)}};var Ag=class t extends Sg{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!mm()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new t}getInitialEvent(e){return D(e==="online","Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}};var DO=32,TO=768,ge=class{constructor(e,n){if(n===void 0){this.pieces_=e.split("/");let r=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=n}toString(){let e="";for(let n=this.pieceNum_;n<this.pieces_.length;n++)this.pieces_[n]!==""&&(e+="/"+this.pieces_[n]);return e||"/"}};function pe(){return new ge("")}function ee(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function Ui(t){return t.pieces_.length-t.pieceNum_}function De(t){let e=t.pieceNum_;return e<t.pieces_.length&&e++,new ge(t.pieces_,e)}function JD(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function QW(t){let e="";for(let n=t.pieceNum_;n<t.pieces_.length;n++)t.pieces_[n]!==""&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}function ql(t,e=0){return t.pieces_.slice(t.pieceNum_+e)}function f1(t){if(t.pieceNum_>=t.pieces_.length)return null;let e=[];for(let n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new ge(e,0)}function ke(t,e){let n=[];for(let r=t.pieceNum_;r<t.pieces_.length;r++)n.push(t.pieces_[r]);if(e instanceof ge)for(let r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);else{let r=e.split("/");for(let i=0;i<r.length;i++)r[i].length>0&&n.push(r[i])}return new ge(n,0)}function te(t){return t.pieceNum_>=t.pieces_.length}function Ot(t,e){let n=ee(t),r=ee(e);if(n===null)return e;if(n===r)return Ot(De(t),De(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function YW(t,e){let n=ql(t,0),r=ql(e,0);for(let i=0;i<n.length&&i<r.length;i++){let s=to(n[i],r[i]);if(s!==0)return s}return n.length===r.length?0:n.length<r.length?-1:1}function e0(t,e){if(Ui(t)!==Ui(e))return!1;for(let n=t.pieceNum_,r=e.pieceNum_;n<=t.pieces_.length;n++,r++)if(t.pieces_[n]!==e.pieces_[r])return!1;return!0}function In(t,e){let n=t.pieceNum_,r=e.pieceNum_;if(Ui(t)>Ui(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[r])return!1;++n,++r}return!0}var nD=class{constructor(e,n){this.errorPrefix_=n,this.parts_=ql(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=gu(this.parts_[r]);p1(this)}};function ZW(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=gu(e),p1(t)}function XW(t){let e=t.parts_.pop();t.byteLength_-=gu(e),t.parts_.length>0&&(t.byteLength_-=1)}function p1(t){if(t.byteLength_>TO)throw new Error(t.errorPrefix_+"has a key path longer than "+TO+" bytes ("+t.byteLength_+").");if(t.parts_.length>DO)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+DO+") or object contains a cycle "+Zs(t))}function Zs(t){return t.parts_.length===0?"":"in property '"+t.parts_.join(".")+"'"}var rD=class t extends Sg{constructor(){super(["visible"]);let e,n;typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(n="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(n="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(n="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(n="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,n&&document.addEventListener(n,()=>{let r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}static getInstance(){return new t}getInitialEvent(e){return D(e==="visible","Unknown event type: "+e),[this.visible_]}};var Ol=1e3,JW=60*5*1e3,bO=30*1e3,e9=1.3,t9=3e4,n9="server_kill",SO=3,t0=(()=>{class t extends bg{constructor(n,r,i,s,o,a,u,c){if(super(),this.repoInfo_=n,this.applicationId_=r,this.onDataUpdate_=i,this.onConnectStatus_=s,this.onServerInfoUpdate_=o,this.authTokenProvider_=a,this.appCheckTokenProvider_=u,this.authOverride_=c,this.id=t.nextPersistentConnectionId_++,this.log_=id("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=Ol,this.maxReconnectDelay_=JW,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,c&&!Hn())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");rD.getInstance().on("visible",this.onVisible_,this),n.host.indexOf("fblocal")===-1&&Ag.getInstance().on("online",this.onOnline_,this)}sendRequest(n,r,i){let s=++this.requestNumber_,o={r:s,a:n,b:r};this.log_(ze(o)),D(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),i&&(this.requestCBHash_[s]=i)}get(n){this.initConnection_();let r=new ot,s={action:"g",request:{p:n._path.toString(),q:n._queryObject},onComplete:a=>{let u=a.d;a.s==="ok"?r.resolve(u):r.reject(u)}};this.outstandingGets_.push(s),this.outstandingGetCount_++;let o=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(o),r.promise}listen(n,r,i,s){this.initConnection_();let o=n._queryIdentifier,a=n._path.toString();this.log_("Listen called for "+a+" "+o),this.listens.has(a)||this.listens.set(a,new Map),D(n._queryParams.isDefault()||!n._queryParams.loadsAllData(),"listen() called for non-default but complete query"),D(!this.listens.get(a).has(o),"listen() called twice for same path/queryId.");let u={onComplete:s,hashFn:r,query:n,tag:i};this.listens.get(a).set(o,u),this.connected_&&this.sendListen_(u)}sendGet_(n){let r=this.outstandingGets_[n];this.sendRequest("g",r.request,i=>{delete this.outstandingGets_[n],this.outstandingGetCount_--,this.outstandingGetCount_===0&&(this.outstandingGets_=[]),r.onComplete&&r.onComplete(i)})}sendListen_(n){let r=n.query,i=r._path.toString(),s=r._queryIdentifier;this.log_("Listen on "+i+" for "+s);let o={p:i},a="q";n.tag&&(o.q=r._queryObject,o.t=n.tag),o.h=n.hashFn(),this.sendRequest(a,o,u=>{let c=u.d,l=u.s;t.warnOnListenWarnings_(c,r),(this.listens.get(i)&&this.listens.get(i).get(s))===n&&(this.log_("listen response",u),l!=="ok"&&this.removeListen_(i,s),n.onComplete&&n.onComplete(l,c))})}static warnOnListenWarnings_(n,r){if(n&&typeof n=="object"&&on(n,"w")){let i=zr(n,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){let s='".indexOn": "'+r._queryParams.getIndex().toString()+'"',o=r._path.toString();At(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${o} to your security rules for better performance.`)}}}refreshAuthToken(n){this.authToken_=n,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(n)}reduceReconnectDelayIfAdminCredential_(n){(n&&n.length===40||$0(n))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=bO)}refreshAppCheckToken(n){this.appCheckToken_=n,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){let n=this.authToken_,r=B0(n)?"auth":"gauth",i={cred:n};this.authOverride_===null?i.noauth=!0:typeof this.authOverride_=="object"&&(i.authvar=this.authOverride_),this.sendRequest(r,i,s=>{let o=s.s,a=s.d||"error";this.authToken_===n&&(o==="ok"?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(o,a))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},n=>{let r=n.s,i=n.d||"error";r==="ok"?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(r,i)})}unlisten(n,r){let i=n._path.toString(),s=n._queryIdentifier;this.log_("Unlisten called for "+i+" "+s),D(n._queryParams.isDefault()||!n._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,s)&&this.connected_&&this.sendUnlisten_(i,s,n._queryObject,r)}sendUnlisten_(n,r,i,s){this.log_("Unlisten on "+n+" for "+r);let o={p:n},a="n";s&&(o.q=i,o.t=s),this.sendRequest(a,o)}onDisconnectPut(n,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",n,r,i):this.onDisconnectRequestQueue_.push({pathString:n,action:"o",data:r,onComplete:i})}onDisconnectMerge(n,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",n,r,i):this.onDisconnectRequestQueue_.push({pathString:n,action:"om",data:r,onComplete:i})}onDisconnectCancel(n,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",n,null,r):this.onDisconnectRequestQueue_.push({pathString:n,action:"oc",data:null,onComplete:r})}sendOnDisconnect_(n,r,i,s){let o={p:r,d:i};this.log_("onDisconnect "+n,o),this.sendRequest(n,o,a=>{s&&setTimeout(()=>{s(a.s,a.d)},Math.floor(0))})}put(n,r,i,s){this.putInternal("p",n,r,i,s)}merge(n,r,i,s){this.putInternal("m",n,r,i,s)}putInternal(n,r,i,s,o){this.initConnection_();let a={p:r,d:i};o!==void 0&&(a.h=o),this.outstandingPuts_.push({action:n,request:a,onComplete:s}),this.outstandingPutCount_++;let u=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(u):this.log_("Buffering put: "+r)}sendPut_(n){let r=this.outstandingPuts_[n].action,i=this.outstandingPuts_[n].request,s=this.outstandingPuts_[n].onComplete;this.outstandingPuts_[n].queued=this.connected_,this.sendRequest(r,i,o=>{this.log_(r+" response",o),delete this.outstandingPuts_[n],this.outstandingPutCount_--,this.outstandingPutCount_===0&&(this.outstandingPuts_=[]),s&&s(o.s,o.d)})}reportStats(n){if(this.connected_){let r={c:n};this.log_("reportStats",r),this.sendRequest("s",r,i=>{if(i.s!=="ok"){let o=i.d;this.log_("reportStats","Error sending stats: "+o)}})}}onDataMessage_(n){if("r"in n){this.log_("from server: "+ze(n));let r=n.r,i=this.requestCBHash_[r];i&&(delete this.requestCBHash_[r],i(n.b))}else{if("error"in n)throw"A server-side error has occurred: "+n.error;"a"in n&&this.onDataPush_(n.a,n.b)}}onDataPush_(n,r){this.log_("handleServerMessage",n,r),n==="d"?this.onDataUpdate_(r.p,r.d,!1,r.t):n==="m"?this.onDataUpdate_(r.p,r.d,!0,r.t):n==="c"?this.onListenRevoked_(r.p,r.q):n==="ac"?this.onAuthRevoked_(r.s,r.d):n==="apc"?this.onAppCheckRevoked_(r.s,r.d):n==="sd"?this.onSecurityDebugPacket_(r):KC("Unrecognized action received from server: "+ze(n)+`
Are you using the latest client?`)}onReady_(n,r){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(n),this.lastSessionId=r,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(n){D(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(n))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(n){n&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=Ol,this.realtime_||this.scheduleConnect_(0)),this.visible_=n}onOnline_(n){n?(this.log_("Browser went online."),this.reconnectDelay_=Ol,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(new Date().getTime()-this.lastConnectionEstablishedTime_>t9&&(this.reconnectDelay_=Ol),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime());let n=new Date().getTime()-this.lastConnectionAttemptTime_,r=Math.max(0,this.reconnectDelay_-n);r=Math.random()*r,this.log_("Trying to reconnect in "+r+"ms"),this.scheduleConnect_(r),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*e9)}this.onConnectStatus_(!1)}establishConnection_(){return v(this,null,function*(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;let n=this.onDataMessage_.bind(this),r=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+t.nextConnectionId_++,o=this.lastSessionId,a=!1,u=null,c=function(){u?u.close():(a=!0,i())},l=function(h){D(u,"sendRequest call when we're not connected not allowed."),u.sendRequest(h)};this.realtime_={close:c,sendRequest:l};let d=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{let[h,f]=yield Promise.all([this.authTokenProvider_.getToken(d),this.appCheckTokenProvider_.getToken(d)]);a?ht("getToken() completed but was canceled"):(ht("getToken() completed. Creating connection."),this.authToken_=h&&h.accessToken,this.appCheckToken_=f&&f.token,u=new tD(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,n,r,i,p=>{At(p+" ("+this.repoInfo_.toString()+")"),this.interrupt(n9)},o))}catch(h){this.log_("Failed to get token: "+h),a||(this.repoInfo_.nodeAdmin&&At(h),c())}}})}interrupt(n){ht("Interrupting connection for reason: "+n),this.interruptReasons_[n]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(n){ht("Resuming connection for reason: "+n),delete this.interruptReasons_[n],_d(this.interruptReasons_)&&(this.reconnectDelay_=Ol,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(n){let r=n-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:r})}cancelSentTransactions_(){for(let n=0;n<this.outstandingPuts_.length;n++){let r=this.outstandingPuts_[n];r&&"h"in r.request&&r.queued&&(r.onComplete&&r.onComplete("disconnect"),delete this.outstandingPuts_[n],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])}onListenRevoked_(n,r){let i;r?i=r.map(o=>ZD(o)).join("$"):i="default";let s=this.removeListen_(n,i);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(n,r){let i=new ge(n).toString(),s;if(this.listens.has(i)){let o=this.listens.get(i);s=o.get(r),o.delete(r),o.size===0&&this.listens.delete(i)}else s=void 0;return s}onAuthRevoked_(n,r){ht("Auth token revoked: "+n+"/"+r),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(n==="invalid_token"||n==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=SO&&(this.reconnectDelay_=bO,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(n,r){ht("App check token revoked: "+n+"/"+r),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(n==="invalid_token"||n==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=SO&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(n){this.securityDebugCallback_?this.securityDebugCallback_(n):"msg"in n&&console.log("FIREBASE: "+n.msg.replace(`
`,`
FIREBASE: `))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(let n of this.listens.values())for(let r of n.values())this.sendListen_(r);for(let n=0;n<this.outstandingPuts_.length;n++)this.outstandingPuts_[n]&&this.sendPut_(n);for(;this.onDisconnectRequestQueue_.length;){let n=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(n.action,n.pathString,n.data,n.onComplete)}for(let n=0;n<this.outstandingGets_.length;n++)this.outstandingGets_[n]&&this.sendGet_(n)}sendConnectStats_(){let n={},r="js";Hn()&&(this.repoInfo_.nodeAdmin?r="admin_node":r="node"),n["sdk."+r+"."+QD.replace(/\./g,"-")]=1,mm()?n["framework.cordova"]=1:L0()&&(n["framework.reactnative"]=1),this.reportStats(n)}shouldReconnect_(){let n=Ag.getInstance().currentlyOnline();return _d(this.interruptReasons_)&&n}}t.nextPersistentConnectionId_=0,t.nextConnectionId_=0;return t})(),re=class t{constructor(e,n){this.name=e,this.node=n}static Wrap(e,n){return new t(e,n)}};var eu=class{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,n){let r=new re(ji,e),i=new re(ji,n);return this.compare(r,i)!==0}minPost(){return re.MIN}};var Ig,xg=class extends eu{static get __EMPTY_NODE(){return Ig}static set __EMPTY_NODE(e){Ig=e}compare(e,n){return to(e.name,n.name)}isDefinedOn(e){throw oo("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,n){return!1}minPost(){return re.MIN}maxPost(){return new re(qr,Ig)}makePost(e,n){return D(typeof e=="string","KeyIndex indexValue must always be a string."),new re(e,Ig)}toString(){return".key"}},_r=new xg;var Xa=class{constructor(e,n,r,i,s=null){this.isReverse_=i,this.resultGenerator_=s,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(e=e,o=n?r(e.key,n):1,i&&(o*=-1),o<0)this.isReverse_?e=e.left:e=e.right;else if(o===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}getNext(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_.pop(),n;if(this.resultGenerator_?n=this.resultGenerator_(e.key,e.value):n={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return n}hasNext(){return this.nodeStack_.length>0}peek(){if(this.nodeStack_.length===0)return null;let e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}},Bn=(()=>{class t{constructor(n,r,i,s,o){this.key=n,this.value=r,this.color=i??t.RED,this.left=s??Cn.EMPTY_NODE,this.right=o??Cn.EMPTY_NODE}copy(n,r,i,s,o){return new t(n??this.key,r??this.value,i??this.color,s??this.left,o??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(n){return this.left.inorderTraversal(n)||!!n(this.key,this.value)||this.right.inorderTraversal(n)}reverseTraversal(n){return this.right.reverseTraversal(n)||n(this.key,this.value)||this.left.reverseTraversal(n)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(n,r,i){let s=this,o=i(n,s.key);return o<0?s=s.copy(null,null,null,s.left.insert(n,r,i),null):o===0?s=s.copy(null,r,null,null,null):s=s.copy(null,null,null,null,s.right.insert(n,r,i)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return Cn.EMPTY_NODE;let n=this;return!n.left.isRed_()&&!n.left.left.isRed_()&&(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.removeMin_(),null),n.fixUp_()}remove(n,r){let i,s;if(i=this,r(n,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(n,r),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),r(n,i.key)===0){if(i.right.isEmpty())return Cn.EMPTY_NODE;s=i.right.min_(),i=i.copy(s.key,s.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(n,r))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let n=this;return n.right.isRed_()&&!n.left.isRed_()&&(n=n.rotateLeft_()),n.left.isRed_()&&n.left.left.isRed_()&&(n=n.rotateRight_()),n.left.isRed_()&&n.right.isRed_()&&(n=n.colorFlip_()),n}moveRedLeft_(){let n=this.colorFlip_();return n.right.left.isRed_()&&(n=n.copy(null,null,null,null,n.right.rotateRight_()),n=n.rotateLeft_(),n=n.colorFlip_()),n}moveRedRight_(){let n=this.colorFlip_();return n.left.left.isRed_()&&(n=n.rotateRight_(),n=n.colorFlip_()),n}rotateLeft_(){let n=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,n,null)}rotateRight_(){let n=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,n)}colorFlip_(){let n=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,n,r)}checkMaxDepth_(){let n=this.check_();return Math.pow(2,n)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");let n=this.left.check_();if(n!==this.right.check_())throw new Error("Black depths differ");return n+(this.isRed_()?0:1)}}return t.RED=!0,t.BLACK=!1,t})(),iD=class{copy(e,n,r,i,s){return this}insert(e,n,r){return new Bn(e,n,null)}remove(e,n){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}},Cn=class t{constructor(e,n=t.EMPTY_NODE){this.comparator_=e,this.root_=n}insert(e,n){return new t(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,Bn.BLACK,null,null))}remove(e){return new t(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Bn.BLACK,null,null))}get(e){let n,r=this.root_;for(;!r.isEmpty();){if(n=this.comparator_(e,r.key),n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null}getPredecessorKey(e){let n,r=this.root_,i=null;for(;!r.isEmpty();)if(n=this.comparator_(e,r.key),n===0){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else n<0?r=r.left:n>0&&(i=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new Xa(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,n){return new Xa(this.root_,e,this.comparator_,!1,n)}getReverseIteratorFrom(e,n){return new Xa(this.root_,e,this.comparator_,!0,n)}getReverseIterator(e){return new Xa(this.root_,null,this.comparator_,!0,e)}};Cn.EMPTY_NODE=new iD;function r9(t,e){return to(t.name,e.name)}function n0(t,e){return to(t,e)}var sD;function i9(t){sD=t}var g1=function(t){return typeof t=="number"?"number:"+YO(t):"string:"+t},m1=function(t){if(t.isLeafNode()){let e=t.val();D(typeof e=="string"||typeof e=="number"||typeof e=="object"&&on(e,".sv"),"Priority must be a string or number.")}else D(t===sD||t.isEmpty(),"priority of unexpected type.");D(t===sD||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};var AO,tu=(()=>{class t{constructor(n,r=t.__childrenNodeConstructor.EMPTY_NODE){this.value_=n,this.priorityNode_=r,this.lazyHash_=null,D(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),m1(this.priorityNode_)}static set __childrenNodeConstructor(n){AO=n}static get __childrenNodeConstructor(){return AO}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(n){return new t(this.value_,n)}getImmediateChild(n){return n===".priority"?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE}getChild(n){return te(n)?this:ee(n)===".priority"?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(n,r){return null}updateImmediateChild(n,r){return n===".priority"?this.updatePriority(r):r.isEmpty()&&n!==".priority"?this:t.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(n,r).updatePriority(this.priorityNode_)}updateChild(n,r){let i=ee(n);return i===null?r:r.isEmpty()&&i!==".priority"?this:(D(i!==".priority"||Ui(n)===1,".priority must be the last token in a path"),this.updateImmediateChild(i,t.__childrenNodeConstructor.EMPTY_NODE.updateChild(De(n),r)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(n,r){return!1}val(n){return n&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(this.lazyHash_===null){let n="";this.priorityNode_.isEmpty()||(n+="priority:"+g1(this.priorityNode_.val())+":");let r=typeof this.value_;n+=r+":",r==="number"?n+=YO(this.value_):n+=this.value_,this.lazyHash_=WO(n)}return this.lazyHash_}getValue(){return this.value_}compareTo(n){return n===t.__childrenNodeConstructor.EMPTY_NODE?1:n instanceof t.__childrenNodeConstructor?-1:(D(n.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(n))}compareToLeafNode_(n){let r=typeof n.value_,i=typeof this.value_,s=t.VALUE_TYPE_ORDER.indexOf(r),o=t.VALUE_TYPE_ORDER.indexOf(i);return D(s>=0,"Unknown leaf type: "+r),D(o>=0,"Unknown leaf type: "+i),s===o?i==="object"?0:this.value_<n.value_?-1:this.value_===n.value_?0:1:o-s}withIndex(){return this}isIndexed(){return!0}equals(n){if(n===this)return!0;if(n.isLeafNode()){let r=n;return this.value_===r.value_&&this.priorityNode_.equals(r.priorityNode_)}else return!1}}t.VALUE_TYPE_ORDER=["object","boolean","number","string"];return t})(),y1,_1;function s9(t){y1=t}function o9(t){_1=t}var oD=class extends eu{compare(e,n){let r=e.node.getPriority(),i=n.node.getPriority(),s=r.compareTo(i);return s===0?to(e.name,n.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,n){return!e.getPriority().equals(n.getPriority())}minPost(){return re.MIN}maxPost(){return new re(qr,new tu("[PRIORITY-POST]",_1))}makePost(e,n){let r=y1(e);return new re(n,new tu("[PRIORITY-POST]",r))}toString(){return".priority"}},Se=new oD;var a9=Math.log(2),aD=class{constructor(e){let n=s=>parseInt(Math.log(s)/a9,10),r=s=>parseInt(Array(s+1).join("1"),2);this.count=n(e+1),this.current_=this.count-1;let i=r(this.count);this.bits_=e+1&i}nextBitIsOne(){let e=!(this.bits_&1<<this.current_);return this.current_--,e}},Mg=function(t,e,n,r){t.sort(e);let i=function(u,c){let l=c-u,d,h;if(l===0)return null;if(l===1)return d=t[u],h=n?n(d):d,new Bn(h,d.node,Bn.BLACK,null,null);{let f=parseInt(l/2,10)+u,p=i(u,f),g=i(f+1,c);return d=t[f],h=n?n(d):d,new Bn(h,d.node,Bn.BLACK,p,g)}},s=function(u){let c=null,l=null,d=t.length,h=function(p,g){let _=d-p,C=d;d-=p;let M=i(_+1,C),T=t[_],j=n?n(T):T;f(new Bn(j,T.node,g,null,M))},f=function(p){c?(c.left=p,c=p):(l=p,c=p)};for(let p=0;p<u.count;++p){let g=u.nextBitIsOne(),_=Math.pow(2,u.count-(p+1));g?h(_,Bn.BLACK):(h(_,Bn.BLACK),h(_,Bn.RED))}return l},o=new aD(t.length),a=s(o);return new Cn(r||e,a)};var BC,Ya={},nu=class t{constructor(e,n){this.indexes_=e,this.indexSet_=n}static get Default(){return D(Ya&&Se,"ChildrenNode.ts has not been loaded"),BC=BC||new t({".priority":Ya},{".priority":Se}),BC}get(e){let n=zr(this.indexes_,e);if(!n)throw new Error("No index defined for "+e);return n instanceof Cn?n:null}hasIndex(e){return on(this.indexSet_,e.toString())}addIndex(e,n){D(e!==_r,"KeyIndex always exists and isn't meant to be added to the IndexMap.");let r=[],i=!1,s=n.getIterator(re.Wrap),o=s.getNext();for(;o;)i=i||e.isDefinedOn(o.node),r.push(o),o=s.getNext();let a;i?a=Mg(r,e.getCompare()):a=Ya;let u=e.toString(),c=Object.assign({},this.indexSet_);c[u]=e;let l=Object.assign({},this.indexes_);return l[u]=a,new t(l,c)}addToIndexes(e,n){let r=pu(this.indexes_,(i,s)=>{let o=zr(this.indexSet_,s);if(D(o,"Missing index implementation for "+s),i===Ya)if(o.isDefinedOn(e.node)){let a=[],u=n.getIterator(re.Wrap),c=u.getNext();for(;c;)c.name!==e.name&&a.push(c),c=u.getNext();return a.push(e),Mg(a,o.getCompare())}else return Ya;else{let a=n.get(e.name),u=i;return a&&(u=u.remove(new re(e.name,a))),u.insert(e,e.node)}});return new t(r,this.indexSet_)}removeFromIndexes(e,n){let r=pu(this.indexes_,i=>{if(i===Ya)return i;{let s=n.get(e.name);return s?i.remove(new re(e.name,s)):i}});return new t(r,this.indexSet_)}};var Fl,Q=(()=>{class t{constructor(n,r,i){this.children_=n,this.priorityNode_=r,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&m1(this.priorityNode_),this.children_.isEmpty()&&D(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return Fl||(Fl=new t(new Cn(n0),null,nu.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||Fl}updatePriority(n){return this.children_.isEmpty()?this:new t(this.children_,n,this.indexMap_)}getImmediateChild(n){if(n===".priority")return this.getPriority();{let r=this.children_.get(n);return r===null?Fl:r}}getChild(n){let r=ee(n);return r===null?this:this.getImmediateChild(r).getChild(De(n))}hasChild(n){return this.children_.get(n)!==null}updateImmediateChild(n,r){if(D(r,"We should always be passing snapshot nodes"),n===".priority")return this.updatePriority(r);{let i=new re(n,r),s,o;r.isEmpty()?(s=this.children_.remove(n),o=this.indexMap_.removeFromIndexes(i,this.children_)):(s=this.children_.insert(n,r),o=this.indexMap_.addToIndexes(i,this.children_));let a=s.isEmpty()?Fl:this.priorityNode_;return new t(s,a,o)}}updateChild(n,r){let i=ee(n);if(i===null)return r;{D(ee(n)!==".priority"||Ui(n)===1,".priority must be the last token in a path");let s=this.getImmediateChild(i).updateChild(De(n),r);return this.updateImmediateChild(i,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(n){if(this.isEmpty())return null;let r={},i=0,s=0,o=!0;if(this.forEachChild(Se,(a,u)=>{r[a]=u.val(n),i++,o&&t.INTEGER_REGEXP_.test(a)?s=Math.max(s,Number(a)):o=!1}),!n&&o&&s<2*i){let a=[];for(let u in r)a[u]=r[u];return a}else return n&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r}hash(){if(this.lazyHash_===null){let n="";this.getPriority().isEmpty()||(n+="priority:"+g1(this.getPriority().val())+":"),this.forEachChild(Se,(r,i)=>{let s=i.hash();s!==""&&(n+=":"+r+":"+s)}),this.lazyHash_=n===""?"":WO(n)}return this.lazyHash_}getPredecessorChildName(n,r,i){let s=this.resolveIndex_(i);if(s){let o=s.getPredecessorKey(new re(n,r));return o?o.name:null}else return this.children_.getPredecessorKey(n)}getFirstChildName(n){let r=this.resolveIndex_(n);if(r){let i=r.minKey();return i&&i.name}else return this.children_.minKey()}getFirstChild(n){let r=this.getFirstChildName(n);return r?new re(r,this.children_.get(r)):null}getLastChildName(n){let r=this.resolveIndex_(n);if(r){let i=r.maxKey();return i&&i.name}else return this.children_.maxKey()}getLastChild(n){let r=this.getLastChildName(n);return r?new re(r,this.children_.get(r)):null}forEachChild(n,r){let i=this.resolveIndex_(n);return i?i.inorderTraversal(s=>r(s.name,s.node)):this.children_.inorderTraversal(r)}getIterator(n){return this.getIteratorFrom(n.minPost(),n)}getIteratorFrom(n,r){let i=this.resolveIndex_(r);if(i)return i.getIteratorFrom(n,s=>s);{let s=this.children_.getIteratorFrom(n.name,re.Wrap),o=s.peek();for(;o!=null&&r.compare(o,n)<0;)s.getNext(),o=s.peek();return s}}getReverseIterator(n){return this.getReverseIteratorFrom(n.maxPost(),n)}getReverseIteratorFrom(n,r){let i=this.resolveIndex_(r);if(i)return i.getReverseIteratorFrom(n,s=>s);{let s=this.children_.getReverseIteratorFrom(n.name,re.Wrap),o=s.peek();for(;o!=null&&r.compare(o,n)>0;)s.getNext(),o=s.peek();return s}}compareTo(n){return this.isEmpty()?n.isEmpty()?0:-1:n.isLeafNode()||n.isEmpty()?1:n===sd?-1:0}withIndex(n){if(n===_r||this.indexMap_.hasIndex(n))return this;{let r=this.indexMap_.addIndex(n,this.children_);return new t(this.children_,this.priorityNode_,r)}}isIndexed(n){return n===_r||this.indexMap_.hasIndex(n)}equals(n){if(n===this)return!0;if(n.isLeafNode())return!1;{let r=n;if(this.getPriority().equals(r.getPriority()))if(this.children_.count()===r.children_.count()){let i=this.getIterator(Se),s=r.getIterator(Se),o=i.getNext(),a=s.getNext();for(;o&&a;){if(o.name!==a.name||!o.node.equals(a.node))return!1;o=i.getNext(),a=s.getNext()}return o===null&&a===null}else return!1;else return!1}}resolveIndex_(n){return n===_r?null:this.indexMap_.get(n.toString())}}return t.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,t})(),uD=class extends Q{constructor(){super(new Cn(n0),Q.EMPTY_NODE,nu.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return Q.EMPTY_NODE}isEmpty(){return!1}},sd=new uD;Object.defineProperties(re,{MIN:{value:new re(ji,Q.EMPTY_NODE)},MAX:{value:new re(qr,sd)}});xg.__EMPTY_NODE=Q.EMPTY_NODE;tu.__childrenNodeConstructor=Q;i9(sd);o9(sd);var u9=!0;function Fe(t,e=null){if(t===null)return Q.EMPTY_NODE;if(typeof t=="object"&&".priority"in t&&(e=t[".priority"]),D(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof t=="object"&&".value"in t&&t[".value"]!==null&&(t=t[".value"]),typeof t!="object"||".sv"in t){let n=t;return new tu(n,Fe(e))}if(!(t instanceof Array)&&u9){let n=[],r=!1;if(ft(t,(o,a)=>{if(o.substring(0,1)!=="."){let u=Fe(a);u.isEmpty()||(r=r||!u.getPriority().isEmpty(),n.push(new re(o,u)))}}),n.length===0)return Q.EMPTY_NODE;let s=Mg(n,r9,o=>o.name,n0);if(r){let o=Mg(n,Se.getCompare());return new Q(s,Fe(e),new nu({".priority":o},{".priority":Se}))}else return new Q(s,Fe(e),nu.Default)}else{let n=Q.EMPTY_NODE;return ft(t,(r,i)=>{if(on(t,r)&&r.substring(0,1)!=="."){let s=Fe(i);(s.isLeafNode()||!s.isEmpty())&&(n=n.updateImmediateChild(r,s))}}),n.updatePriority(Fe(e))}}s9(Fe);var Gl=class extends eu{constructor(e){super(),this.indexPath_=e,D(!te(e)&&ee(e)!==".priority","Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,n){let r=this.extractChild(e.node),i=this.extractChild(n.node),s=r.compareTo(i);return s===0?to(e.name,n.name):s}makePost(e,n){let r=Fe(e),i=Q.EMPTY_NODE.updateChild(this.indexPath_,r);return new re(n,i)}maxPost(){let e=Q.EMPTY_NODE.updateChild(this.indexPath_,sd);return new re(qr,e)}toString(){return ql(this.indexPath_,0).join("/")}};var cD=class extends eu{compare(e,n){let r=e.node.compareTo(n.node);return r===0?to(e.name,n.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,n){return!e.equals(n)}minPost(){return re.MIN}maxPost(){return re.MAX}makePost(e,n){let r=Fe(e);return new re(n,r)}toString(){return".value"}},r0=new cD;function v1(t){return{type:"value",snapshotNode:t}}function ru(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function zl(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function Wl(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}function c9(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}var Kl=class{constructor(e){this.index_=e}updateChild(e,n,r,i,s,o){D(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");let a=e.getImmediateChild(n);return a.getChild(i).equals(r.getChild(i))&&a.isEmpty()===r.isEmpty()||(o!=null&&(r.isEmpty()?e.hasChild(n)?o.trackChildChange(zl(n,a)):D(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(ru(n,r)):o.trackChildChange(Wl(n,r,a))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(n,r).withIndex(this.index_)}updateFullNode(e,n,r){return r!=null&&(e.isLeafNode()||e.forEachChild(Se,(i,s)=>{n.hasChild(i)||r.trackChildChange(zl(i,s))}),n.isLeafNode()||n.forEachChild(Se,(i,s)=>{if(e.hasChild(i)){let o=e.getImmediateChild(i);o.equals(s)||r.trackChildChange(Wl(i,s,o))}else r.trackChildChange(ru(i,s))})),n.withIndex(this.index_)}updatePriority(e,n){return e.isEmpty()?Q.EMPTY_NODE:e.updatePriority(n)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}};var Rg=class t{constructor(e){this.indexedFilter_=new Kl(e.getIndex()),this.index_=e.getIndex(),this.startPost_=t.getStartPost_(e),this.endPost_=t.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){let n=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,r=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return n&&r}updateChild(e,n,r,i,s,o){return this.matches(new re(n,r))||(r=Q.EMPTY_NODE),this.indexedFilter_.updateChild(e,n,r,i,s,o)}updateFullNode(e,n,r){n.isLeafNode()&&(n=Q.EMPTY_NODE);let i=n.withIndex(this.index_);i=i.updatePriority(Q.EMPTY_NODE);let s=this;return n.forEachChild(Se,(o,a)=>{s.matches(new re(o,a))||(i=i.updateImmediateChild(o,Q.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,i,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){let n=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),n)}else return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){let n=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),n)}else return e.getIndex().maxPost()}};var lD=class{constructor(e){this.withinDirectionalStart=n=>this.reverse_?this.withinEndPost(n):this.withinStartPost(n),this.withinDirectionalEnd=n=>this.reverse_?this.withinStartPost(n):this.withinEndPost(n),this.withinStartPost=n=>{let r=this.index_.compare(this.rangedFilter_.getStartPost(),n);return this.startIsInclusive_?r<=0:r<0},this.withinEndPost=n=>{let r=this.index_.compare(n,this.rangedFilter_.getEndPost());return this.endIsInclusive_?r<=0:r<0},this.rangedFilter_=new Rg(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,n,r,i,s,o){return this.rangedFilter_.matches(new re(n,r))||(r=Q.EMPTY_NODE),e.getImmediateChild(n).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,n,r,i,s,o):this.fullLimitUpdateChild_(e,n,r,s,o)}updateFullNode(e,n,r){let i;if(n.isLeafNode()||n.isEmpty())i=Q.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<n.numChildren()&&n.isIndexed(this.index_)){i=Q.EMPTY_NODE.withIndex(this.index_);let s;this.reverse_?s=n.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):s=n.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;s.hasNext()&&o<this.limit_;){let a=s.getNext();if(this.withinDirectionalStart(a))if(this.withinDirectionalEnd(a))i=i.updateImmediateChild(a.name,a.node),o++;else break;else continue}}else{i=n.withIndex(this.index_),i=i.updatePriority(Q.EMPTY_NODE);let s;this.reverse_?s=i.getReverseIterator(this.index_):s=i.getIterator(this.index_);let o=0;for(;s.hasNext();){let a=s.getNext();o<this.limit_&&this.withinDirectionalStart(a)&&this.withinDirectionalEnd(a)?o++:i=i.updateImmediateChild(a.name,Q.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,r)}updatePriority(e,n){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,n,r,i,s){let o;if(this.reverse_){let d=this.index_.getCompare();o=(h,f)=>d(f,h)}else o=this.index_.getCompare();let a=e;D(a.numChildren()===this.limit_,"");let u=new re(n,r),c=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),l=this.rangedFilter_.matches(u);if(a.hasChild(n)){let d=a.getImmediateChild(n),h=i.getChildAfterChild(this.index_,c,this.reverse_);for(;h!=null&&(h.name===n||a.hasChild(h.name));)h=i.getChildAfterChild(this.index_,h,this.reverse_);let f=h==null?1:o(h,u);if(l&&!r.isEmpty()&&f>=0)return s?.trackChildChange(Wl(n,r,d)),a.updateImmediateChild(n,r);{s?.trackChildChange(zl(n,d));let g=a.updateImmediateChild(n,Q.EMPTY_NODE);return h!=null&&this.rangedFilter_.matches(h)?(s?.trackChildChange(ru(h.name,h.node)),g.updateImmediateChild(h.name,h.node)):g}}else return r.isEmpty()?e:l&&o(c,u)>=0?(s!=null&&(s.trackChildChange(zl(c.name,c.node)),s.trackChildChange(ru(n,r))),a.updateImmediateChild(n,r).updateImmediateChild(c.name,Q.EMPTY_NODE)):e}};var Ql=class t{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Se}hasStart(){return this.startSet_}isViewFromLeft(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"}getIndexStartValue(){return D(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return D(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:ji}hasEnd(){return this.endSet_}getIndexEndValue(){return D(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return D(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:qr}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&this.viewFrom_!==""}getLimit(){return D(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Se}copy(){let e=new t;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}};function l9(t){return t.loadsAllData()?new Kl(t.getIndex()):t.hasLimit()?new lD(t):new Rg(t)}function d9(t,e){let n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="l",n}function h9(t,e){let n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="r",n}function dD(t,e,n){let r=t.copy();return r.startSet_=!0,e===void 0&&(e=null),r.indexStartValue_=e,n!=null?(r.startNameSet_=!0,r.indexStartName_=n):(r.startNameSet_=!1,r.indexStartName_=""),r}function f9(t,e,n){let r;return t.index_===_r||n?r=dD(t,e,n):r=dD(t,e,qr),r.startAfterSet_=!0,r}function hD(t,e,n){let r=t.copy();return r.endSet_=!0,e===void 0&&(e=null),r.indexEndValue_=e,n!==void 0?(r.endNameSet_=!0,r.indexEndName_=n):(r.endNameSet_=!1,r.indexEndName_=""),r}function p9(t,e,n){let r;return t.index_===_r||n?r=hD(t,e,n):r=hD(t,e,ji),r.endBeforeSet_=!0,r}function Yg(t,e){let n=t.copy();return n.index_=e,n}function xO(t){let e={};if(t.isDefault())return e;let n;if(t.index_===Se?n="$priority":t.index_===r0?n="$value":t.index_===_r?n="$key":(D(t.index_ instanceof Gl,"Unrecognized index type!"),n=t.index_.toString()),e.orderBy=ze(n),t.startSet_){let r=t.startAfterSet_?"startAfter":"startAt";e[r]=ze(t.indexStartValue_),t.startNameSet_&&(e[r]+=","+ze(t.indexStartName_))}if(t.endSet_){let r=t.endBeforeSet_?"endBefore":"endAt";e[r]=ze(t.indexEndValue_),t.endNameSet_&&(e[r]+=","+ze(t.indexEndName_))}return t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function MO(t){let e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_),e.sin=!t.startAfterSet_),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_),e.ein=!t.endBeforeSet_),t.limitSet_){e.l=t.limit_;let n=t.viewFrom_;n===""&&(t.isViewFromLeft()?n="l":n="r"),e.vf=n}return t.index_!==Se&&(e.i=t.index_.toString()),e}var fD=class t extends bg{constructor(e,n,r,i){super(),this.repoInfo_=e,this.onDataUpdate_=n,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=id("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,n){return n!==void 0?"tag$"+n:(D(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,n,r,i){let s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);let o=t.getListenId_(e,r),a={};this.listens_[o]=a;let u=xO(e._queryParams);this.restRequest_(s+".json",u,(c,l)=>{let d=l;if(c===404&&(d=null,c=null),c===null&&this.onDataUpdate_(s,d,!1,r),zr(this.listens_,o)===a){let h;c?c===401?h="permission_denied":h="rest_error:"+c:h="ok",i(h,null)}})}unlisten(e,n){let r=t.getListenId_(e,n);delete this.listens_[r]}get(e){let n=xO(e._queryParams),r=e._path.toString(),i=new ot;return this.restRequest_(r+".json",n,(s,o)=>{let a=o;s===404&&(a=null,s=null),s===null?(this.onDataUpdate_(r,a,!1,null),i.resolve(a)):i.reject(new Error(a))}),i.promise}refreshAuthToken(e){}restRequest_(e,n={},r){return n.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,s])=>{i&&i.accessToken&&(n.auth=i.accessToken),s&&s.token&&(n.ac=s.token);let o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+H0(n);this.log_("Sending REST request for "+o);let a=new XMLHttpRequest;a.onreadystatechange=()=>{if(r&&a.readyState===4){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let u=null;if(a.status>=200&&a.status<300){try{u=yd(a.responseText)}catch{At("Failed to parse JSON response for "+o+": "+a.responseText)}r(null,u)}else a.status!==401&&a.status!==404&&At("Got unsuccessful REST response for "+o+" Status: "+a.status),r(a.status);r=null}},a.open("GET",o,!0),a.send()})}};var pD=class{constructor(){this.rootNode_=Q.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,n){this.rootNode_=this.rootNode_.updateChild(e,n)}};function Ng(){return{value:null,children:new Map}}function cu(t,e,n){if(te(e))t.value=n,t.children.clear();else if(t.value!==null)t.value=t.value.updateChild(e,n);else{let r=ee(e);t.children.has(r)||t.children.set(r,Ng());let i=t.children.get(r);e=De(e),cu(i,e,n)}}function gD(t,e){if(te(e))return t.value=null,t.children.clear(),!0;if(t.value!==null){if(t.value.isLeafNode())return!1;{let n=t.value;return t.value=null,n.forEachChild(Se,(r,i)=>{cu(t,new ge(r),i)}),gD(t,e)}}else if(t.children.size>0){let n=ee(e);return e=De(e),t.children.has(n)&&gD(t.children.get(n),e)&&t.children.delete(n),t.children.size===0}else return!0}function mD(t,e,n){t.value!==null?n(e,t.value):g9(t,(r,i)=>{let s=new ge(e.toString()+"/"+r);mD(i,s,n)})}function g9(t,e){t.children.forEach((n,r)=>{e(r,n)})}var yD=class{constructor(e){this.collection_=e,this.last_=null}get(){let e=this.collection_.get(),n=Object.assign({},e);return this.last_&&ft(this.last_,(r,i)=>{n[r]=n[r]-i}),this.last_=e,n}};var RO=10*1e3,m9=30*1e3,y9=5*60*1e3,_D=class{constructor(e,n){this.server_=n,this.statsToReport_={},this.statsListener_=new yD(e);let r=RO+(m9-RO)*Math.random();Ll(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){let e=this.statsListener_.get(),n={},r=!1;ft(e,(i,s)=>{s>0&&on(this.statsToReport_,i)&&(n[i]=s,r=!0)}),r&&this.server_.reportStats(n),Ll(this.reportStats_.bind(this),Math.floor(Math.random()*2*y9))}};var yr=function(t){return t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",t}(yr||{});function i0(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function s0(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function o0(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}var vD=class t{constructor(e,n,r){this.path=e,this.affectedTree=n,this.revert=r,this.type=yr.ACK_USER_WRITE,this.source=i0()}operationForChild(e){if(te(this.path)){if(this.affectedTree.value!=null)return D(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{let n=this.affectedTree.subtree(new ge(e));return new t(pe(),n,this.revert)}}else return D(ee(this.path)===e,"operationForChild called for unrelated child."),new t(De(this.path),this.affectedTree,this.revert)}};var Pg=class t{constructor(e,n){this.source=e,this.path=n,this.type=yr.LISTEN_COMPLETE}operationForChild(e){return te(this.path)?new t(this.source,pe()):new t(this.source,De(this.path))}};var iu=class t{constructor(e,n,r){this.source=e,this.path=n,this.snap=r,this.type=yr.OVERWRITE}operationForChild(e){return te(this.path)?new t(this.source,pe(),this.snap.getImmediateChild(e)):new t(this.source,De(this.path),this.snap)}};var Yl=class t{constructor(e,n,r){this.source=e,this.path=n,this.children=r,this.type=yr.MERGE}operationForChild(e){if(te(this.path)){let n=this.children.subtree(new ge(e));return n.isEmpty()?null:n.value?new iu(this.source,pe(),n.value):new t(this.source,pe(),n)}else return D(ee(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new t(this.source,De(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}};var wr=class{constructor(e,n,r){this.node_=e,this.fullyInitialized_=n,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(te(e))return this.isFullyInitialized()&&!this.filtered_;let n=ee(e);return this.isCompleteForChild(n)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}};var wD=class{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}};function _9(t,e,n,r){let i=[],s=[];return e.forEach(o=>{o.type==="child_changed"&&t.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&s.push(c9(o.childName,o.snapshotNode))}),Vl(t,i,"child_removed",e,r,n),Vl(t,i,"child_added",e,r,n),Vl(t,i,"child_moved",s,r,n),Vl(t,i,"child_changed",e,r,n),Vl(t,i,"value",e,r,n),i}function Vl(t,e,n,r,i,s){let o=r.filter(a=>a.type===n);o.sort((a,u)=>w9(t,a,u)),o.forEach(a=>{let u=v9(t,a,s);i.forEach(c=>{c.respondsTo(a.type)&&e.push(c.createEvent(u,t.query_))})})}function v9(t,e,n){return e.type==="value"||e.type==="child_removed"||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}function w9(t,e,n){if(e.childName==null||n.childName==null)throw oo("Should only compare child_ events.");let r=new re(e.childName,e.snapshotNode),i=new re(n.childName,n.snapshotNode);return t.index_.compare(r,i)}function Zg(t,e){return{eventCache:t,serverCache:e}}function Ul(t,e,n,r){return Zg(new wr(e,n,r),t.serverCache)}function w1(t,e,n,r){return Zg(t.eventCache,new wr(e,n,r))}function kg(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function eo(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}var $C,E9=()=>($C||($C=new Cn(vW)),$C),Ft=class t{constructor(e,n=E9()){this.value=e,this.children=n}static fromObject(e){let n=new t(null);return ft(e,(r,i)=>{n=n.set(new ge(r),i)}),n}isEmpty(){return this.value===null&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,n){if(this.value!=null&&n(this.value))return{path:pe(),value:this.value};if(te(e))return null;{let r=ee(e),i=this.children.get(r);if(i!==null){let s=i.findRootMostMatchingPathAndValue(De(e),n);return s!=null?{path:ke(new ge(r),s.path),value:s.value}:null}else return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(te(e))return this;{let n=ee(e),r=this.children.get(n);return r!==null?r.subtree(De(e)):new t(null)}}set(e,n){if(te(e))return new t(n,this.children);{let r=ee(e),s=(this.children.get(r)||new t(null)).set(De(e),n),o=this.children.insert(r,s);return new t(this.value,o)}}remove(e){if(te(e))return this.children.isEmpty()?new t(null):new t(null,this.children);{let n=ee(e),r=this.children.get(n);if(r){let i=r.remove(De(e)),s;return i.isEmpty()?s=this.children.remove(n):s=this.children.insert(n,i),this.value===null&&s.isEmpty()?new t(null):new t(this.value,s)}else return this}}get(e){if(te(e))return this.value;{let n=ee(e),r=this.children.get(n);return r?r.get(De(e)):null}}setTree(e,n){if(te(e))return n;{let r=ee(e),s=(this.children.get(r)||new t(null)).setTree(De(e),n),o;return s.isEmpty()?o=this.children.remove(r):o=this.children.insert(r,s),new t(this.value,o)}}fold(e){return this.fold_(pe(),e)}fold_(e,n){let r={};return this.children.inorderTraversal((i,s)=>{r[i]=s.fold_(ke(e,i),n)}),n(e,this.value,r)}findOnPath(e,n){return this.findOnPath_(e,pe(),n)}findOnPath_(e,n,r){let i=this.value?r(n,this.value):!1;if(i)return i;if(te(e))return null;{let s=ee(e),o=this.children.get(s);return o?o.findOnPath_(De(e),ke(n,s),r):null}}foreachOnPath(e,n){return this.foreachOnPath_(e,pe(),n)}foreachOnPath_(e,n,r){if(te(e))return this;{this.value&&r(n,this.value);let i=ee(e),s=this.children.get(i);return s?s.foreachOnPath_(De(e),ke(n,i),r):new t(null)}}foreach(e){this.foreach_(pe(),e)}foreach_(e,n){this.children.inorderTraversal((r,i)=>{i.foreach_(ke(e,r),n)}),this.value&&n(e,this.value)}foreachChild(e){this.children.inorderTraversal((n,r)=>{r.value&&e(n,r.value)})}};var $n=class t{constructor(e){this.writeTree_=e}static empty(){return new t(new Ft(null))}};function Bl(t,e,n){if(te(e))return new $n(new Ft(n));{let r=t.writeTree_.findRootMostValueAndPath(e);if(r!=null){let i=r.path,s=r.value,o=Ot(i,e);return s=s.updateChild(o,n),new $n(t.writeTree_.set(i,s))}else{let i=new Ft(n),s=t.writeTree_.setTree(e,i);return new $n(s)}}}function ED(t,e,n){let r=t;return ft(n,(i,s)=>{r=Bl(r,ke(e,i),s)}),r}function NO(t,e){if(te(e))return $n.empty();{let n=t.writeTree_.setTree(e,new Ft(null));return new $n(n)}}function ID(t,e){return no(t,e)!=null}function no(t,e){let n=t.writeTree_.findRootMostValueAndPath(e);return n!=null?t.writeTree_.get(n.path).getChild(Ot(n.path,e)):null}function PO(t){let e=[],n=t.writeTree_.value;return n!=null?n.isLeafNode()||n.forEachChild(Se,(r,i)=>{e.push(new re(r,i))}):t.writeTree_.children.inorderTraversal((r,i)=>{i.value!=null&&e.push(new re(r,i.value))}),e}function Vi(t,e){if(te(e))return t;{let n=no(t,e);return n!=null?new $n(new Ft(n)):new $n(t.writeTree_.subtree(e))}}function CD(t){return t.writeTree_.isEmpty()}function su(t,e){return E1(pe(),t.writeTree_,e)}function E1(t,e,n){if(e.value!=null)return n.updateChild(t,e.value);{let r=null;return e.children.inorderTraversal((i,s)=>{i===".priority"?(D(s.value!==null,"Priority writes must always be leaf nodes"),r=s.value):n=E1(ke(t,i),s,n)}),!n.getChild(t).isEmpty()&&r!==null&&(n=n.updateChild(ke(t,".priority"),r)),n}}function Xg(t,e){return T1(e,t)}function I9(t,e,n,r,i){D(r>t.lastWriteId,"Stacking an older write on top of newer ones"),i===void 0&&(i=!0),t.allWrites.push({path:e,snap:n,writeId:r,visible:i}),i&&(t.visibleWrites=Bl(t.visibleWrites,e,n)),t.lastWriteId=r}function C9(t,e,n,r){D(r>t.lastWriteId,"Stacking an older merge on top of newer ones"),t.allWrites.push({path:e,children:n,writeId:r,visible:!0}),t.visibleWrites=ED(t.visibleWrites,e,n),t.lastWriteId=r}function D9(t,e){for(let n=0;n<t.allWrites.length;n++){let r=t.allWrites[n];if(r.writeId===e)return r}return null}function T9(t,e){let n=t.allWrites.findIndex(a=>a.writeId===e);D(n>=0,"removeWrite called with nonexistent writeId.");let r=t.allWrites[n];t.allWrites.splice(n,1);let i=r.visible,s=!1,o=t.allWrites.length-1;for(;i&&o>=0;){let a=t.allWrites[o];a.visible&&(o>=n&&b9(a,r.path)?i=!1:In(r.path,a.path)&&(s=!0)),o--}if(i){if(s)return S9(t),!0;if(r.snap)t.visibleWrites=NO(t.visibleWrites,r.path);else{let a=r.children;ft(a,u=>{t.visibleWrites=NO(t.visibleWrites,ke(r.path,u))})}return!0}else return!1}function b9(t,e){if(t.snap)return In(t.path,e);for(let n in t.children)if(t.children.hasOwnProperty(n)&&In(ke(t.path,n),e))return!0;return!1}function S9(t){t.visibleWrites=I1(t.allWrites,A9,pe()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}function A9(t){return t.visible}function I1(t,e,n){let r=$n.empty();for(let i=0;i<t.length;++i){let s=t[i];if(e(s)){let o=s.path,a;if(s.snap)In(n,o)?(a=Ot(n,o),r=Bl(r,a,s.snap)):In(o,n)&&(a=Ot(o,n),r=Bl(r,pe(),s.snap.getChild(a)));else if(s.children){if(In(n,o))a=Ot(n,o),r=ED(r,a,s.children);else if(In(o,n))if(a=Ot(o,n),te(a))r=ED(r,pe(),s.children);else{let u=zr(s.children,ee(a));if(u){let c=u.getChild(De(a));r=Bl(r,pe(),c)}}}else throw oo("WriteRecord should have .snap or .children")}}return r}function C1(t,e,n,r,i){if(!r&&!i){let s=no(t.visibleWrites,e);if(s!=null)return s;{let o=Vi(t.visibleWrites,e);if(CD(o))return n;if(n==null&&!ID(o,pe()))return null;{let a=n||Q.EMPTY_NODE;return su(o,a)}}}else{let s=Vi(t.visibleWrites,e);if(!i&&CD(s))return n;if(!i&&n==null&&!ID(s,pe()))return null;{let o=function(c){return(c.visible||i)&&(!r||!~r.indexOf(c.writeId))&&(In(c.path,e)||In(e,c.path))},a=I1(t.allWrites,o,e),u=n||Q.EMPTY_NODE;return su(a,u)}}}function x9(t,e,n){let r=Q.EMPTY_NODE,i=no(t.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(Se,(s,o)=>{r=r.updateImmediateChild(s,o)}),r;if(n){let s=Vi(t.visibleWrites,e);return n.forEachChild(Se,(o,a)=>{let u=su(Vi(s,new ge(o)),a);r=r.updateImmediateChild(o,u)}),PO(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}else{let s=Vi(t.visibleWrites,e);return PO(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}}function M9(t,e,n,r,i){D(r||i,"Either existingEventSnap or existingServerSnap must exist");let s=ke(e,n);if(ID(t.visibleWrites,s))return null;{let o=Vi(t.visibleWrites,s);return CD(o)?i.getChild(n):su(o,i.getChild(n))}}function R9(t,e,n,r){let i=ke(e,n),s=no(t.visibleWrites,i);if(s!=null)return s;if(r.isCompleteForChild(n)){let o=Vi(t.visibleWrites,i);return su(o,r.getNode().getImmediateChild(n))}else return null}function N9(t,e){return no(t.visibleWrites,e)}function P9(t,e,n,r,i,s,o){let a,u=Vi(t.visibleWrites,e),c=no(u,pe());if(c!=null)a=c;else if(n!=null)a=su(u,n);else return[];if(a=a.withIndex(o),!a.isEmpty()&&!a.isLeafNode()){let l=[],d=o.getCompare(),h=s?a.getReverseIteratorFrom(r,o):a.getIteratorFrom(r,o),f=h.getNext();for(;f&&l.length<i;)d(f,r)!==0&&l.push(f),f=h.getNext();return l}else return[]}function k9(){return{visibleWrites:$n.empty(),allWrites:[],lastWriteId:-1}}function Og(t,e,n,r){return C1(t.writeTree,t.treePath,e,n,r)}function a0(t,e){return x9(t.writeTree,t.treePath,e)}function kO(t,e,n,r){return M9(t.writeTree,t.treePath,e,n,r)}function Fg(t,e){return N9(t.writeTree,ke(t.treePath,e))}function O9(t,e,n,r,i,s){return P9(t.writeTree,t.treePath,e,n,r,i,s)}function u0(t,e,n){return R9(t.writeTree,t.treePath,e,n)}function D1(t,e){return T1(ke(t.treePath,e),t.writeTree)}function T1(t,e){return{treePath:t,writeTree:e}}var DD=class{constructor(){this.changeMap=new Map}trackChildChange(e){let n=e.type,r=e.childName;D(n==="child_added"||n==="child_changed"||n==="child_removed","Only child changes supported for tracking"),D(r!==".priority","Only non-priority child changes can be tracked.");let i=this.changeMap.get(r);if(i){let s=i.type;if(n==="child_added"&&s==="child_removed")this.changeMap.set(r,Wl(r,e.snapshotNode,i.snapshotNode));else if(n==="child_removed"&&s==="child_added")this.changeMap.delete(r);else if(n==="child_removed"&&s==="child_changed")this.changeMap.set(r,zl(r,i.oldSnap));else if(n==="child_changed"&&s==="child_added")this.changeMap.set(r,ru(r,e.snapshotNode));else if(n==="child_changed"&&s==="child_changed")this.changeMap.set(r,Wl(r,e.snapshotNode,i.oldSnap));else throw oo("Illegal combination of changes: "+e+" occurred after "+i)}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}};var TD=class{getCompleteChild(e){return null}getChildAfterChild(e,n,r){return null}},b1=new TD,Zl=class{constructor(e,n,r=null){this.writes_=e,this.viewCache_=n,this.optCompleteServerCache_=r}getCompleteChild(e){let n=this.viewCache_.eventCache;if(n.isCompleteForChild(e))return n.getNode().getImmediateChild(e);{let r=this.optCompleteServerCache_!=null?new wr(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return u0(this.writes_,e,r)}}getChildAfterChild(e,n,r){let i=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:eo(this.viewCache_),s=O9(this.writes_,i,n,1,r,e);return s.length===0?null:s[0]}};function F9(t){return{filter:t}}function V9(t,e){D(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),D(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}function L9(t,e,n,r,i){let s=new DD,o,a;if(n.type===yr.OVERWRITE){let c=n;c.source.fromUser?o=bD(t,e,c.path,c.snap,r,i,s):(D(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.serverCache.isFiltered()&&!te(c.path),o=Vg(t,e,c.path,c.snap,r,i,a,s))}else if(n.type===yr.MERGE){let c=n;c.source.fromUser?o=U9(t,e,c.path,c.children,r,i,s):(D(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.serverCache.isFiltered(),o=SD(t,e,c.path,c.children,r,i,a,s))}else if(n.type===yr.ACK_USER_WRITE){let c=n;c.revert?o=H9(t,e,c.path,r,i,s):o=B9(t,e,c.path,c.affectedTree,r,i,s)}else if(n.type===yr.LISTEN_COMPLETE)o=$9(t,e,n.path,r,s);else throw oo("Unknown operation type: "+n.type);let u=s.getChanges();return j9(e,o,u),{viewCache:o,changes:u}}function j9(t,e,n){let r=e.eventCache;if(r.isFullyInitialized()){let i=r.getNode().isLeafNode()||r.getNode().isEmpty(),s=kg(t);(n.length>0||!t.eventCache.isFullyInitialized()||i&&!r.getNode().equals(s)||!r.getNode().getPriority().equals(s.getPriority()))&&n.push(v1(kg(e)))}}function S1(t,e,n,r,i,s){let o=e.eventCache;if(Fg(r,n)!=null)return e;{let a,u;if(te(n))if(D(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){let c=eo(e),l=c instanceof Q?c:Q.EMPTY_NODE,d=a0(r,l);a=t.filter.updateFullNode(e.eventCache.getNode(),d,s)}else{let c=Og(r,eo(e));a=t.filter.updateFullNode(e.eventCache.getNode(),c,s)}else{let c=ee(n);if(c===".priority"){D(Ui(n)===1,"Can't have a priority with additional path components");let l=o.getNode();u=e.serverCache.getNode();let d=kO(r,n,l,u);d!=null?a=t.filter.updatePriority(l,d):a=o.getNode()}else{let l=De(n),d;if(o.isCompleteForChild(c)){u=e.serverCache.getNode();let h=kO(r,n,o.getNode(),u);h!=null?d=o.getNode().getImmediateChild(c).updateChild(l,h):d=o.getNode().getImmediateChild(c)}else d=u0(r,c,e.serverCache);d!=null?a=t.filter.updateChild(o.getNode(),c,d,l,i,s):a=o.getNode()}}return Ul(e,a,o.isFullyInitialized()||te(n),t.filter.filtersNodes())}}function Vg(t,e,n,r,i,s,o,a){let u=e.serverCache,c,l=o?t.filter:t.filter.getIndexedFilter();if(te(n))c=l.updateFullNode(u.getNode(),r,null);else if(l.filtersNodes()&&!u.isFiltered()){let f=u.getNode().updateChild(n,r);c=l.updateFullNode(u.getNode(),f,null)}else{let f=ee(n);if(!u.isCompleteForPath(n)&&Ui(n)>1)return e;let p=De(n),_=u.getNode().getImmediateChild(f).updateChild(p,r);f===".priority"?c=l.updatePriority(u.getNode(),_):c=l.updateChild(u.getNode(),f,_,p,b1,null)}let d=w1(e,c,u.isFullyInitialized()||te(n),l.filtersNodes()),h=new Zl(i,d,s);return S1(t,d,n,i,h,a)}function bD(t,e,n,r,i,s,o){let a=e.eventCache,u,c,l=new Zl(i,e,s);if(te(n))c=t.filter.updateFullNode(e.eventCache.getNode(),r,o),u=Ul(e,c,!0,t.filter.filtersNodes());else{let d=ee(n);if(d===".priority")c=t.filter.updatePriority(e.eventCache.getNode(),r),u=Ul(e,c,a.isFullyInitialized(),a.isFiltered());else{let h=De(n),f=a.getNode().getImmediateChild(d),p;if(te(h))p=r;else{let g=l.getCompleteChild(d);g!=null?JD(h)===".priority"&&g.getChild(f1(h)).isEmpty()?p=g:p=g.updateChild(h,r):p=Q.EMPTY_NODE}if(f.equals(p))u=e;else{let g=t.filter.updateChild(a.getNode(),d,p,h,l,o);u=Ul(e,g,a.isFullyInitialized(),t.filter.filtersNodes())}}}return u}function OO(t,e){return t.eventCache.isCompleteForChild(e)}function U9(t,e,n,r,i,s,o){let a=e;return r.foreach((u,c)=>{let l=ke(n,u);OO(e,ee(l))&&(a=bD(t,a,l,c,i,s,o))}),r.foreach((u,c)=>{let l=ke(n,u);OO(e,ee(l))||(a=bD(t,a,l,c,i,s,o))}),a}function FO(t,e,n){return n.foreach((r,i)=>{e=e.updateChild(r,i)}),e}function SD(t,e,n,r,i,s,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let u=e,c;te(n)?c=r:c=new Ft(null).setTree(n,r);let l=e.serverCache.getNode();return c.children.inorderTraversal((d,h)=>{if(l.hasChild(d)){let f=e.serverCache.getNode().getImmediateChild(d),p=FO(t,f,h);u=Vg(t,u,new ge(d),p,i,s,o,a)}}),c.children.inorderTraversal((d,h)=>{let f=!e.serverCache.isCompleteForChild(d)&&h.value===null;if(!l.hasChild(d)&&!f){let p=e.serverCache.getNode().getImmediateChild(d),g=FO(t,p,h);u=Vg(t,u,new ge(d),g,i,s,o,a)}}),u}function B9(t,e,n,r,i,s,o){if(Fg(i,n)!=null)return e;let a=e.serverCache.isFiltered(),u=e.serverCache;if(r.value!=null){if(te(n)&&u.isFullyInitialized()||u.isCompleteForPath(n))return Vg(t,e,n,u.getNode().getChild(n),i,s,a,o);if(te(n)){let c=new Ft(null);return u.getNode().forEachChild(_r,(l,d)=>{c=c.set(new ge(l),d)}),SD(t,e,n,c,i,s,a,o)}else return e}else{let c=new Ft(null);return r.foreach((l,d)=>{let h=ke(n,l);u.isCompleteForPath(h)&&(c=c.set(l,u.getNode().getChild(h)))}),SD(t,e,n,c,i,s,a,o)}}function $9(t,e,n,r,i){let s=e.serverCache,o=w1(e,s.getNode(),s.isFullyInitialized()||te(n),s.isFiltered());return S1(t,o,n,r,b1,i)}function H9(t,e,n,r,i,s){let o;if(Fg(r,n)!=null)return e;{let a=new Zl(r,e,i),u=e.eventCache.getNode(),c;if(te(n)||ee(n)===".priority"){let l;if(e.serverCache.isFullyInitialized())l=Og(r,eo(e));else{let d=e.serverCache.getNode();D(d instanceof Q,"serverChildren would be complete if leaf node"),l=a0(r,d)}l=l,c=t.filter.updateFullNode(u,l,s)}else{let l=ee(n),d=u0(r,l,e.serverCache);d==null&&e.serverCache.isCompleteForChild(l)&&(d=u.getImmediateChild(l)),d!=null?c=t.filter.updateChild(u,l,d,De(n),a,s):e.eventCache.getNode().hasChild(l)?c=t.filter.updateChild(u,l,Q.EMPTY_NODE,De(n),a,s):c=u,c.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=Og(r,eo(e)),o.isLeafNode()&&(c=t.filter.updateFullNode(c,o,s)))}return o=e.serverCache.isFullyInitialized()||Fg(r,pe())!=null,Ul(e,c,o,t.filter.filtersNodes())}}var AD=class{constructor(e,n){this.query_=e,this.eventRegistrations_=[];let r=this.query_._queryParams,i=new Kl(r.getIndex()),s=l9(r);this.processor_=F9(s);let o=n.serverCache,a=n.eventCache,u=i.updateFullNode(Q.EMPTY_NODE,o.getNode(),null),c=s.updateFullNode(Q.EMPTY_NODE,a.getNode(),null),l=new wr(u,o.isFullyInitialized(),i.filtersNodes()),d=new wr(c,a.isFullyInitialized(),s.filtersNodes());this.viewCache_=Zg(d,l),this.eventGenerator_=new wD(this.query_)}get query(){return this.query_}};function q9(t){return t.viewCache_.serverCache.getNode()}function G9(t){return kg(t.viewCache_)}function z9(t,e){let n=eo(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!te(e)&&!n.getImmediateChild(ee(e)).isEmpty())?n.getChild(e):null}function VO(t){return t.eventRegistrations_.length===0}function W9(t,e){t.eventRegistrations_.push(e)}function LO(t,e,n){let r=[];if(n){D(e==null,"A cancel should cancel all event registrations.");let i=t.query._path;t.eventRegistrations_.forEach(s=>{let o=s.createCancelEvent(n,i);o&&r.push(o)})}if(e){let i=[];for(let s=0;s<t.eventRegistrations_.length;++s){let o=t.eventRegistrations_[s];if(!o.matches(e))i.push(o);else if(e.hasAnyCallback()){i=i.concat(t.eventRegistrations_.slice(s+1));break}}t.eventRegistrations_=i}else t.eventRegistrations_=[];return r}function jO(t,e,n,r){e.type===yr.MERGE&&e.source.queryId!==null&&(D(eo(t.viewCache_),"We should always have a full cache before handling merges"),D(kg(t.viewCache_),"Missing event cache, even though we have a server cache"));let i=t.viewCache_,s=L9(t.processor_,i,e,n,r);return V9(t.processor_,s.viewCache),D(s.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=s.viewCache,A1(t,s.changes,s.viewCache.eventCache.getNode(),null)}function K9(t,e){let n=t.viewCache_.eventCache,r=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(Se,(s,o)=>{r.push(ru(s,o))}),n.isFullyInitialized()&&r.push(v1(n.getNode())),A1(t,r,n.getNode(),e)}function A1(t,e,n,r){let i=r?[r]:t.eventRegistrations_;return _9(t.eventGenerator_,e,n,i)}var Lg,jg=class{constructor(){this.views=new Map}};function Q9(t){D(!Lg,"__referenceConstructor has already been defined"),Lg=t}function Y9(){return D(Lg,"Reference.ts has not been loaded"),Lg}function Z9(t){return t.views.size===0}function c0(t,e,n,r){let i=e.source.queryId;if(i!==null){let s=t.views.get(i);return D(s!=null,"SyncTree gave us an op for an invalid query."),jO(s,e,n,r)}else{let s=[];for(let o of t.views.values())s=s.concat(jO(o,e,n,r));return s}}function x1(t,e,n,r,i){let s=e._queryIdentifier,o=t.views.get(s);if(!o){let a=Og(n,i?r:null),u=!1;a?u=!0:r instanceof Q?(a=a0(n,r),u=!1):(a=Q.EMPTY_NODE,u=!1);let c=Zg(new wr(a,u,!1),new wr(r,i,!1));return new AD(e,c)}return o}function X9(t,e,n,r,i,s){let o=x1(t,e,r,i,s);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,o),W9(o,n),K9(o,n)}function J9(t,e,n,r){let i=e._queryIdentifier,s=[],o=[],a=Bi(t);if(i==="default")for(let[u,c]of t.views.entries())o=o.concat(LO(c,n,r)),VO(c)&&(t.views.delete(u),c.query._queryParams.loadsAllData()||s.push(c.query));else{let u=t.views.get(i);u&&(o=o.concat(LO(u,n,r)),VO(u)&&(t.views.delete(i),u.query._queryParams.loadsAllData()||s.push(u.query)))}return a&&!Bi(t)&&s.push(new(Y9())(e._repo,e._path)),{removed:s,events:o}}function M1(t){let e=[];for(let n of t.views.values())n.query._queryParams.loadsAllData()||e.push(n);return e}function Li(t,e){let n=null;for(let r of t.views.values())n=n||z9(r,e);return n}function R1(t,e){if(e._queryParams.loadsAllData())return Jg(t);{let r=e._queryIdentifier;return t.views.get(r)}}function N1(t,e){return R1(t,e)!=null}function Bi(t){return Jg(t)!=null}function Jg(t){for(let e of t.views.values())if(e.query._queryParams.loadsAllData())return e;return null}var Ug;function e3(t){D(!Ug,"__referenceConstructor has already been defined"),Ug=t}function t3(){return D(Ug,"Reference.ts has not been loaded"),Ug}var n3=1,Bg=class{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Ft(null),this.pendingWriteTree_=k9(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}};function l0(t,e,n,r,i){return I9(t.pendingWriteTree_,e,n,r,i),i?lu(t,new iu(i0(),e,n)):[]}function r3(t,e,n,r){C9(t.pendingWriteTree_,e,n,r);let i=Ft.fromObject(n);return lu(t,new Yl(i0(),e,i))}function Fi(t,e,n=!1){let r=D9(t.pendingWriteTree_,e);if(T9(t.pendingWriteTree_,e)){let s=new Ft(null);return r.snap!=null?s=s.set(pe(),!0):ft(r.children,o=>{s=s.set(new ge(o),!0)}),lu(t,new vD(r.path,s,n))}else return[]}function od(t,e,n){return lu(t,new iu(s0(),e,n))}function i3(t,e,n){let r=Ft.fromObject(n);return lu(t,new Yl(s0(),e,r))}function s3(t,e){return lu(t,new Pg(s0(),e))}function o3(t,e,n){let r=d0(t,n);if(r){let i=h0(r),s=i.path,o=i.queryId,a=Ot(s,e),u=new Pg(o0(o),a);return f0(t,s,u)}else return[]}function $g(t,e,n,r,i=!1){let s=e._path,o=t.syncPointTree_.get(s),a=[];if(o&&(e._queryIdentifier==="default"||N1(o,e))){let u=J9(o,e,n,r);Z9(o)&&(t.syncPointTree_=t.syncPointTree_.remove(s));let c=u.removed;if(a=u.events,!i){let l=c.findIndex(h=>h._queryParams.loadsAllData())!==-1,d=t.syncPointTree_.findOnPath(s,(h,f)=>Bi(f));if(l&&!d){let h=t.syncPointTree_.subtree(s);if(!h.isEmpty()){let f=c3(h);for(let p=0;p<f.length;++p){let g=f[p],_=g.query,C=F1(t,g);t.listenProvider_.startListening($l(_),Xl(t,_),C.hashFn,C.onComplete)}}}!d&&c.length>0&&!r&&(l?t.listenProvider_.stopListening($l(e),null):c.forEach(h=>{let f=t.queryToTagMap.get(tm(h));t.listenProvider_.stopListening($l(h),f)}))}l3(t,c)}return a}function P1(t,e,n,r){let i=d0(t,r);if(i!=null){let s=h0(i),o=s.path,a=s.queryId,u=Ot(o,e),c=new iu(o0(a),u,n);return f0(t,o,c)}else return[]}function a3(t,e,n,r){let i=d0(t,r);if(i){let s=h0(i),o=s.path,a=s.queryId,u=Ot(o,e),c=Ft.fromObject(n),l=new Yl(o0(a),u,c);return f0(t,o,l)}else return[]}function xD(t,e,n,r=!1){let i=e._path,s=null,o=!1;t.syncPointTree_.foreachOnPath(i,(h,f)=>{let p=Ot(h,i);s=s||Li(f,p),o=o||Bi(f)});let a=t.syncPointTree_.get(i);a?(o=o||Bi(a),s=s||Li(a,pe())):(a=new jg,t.syncPointTree_=t.syncPointTree_.set(i,a));let u;s!=null?u=!0:(u=!1,s=Q.EMPTY_NODE,t.syncPointTree_.subtree(i).foreachChild((f,p)=>{let g=Li(p,pe());g&&(s=s.updateImmediateChild(f,g))}));let c=N1(a,e);if(!c&&!e._queryParams.loadsAllData()){let h=tm(e);D(!t.queryToTagMap.has(h),"View does not exist, but we have a tag");let f=d3();t.queryToTagMap.set(h,f),t.tagToQueryMap.set(f,h)}let l=Xg(t.pendingWriteTree_,i),d=X9(a,e,n,l,s,u);if(!c&&!o&&!r){let h=R1(a,e);d=d.concat(h3(t,e,h))}return d}function em(t,e,n){let i=t.pendingWriteTree_,s=t.syncPointTree_.findOnPath(e,(o,a)=>{let u=Ot(o,e),c=Li(a,u);if(c)return c});return C1(i,e,s,n,!0)}function u3(t,e){let n=e._path,r=null;t.syncPointTree_.foreachOnPath(n,(c,l)=>{let d=Ot(c,n);r=r||Li(l,d)});let i=t.syncPointTree_.get(n);i?r=r||Li(i,pe()):(i=new jg,t.syncPointTree_=t.syncPointTree_.set(n,i));let s=r!=null,o=s?new wr(r,!0,!1):null,a=Xg(t.pendingWriteTree_,e._path),u=x1(i,e,a,s?o.getNode():Q.EMPTY_NODE,s);return G9(u)}function lu(t,e){return k1(e,t.syncPointTree_,null,Xg(t.pendingWriteTree_,pe()))}function k1(t,e,n,r){if(te(t.path))return O1(t,e,n,r);{let i=e.get(pe());n==null&&i!=null&&(n=Li(i,pe()));let s=[],o=ee(t.path),a=t.operationForChild(o),u=e.children.get(o);if(u&&a){let c=n?n.getImmediateChild(o):null,l=D1(r,o);s=s.concat(k1(a,u,c,l))}return i&&(s=s.concat(c0(i,t,r,n))),s}}function O1(t,e,n,r){let i=e.get(pe());n==null&&i!=null&&(n=Li(i,pe()));let s=[];return e.children.inorderTraversal((o,a)=>{let u=n?n.getImmediateChild(o):null,c=D1(r,o),l=t.operationForChild(o);l&&(s=s.concat(O1(l,a,u,c)))}),i&&(s=s.concat(c0(i,t,r,n))),s}function F1(t,e){let n=e.query,r=Xl(t,n);return{hashFn:()=>(q9(e)||Q.EMPTY_NODE).hash(),onComplete:i=>{if(i==="ok")return r?o3(t,n._path,r):s3(t,n._path);{let s=IW(i,n);return $g(t,n,null,s)}}}}function Xl(t,e){let n=tm(e);return t.queryToTagMap.get(n)}function tm(t){return t._path.toString()+"$"+t._queryIdentifier}function d0(t,e){return t.tagToQueryMap.get(e)}function h0(t){let e=t.indexOf("$");return D(e!==-1&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new ge(t.substr(0,e))}}function f0(t,e,n){let r=t.syncPointTree_.get(e);D(r,"Missing sync point for query tag that we're tracking");let i=Xg(t.pendingWriteTree_,e);return c0(r,n,i,null)}function c3(t){return t.fold((e,n,r)=>{if(n&&Bi(n))return[Jg(n)];{let i=[];return n&&(i=M1(n)),ft(r,(s,o)=>{i=i.concat(o)}),i}})}function $l(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new(t3())(t._repo,t._path):t}function l3(t,e){for(let n=0;n<e.length;++n){let r=e[n];if(!r._queryParams.loadsAllData()){let i=tm(r),s=t.queryToTagMap.get(i);t.queryToTagMap.delete(i),t.tagToQueryMap.delete(s)}}}function d3(){return n3++}function h3(t,e,n){let r=e._path,i=Xl(t,e),s=F1(t,n),o=t.listenProvider_.startListening($l(e),i,s.hashFn,s.onComplete),a=t.syncPointTree_.subtree(r);if(i)D(!Bi(a.value),"If we're adding a query, it shouldn't be shadowed");else{let u=a.fold((c,l,d)=>{if(!te(c)&&l&&Bi(l))return[Jg(l).query];{let h=[];return l&&(h=h.concat(M1(l).map(f=>f.query))),ft(d,(f,p)=>{h=h.concat(p)}),h}});for(let c=0;c<u.length;++c){let l=u[c];t.listenProvider_.stopListening($l(l),Xl(t,l))}}return o}var MD=class t{constructor(e){this.node_=e}getImmediateChild(e){let n=this.node_.getImmediateChild(e);return new t(n)}node(){return this.node_}},RD=class t{constructor(e,n){this.syncTree_=e,this.path_=n}getImmediateChild(e){let n=ke(this.path_,e);return new t(this.syncTree_,n)}node(){return em(this.syncTree_,this.path_)}},f3=function(t){return t=t||{},t.timestamp=t.timestamp||new Date().getTime(),t},UO=function(t,e,n){if(!t||typeof t!="object")return t;if(D(".sv"in t,"Unexpected leaf node or priority contents"),typeof t[".sv"]=="string")return p3(t[".sv"],e,n);if(typeof t[".sv"]=="object")return g3(t[".sv"],e);D(!1,"Unexpected server value: "+JSON.stringify(t,null,2))},p3=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:D(!1,"Unexpected server value: "+t)}},g3=function(t,e,n){t.hasOwnProperty("increment")||D(!1,"Unexpected server value: "+JSON.stringify(t,null,2));let r=t.increment;typeof r!="number"&&D(!1,"Unexpected increment value: "+r);let i=e.node();if(D(i!==null&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;let o=i.getValue();return typeof o!="number"?r:o+r},V1=function(t,e,n,r){return g0(e,new RD(n,t),r)},p0=function(t,e,n){return g0(t,new MD(e),n)};function g0(t,e,n){let r=t.getPriority().val(),i=UO(r,e.getImmediateChild(".priority"),n),s;if(t.isLeafNode()){let o=t,a=UO(o.getValue(),e,n);return a!==o.getValue()||i!==o.getPriority().val()?new tu(a,Fe(i)):t}else{let o=t;return s=o,i!==o.getPriority().val()&&(s=s.updatePriority(new tu(i))),o.forEachChild(Se,(a,u)=>{let c=g0(u,e.getImmediateChild(a),n);c!==u&&(s=s.updateImmediateChild(a,c))}),s}}var Jl=class{constructor(e="",n=null,r={children:{},childCount:0}){this.name=e,this.parent=n,this.node=r}};function nm(t,e){let n=e instanceof ge?e:new ge(e),r=t,i=ee(n);for(;i!==null;){let s=zr(r.node.children,i)||{children:{},childCount:0};r=new Jl(i,r,s),n=De(n),i=ee(n)}return r}function ro(t){return t.node.value}function m0(t,e){t.node.value=e,ND(t)}function L1(t){return t.node.childCount>0}function m3(t){return ro(t)===void 0&&!L1(t)}function rm(t,e){ft(t.node.children,(n,r)=>{e(new Jl(n,t,r))})}function j1(t,e,n,r){n&&!r&&e(t),rm(t,i=>{j1(i,e,!0,r)}),n&&r&&e(t)}function y3(t,e,n){let r=n?t:t.parent;for(;r!==null;){if(e(r))return!0;r=r.parent}return!1}function ad(t){return new ge(t.parent===null?t.name:ad(t.parent)+"/"+t.name)}function ND(t){t.parent!==null&&_3(t.parent,t.name,t)}function _3(t,e,n){let r=m3(n),i=on(t.node.children,e);r&&i?(delete t.node.children[e],t.node.childCount--,ND(t)):!r&&!i&&(t.node.children[e]=n.node,t.node.childCount++,ND(t))}var v3=/[\[\].#$\/\u0000-\u001F\u007F]/,w3=/[\[\].#$\u0000-\u001F\u007F]/,HC=10*1024*1024,im=function(t){return typeof t=="string"&&t.length!==0&&!v3.test(t)},U1=function(t){return typeof t=="string"&&t.length!==0&&!w3.test(t)},E3=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),U1(t)},ed=function(t){return t===null||typeof t=="string"||typeof t=="number"&&!Qg(t)||t&&typeof t=="object"&&on(t,".sv")},Er=function(t,e,n,r){r&&e===void 0||ud(Lt(t,"value"),e,n)},ud=function(t,e,n){let r=n instanceof ge?new nD(n,t):n;if(e===void 0)throw new Error(t+"contains undefined "+Zs(r));if(typeof e=="function")throw new Error(t+"contains a function "+Zs(r)+" with contents = "+e.toString());if(Qg(e))throw new Error(t+"contains "+e.toString()+" "+Zs(r));if(typeof e=="string"&&e.length>HC/3&&gu(e)>HC)throw new Error(t+"contains a string greater than "+HC+" utf8 bytes "+Zs(r)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){let i=!1,s=!1;if(ft(e,(o,a)=>{if(o===".value")i=!0;else if(o!==".priority"&&o!==".sv"&&(s=!0,!im(o)))throw new Error(t+" contains an invalid key ("+o+") "+Zs(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);ZW(r,o),ud(t,a,r),XW(r)}),i&&s)throw new Error(t+' contains ".value" child '+Zs(r)+" in addition to actual children.")}},I3=function(t,e){let n,r;for(n=0;n<e.length;n++){r=e[n];let s=ql(r);for(let o=0;o<s.length;o++)if(!(s[o]===".priority"&&o===s.length-1)){if(!im(s[o]))throw new Error(t+"contains an invalid key ("+s[o]+") in path "+r.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(YW);let i=null;for(n=0;n<e.length;n++){if(r=e[n],i!==null&&In(i,r))throw new Error(t+"contains a path "+i.toString()+" that is ancestor of another path "+r.toString());i=r}},B1=function(t,e,n,r){if(r&&e===void 0)return;let i=Lt(t,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(i+" must be an object containing the children to replace.");let s=[];ft(e,(o,a)=>{let u=new ge(o);if(ud(i,a,ke(n,u)),JD(u)===".priority"&&!ed(a))throw new Error(i+"contains an invalid value for '"+u.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");s.push(u)}),I3(i,s)},y0=function(t,e,n){if(!(n&&e===void 0)){if(Qg(e))throw new Error(Lt(t,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!ed(e))throw new Error(Lt(t,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},cd=function(t,e,n,r){if(!(r&&n===void 0)&&!im(n))throw new Error(Lt(t,e)+'was an invalid key = "'+n+`".  Firebase keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]").`)},du=function(t,e,n,r){if(!(r&&n===void 0)&&!U1(n))throw new Error(Lt(t,e)+'was an invalid path = "'+n+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},C3=function(t,e,n,r){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),du(t,e,n,r)},en=function(t,e){if(ee(e)===".info")throw new Error(t+" failed = Can't modify data under /.info/")},$1=function(t,e){let n=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!im(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||n.length!==0&&!E3(n))throw new Error(Lt(t,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)};var PD=class{constructor(){this.eventLists_=[],this.recursionDepth_=0}};function sm(t,e){let n=null;for(let r=0;r<e.length;r++){let i=e[r],s=i.getPath();n!==null&&!e0(s,n.path)&&(t.eventLists_.push(n),n=null),n===null&&(n={events:[],path:s}),n.events.push(i)}n&&t.eventLists_.push(n)}function H1(t,e,n){sm(t,n),q1(t,r=>e0(r,e))}function tn(t,e,n){sm(t,n),q1(t,r=>In(r,e)||In(e,r))}function q1(t,e){t.recursionDepth_++;let n=!0;for(let r=0;r<t.eventLists_.length;r++){let i=t.eventLists_[r];if(i){let s=i.path;e(s)?(D3(t.eventLists_[r]),t.eventLists_[r]=null):n=!1}}n&&(t.eventLists_=[]),t.recursionDepth_--}function D3(t){for(let e=0;e<t.events.length;e++){let n=t.events[e];if(n!==null){t.events[e]=null;let r=n.getEventRunner();Js&&ht("event: "+n.toString()),uu(r)}}}var G1="repo_interrupt",T3=25,kD=class{constructor(e,n,r,i){this.repoInfo_=e,this.forceRestClient_=n,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new PD,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Ng(),this.transactionQueueTree_=new Jl,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}};function b3(t,e,n){if(t.stats_=XD(t.repoInfo_),t.forceRestClient_||bW())t.server_=new fD(t.repoInfo_,(r,i,s,o)=>{BO(t,r,i,s,o)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(()=>$O(t,!0),0);else{if(typeof n<"u"&&n!==null){if(typeof n!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{ze(n)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}t.persistentConnection_=new t0(t.repoInfo_,e,(r,i,s,o)=>{BO(t,r,i,s,o)},r=>{$O(t,r)},r=>{S3(t,r)},t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(r=>{t.server_.refreshAuthToken(r)}),t.appCheckProvider_.addTokenChangeListener(r=>{t.server_.refreshAppCheckToken(r.token)}),t.statsReporter_=AW(t.repoInfo_,()=>new _D(t.stats_,t.server_)),t.infoData_=new pD,t.infoSyncTree_=new Bg({startListening:(r,i,s,o)=>{let a=[],u=t.infoData_.getNode(r._path);return u.isEmpty()||(a=od(t.infoSyncTree_,r._path,u),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),_0(t,"connected",!1),t.serverSyncTree_=new Bg({startListening:(r,i,s,o)=>(t.server_.listen(r,s,i,(a,u)=>{let c=o(a,u);tn(t.eventQueue_,r._path,c)}),[]),stopListening:(r,i)=>{t.server_.unlisten(r,i)}})}function z1(t){let n=t.infoData_.getNode(new ge(".info/serverTimeOffset")).val()||0;return new Date().getTime()+n}function ld(t){return f3({timestamp:z1(t)})}function BO(t,e,n,r,i){t.dataUpdateCount++;let s=new ge(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;let o=[];if(i)if(r){let u=pu(n,c=>Fe(c));o=a3(t.serverSyncTree_,s,u,i)}else{let u=Fe(n);o=P1(t.serverSyncTree_,s,u,i)}else if(r){let u=pu(n,c=>Fe(c));o=i3(t.serverSyncTree_,s,u)}else{let u=Fe(n);o=od(t.serverSyncTree_,s,u)}let a=s;o.length>0&&(a=ou(t,s)),tn(t.eventQueue_,a,o)}function $O(t,e){_0(t,"connected",e),e===!1&&M3(t)}function S3(t,e){ft(e,(n,r)=>{_0(t,n,r)})}function _0(t,e,n){let r=new ge("/.info/"+e),i=Fe(n);t.infoData_.updateSnapshot(r,i);let s=od(t.infoSyncTree_,r,i);tn(t.eventQueue_,r,s)}function om(t){return t.nextWriteId_++}function A3(t,e,n){let r=u3(t.serverSyncTree_,e);return r!=null?Promise.resolve(r):t.server_.get(e).then(i=>{let s=Fe(i).withIndex(e._queryParams.getIndex());xD(t.serverSyncTree_,e,n,!0);let o;if(e._queryParams.loadsAllData())o=od(t.serverSyncTree_,e._path,s);else{let a=Xl(t.serverSyncTree_,e);o=P1(t.serverSyncTree_,e._path,s,a)}return tn(t.eventQueue_,e._path,o),$g(t.serverSyncTree_,e,n,null,!0),s},i=>(hu(t,"get for query "+ze(e)+" failed: "+i),Promise.reject(new Error(i))))}function v0(t,e,n,r,i){hu(t,"set",{path:e.toString(),value:n,priority:r});let s=ld(t),o=Fe(n,r),a=em(t.serverSyncTree_,e),u=p0(o,a,s),c=om(t),l=l0(t.serverSyncTree_,e,u,c,!0);sm(t.eventQueue_,l),t.server_.put(e.toString(),o.val(!0),(h,f)=>{let p=h==="ok";p||At("set at "+e+" failed: "+h);let g=Fi(t.serverSyncTree_,c,!p);tn(t.eventQueue_,e,g),$i(t,i,h,f)});let d=E0(t,e);ou(t,d),tn(t.eventQueue_,d,[])}function x3(t,e,n,r){hu(t,"update",{path:e.toString(),value:n});let i=!0,s=ld(t),o={};if(ft(n,(a,u)=>{i=!1,o[a]=V1(ke(e,a),Fe(u),t.serverSyncTree_,s)}),i)ht("update() called with empty data.  Don't do anything."),$i(t,r,"ok",void 0);else{let a=om(t),u=r3(t.serverSyncTree_,e,o,a);sm(t.eventQueue_,u),t.server_.merge(e.toString(),n,(c,l)=>{let d=c==="ok";d||At("update at "+e+" failed: "+c);let h=Fi(t.serverSyncTree_,a,!d),f=h.length>0?ou(t,e):e;tn(t.eventQueue_,f,h),$i(t,r,c,l)}),ft(n,c=>{let l=E0(t,ke(e,c));ou(t,l)}),tn(t.eventQueue_,e,[])}}function M3(t){hu(t,"onDisconnectEvents");let e=ld(t),n=Ng();mD(t.onDisconnect_,pe(),(i,s)=>{let o=V1(i,s,t.serverSyncTree_,e);cu(n,i,o)});let r=[];mD(n,pe(),(i,s)=>{r=r.concat(od(t.serverSyncTree_,i,s));let o=E0(t,i);ou(t,o)}),t.onDisconnect_=Ng(),tn(t.eventQueue_,pe(),r)}function R3(t,e,n){t.server_.onDisconnectCancel(e.toString(),(r,i)=>{r==="ok"&&gD(t.onDisconnect_,e),$i(t,n,r,i)})}function HO(t,e,n,r){let i=Fe(n);t.server_.onDisconnectPut(e.toString(),i.val(!0),(s,o)=>{s==="ok"&&cu(t.onDisconnect_,e,i),$i(t,r,s,o)})}function N3(t,e,n,r,i){let s=Fe(n,r);t.server_.onDisconnectPut(e.toString(),s.val(!0),(o,a)=>{o==="ok"&&cu(t.onDisconnect_,e,s),$i(t,i,o,a)})}function P3(t,e,n,r){if(_d(n)){ht("onDisconnect().update() called with empty data.  Don't do anything."),$i(t,r,"ok",void 0);return}t.server_.onDisconnectMerge(e.toString(),n,(i,s)=>{i==="ok"&&ft(n,(o,a)=>{let u=Fe(a);cu(t.onDisconnect_,ke(e,o),u)}),$i(t,r,i,s)})}function k3(t,e,n){let r;ee(e._path)===".info"?r=xD(t.infoSyncTree_,e,n):r=xD(t.serverSyncTree_,e,n),H1(t.eventQueue_,e._path,r)}function OD(t,e,n){let r;ee(e._path)===".info"?r=$g(t.infoSyncTree_,e,n):r=$g(t.serverSyncTree_,e,n),H1(t.eventQueue_,e._path,r)}function W1(t){t.persistentConnection_&&t.persistentConnection_.interrupt(G1)}function O3(t){t.persistentConnection_&&t.persistentConnection_.resume(G1)}function hu(t,...e){let n="";t.persistentConnection_&&(n=t.persistentConnection_.id+":"),ht(n,...e)}function $i(t,e,n,r){e&&uu(()=>{if(n==="ok")e(null);else{let i=(n||"error").toUpperCase(),s=i;r&&(s+=": "+r);let o=new Error(s);o.code=i,e(o)}})}function F3(t,e,n,r,i,s){hu(t,"transaction on "+e);let o={path:e,update:n,onComplete:r,status:null,order:zO(),applyLocally:s,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},a=w0(t,e,void 0);o.currentInputSnapshot=a;let u=o.update(a.val());if(u===void 0)o.unwatcher(),o.currentOutputSnapshotRaw=null,o.currentOutputSnapshotResolved=null,o.onComplete&&o.onComplete(null,!1,o.currentInputSnapshot);else{ud("transaction failed: Data returned ",u,o.path),o.status=0;let c=nm(t.transactionQueueTree_,e),l=ro(c)||[];l.push(o),m0(c,l);let d;typeof u=="object"&&u!==null&&on(u,".priority")?(d=zr(u,".priority"),D(ed(d),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):d=(em(t.serverSyncTree_,e)||Q.EMPTY_NODE).getPriority().val();let h=ld(t),f=Fe(u,d),p=p0(f,a,h);o.currentOutputSnapshotRaw=f,o.currentOutputSnapshotResolved=p,o.currentWriteId=om(t);let g=l0(t.serverSyncTree_,e,p,o.currentWriteId,o.applyLocally);tn(t.eventQueue_,e,g),am(t,t.transactionQueueTree_)}}function w0(t,e,n){return em(t.serverSyncTree_,e,n)||Q.EMPTY_NODE}function am(t,e=t.transactionQueueTree_){if(e||um(t,e),ro(e)){let n=Q1(t,e);D(n.length>0,"Sending zero length transaction queue"),n.every(i=>i.status===0)&&V3(t,ad(e),n)}else L1(e)&&rm(e,n=>{am(t,n)})}function V3(t,e,n){let r=n.map(c=>c.currentWriteId),i=w0(t,e,r),s=i,o=i.hash();for(let c=0;c<n.length;c++){let l=n[c];D(l.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),l.status=1,l.retryCount++;let d=Ot(e,l.path);s=s.updateChild(d,l.currentOutputSnapshotRaw)}let a=s.val(!0),u=e;t.server_.put(u.toString(),a,c=>{hu(t,"transaction put response",{path:u.toString(),status:c});let l=[];if(c==="ok"){let d=[];for(let h=0;h<n.length;h++)n[h].status=2,l=l.concat(Fi(t.serverSyncTree_,n[h].currentWriteId)),n[h].onComplete&&d.push(()=>n[h].onComplete(null,!0,n[h].currentOutputSnapshotResolved)),n[h].unwatcher();um(t,nm(t.transactionQueueTree_,e)),am(t,t.transactionQueueTree_),tn(t.eventQueue_,e,l);for(let h=0;h<d.length;h++)uu(d[h])}else{if(c==="datastale")for(let d=0;d<n.length;d++)n[d].status===3?n[d].status=4:n[d].status=0;else{At("transaction at "+u.toString()+" failed: "+c);for(let d=0;d<n.length;d++)n[d].status=4,n[d].abortReason=c}ou(t,e)}},o)}function ou(t,e){let n=K1(t,e),r=ad(n),i=Q1(t,n);return L3(t,i,r),r}function L3(t,e,n){if(e.length===0)return;let r=[],i=[],o=e.filter(a=>a.status===0).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){let u=e[a],c=Ot(n,u.path),l=!1,d;if(D(c!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),u.status===4)l=!0,d=u.abortReason,i=i.concat(Fi(t.serverSyncTree_,u.currentWriteId,!0));else if(u.status===0)if(u.retryCount>=T3)l=!0,d="maxretry",i=i.concat(Fi(t.serverSyncTree_,u.currentWriteId,!0));else{let h=w0(t,u.path,o);u.currentInputSnapshot=h;let f=e[a].update(h.val());if(f!==void 0){ud("transaction failed: Data returned ",f,u.path);let p=Fe(f);typeof f=="object"&&f!=null&&on(f,".priority")||(p=p.updatePriority(h.getPriority()));let _=u.currentWriteId,C=ld(t),M=p0(p,h,C);u.currentOutputSnapshotRaw=p,u.currentOutputSnapshotResolved=M,u.currentWriteId=om(t),o.splice(o.indexOf(_),1),i=i.concat(l0(t.serverSyncTree_,u.path,M,u.currentWriteId,u.applyLocally)),i=i.concat(Fi(t.serverSyncTree_,_,!0))}else l=!0,d="nodata",i=i.concat(Fi(t.serverSyncTree_,u.currentWriteId,!0))}tn(t.eventQueue_,n,i),i=[],l&&(e[a].status=2,function(h){setTimeout(h,Math.floor(0))}(e[a].unwatcher),e[a].onComplete&&(d==="nodata"?r.push(()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot)):r.push(()=>e[a].onComplete(new Error(d),!1,null))))}um(t,t.transactionQueueTree_);for(let a=0;a<r.length;a++)uu(r[a]);am(t,t.transactionQueueTree_)}function K1(t,e){let n,r=t.transactionQueueTree_;for(n=ee(e);n!==null&&ro(r)===void 0;)r=nm(r,n),e=De(e),n=ee(e);return r}function Q1(t,e){let n=[];return Y1(t,e,n),n.sort((r,i)=>r.order-i.order),n}function Y1(t,e,n){let r=ro(e);if(r)for(let i=0;i<r.length;i++)n.push(r[i]);rm(e,i=>{Y1(t,i,n)})}function um(t,e){let n=ro(e);if(n){let r=0;for(let i=0;i<n.length;i++)n[i].status!==2&&(n[r]=n[i],r++);n.length=r,m0(e,n.length>0?n:void 0)}rm(e,r=>{um(t,r)})}function E0(t,e){let n=ad(K1(t,e)),r=nm(t.transactionQueueTree_,e);return y3(r,i=>{qC(t,i)}),qC(t,r),j1(r,i=>{qC(t,i)}),n}function qC(t,e){let n=ro(e);if(n){let r=[],i=[],s=-1;for(let o=0;o<n.length;o++)n[o].status===3||(n[o].status===1?(D(s===o-1,"All SENT items should be at beginning of queue."),s=o,n[o].status=3,n[o].abortReason="set"):(D(n[o].status===0,"Unexpected transaction status in abort"),n[o].unwatcher(),i=i.concat(Fi(t.serverSyncTree_,n[o].currentWriteId,!0)),n[o].onComplete&&r.push(n[o].onComplete.bind(null,new Error("set"),!1,null))));s===-1?m0(e,void 0):n.length=s+1,tn(t.eventQueue_,ad(e),i);for(let o=0;o<r.length;o++)uu(r[o])}}function j3(t){let e="",n=t.split("/");for(let r=0;r<n.length;r++)if(n[r].length>0){let i=n[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}function U3(t){let e={};t.charAt(0)==="?"&&(t=t.substring(1));for(let n of t.split("&")){if(n.length===0)continue;let r=n.split("=");r.length===2?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):At(`Invalid query segment '${n}' in query '${t}'`)}return e}var FD=function(t,e){let n=B3(t),r=n.namespace;n.domain==="firebase.com"&&vr(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&n.domain!=="localhost"&&vr("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||yW();let i=n.scheme==="ws"||n.scheme==="wss";return{repoInfo:new Dg(n.host,n.secure,r,i,e,"",r!==n.subdomain),path:new ge(n.pathString)}},B3=function(t){let e="",n="",r="",i="",s="",o=!0,a="https",u=443;if(typeof t=="string"){let c=t.indexOf("//");c>=0&&(a=t.substring(0,c-1),t=t.substring(c+2));let l=t.indexOf("/");l===-1&&(l=t.length);let d=t.indexOf("?");d===-1&&(d=t.length),e=t.substring(0,Math.min(l,d)),l<d&&(i=j3(t.substring(l,d)));let h=U3(t.substring(Math.min(t.length,d)));c=e.indexOf(":"),c>=0?(o=a==="https"||a==="wss",u=parseInt(e.substring(c+1),10)):c=e.length;let f=e.slice(0,c);if(f.toLowerCase()==="localhost")n="localhost";else if(f.split(".").length<=2)n=f;else{let p=e.indexOf(".");r=e.substring(0,p).toLowerCase(),n=e.substring(p+1),s=r}"ns"in h&&(s=h.ns)}return{host:e,port:u,domain:n,subdomain:r,secure:o,scheme:a,pathString:i,namespace:s}};var qO="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",$3=function(){let t=0,e=[];return function(n){let r=n===t;t=n;let i,s=new Array(8);for(i=7;i>=0;i--)s[i]=qO.charAt(n%64),n=Math.floor(n/64);D(n===0,"Cannot push at time == 0");let o=s.join("");if(r){for(i=11;i>=0&&e[i]===63;i--)e[i]=0;e[i]++}else for(i=0;i<12;i++)e[i]=Math.floor(Math.random()*64);for(i=0;i<12;i++)o+=qO.charAt(e[i]);return D(o.length===20,"nextPushId: Length should be 20."),o}}();var Hg=class{constructor(e,n,r,i){this.eventType=e,this.eventRegistration=n,this.snapshot=r,this.prevName=i}getPath(){let e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+ze(this.snapshot.exportVal())}},qg=class{constructor(e,n,r){this.eventRegistration=e,this.error=n,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}};var td=class{constructor(e,n){this.snapshotCallback=e,this.cancelCallback=n}onValue(e,n){this.snapshotCallback.call(null,e,n)}onCancel(e){return D(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}};var Gg=class{constructor(e,n){this._repo=e,this._path=n}cancel(){let e=new ot;return R3(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){en("OnDisconnect.remove",this._path);let e=new ot;return HO(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){en("OnDisconnect.set",this._path),Er("OnDisconnect.set",e,this._path,!1);let n=new ot;return HO(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}setWithPriority(e,n){en("OnDisconnect.setWithPriority",this._path),Er("OnDisconnect.setWithPriority",e,this._path,!1),y0("OnDisconnect.setWithPriority",n,!1);let r=new ot;return N3(this._repo,this._path,e,n,r.wrapCallback(()=>{})),r.promise}update(e){en("OnDisconnect.update",this._path),B1("OnDisconnect.update",e,this._path,!1);let n=new ot;return P3(this._repo,this._path,e,n.wrapCallback(()=>{})),n.promise}};var Vt=class t{constructor(e,n,r,i){this._repo=e,this._path=n,this._queryParams=r,this._orderByCalled=i}get key(){return te(this._path)?null:JD(this._path)}get ref(){return new nn(this._repo,this._path)}get _queryIdentifier(){let e=MO(this._queryParams),n=ZD(e);return n==="{}"?"default":n}get _queryObject(){return MO(this._queryParams)}isEqual(e){if(e=ie(e),!(e instanceof t))return!1;let n=this._repo===e._repo,r=e0(this._path,e._path),i=this._queryIdentifier===e._queryIdentifier;return n&&r&&i}toJSON(){return this.toString()}toString(){return this._repo.toString()+QW(this._path)}};function cm(t,e){if(t._orderByCalled===!0)throw new Error(e+": You can't combine multiple orderBy calls.")}function qi(t){let e=null,n=null;if(t.hasStart()&&(e=t.getIndexStartValue()),t.hasEnd()&&(n=t.getIndexEndValue()),t.getIndex()===_r){let r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(t.hasStart()){if(t.getIndexStartName()!==ji)throw new Error(r);if(typeof e!="string")throw new Error(i)}if(t.hasEnd()){if(t.getIndexEndName()!==qr)throw new Error(r);if(typeof n!="string")throw new Error(i)}}else if(t.getIndex()===Se){if(e!=null&&!ed(e)||n!=null&&!ed(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(D(t.getIndex()instanceof Gl||t.getIndex()===r0,"unknown index type."),e!=null&&typeof e=="object"||n!=null&&typeof n=="object")throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function lm(t){if(t.hasStart()&&t.hasEnd()&&t.hasLimit()&&!t.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}var nn=class t extends Vt{constructor(e,n){super(e,n,new Ql,!1)}get parent(){let e=f1(this._path);return e===null?null:new t(this._repo,e)}get root(){let e=this;for(;e.parent!==null;)e=e.parent;return e}},au=class t{constructor(e,n,r){this._node=e,this.ref=n,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){let n=new ge(e),r=Hi(this.ref,e);return new t(this._node.getChild(n),r,Se)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return this._node.isLeafNode()?!1:!!this._node.forEachChild(this._index,(r,i)=>e(new t(i,Hi(this.ref,r),Se)))}hasChild(e){let n=new ge(e);return!this._node.getChild(n).isEmpty()}hasChildren(){return this._node.isLeafNode()?!1:!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}};function I0(t,e){return t=ie(t),t._checkNotDeleted("ref"),e!==void 0?Hi(t._root,e):t._root}function C0(t,e){t=ie(t),t._checkNotDeleted("refFromURL");let n=FD(e,t._repo.repoInfo_.nodeAdmin);$1("refFromURL",n);let r=n.repoInfo;return!t._repo.repoInfo_.isCustomHost()&&r.host!==t._repo.repoInfo_.host&&vr("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+t._repo.repoInfo_.host+")"),I0(t,n.path.toString())}function Hi(t,e){return t=ie(t),ee(t._path)===null?C3("child","path",e,!1):du("child","path",e,!1),new nn(t._repo,ke(t._path,e))}function Z1(t,e){t=ie(t),en("push",t._path),Er("push",e,t._path,!0);let n=z1(t._repo),r=$3(n),i=Hi(t,r),s=Hi(t,r),o;return e!=null?o=dm(s,e).then(()=>s):o=Promise.resolve(s),i.then=o.then.bind(o),i.catch=o.then.bind(o,void 0),i}function X1(t){return en("remove",t._path),dm(t,null)}function dm(t,e){t=ie(t),en("set",t._path),Er("set",e,t._path,!1);let n=new ot;return v0(t._repo,t._path,e,null,n.wrapCallback(()=>{})),n.promise}function J1(t,e){t=ie(t),en("setPriority",t._path),y0("setPriority",e,!1);let n=new ot;return v0(t._repo,ke(t._path,".priority"),e,null,n.wrapCallback(()=>{})),n.promise}function eF(t,e,n){if(en("setWithPriority",t._path),Er("setWithPriority",e,t._path,!1),y0("setWithPriority",n,!1),t.key===".length"||t.key===".keys")throw"setWithPriority failed: "+t.key+" is a read-only object.";let r=new ot;return v0(t._repo,t._path,e,n,r.wrapCallback(()=>{})),r.promise}function tF(t,e){B1("update",e,t._path,!1);let n=new ot;return x3(t._repo,t._path,e,n.wrapCallback(()=>{})),n.promise}function nF(t){t=ie(t);let e=new td(()=>{}),n=new nd(e);return A3(t._repo,t,n).then(r=>new au(r,new nn(t._repo,t._path),t._queryParams.getIndex()))}var nd=class t{constructor(e){this.callbackContext=e}respondsTo(e){return e==="value"}createEvent(e,n){let r=n._queryParams.getIndex();return new Hg("value",this,new au(e.snapshotNode,new nn(n._repo,n._path),r))}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new qg(this,e,n):null}matches(e){return e instanceof t?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1}hasAnyCallback(){return this.callbackContext!==null}},zg=class t{constructor(e,n){this.eventType=e,this.callbackContext=n}respondsTo(e){let n=e==="children_added"?"child_added":e;return n=n==="children_removed"?"child_removed":n,this.eventType===n}createCancelEvent(e,n){return this.callbackContext.hasCancelCallback?new qg(this,e,n):null}createEvent(e,n){D(e.childName!=null,"Child events should have a childName.");let r=Hi(new nn(n._repo,n._path),e.childName),i=n._queryParams.getIndex();return new Hg(e.type,this,new au(e.snapshotNode,r,i),e.prevName)}getEventRunner(e){return e.getEventType()==="cancel"?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof t?this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)):!1}hasAnyCallback(){return!!this.callbackContext}};function dd(t,e,n,r,i){let s;if(typeof r=="object"&&(s=void 0,i=r),typeof r=="function"&&(s=r),i&&i.onlyOnce){let u=n,c=(l,d)=>{OD(t._repo,t,a),u(l,d)};c.userCallback=n.userCallback,c.context=n.context,n=c}let o=new td(n,s||void 0),a=e==="value"?new nd(o):new zg(e,o);return k3(t._repo,t,a),()=>OD(t._repo,t,a)}function hm(t,e,n,r){return dd(t,"value",e,n,r)}function D0(t,e,n,r){return dd(t,"child_added",e,n,r)}function T0(t,e,n,r){return dd(t,"child_changed",e,n,r)}function b0(t,e,n,r){return dd(t,"child_moved",e,n,r)}function S0(t,e,n,r){return dd(t,"child_removed",e,n,r)}function A0(t,e,n){let r=null,i=n?new td(n):null;e==="value"?r=new nd(i):e&&(r=new zg(e,i)),OD(t._repo,t,r)}var rn=class{},Wg=class extends rn{constructor(e,n){super(),this._value=e,this._key=n,this.type="endAt"}_apply(e){Er("endAt",this._value,e._path,!0);let n=hD(e._queryParams,this._value,this._key);if(lm(n),qi(n),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Vt(e._repo,e._path,n,e._orderByCalled)}};function rF(t,e){return cd("endAt","key",e,!0),new Wg(t,e)}var VD=class extends rn{constructor(e,n){super(),this._value=e,this._key=n,this.type="endBefore"}_apply(e){Er("endBefore",this._value,e._path,!1);let n=p9(e._queryParams,this._value,this._key);if(lm(n),qi(n),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new Vt(e._repo,e._path,n,e._orderByCalled)}};function iF(t,e){return cd("endBefore","key",e,!0),new VD(t,e)}var Kg=class extends rn{constructor(e,n){super(),this._value=e,this._key=n,this.type="startAt"}_apply(e){Er("startAt",this._value,e._path,!0);let n=dD(e._queryParams,this._value,this._key);if(lm(n),qi(n),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new Vt(e._repo,e._path,n,e._orderByCalled)}};function sF(t=null,e){return cd("startAt","key",e,!0),new Kg(t,e)}var LD=class extends rn{constructor(e,n){super(),this._value=e,this._key=n,this.type="startAfter"}_apply(e){Er("startAfter",this._value,e._path,!1);let n=f9(e._queryParams,this._value,this._key);if(lm(n),qi(n),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new Vt(e._repo,e._path,n,e._orderByCalled)}};function oF(t,e){return cd("startAfter","key",e,!0),new LD(t,e)}var jD=class extends rn{constructor(e){super(),this._limit=e,this.type="limitToFirst"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new Vt(e._repo,e._path,d9(e._queryParams,this._limit),e._orderByCalled)}};function aF(t){if(typeof t!="number"||Math.floor(t)!==t||t<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new jD(t)}var UD=class extends rn{constructor(e){super(),this._limit=e,this.type="limitToLast"}_apply(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new Vt(e._repo,e._path,h9(e._queryParams,this._limit),e._orderByCalled)}};function uF(t){if(typeof t!="number"||Math.floor(t)!==t||t<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new UD(t)}var BD=class extends rn{constructor(e){super(),this._path=e,this.type="orderByChild"}_apply(e){cm(e,"orderByChild");let n=new ge(this._path);if(te(n))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");let r=new Gl(n),i=Yg(e._queryParams,r);return qi(i),new Vt(e._repo,e._path,i,!0)}};function cF(t){if(t==="$key")throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if(t==="$priority")throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if(t==="$value")throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return du("orderByChild","path",t,!1),new BD(t)}var $D=class extends rn{constructor(){super(...arguments),this.type="orderByKey"}_apply(e){cm(e,"orderByKey");let n=Yg(e._queryParams,_r);return qi(n),new Vt(e._repo,e._path,n,!0)}};function lF(){return new $D}var HD=class extends rn{constructor(){super(...arguments),this.type="orderByPriority"}_apply(e){cm(e,"orderByPriority");let n=Yg(e._queryParams,Se);return qi(n),new Vt(e._repo,e._path,n,!0)}};function dF(){return new HD}var qD=class extends rn{constructor(){super(...arguments),this.type="orderByValue"}_apply(e){cm(e,"orderByValue");let n=Yg(e._queryParams,r0);return qi(n),new Vt(e._repo,e._path,n,!0)}};function hF(){return new qD}var GD=class extends rn{constructor(e,n){super(),this._value=e,this._key=n,this.type="equalTo"}_apply(e){if(Er("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new Wg(this._value,this._key)._apply(new Kg(this._value,this._key)._apply(e))}};function fF(t,e){return cd("equalTo","key",e,!0),new GD(t,e)}function Dn(t,...e){let n=ie(t);for(let r of e)n=r._apply(n);return n}Q9(nn);e3(nn);var H3="FIREBASE_DATABASE_EMULATOR_HOST",zD={},q3=!1;function G3(t,e,n,r){t.repoInfo_=new Dg(`${e}:${n}`,!1,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams,!0),r&&(t.authTokenProvider_=r)}function x0(t,e,n,r,i){let s=r||t.options.databaseURL;s===void 0&&(t.options.projectId||vr("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),ht("Using default host for project ",t.options.projectId),s=`${t.options.projectId}-default-rtdb.firebaseio.com`);let o=FD(s,i),a=o.repoInfo,u,c;typeof process<"u"&&process.env&&(c=process.env[H3]),c?(u=!0,s=`http://${c}?ns=${a.namespace}`,o=FD(s,i),a=o.repoInfo):u=!o.repoInfo.secure;let l=i&&u?new jl(jl.OWNER):new YC(t.name,t.options,e);$1("Invalid Firebase Database URL",o),te(o.path)||vr("Database URL must point to the root of a Firebase Database (not including a child path).");let d=W3(a,t,l,new QC(t.name,n));return new WD(d,t)}function z3(t,e){let n=zD[e];(!n||n[t.key]!==t)&&vr(`Database ${e}(${t.repoInfo_}) has already been deleted.`),W1(t),delete n[t.key]}function W3(t,e,n,r){let i=zD[e.name];i||(i={},zD[e.name]=i);let s=i[t.toURLString()];return s&&vr("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new kD(t,q3,n,r),i[t.toURLString()]=s,s}var WD=class{constructor(e,n){this._repoInternal=e,this.app=n,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(b3(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new nn(this._repo,pe())),this._rootInternal}_delete(){return this._rootInternal!==null&&(z3(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){this._rootInternal===null&&vr("Cannot call "+e+" on a deleted database.")}};function pF(){h1.IS_TRANSPORT_INITIALIZED&&At("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function gF(){pF(),Hl.forceDisallow()}function mF(){pF(),Za.forceDisallow(),Hl.forceAllow()}function yF(t,e,n,r={}){t=ie(t),t._checkNotDeleted("useEmulator"),t._instanceStarted&&vr("Cannot call useEmulator() after instance has already been initialized.");let i=t._repoInternal,s;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&vr('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new jl(jl.OWNER);else if(r.mockUserToken){let o=typeof r.mockUserToken=="string"?r.mockUserToken:gd(r.mockUserToken,t.app.options.projectId);s=new jl(o)}G3(i,e,n,s)}function _F(t){t=ie(t),t._checkNotDeleted("goOffline"),W1(t._repo)}function vF(t){t=ie(t),t._checkNotDeleted("goOnline"),O3(t._repo)}function wF(t,e){KO(t,e)}function K3(t){YD(wd),Gi(new zt("database",(e,{instanceIdentifier:n})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return x0(r,i,s,n)},"PUBLIC").setMultipleInstances(!0)),Tn(fO,pO,t),Tn(fO,pO,"esm2017")}var Q3={".sv":"timestamp"};function EF(){return Q3}function IF(t){return{".sv":{increment:t}}}var KD=class{constructor(e,n){this.committed=e,this.snapshot=n}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}};function CF(t,e,n){var r;if(t=ie(t),en("Reference.transaction",t._path),t.key===".length"||t.key===".keys")throw"Reference.transaction failed: "+t.key+" is a read-only object.";let i=(r=n?.applyLocally)!==null&&r!==void 0?r:!0,s=new ot,o=(u,c,l)=>{let d=null;u?s.reject(u):(d=new au(l,new nn(t._repo,t._path),Se),s.resolve(new KD(c,d)))},a=hm(t,()=>{});return F3(t._repo,t._path,e,o,a,i),s.promise}t0.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)};t0.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};K3();var Y3="@firebase/database-compat",Z3="1.0.3";var X3=new Wr("@firebase/database-compat"),DF=function(t){let e="FIREBASE WARNING: "+t;X3.warn(e)};var J3=function(t,e,n,r){if(!(r&&n===void 0)&&typeof n!="boolean")throw new Error(Lt(t,e)+"must be a boolean.")},e6=function(t,e,n){if(!(n&&e===void 0))switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(Lt(t,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}};var M0=class{constructor(e){this._delegate=e}cancel(e){B("OnDisconnect.cancel",0,1,arguments.length),nt("OnDisconnect.cancel","onComplete",e,!0);let n=this._delegate.cancel();return e&&n.then(()=>e(null),r=>e(r)),n}remove(e){B("OnDisconnect.remove",0,1,arguments.length),nt("OnDisconnect.remove","onComplete",e,!0);let n=this._delegate.remove();return e&&n.then(()=>e(null),r=>e(r)),n}set(e,n){B("OnDisconnect.set",1,2,arguments.length),nt("OnDisconnect.set","onComplete",n,!0);let r=this._delegate.set(e);return n&&r.then(()=>n(null),i=>n(i)),r}setWithPriority(e,n,r){B("OnDisconnect.setWithPriority",2,3,arguments.length),nt("OnDisconnect.setWithPriority","onComplete",r,!0);let i=this._delegate.setWithPriority(e,n);return r&&i.then(()=>r(null),s=>r(s)),i}update(e,n){if(B("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){let i={};for(let s=0;s<e.length;++s)i[""+s]=e[s];e=i,DF("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}nt("OnDisconnect.update","onComplete",n,!0);let r=this._delegate.update(e);return n&&r.then(()=>n(null),i=>n(i)),r}};var R0=class{constructor(e,n){this.committed=e,this.snapshot=n}toJSON(){return B("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}};var io=class t{constructor(e,n){this._database=e,this._delegate=n}val(){return B("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return B("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return B("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return B("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(e){return B("DataSnapshot.child",0,1,arguments.length),e=String(e),du("DataSnapshot.child","path",e,!1),new t(this._database,this._delegate.child(e))}hasChild(e){return B("DataSnapshot.hasChild",1,1,arguments.length),du("DataSnapshot.hasChild","path",e,!1),this._delegate.hasChild(e)}getPriority(){return B("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(e){return B("DataSnapshot.forEach",1,1,arguments.length),nt("DataSnapshot.forEach","action",e,!1),this._delegate.forEach(n=>e(new t(this._database,n)))}hasChildren(){return B("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return B("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return B("DataSnapshot.ref",0,0,arguments.length),new Gr(this._database,this._delegate.ref)}get ref(){return this.getRef()}},fm=class t{constructor(e,n){this.database=e,this._delegate=n}on(e,n,r,i){var s;B("Query.on",2,4,arguments.length),nt("Query.on","callback",n,!1);let o=t.getCancelAndContextArgs_("Query.on",r,i),a=(c,l)=>{n.call(o.context,new io(this.database,c),l)};a.userCallback=n,a.context=o.context;let u=(s=o.cancel)===null||s===void 0?void 0:s.bind(o.context);switch(e){case"value":return hm(this._delegate,a,u),n;case"child_added":return D0(this._delegate,a,u),n;case"child_removed":return S0(this._delegate,a,u),n;case"child_changed":return T0(this._delegate,a,u),n;case"child_moved":return b0(this._delegate,a,u),n;default:throw new Error(Lt("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,n,r){if(B("Query.off",0,3,arguments.length),e6("Query.off",e,!0),nt("Query.off","callback",n,!0),vm("Query.off","context",r,!0),n){let i=()=>{};i.userCallback=n,i.context=r,A0(this._delegate,e,i)}else A0(this._delegate,e)}get(){return nF(this._delegate).then(e=>new io(this.database,e))}once(e,n,r,i){B("Query.once",1,4,arguments.length),nt("Query.once","callback",n,!0);let s=t.getCancelAndContextArgs_("Query.once",r,i),o=new ot,a=(c,l)=>{let d=new io(this.database,c);n&&n.call(s.context,d,l),o.resolve(d)};a.userCallback=n,a.context=s.context;let u=c=>{s.cancel&&s.cancel.call(s.context,c),o.reject(c)};switch(e){case"value":hm(this._delegate,a,u,{onlyOnce:!0});break;case"child_added":D0(this._delegate,a,u,{onlyOnce:!0});break;case"child_removed":S0(this._delegate,a,u,{onlyOnce:!0});break;case"child_changed":T0(this._delegate,a,u,{onlyOnce:!0});break;case"child_moved":b0(this._delegate,a,u,{onlyOnce:!0});break;default:throw new Error(Lt("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return o.promise}limitToFirst(e){return B("Query.limitToFirst",1,1,arguments.length),new t(this.database,Dn(this._delegate,aF(e)))}limitToLast(e){return B("Query.limitToLast",1,1,arguments.length),new t(this.database,Dn(this._delegate,uF(e)))}orderByChild(e){return B("Query.orderByChild",1,1,arguments.length),new t(this.database,Dn(this._delegate,cF(e)))}orderByKey(){return B("Query.orderByKey",0,0,arguments.length),new t(this.database,Dn(this._delegate,lF()))}orderByPriority(){return B("Query.orderByPriority",0,0,arguments.length),new t(this.database,Dn(this._delegate,dF()))}orderByValue(){return B("Query.orderByValue",0,0,arguments.length),new t(this.database,Dn(this._delegate,hF()))}startAt(e=null,n){return B("Query.startAt",0,2,arguments.length),new t(this.database,Dn(this._delegate,sF(e,n)))}startAfter(e=null,n){return B("Query.startAfter",0,2,arguments.length),new t(this.database,Dn(this._delegate,oF(e,n)))}endAt(e=null,n){return B("Query.endAt",0,2,arguments.length),new t(this.database,Dn(this._delegate,rF(e,n)))}endBefore(e=null,n){return B("Query.endBefore",0,2,arguments.length),new t(this.database,Dn(this._delegate,iF(e,n)))}equalTo(e,n){return B("Query.equalTo",1,2,arguments.length),new t(this.database,Dn(this._delegate,fF(e,n)))}toString(){return B("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return B("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if(B("Query.isEqual",1,1,arguments.length),!(e instanceof t)){let n="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(n)}return this._delegate.isEqual(e._delegate)}static getCancelAndContextArgs_(e,n,r){let i={cancel:void 0,context:void 0};if(n&&r)i.cancel=n,nt(e,"cancel",i.cancel,!0),i.context=r,vm(e,"context",i.context,!0);else if(n)if(typeof n=="object"&&n!==null)i.context=n;else if(typeof n=="function")i.cancel=n;else throw new Error(Lt(e,"cancelOrContext")+" must either be a cancel callback or a context object.");return i}get ref(){return new Gr(this.database,new nn(this._delegate._repo,this._delegate._path))}},Gr=class t extends fm{constructor(e,n){super(e,new Vt(n._repo,n._path,new Ql,!1)),this.database=e,this._delegate=n}getKey(){return B("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return B("Reference.child",1,1,arguments.length),typeof e=="number"&&(e=String(e)),new t(this.database,Hi(this._delegate,e))}getParent(){B("Reference.parent",0,0,arguments.length);let e=this._delegate.parent;return e?new t(this.database,e):null}getRoot(){return B("Reference.root",0,0,arguments.length),new t(this.database,this._delegate.root)}set(e,n){B("Reference.set",1,2,arguments.length),nt("Reference.set","onComplete",n,!0);let r=dm(this._delegate,e);return n&&r.then(()=>n(null),i=>n(i)),r}update(e,n){if(B("Reference.update",1,2,arguments.length),Array.isArray(e)){let i={};for(let s=0;s<e.length;++s)i[""+s]=e[s];e=i,DF("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}en("Reference.update",this._delegate._path),nt("Reference.update","onComplete",n,!0);let r=tF(this._delegate,e);return n&&r.then(()=>n(null),i=>n(i)),r}setWithPriority(e,n,r){B("Reference.setWithPriority",2,3,arguments.length),nt("Reference.setWithPriority","onComplete",r,!0);let i=eF(this._delegate,e,n);return r&&i.then(()=>r(null),s=>r(s)),i}remove(e){B("Reference.remove",0,1,arguments.length),nt("Reference.remove","onComplete",e,!0);let n=X1(this._delegate);return e&&n.then(()=>e(null),r=>e(r)),n}transaction(e,n,r){B("Reference.transaction",1,3,arguments.length),nt("Reference.transaction","transactionUpdate",e,!1),nt("Reference.transaction","onComplete",n,!0),J3("Reference.transaction","applyLocally",r,!0);let i=CF(this._delegate,e,{applyLocally:r}).then(s=>new R0(s.committed,new io(this.database,s.snapshot)));return n&&i.then(s=>n(null,s.committed,s.snapshot),s=>n(s,!1,null)),i}setPriority(e,n){B("Reference.setPriority",1,2,arguments.length),nt("Reference.setPriority","onComplete",n,!0);let r=J1(this._delegate,e);return n&&r.then(()=>n(null),i=>n(i)),r}push(e,n){B("Reference.push",0,2,arguments.length),nt("Reference.push","onComplete",n,!0);let r=Z1(this._delegate,e),i=r.then(o=>new t(this.database,o));n&&i.then(()=>n(null),o=>n(o));let s=new t(this.database,r);return s.then=i.then.bind(i),s.catch=i.catch.bind(i,void 0),s}onDisconnect(){return en("Reference.onDisconnect",this._delegate._path),new M0(new Gg(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}};var so=class{constructor(e,n){this._delegate=e,this.app=n,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets:gF,forceLongPolling:mF}}useEmulator(e,n,r={}){yF(this._delegate,e,n,r)}ref(e){if(B("database.ref",0,1,arguments.length),e instanceof Gr){let n=C0(this._delegate,e.toString());return new Gr(this,n)}else{let n=I0(this._delegate,e);return new Gr(this,n)}}refFromURL(e){B("database.refFromURL",1,1,arguments.length);let r=C0(this._delegate,e);return new Gr(this,r)}goOffline(){return B("database.goOffline",0,0,arguments.length),_F(this._delegate)}goOnline(){return B("database.goOnline",0,0,arguments.length),vF(this._delegate)}};so.ServerValue={TIMESTAMP:EF(),increment:t=>IF(t)};function t6({app:t,url:e,version:n,customAuthImpl:r,customAppCheckImpl:i,namespace:s,nodeAdmin:o=!1}){YD(n);let a=new wm("database-standalone"),u=new vd("auth-internal",a);u.setComponent(new zt("auth-internal",()=>r,"PRIVATE"));let c;return i&&(c=new vd("app-check-internal",a),c.setComponent(new zt("app-check-internal",()=>i,"PRIVATE"))),{instance:new so(x0(t,u,c,e,o),t),namespace:s}}var n6=Object.freeze({__proto__:null,initStandalone:t6});var r6=so.ServerValue;function i6(t){t.INTERNAL.registerComponent(new zt("database-compat",(e,{instanceIdentifier:n})=>{let r=e.getProvider("app-compat").getImmediate(),i=e.getProvider("database").getImmediate({identifier:n});return new so(i,r)},"PUBLIC").setServiceProps({Reference:Gr,Query:fm,Database:so,DataSnapshot:io,enableLogging:wF,INTERNAL:n6,ServerValue:r6}).setMultipleInstances(!0)),t.registerVersion(Y3,Z3)}i6(pt);function hd(t,e,n="on",r=Yi){return new J(i=>{let s=null;return s=t[n](e,(o,a)=>{r.schedule(()=>{i.next({snapshot:o,prevKey:a})}),n==="once"&&r.schedule(()=>i.complete())},o=>{r.schedule(()=>i.error(o))}),n==="on"?{unsubscribe(){s!=null&&t.off(e,s)}}:{unsubscribe(){}}}).pipe(F(i=>{let{snapshot:s,prevKey:o}=i,a=null;return s.exists()&&(a=s.key),{type:e,payload:s,prevKey:o,key:a}}),Iu())}function s6(t){return typeof t=="string"}function o6(t){return typeof t.exportVal=="function"}function xF(t){return t==null}function MF(t){return typeof t.set=="function"}function TF(t,e){return MF(e)?e:t.ref(e)}function RF(t,e){if(s6(t))return e.stringCase();if(MF(t))return e.firebaseCase();if(o6(t))return e.snapshotCase();throw new Error(`Expects a string, snapshot, or reference. Got: ${typeof t}`)}function NF(t){return(xF(t)||t.length===0)&&(t=["child_added","child_removed","child_changed","child_moved"]),t}function PF(t,e,n){e=NF(e);let r=e.map(i=>hd(t,i,"on",n));return wo(...r)}function a6(t,e,n){let r=PF(t,e).pipe(Gn((i,s)=>[...i,s],[]));return c6(t,r,n)}function u6(t,e){return hd(t,"value","on",e).pipe(F(n=>{let r;return n.payload.forEach(i=>(r=i.key,!1)),{data:n,lastKeyToLoad:r}}))}function c6(t,e,n){return u6(t,n).pipe(Hm(e),F(([i,s])=>{let o=i.lastKeyToLoad,a=s.map(u=>u.key);return{actions:s,lastKeyToLoad:o,loadedKeys:a}}),Bm(i=>i.loadedKeys.indexOf(i.lastKeyToLoad)===-1),F(i=>i.actions))}function bF(t,e){return function(r,i){return RF(r,{stringCase:()=>t.child(r)[e](i),firebaseCase:()=>r[e](i),snapshotCase:()=>r.ref[e](i)})}}function l6(t){return function(n){return n?RF(n,{stringCase:()=>t.child(n).remove(),firebaseCase:()=>n.remove(),snapshotCase:()=>n.ref.remove()}):t.remove()}}function d6(t,e,n){return hd(t,"value","once",n).pipe(Re(r=>{let i=[V(r)];return e.forEach(s=>i.push(hd(t,s,"on",n))),wo(...i).pipe(Gn(f6,[]))}),vu())}function kF(t,e){let n=t.length;for(let r=0;r<n;r++)if(t[r].payload.key===e)return r;return-1}function h6(t,e){if(xF(e))return 0;{let n=kF(t,e);return n===-1?t.length:n+1}}function f6(t,e){let{payload:n,prevKey:r,key:i}=e,s=kF(t,i),o=h6(t,r);switch(e.type){case"value":if(e.payload?.exists()){let a=null;e.payload.forEach(u=>{let c={payload:u,type:"value",prevKey:a,key:u.key};return a=u.key,t=[...t,c],!1})}return t;case"child_added":if(s>-1)(t[s-1]?.key||null)!==r&&(t=t.filter(u=>u.payload.key!==n.key),t.splice(o,0,e));else{if(r==null)return[e,...t];t=t.slice(),t.splice(o,0,e)}return t;case"child_removed":return t.filter(a=>a.payload.key!==n.key);case"child_changed":return t.map(a=>a.payload.key===i?e:a);case"child_moved":if(s>-1){let a=t.splice(s,1)[0];return t=t.slice(),t.splice(o,0,a),t}return t;default:return t}}function SF(t,e,n){return e=NF(e),d6(t,e,n)}function p6(t,e){let n=e.schedulers.outsideAngular,r=e.schedulers.ngZone.run(()=>t.ref);return{query:t,update:bF(r,"update"),set:bF(r,"set"),push:i=>r.push(i),remove:l6(r),snapshotChanges(i){return SF(t,i,n).pipe($e)},stateChanges(i){return PF(t,i,n).pipe($e)},auditTrail(i){return a6(t,i,n).pipe($e)},valueChanges(i,s){return SF(t,i,n).pipe(F(a=>a.map(u=>s&&s.idField?ce(S({},u.payload.val()),{[s.idField]:u.key}):u.payload.val())),$e)}}}function AF(t,e){return function(){return hd(t,"value","on",e)}}function g6(t,e){return{query:t,snapshotChanges(){return AF(t,e.schedulers.outsideAngular)().pipe($e)},update(n){return t.ref.update(n)},set(n){return t.ref.set(n)},remove(){return t.ref.remove()},valueChanges(){return AF(t,e.schedulers.outsideAngular)().pipe($e,F(r=>r.payload.exists()?r.payload.val():null))}}}var m6=new P("angularfire2.realtimeDatabaseURL"),y6=new P("angularfire2.database.use-emulator"),_6=(()=>{class t{schedulers;database;constructor(n,r,i,s,o,a,u,c,l,d,h,f,p,g,_){this.schedulers=a;let C=u,M=vs(n,o,r);c&&vc(M,o,l,h,f,p,d,g),this.database=ra(`${M.name}.database.${i}`,"AngularFireDatabase",M.name,()=>{let T=o.runOutsideAngular(()=>M.database(i||void 0));return C&&T.useEmulator(...C),T},[C])}list(n,r){let i=this.schedulers.ngZone.runOutsideAngular(()=>TF(this.database,n)),s=i;return r&&(s=r(i)),p6(s,this)}object(n){let r=this.schedulers.ngZone.runOutsideAngular(()=>TF(this.database,n));return g6(r,this)}createPushId(){return this.schedulers.ngZone.runOutsideAngular(()=>this.database.ref()).push().key}static \u0275fac=function(r){return new(r||t)(I(fi),I(pi,8),I(m6,8),I(Ct),I(se),I(na),I(y6,8),I(vf,8),I(fc,8),I(pc,8),I(gc,8),I(mc,8),I(yc,8),I(_c,8),I(Nr,8))};static \u0275prov=k({token:t,factory:t.\u0275fac,providedIn:"any"})}return t})(),OF=(()=>{class t{constructor(){pt.registerVersion("angularfire",_s.full,"rtdb-compat")}static \u0275fac=function(r){return new(r||t)};static \u0275mod=Ye({type:t});static \u0275inj=Qe({providers:[_6]})}return t})();var FF={production:!1,firebaseConfig:{apiKey:"AIzaSyBbjeSuMPnN-FCWr8-TgnauzWLutGiGRrQ",authDomain:"clientes-975cc.firebaseapp.com",projectId:"clientes-975cc",storageBucket:"clientes-975cc.appspot.com",messagingSenderId:"677979834388",appId:"1:677979834388:web:3a7fc9bfc57268d284ff01"}};var VF=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=Ye({type:e,bootstrap:[hO]}),e.\u0275inj=Qe({imports:[FA,Sx,lO,Hx.initializeApp(FF.firebaseConfig),OF]});let t=e;return t})();OA().bootstrapModule(VF).catch(t=>console.error(t));
